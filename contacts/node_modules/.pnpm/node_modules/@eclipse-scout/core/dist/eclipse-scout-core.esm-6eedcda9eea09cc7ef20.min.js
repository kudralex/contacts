import*as Pb from"sourcemapped-stacktrace";var xi={};xi.n=i=>{var e=i&&i.__esModule?()=>i.default:()=>i;return xi.d(e,{a:e}),e},xi.d=(i,e)=>{for(var t in e)xi.o(e,t)&&!xi.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},xi.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),xi.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var c={};xi.r(c),xi.d(c,{AbortKeyStroke:()=>na,AbstractCompactTreeControlKeyStroke:()=>dn,AbstractGrid:()=>qo,AbstractLayout:()=>te,AbstractTableNavigationKeyStroke:()=>Ir,AbstractTreeNavigationKeyStroke:()=>is,Accordion:()=>_h,AccordionAdapter:()=>bh,AccordionField:()=>Bg,AccordionFieldAdapter:()=>Og,AccordionLayout:()=>la,Action:()=>oe,ActionAdapter:()=>bs,ActionExecKeyStroke:()=>ha,ActionKeyStroke:()=>Qs,AggregateTableControl:()=>Wr,AggregateTableControlAdapter:()=>Hu,AjaxCall:()=>Is,AjaxError:()=>Kn,AlphanumericSortingStringColumn:()=>cg,App:()=>ie,AppLinkKeyStroke:()=>hn,AutoLeafPageWithNodes:()=>Df,BackgroundJobPollingStatus:()=>Gi,BackgroundJobPollingSupport:()=>Qd,BasicField:()=>fl,BasicFieldAdapter:()=>Qa,BeanColumn:()=>pg,BeanField:()=>Hg,BeanFieldAdapter:()=>Ng,BeanTile:()=>V_,BeanTileAdapter:()=>W_,BenchColumn:()=>vr,BenchColumnLayoutData:()=>Io,BenchRowLayoutData:()=>af,BooleanColumn:()=>oo,Box:()=>ua,BoxButtons:()=>Xn,BreadcrumbBar:()=>bb,BreadcrumbBarAdapter:()=>yb,BreadcrumbBarField:()=>vb,BreadcrumbBarFieldAdapter:()=>wb,BreadcrumbBarLayout:()=>Gf,BreadcrumbItem:()=>zf,BreadcrumbItemAdapter:()=>gb,BrowserField:()=>Ao,BrowserFieldAdapter:()=>Vg,BrowserFieldLayout:()=>Cc,BusyIndicator:()=>Zd,Button:()=>Le,ButtonAdapter:()=>Pc,ButtonAdapterMenu:()=>Dn,ButtonKeyStroke:()=>cn,ButtonLayout:()=>ed,ButtonTile:()=>Zp,CachedElement:()=>Wl,Calculator:()=>Nc,Calendar:()=>Ne,CalendarAdapter:()=>Nm,CalendarComponent:()=>Mn,CalendarComponentAdapter:()=>Vm,CalendarField:()=>Wg,CalendarFieldAdapter:()=>Kg,CalendarLayout:()=>iu,CalendarListComponent:()=>tu,CalendarModeMenu:()=>on,CalendarModesMenu:()=>ru,Call:()=>An,CancelMenu:()=>gu,Carousel:()=>Fm,CarouselField:()=>zg,CarouselLayout:()=>yh,Cell:()=>Pt,CellEditorCancelEditKeyStroke:()=>zu,CellEditorCompleteEditKeyStroke:()=>Gu,CellEditorPopup:()=>Vu,CellEditorPopupLayout:()=>Ku,CellEditorTabKeyStroke:()=>Uu,CheckBoxField:()=>Fs,CheckBoxFieldAdapter:()=>Gg,CheckBoxToggleKeyStroke:()=>td,ClickActiveElementKeyStroke:()=>jn,ClipboardField:()=>Do,ClipboardFieldAdapter:()=>Ug,CloseKeyStroke:()=>Jo,CloseMenu:()=>Qm,Code:()=>fm,CodeLookupCall:()=>Yl,CodeType:()=>kn,CollapseHandle:()=>er,ColorField:()=>qg,ColorFieldAdapter:()=>Yg,Column:()=>Me,ColumnLayout:()=>ch,ColumnOptimalWidthMeasurer:()=>$u,ColumnUserFilter:()=>Zi,ComboMenu:()=>Wh,ComboMenuAdapter:()=>km,CompactBean:()=>Lu,CompactColumn:()=>Ru,CompactLine:()=>Iu,CompactLineBlock:()=>cl,CompactTree:()=>Fg,CompactTreeDownKeyStroke:()=>mc,CompactTreeLeftKeyStroke:()=>gc,CompactTreeNode:()=>pc,CompactTreeRightKeyStroke:()=>_c,CompactTreeUpKeyStroke:()=>fc,Composite:()=>Qf,CompositeField:()=>xs,CompositeFieldAdapter:()=>un,CompositeTile:()=>Np,ContextMenuKeyStroke:()=>sa,ContextMenuPopup:()=>mt,ContextMenuPopupLayout:()=>Kh,CopyKeyStroke:()=>Sc,DateColumn:()=>ku,DateColumnUserFilter:()=>yg,DateField:()=>Kt,DateFieldAdapter:()=>Mo,DateFormat:()=>Ft,DateFormatPatternDefinition:()=>Je,DateFormatPatternType:()=>Xe,DatePicker:()=>fa,DatePickerPopup:()=>ma,DatePickerPopupLayout:()=>Mh,DatePickerTouchPopup:()=>$h,DatePickerTouchPopupLayout:()=>Rh,DatePredictionFailedStatus:()=>id,DateRange:()=>We,DateTimeCompositeLayout:()=>xc,DecimalFormat:()=>Ur,DefaultStatus:()=>Lo,DeferredGlassPaneTarget:()=>To,Desktop:()=>Ie,DesktopAdapter:()=>X_,DesktopBench:()=>Pi,DesktopFormController:()=>Hf,DesktopHeader:()=>hf,DesktopHeaderLayout:()=>cf,DesktopLayout:()=>tf,DesktopLogo:()=>ef,DesktopNavigation:()=>zt,DesktopNavigationHandle:()=>Cd,DesktopNavigationLayout:()=>pf,DesktopNotification:()=>ii,DesktopNotificationAdapter:()=>eb,DesktopResponsiveHandler:()=>ig,DesktopTab:()=>rf,DesktopTabArea:()=>wd,DesktopTabAreaLayout:()=>sf,DesktopTabBoxController:()=>Td,DesktopTabSelectKeyStroke:()=>of,DesktopToolBox:()=>xd,DetailTableTreeFilter:()=>Mf,Device:()=>F,DialogLayout:()=>br,Dimension:()=>A,DisableBrowserF5ReloadKeyStroke:()=>nf,DisableBrowserTabSwitchingKeyStroke:()=>df,DoubleClickSupport:()=>Vs,DragAndDropHandler:()=>Gd,EllipsisMenu:()=>tl,EllipsisTabMenu:()=>yp,EnlargeNavigationKeyStroke:()=>mf,ErrorHandler:()=>vo,Event:()=>Gt,EventDelegator:()=>gr,EventEmitter:()=>ir,EventSupport:()=>On,Extension:()=>Jf,FieldStatus:()=>Xa,FileChooser:()=>zm,FileChooserAdapter:()=>Gm,FileChooserButton:()=>jg,FileChooserButtonAdapter:()=>Xg,FileChooserController:()=>ll,FileChooserField:()=>Jg,FileChooserFieldAdapter:()=>El,FileChooserFieldBrowseKeyStroke:()=>Ec,FileChooserFieldDeleteKeyStroke:()=>Ac,FileInput:()=>wi,FilterFieldsGroupBox:()=>Nf,FilterSupport:()=>Ho,FlexboxLayout:()=>ls,FlexboxLayoutData:()=>ks,FocusAdjacentElementKeyStroke:()=>oa,FocusContext:()=>aa,FocusFilterFieldKeyStroke:()=>Ol,FocusManager:()=>vh,FocusRule:()=>It,Form:()=>Y,FormAdapter:()=>Pa,FormController:()=>ml,FormField:()=>M,FormFieldAdapter:()=>dt,FormFieldLayout:()=>li,FormFieldMenu:()=>Bm,FormFieldMenuAdapter:()=>Om,FormFieldTile:()=>Vi,FormFieldTileAdapter:()=>q_,FormGrid:()=>pu,FormLayout:()=>dl,FormLifecycle:()=>mu,FormLifecycleMenu:()=>ro,FormMenu:()=>qr,FormMenuActionKeyStroke:()=>fu,FormMenuAdapter:()=>Jm,FormTableControl:()=>_g,FormTableControlAdapter:()=>bg,FormTableControlLayout:()=>Nu,GlassPane:()=>Em,GlassPaneRenderer:()=>js,GridData:()=>ze,Group:()=>Si,GroupAdapter:()=>Im,GroupBox:()=>Fe,GroupBoxAdapter:()=>Mc,GroupBoxGridConfig:()=>Dc,GroupBoxLayout:()=>rd,GroupBoxMenuItemsOrder:()=>rs,GroupBoxResponsiveHandler:()=>$n,GroupLayout:()=>Lh,GroupToggleCollapseKeyStroke:()=>Ih,HAlign:()=>ht,HeaderTabBoxController:()=>uf,HierarchicalLookupResultBuilder:()=>Jd,HorizontalGrid:()=>Ks,HorizontalGridMatrix:()=>hh,HtmlComponent:()=>S,HtmlEncoder:()=>qd,HtmlEnvironment:()=>ue,HtmlField:()=>Lc,HtmlFieldAdapter:()=>Qg,HtmlTile:()=>Vp,HtmlTileAdapter:()=>N_,HybridManager:()=>Od,HybridManagerAdapter:()=>Z_,IFrame:()=>wh,Icon:()=>Qr,IconColumn:()=>Ra,IconDesc:()=>hi,Image:()=>_a,ImageField:()=>Hs,ImageFieldAdapter:()=>Zg,ImageFieldLayout:()=>Ic,ImageLayout:()=>Bh,InputFieldKeyStrokeContext:()=>Fr,Insets:()=>qe,IntegerField:()=>$o,JsFormAdapter:()=>sg,Key:()=>qn,KeyStroke:()=>B,KeyStrokeContext:()=>Oe,KeyStrokeManager:()=>mh,KeyTableFilter:()=>Sg,Label:()=>ca,LabelAdapter:()=>Mm,LabelField:()=>sd,LabelFieldAdapter:()=>e_,LayoutConstants:()=>qi,LayoutValidator:()=>nh,LazyNodeFilter:()=>dc,Lifecycle:()=>su,ListBox:()=>od,ListBoxAdapter:()=>t_,ListBoxLayout:()=>Bc,LoadingSupport:()=>rr,Locale:()=>ti,LogLevel:()=>je,LogicalGrid:()=>ea,LogicalGridConfig:()=>gs,LogicalGridData:()=>Nr,LogicalGridLayout:()=>Uo,LogicalGridLayoutConfig:()=>di,LogicalGridLayoutInfo:()=>ah,LogicalGridMatrix:()=>ta,LogicalGridMatrixCell:()=>Yo,LogicalGridMatrixCursor:()=>Hi,LoginApp:()=>fb,LoginBox:()=>Ml,LogoutApp:()=>mb,LogoutBox:()=>Kf,LookupBox:()=>Po,LookupBoxLayout:()=>Za,LookupCall:()=>ei,LookupFieldAdapter:()=>nd,LookupRow:()=>jr,MaxLengthHandler:()=>Nn,Menu:()=>le,MenuAdapter:()=>il,MenuBar:()=>ce,MenuBarBox:()=>wa,MenuBarBoxLayout:()=>eu,MenuBarLayout:()=>Zr,MenuBarLeftKeyStroke:()=>Jh,MenuBarPopup:()=>Zh,MenuBarRightKeyStroke:()=>Qh,MenuBox:()=>Yh,MenuBoxLayout:()=>jh,MenuDestinations:()=>kt,MenuExecByNumberKeyStroke:()=>zh,MenuExecKeyStroke:()=>Vh,MenuItemsOrder:()=>sn,MenuKeyStroke:()=>Nh,MenuNavigationDownKeyStroke:()=>Gh,MenuNavigationExecKeyStroke:()=>ol,MenuNavigationKeyStroke:()=>sl,MenuNavigationUpKeyStroke:()=>Uh,MessageBox:()=>Ti,MessageBoxAdapter:()=>Lg,MessageBoxController:()=>gl,MessageBoxLayout:()=>Tc,MessageBoxes:()=>as,MobilePopup:()=>Ah,MobilePopupAdapter:()=>Rm,MobilePopupLayout:()=>Dh,Mode:()=>jm,ModeAdapter:()=>Xm,ModeSelector:()=>uu,ModeSelectorField:()=>i_,ModeSelectorFieldAdapter:()=>r_,ModeSelectorLayout:()=>cu,ModelAdapter:()=>He,NavigateButton:()=>Fn,NavigateDownButton:()=>Md,NavigateUpButton:()=>$d,Notification:()=>Oh,NotificationAdapter:()=>Hh,NotificationBadgeStatus:()=>Kr,NullLayout:()=>jo,NullLogger:()=>Vl,NullWidget:()=>Hl,NullWidgetAdapter:()=>Zf,NumberColumn:()=>Oi,NumberColumnUserFilter:()=>vg,NumberField:()=>fo,NumberFieldAdapter:()=>Hc,ObjectFactory:()=>$t,OfflineDesktopNotification:()=>_f,OkMenu:()=>_u,OpenUriHandler:()=>lf,Outline:()=>fr,OutlineAdapter:()=>us,OutlineKeyStrokeContext:()=>If,OutlineLayout:()=>Ad,OutlineMediator:()=>$f,OutlineNavigateToTopKeyStroke:()=>kf,OutlineOverview:()=>Rd,OutlineTileField:()=>lb,OutlineTileFieldAdapter:()=>ab,OutlineViewButton:()=>Dd,OutlineViewButtonAdapter:()=>ob,Page:()=>ai,PageLayout:()=>Rf,PageTileButton:()=>Ef,PageTileGrid:()=>Ed,PageTileGridSelectKeyStroke:()=>Af,PageWithNodes:()=>ib,PageWithTable:()=>rb,ParsingFailedStatus:()=>vi,PlaceholderField:()=>ad,PlaceholderFieldAdapter:()=>o_,PlaceholderTile:()=>bi,PlainTextEncoder:()=>Ud,Planner:()=>he,PlannerAdapter:()=>Os,PlannerField:()=>n_,PlannerFieldAdapter:()=>l_,PlannerHeader:()=>ou,PlannerLayout:()=>nu,PlannerMenuItemsOrder:()=>lu,Point:()=>Z,Popup:()=>pe,PopupAdapter:()=>Ph,PopupBlockerDesktopNotification:()=>yf,PopupBlockerHandler:()=>Pn,PopupLayout:()=>Ii,PopupManager:()=>kd,PopupManagerAdapter:()=>$m,PopupWindow:()=>Bs,PrepopulatedLookupCall:()=>cm,PromiseCreator:()=>sm,PropertyChangeEventFilter:()=>th,PropertyEventEmitter:()=>Il,ProposalChooser:()=>ud,ProposalChooserLayout:()=>ip,ProposalField:()=>Zc,ProposalFieldAdapter:()=>g_,ProposalTreeNode:()=>tp,QueryBy:()=>me,RadioButton:()=>bl,RadioButtonAdapter:()=>a_,RadioButtonGroup:()=>ds,RadioButtonGroupAdapter:()=>d_,RadioButtonGroupGridConfig:()=>Wc,RadioButtonGroupLayout:()=>Kc,RadioButtonGroupLeftOrUpKeyStroke:()=>zc,RadioButtonGroupRightOrDownKeyStroke:()=>Gc,RadioButtonKeyStroke:()=>yl,RadioButtonLayout:()=>Vc,Range:()=>O,RangeKeyStroke:()=>Yn,Reconnector:()=>ih,Rectangle:()=>re,RemoteApp:()=>jf,RemoteEvent:()=>jl,RemoteLookupCall:()=>ql,RemoteLookupRequest:()=>ns,RemoteTileFilter:()=>_d,ResetMenu:()=>Zm,Resizable:()=>Ee,ResponseQueue:()=>Fo,ResponsiveHandler:()=>Fa,ResponsiveManager:()=>ne,RestLookupCall:()=>am,RoundingMode:()=>or,Route:()=>qm,RouteChangeEvent:()=>au,RowLayout:()=>Ri,SaveMenu:()=>eg,Scrollbar:()=>Jn,SearchOutline:()=>hb,SearchOutlineAdapter:()=>ub,SearchOutlineLayout:()=>Lf,SequenceBox:()=>vl,SequenceBoxAdapter:()=>h_,SequenceBoxGridConfig:()=>Uc,SequenceBoxLayout:()=>qc,Session:()=>ci,ShrinkNavigationKeyStroke:()=>ff,SimpleLoadingSupport:()=>Kd,SimpleTab:()=>yd,SimpleTabArea:()=>Ni,SimpleTabAreaLayout:()=>vd,SimpleTabBox:()=>ia,SimpleTabBoxController:()=>wo,SimpleTabBoxLayout:()=>ph,SimpleTabViewContentLayout:()=>fh,SingleLayout:()=>Cr,Slider:()=>du,SliderAdapter:()=>Ym,SliderField:()=>u_,SliderLayout:()=>hu,SmartColumn:()=>mg,SmartField:()=>ae,SmartFieldAdapter:()=>xo,SmartFieldCancelKeyStroke:()=>Yc,SmartFieldLayout:()=>dd,SmartFieldMultiline:()=>p_,SmartFieldMultilineAdapter:()=>f_,SmartFieldMultilineLayout:()=>Qc,SmartFieldPopup:()=>Al,SmartFieldPopupLayout:()=>Xc,SmartFieldTouchPopup:()=>c_,SplitBox:()=>_e,SplitBoxAdapter:()=>v_,SplitBoxCollapseKeyStroke:()=>np,SplitBoxFirstCollapseKeyStroke:()=>lp,SplitBoxLayout:()=>dp,SplitBoxSecondCollapseKeyStroke:()=>ap,Splitter:()=>Xr,StaticLookupCall:()=>Ko,Status:()=>E,StatusMenuMapping:()=>Ag,StatusMenuMappingAdapter:()=>Dg,StringField:()=>Wi,StringFieldAdapter:()=>w_,StringFieldCtrlEnterKeyStroke:()=>cp,StringFieldEnterKeyStroke:()=>up,StringFieldLayout:()=>hp,SubCloseKeyStroke:()=>qh,Switch:()=>O_,Tab:()=>pd,TabArea:()=>_r,TabAreaLayout:()=>bp,TabAreaLeftKeyStroke:()=>pp,TabAreaRightKeyStroke:()=>fp,TabBox:()=>mn,TabBoxAdapter:()=>T_,TabBoxHeader:()=>_p,TabBoxHeaderLayout:()=>gp,TabBoxLayout:()=>wp,TabItem:()=>Tp,TabItemAdapter:()=>C_,TabItemKeyStroke:()=>gh,TabItemLayout:()=>Sp,Table:()=>W,TableAdapter:()=>So,TableCompactHandler:()=>yu,TableControl:()=>yr,TableControlActionKeyStroke:()=>Bu,TableControlAdapter:()=>La,TableControlAdapterMenu:()=>Co,TableControlCloseKeyStroke:()=>qu,TableCopyKeyStroke:()=>Yu,TableField:()=>Ro,TableFieldAdapter:()=>P_,TableFooter:()=>vu,TableFooterLayout:()=>wu,TableHeader:()=>Tu,TableHeaderMenu:()=>Ci,TableHeaderMenuButton:()=>ut,TableHeaderMenuGroup:()=>Lr,TableHeaderMenuLayout:()=>Eo,TableInfoFilterTooltip:()=>og,TableInfoLoadTooltip:()=>ng,TableInfoSelectionTooltip:()=>lg,TableLayout:()=>Su,TableLayoutResetter:()=>cd,TableMatrix:()=>At,TableNavigationCollapseKeyStroke:()=>ju,TableNavigationDownKeyStroke:()=>ic,TableNavigationEndKeyStroke:()=>sc,TableNavigationExpandKeyStroke:()=>Xu,TableNavigationHomeKeyStroke:()=>rc,TableNavigationPageDownKeyStroke:()=>nc,TableNavigationPageUpKeyStroke:()=>oc,TableNavigationUpKeyStroke:()=>tc,TableProposalChooser:()=>b_,TableRefreshKeyStroke:()=>Zu,TableRow:()=>Qt,TableRowDetail:()=>Ma,TableRowTileMapping:()=>hg,TableRowTileMappingAdapter:()=>ug,TableSelectAllKeyStroke:()=>Ju,TableSelectionHandler:()=>Cu,TableStartCellEditKeyStroke:()=>Qu,TableTextUserFilter:()=>mr,TableTileGridMediator:()=>so,TableTileGridMediatorAdapter:()=>Pu,TableToggleRowKeyStroke:()=>ec,TableTooltip:()=>Fu,TableUpdateBuffer:()=>Au,TableUserFilter:()=>Zt,TagBar:()=>ui,TagBarLayout:()=>Lp,TagBarOverflowPopup:()=>Dl,TagBarOverflowPopupLayout:()=>Ip,TagChooserPopup:()=>Cp,TagChooserPopupLayout:()=>Pp,TagField:()=>Bd,TagFieldAdapter:()=>F_,TagFieldContainerLayout:()=>Ln,TagFieldDeleteKeyStroke:()=>fd,TagFieldEnterKeyStroke:()=>xp,TagFieldLayout:()=>Ep,TagFieldNavigationKeyStroke:()=>md,TagFieldOpenPopupKeyStroke:()=>Fp,TextColumnUserFilter:()=>Tg,TextMap:()=>Vr,TextTableFilter:()=>Cg,Tile:()=>Wt,TileAccordion:()=>Wp,TileAccordionAdapter:()=>K_,TileAccordionLayout:()=>Kp,TileAccordionSelectionHandler:()=>zp,TileAdapter:()=>vn,TileButton:()=>Tl,TileField:()=>D_,TileFieldAdapter:()=>M_,TileGrid:()=>_o,TileGridAdapter:()=>Bp,TileGridGridConfig:()=>Op,TileGridLayout:()=>hs,TileGridLayoutConfig:()=>tr,TileGridSelectAllKeyStroke:()=>Gp,TileGridSelectDownKeyStroke:()=>Yp,TileGridSelectFirstKeyStroke:()=>Xp,TileGridSelectKeyStroke:()=>ss,TileGridSelectLastKeyStroke:()=>Jp,TileGridSelectLeftKeyStroke:()=>Up,TileGridSelectRightKeyStroke:()=>qp,TileGridSelectUpKeyStroke:()=>jp,TileGridSelectionHandler:()=>gd,TileHtmlField:()=>Y_,TileOutlineOverview:()=>Pl,TileOverviewForm:()=>Aa,TileOverviewFormAdapter:()=>rg,TileTableField:()=>j_,TileTableHeaderBox:()=>Wf,TileTableHeaderGroupByLookupCall:()=>Du,TileTableHeaderSortByLookupCall:()=>Mu,TileTableHierarchyFilter:()=>lc,TileTextFilter:()=>Tn,TimePicker:()=>Wa,TimePickerPopup:()=>Ka,TimePickerPopupLayout:()=>ac,TimePickerTouchPopup:()=>za,Tooltip:()=>lr,TooltipSupport:()=>da,TouchPopup:()=>el,TouchPopupLayout:()=>pa,Tree:()=>fe,TreeAdapter:()=>Rn,TreeBox:()=>R_,TreeBoxAdapter:()=>L_,TreeBoxLayout:()=>Ap,TreeBreadcrumbFilter:()=>hc,TreeCollapseAllKeyStroke:()=>cc,TreeCollapseOrDrillUpKeyStroke:()=>Ya,TreeExpandOrDrillDownKeyStroke:()=>ja,TreeField:()=>Dp,TreeFieldAdapter:()=>Mp,TreeLayout:()=>pl,TreeLayoutResetter:()=>op,TreeNavigationDownKeyStroke:()=>Ua,TreeNavigationEndKeyStroke:()=>qa,TreeNavigationUpKeyStroke:()=>Ga,TreeNode:()=>ts,TreeProposalChooser:()=>sp,TreeSet:()=>Kl,TreeSpaceKeyStroke:()=>uc,TreeVisitResult:()=>ye,TypeDescriptor:()=>zr,URL:()=>Et,UnsavedFormChangesForm:()=>In,UnsavedFormsLookupCall:()=>Vf,UserAgent:()=>sh,UuidPool:()=>wr,UuidPoolAdapter:()=>Tb,ValidationFailedStatus:()=>Wn,ValueField:()=>ge,ValueFieldAdapter:()=>Ot,VerticalGridMatrix:()=>Fl,VerticalSmartGrid:()=>dh,ViewButton:()=>Tf,ViewButtonActionKeyStroke:()=>vf,ViewButtonAdapter:()=>Sf,ViewButtonBox:()=>Fd,ViewMenuOpenKeyStroke:()=>Cf,ViewMenuPopup:()=>Pf,ViewMenuPopupEnterKeyStroke:()=>xf,ViewMenuTab:()=>Ff,ViewportScroller:()=>Gr,VirtualKeyStrokeEvent:()=>ra,VirtualScrolling:()=>Th,Widget:()=>I,WidgetEventTypeFilter:()=>oh,WidgetField:()=>$g,WidgetFieldAdapter:()=>Rg,WidgetFieldLayout:()=>yc,WidgetPopup:()=>tn,WidgetPopupAdapter:()=>xh,WidgetPopupLayout:()=>Fh,WidgetSupport:()=>Bl,WidgetTile:()=>Qp,WidgetTileAdapter:()=>U_,WidgetTooltip:()=>Dm,WizardProgressField:()=>I_,WizardProgressFieldAdapter:()=>k_,WizardProgressFieldLayout:()=>$p,WrappedFormField:()=>_n,WrappedFormFieldAdapter:()=>B_,YearPanel:()=>Sa,aggregation:()=>wt,ajax:()=>Di,arrays:()=>f,clipboard:()=>sr,codes:()=>Tt,colorSchemes:()=>Lt,comparators:()=>gt,cookies:()=>Gl,dates:()=>T,default:()=>Cb,defaultValues:()=>Ve,dragAndDrop:()=>Ae,events:()=>lt,fields:()=>ee,files:()=>Yr,filters:()=>ps,focusUtils:()=>Yi,fonts:()=>vt,graphics:()=>w,icons:()=>ve,inspector:()=>Vo,isPropertyChangeEvent:()=>Yf,keyStrokeModifier:()=>Se,keys:()=>_,locales:()=>bt,logging:()=>pi,lookupField:()=>fn,menuNavigationKeyStrokes:()=>vs,menus:()=>Ke,mimeTypes:()=>at,models:()=>cs,numbers:()=>Ge,objects:()=>v,promises:()=>om,router:()=>Yt,scout:()=>u,scrollbars:()=>x,strings:()=>y,styles:()=>L,texts:()=>Ce,tooltips:()=>G,webstorage:()=>Pe,widgets:()=>ke});var Rl={};xi.r(Rl),xi.d(Rl,{AbortKeyStroke:()=>na,AbstractCompactTreeControlKeyStroke:()=>dn,AbstractGrid:()=>qo,AbstractLayout:()=>te,AbstractTableNavigationKeyStroke:()=>Ir,AbstractTreeNavigationKeyStroke:()=>is,Accordion:()=>_h,AccordionAdapter:()=>bh,AccordionField:()=>Bg,AccordionFieldAdapter:()=>Og,AccordionLayout:()=>la,Action:()=>oe,ActionAdapter:()=>bs,ActionExecKeyStroke:()=>ha,ActionKeyStroke:()=>Qs,AggregateTableControl:()=>Wr,AggregateTableControlAdapter:()=>Hu,AjaxCall:()=>Is,AjaxError:()=>Kn,AlphanumericSortingStringColumn:()=>cg,App:()=>ie,AppLinkKeyStroke:()=>hn,AutoLeafPageWithNodes:()=>Df,BackgroundJobPollingStatus:()=>Gi,BackgroundJobPollingSupport:()=>Qd,BasicField:()=>fl,BasicFieldAdapter:()=>Qa,BeanColumn:()=>pg,BeanField:()=>Hg,BeanFieldAdapter:()=>Ng,BeanTile:()=>V_,BeanTileAdapter:()=>W_,BenchColumn:()=>vr,BenchColumnLayoutData:()=>Io,BenchRowLayoutData:()=>af,BooleanColumn:()=>oo,Box:()=>ua,BoxButtons:()=>Xn,BreadcrumbBar:()=>bb,BreadcrumbBarAdapter:()=>yb,BreadcrumbBarField:()=>vb,BreadcrumbBarFieldAdapter:()=>wb,BreadcrumbBarLayout:()=>Gf,BreadcrumbItem:()=>zf,BreadcrumbItemAdapter:()=>gb,BrowserField:()=>Ao,BrowserFieldAdapter:()=>Vg,BrowserFieldLayout:()=>Cc,BusyIndicator:()=>Zd,Button:()=>Le,ButtonAdapter:()=>Pc,ButtonAdapterMenu:()=>Dn,ButtonKeyStroke:()=>cn,ButtonLayout:()=>ed,ButtonTile:()=>Zp,CachedElement:()=>Wl,Calculator:()=>Nc,Calendar:()=>Ne,CalendarAdapter:()=>Nm,CalendarComponent:()=>Mn,CalendarComponentAdapter:()=>Vm,CalendarField:()=>Wg,CalendarFieldAdapter:()=>Kg,CalendarLayout:()=>iu,CalendarListComponent:()=>tu,CalendarModeMenu:()=>on,CalendarModesMenu:()=>ru,Call:()=>An,CancelMenu:()=>gu,Carousel:()=>Fm,CarouselField:()=>zg,CarouselLayout:()=>yh,Cell:()=>Pt,CellEditorCancelEditKeyStroke:()=>zu,CellEditorCompleteEditKeyStroke:()=>Gu,CellEditorPopup:()=>Vu,CellEditorPopupLayout:()=>Ku,CellEditorTabKeyStroke:()=>Uu,CheckBoxField:()=>Fs,CheckBoxFieldAdapter:()=>Gg,CheckBoxToggleKeyStroke:()=>td,ClickActiveElementKeyStroke:()=>jn,ClipboardField:()=>Do,ClipboardFieldAdapter:()=>Ug,CloseKeyStroke:()=>Jo,CloseMenu:()=>Qm,Code:()=>fm,CodeLookupCall:()=>Yl,CodeType:()=>kn,CollapseHandle:()=>er,ColorField:()=>qg,ColorFieldAdapter:()=>Yg,Column:()=>Me,ColumnLayout:()=>ch,ColumnOptimalWidthMeasurer:()=>$u,ColumnUserFilter:()=>Zi,ComboMenu:()=>Wh,ComboMenuAdapter:()=>km,CompactBean:()=>Lu,CompactColumn:()=>Ru,CompactLine:()=>Iu,CompactLineBlock:()=>cl,CompactTree:()=>Fg,CompactTreeDownKeyStroke:()=>mc,CompactTreeLeftKeyStroke:()=>gc,CompactTreeNode:()=>pc,CompactTreeRightKeyStroke:()=>_c,CompactTreeUpKeyStroke:()=>fc,Composite:()=>Qf,CompositeField:()=>xs,CompositeFieldAdapter:()=>un,CompositeTile:()=>Np,ContextMenuKeyStroke:()=>sa,ContextMenuPopup:()=>mt,ContextMenuPopupLayout:()=>Kh,CopyKeyStroke:()=>Sc,DateColumn:()=>ku,DateColumnUserFilter:()=>yg,DateField:()=>Kt,DateFieldAdapter:()=>Mo,DateFormat:()=>Ft,DateFormatPatternDefinition:()=>Je,DateFormatPatternType:()=>Xe,DatePicker:()=>fa,DatePickerPopup:()=>ma,DatePickerPopupLayout:()=>Mh,DatePickerTouchPopup:()=>$h,DatePickerTouchPopupLayout:()=>Rh,DatePredictionFailedStatus:()=>id,DateRange:()=>We,DateTimeCompositeLayout:()=>xc,DecimalFormat:()=>Ur,DefaultStatus:()=>Lo,DeferredGlassPaneTarget:()=>To,Desktop:()=>Ie,DesktopAdapter:()=>X_,DesktopBench:()=>Pi,DesktopFormController:()=>Hf,DesktopHeader:()=>hf,DesktopHeaderLayout:()=>cf,DesktopLayout:()=>tf,DesktopLogo:()=>ef,DesktopNavigation:()=>zt,DesktopNavigationHandle:()=>Cd,DesktopNavigationLayout:()=>pf,DesktopNotification:()=>ii,DesktopNotificationAdapter:()=>eb,DesktopResponsiveHandler:()=>ig,DesktopTab:()=>rf,DesktopTabArea:()=>wd,DesktopTabAreaLayout:()=>sf,DesktopTabBoxController:()=>Td,DesktopTabSelectKeyStroke:()=>of,DesktopToolBox:()=>xd,DetailTableTreeFilter:()=>Mf,Device:()=>F,DialogLayout:()=>br,Dimension:()=>A,DisableBrowserF5ReloadKeyStroke:()=>nf,DisableBrowserTabSwitchingKeyStroke:()=>df,DoubleClickSupport:()=>Vs,DragAndDropHandler:()=>Gd,EllipsisMenu:()=>tl,EllipsisTabMenu:()=>yp,EnlargeNavigationKeyStroke:()=>mf,ErrorHandler:()=>vo,Event:()=>Gt,EventDelegator:()=>gr,EventEmitter:()=>ir,EventSupport:()=>On,Extension:()=>Jf,FieldStatus:()=>Xa,FileChooser:()=>zm,FileChooserAdapter:()=>Gm,FileChooserButton:()=>jg,FileChooserButtonAdapter:()=>Xg,FileChooserController:()=>ll,FileChooserField:()=>Jg,FileChooserFieldAdapter:()=>El,FileChooserFieldBrowseKeyStroke:()=>Ec,FileChooserFieldDeleteKeyStroke:()=>Ac,FileInput:()=>wi,FilterFieldsGroupBox:()=>Nf,FilterSupport:()=>Ho,FlexboxLayout:()=>ls,FlexboxLayoutData:()=>ks,FocusAdjacentElementKeyStroke:()=>oa,FocusContext:()=>aa,FocusFilterFieldKeyStroke:()=>Ol,FocusManager:()=>vh,FocusRule:()=>It,Form:()=>Y,FormAdapter:()=>Pa,FormController:()=>ml,FormField:()=>M,FormFieldAdapter:()=>dt,FormFieldLayout:()=>li,FormFieldMenu:()=>Bm,FormFieldMenuAdapter:()=>Om,FormFieldTile:()=>Vi,FormFieldTileAdapter:()=>q_,FormGrid:()=>pu,FormLayout:()=>dl,FormLifecycle:()=>mu,FormLifecycleMenu:()=>ro,FormMenu:()=>qr,FormMenuActionKeyStroke:()=>fu,FormMenuAdapter:()=>Jm,FormTableControl:()=>_g,FormTableControlAdapter:()=>bg,FormTableControlLayout:()=>Nu,GlassPane:()=>Em,GlassPaneRenderer:()=>js,GridData:()=>ze,Group:()=>Si,GroupAdapter:()=>Im,GroupBox:()=>Fe,GroupBoxAdapter:()=>Mc,GroupBoxGridConfig:()=>Dc,GroupBoxLayout:()=>rd,GroupBoxMenuItemsOrder:()=>rs,GroupBoxResponsiveHandler:()=>$n,GroupLayout:()=>Lh,GroupToggleCollapseKeyStroke:()=>Ih,HAlign:()=>ht,HeaderTabBoxController:()=>uf,HierarchicalLookupResultBuilder:()=>Jd,HorizontalGrid:()=>Ks,HorizontalGridMatrix:()=>hh,HtmlComponent:()=>S,HtmlEncoder:()=>qd,HtmlEnvironment:()=>ue,HtmlField:()=>Lc,HtmlFieldAdapter:()=>Qg,HtmlTile:()=>Vp,HtmlTileAdapter:()=>N_,HybridManager:()=>Od,HybridManagerAdapter:()=>Z_,IFrame:()=>wh,Icon:()=>Qr,IconColumn:()=>Ra,IconDesc:()=>hi,Image:()=>_a,ImageField:()=>Hs,ImageFieldAdapter:()=>Zg,ImageFieldLayout:()=>Ic,ImageLayout:()=>Bh,InputFieldKeyStrokeContext:()=>Fr,Insets:()=>qe,IntegerField:()=>$o,JsFormAdapter:()=>sg,Key:()=>qn,KeyStroke:()=>B,KeyStrokeContext:()=>Oe,KeyStrokeManager:()=>mh,KeyTableFilter:()=>Sg,Label:()=>ca,LabelAdapter:()=>Mm,LabelField:()=>sd,LabelFieldAdapter:()=>e_,LayoutConstants:()=>qi,LayoutValidator:()=>nh,LazyNodeFilter:()=>dc,Lifecycle:()=>su,ListBox:()=>od,ListBoxAdapter:()=>t_,ListBoxLayout:()=>Bc,LoadingSupport:()=>rr,Locale:()=>ti,LogLevel:()=>je,LogicalGrid:()=>ea,LogicalGridConfig:()=>gs,LogicalGridData:()=>Nr,LogicalGridLayout:()=>Uo,LogicalGridLayoutConfig:()=>di,LogicalGridLayoutInfo:()=>ah,LogicalGridMatrix:()=>ta,LogicalGridMatrixCell:()=>Yo,LogicalGridMatrixCursor:()=>Hi,LoginApp:()=>fb,LoginBox:()=>Ml,LogoutApp:()=>mb,LogoutBox:()=>Kf,LookupBox:()=>Po,LookupBoxLayout:()=>Za,LookupCall:()=>ei,LookupFieldAdapter:()=>nd,LookupRow:()=>jr,MaxLengthHandler:()=>Nn,Menu:()=>le,MenuAdapter:()=>il,MenuBar:()=>ce,MenuBarBox:()=>wa,MenuBarBoxLayout:()=>eu,MenuBarLayout:()=>Zr,MenuBarLeftKeyStroke:()=>Jh,MenuBarPopup:()=>Zh,MenuBarRightKeyStroke:()=>Qh,MenuBox:()=>Yh,MenuBoxLayout:()=>jh,MenuDestinations:()=>kt,MenuExecByNumberKeyStroke:()=>zh,MenuExecKeyStroke:()=>Vh,MenuItemsOrder:()=>sn,MenuKeyStroke:()=>Nh,MenuNavigationDownKeyStroke:()=>Gh,MenuNavigationExecKeyStroke:()=>ol,MenuNavigationKeyStroke:()=>sl,MenuNavigationUpKeyStroke:()=>Uh,MessageBox:()=>Ti,MessageBoxAdapter:()=>Lg,MessageBoxController:()=>gl,MessageBoxLayout:()=>Tc,MessageBoxes:()=>as,MobilePopup:()=>Ah,MobilePopupAdapter:()=>Rm,MobilePopupLayout:()=>Dh,Mode:()=>jm,ModeAdapter:()=>Xm,ModeSelector:()=>uu,ModeSelectorField:()=>i_,ModeSelectorFieldAdapter:()=>r_,ModeSelectorLayout:()=>cu,ModelAdapter:()=>He,NavigateButton:()=>Fn,NavigateDownButton:()=>Md,NavigateUpButton:()=>$d,Notification:()=>Oh,NotificationAdapter:()=>Hh,NotificationBadgeStatus:()=>Kr,NullLayout:()=>jo,NullLogger:()=>Vl,NullWidget:()=>Hl,NullWidgetAdapter:()=>Zf,NumberColumn:()=>Oi,NumberColumnUserFilter:()=>vg,NumberField:()=>fo,NumberFieldAdapter:()=>Hc,ObjectFactory:()=>$t,OfflineDesktopNotification:()=>_f,OkMenu:()=>_u,OpenUriHandler:()=>lf,Outline:()=>fr,OutlineAdapter:()=>us,OutlineKeyStrokeContext:()=>If,OutlineLayout:()=>Ad,OutlineMediator:()=>$f,OutlineNavigateToTopKeyStroke:()=>kf,OutlineOverview:()=>Rd,OutlineTileField:()=>lb,OutlineTileFieldAdapter:()=>ab,OutlineViewButton:()=>Dd,OutlineViewButtonAdapter:()=>ob,Page:()=>ai,PageLayout:()=>Rf,PageTileButton:()=>Ef,PageTileGrid:()=>Ed,PageTileGridSelectKeyStroke:()=>Af,PageWithNodes:()=>ib,PageWithTable:()=>rb,ParsingFailedStatus:()=>vi,PlaceholderField:()=>ad,PlaceholderFieldAdapter:()=>o_,PlaceholderTile:()=>bi,PlainTextEncoder:()=>Ud,Planner:()=>he,PlannerAdapter:()=>Os,PlannerField:()=>n_,PlannerFieldAdapter:()=>l_,PlannerHeader:()=>ou,PlannerLayout:()=>nu,PlannerMenuItemsOrder:()=>lu,Point:()=>Z,Popup:()=>pe,PopupAdapter:()=>Ph,PopupBlockerDesktopNotification:()=>yf,PopupBlockerHandler:()=>Pn,PopupLayout:()=>Ii,PopupManager:()=>kd,PopupManagerAdapter:()=>$m,PopupWindow:()=>Bs,PrepopulatedLookupCall:()=>cm,PromiseCreator:()=>sm,PropertyChangeEventFilter:()=>th,PropertyEventEmitter:()=>Il,ProposalChooser:()=>ud,ProposalChooserLayout:()=>ip,ProposalField:()=>Zc,ProposalFieldAdapter:()=>g_,ProposalTreeNode:()=>tp,QueryBy:()=>me,RadioButton:()=>bl,RadioButtonAdapter:()=>a_,RadioButtonGroup:()=>ds,RadioButtonGroupAdapter:()=>d_,RadioButtonGroupGridConfig:()=>Wc,RadioButtonGroupLayout:()=>Kc,RadioButtonGroupLeftOrUpKeyStroke:()=>zc,RadioButtonGroupRightOrDownKeyStroke:()=>Gc,RadioButtonKeyStroke:()=>yl,RadioButtonLayout:()=>Vc,Range:()=>O,RangeKeyStroke:()=>Yn,Reconnector:()=>ih,Rectangle:()=>re,RemoteApp:()=>jf,RemoteEvent:()=>jl,RemoteLookupCall:()=>ql,RemoteLookupRequest:()=>ns,RemoteTileFilter:()=>_d,ResetMenu:()=>Zm,Resizable:()=>Ee,ResponseQueue:()=>Fo,ResponsiveHandler:()=>Fa,ResponsiveManager:()=>ne,RestLookupCall:()=>am,RoundingMode:()=>or,Route:()=>qm,RouteChangeEvent:()=>au,RowLayout:()=>Ri,SaveMenu:()=>eg,Scrollbar:()=>Jn,SearchOutline:()=>hb,SearchOutlineAdapter:()=>ub,SearchOutlineLayout:()=>Lf,SequenceBox:()=>vl,SequenceBoxAdapter:()=>h_,SequenceBoxGridConfig:()=>Uc,SequenceBoxLayout:()=>qc,Session:()=>ci,ShrinkNavigationKeyStroke:()=>ff,SimpleLoadingSupport:()=>Kd,SimpleTab:()=>yd,SimpleTabArea:()=>Ni,SimpleTabAreaLayout:()=>vd,SimpleTabBox:()=>ia,SimpleTabBoxController:()=>wo,SimpleTabBoxLayout:()=>ph,SimpleTabViewContentLayout:()=>fh,SingleLayout:()=>Cr,Slider:()=>du,SliderAdapter:()=>Ym,SliderField:()=>u_,SliderLayout:()=>hu,SmartColumn:()=>mg,SmartField:()=>ae,SmartFieldAdapter:()=>xo,SmartFieldCancelKeyStroke:()=>Yc,SmartFieldLayout:()=>dd,SmartFieldMultiline:()=>p_,SmartFieldMultilineAdapter:()=>f_,SmartFieldMultilineLayout:()=>Qc,SmartFieldPopup:()=>Al,SmartFieldPopupLayout:()=>Xc,SmartFieldTouchPopup:()=>c_,SplitBox:()=>_e,SplitBoxAdapter:()=>v_,SplitBoxCollapseKeyStroke:()=>np,SplitBoxFirstCollapseKeyStroke:()=>lp,SplitBoxLayout:()=>dp,SplitBoxSecondCollapseKeyStroke:()=>ap,Splitter:()=>Xr,StaticLookupCall:()=>Ko,Status:()=>E,StatusMenuMapping:()=>Ag,StatusMenuMappingAdapter:()=>Dg,StringField:()=>Wi,StringFieldAdapter:()=>w_,StringFieldCtrlEnterKeyStroke:()=>cp,StringFieldEnterKeyStroke:()=>up,StringFieldLayout:()=>hp,SubCloseKeyStroke:()=>qh,Switch:()=>O_,Tab:()=>pd,TabArea:()=>_r,TabAreaLayout:()=>bp,TabAreaLeftKeyStroke:()=>pp,TabAreaRightKeyStroke:()=>fp,TabBox:()=>mn,TabBoxAdapter:()=>T_,TabBoxHeader:()=>_p,TabBoxHeaderLayout:()=>gp,TabBoxLayout:()=>wp,TabItem:()=>Tp,TabItemAdapter:()=>C_,TabItemKeyStroke:()=>gh,TabItemLayout:()=>Sp,Table:()=>W,TableAdapter:()=>So,TableCompactHandler:()=>yu,TableControl:()=>yr,TableControlActionKeyStroke:()=>Bu,TableControlAdapter:()=>La,TableControlAdapterMenu:()=>Co,TableControlCloseKeyStroke:()=>qu,TableCopyKeyStroke:()=>Yu,TableField:()=>Ro,TableFieldAdapter:()=>P_,TableFooter:()=>vu,TableFooterLayout:()=>wu,TableHeader:()=>Tu,TableHeaderMenu:()=>Ci,TableHeaderMenuButton:()=>ut,TableHeaderMenuGroup:()=>Lr,TableHeaderMenuLayout:()=>Eo,TableInfoFilterTooltip:()=>og,TableInfoLoadTooltip:()=>ng,TableInfoSelectionTooltip:()=>lg,TableLayout:()=>Su,TableLayoutResetter:()=>cd,TableMatrix:()=>At,TableNavigationCollapseKeyStroke:()=>ju,TableNavigationDownKeyStroke:()=>ic,TableNavigationEndKeyStroke:()=>sc,TableNavigationExpandKeyStroke:()=>Xu,TableNavigationHomeKeyStroke:()=>rc,TableNavigationPageDownKeyStroke:()=>nc,TableNavigationPageUpKeyStroke:()=>oc,TableNavigationUpKeyStroke:()=>tc,TableProposalChooser:()=>b_,TableRefreshKeyStroke:()=>Zu,TableRow:()=>Qt,TableRowDetail:()=>Ma,TableRowTileMapping:()=>hg,TableRowTileMappingAdapter:()=>ug,TableSelectAllKeyStroke:()=>Ju,TableSelectionHandler:()=>Cu,TableStartCellEditKeyStroke:()=>Qu,TableTextUserFilter:()=>mr,TableTileGridMediator:()=>so,TableTileGridMediatorAdapter:()=>Pu,TableToggleRowKeyStroke:()=>ec,TableTooltip:()=>Fu,TableUpdateBuffer:()=>Au,TableUserFilter:()=>Zt,TagBar:()=>ui,TagBarLayout:()=>Lp,TagBarOverflowPopup:()=>Dl,TagBarOverflowPopupLayout:()=>Ip,TagChooserPopup:()=>Cp,TagChooserPopupLayout:()=>Pp,TagField:()=>Bd,TagFieldAdapter:()=>F_,TagFieldContainerLayout:()=>Ln,TagFieldDeleteKeyStroke:()=>fd,TagFieldEnterKeyStroke:()=>xp,TagFieldLayout:()=>Ep,TagFieldNavigationKeyStroke:()=>md,TagFieldOpenPopupKeyStroke:()=>Fp,TextColumnUserFilter:()=>Tg,TextMap:()=>Vr,TextTableFilter:()=>Cg,Tile:()=>Wt,TileAccordion:()=>Wp,TileAccordionAdapter:()=>K_,TileAccordionLayout:()=>Kp,TileAccordionSelectionHandler:()=>zp,TileAdapter:()=>vn,TileButton:()=>Tl,TileField:()=>D_,TileFieldAdapter:()=>M_,TileGrid:()=>_o,TileGridAdapter:()=>Bp,TileGridGridConfig:()=>Op,TileGridLayout:()=>hs,TileGridLayoutConfig:()=>tr,TileGridSelectAllKeyStroke:()=>Gp,TileGridSelectDownKeyStroke:()=>Yp,TileGridSelectFirstKeyStroke:()=>Xp,TileGridSelectKeyStroke:()=>ss,TileGridSelectLastKeyStroke:()=>Jp,TileGridSelectLeftKeyStroke:()=>Up,TileGridSelectRightKeyStroke:()=>qp,TileGridSelectUpKeyStroke:()=>jp,TileGridSelectionHandler:()=>gd,TileHtmlField:()=>Y_,TileOutlineOverview:()=>Pl,TileOverviewForm:()=>Aa,TileOverviewFormAdapter:()=>rg,TileTableField:()=>j_,TileTableHeaderBox:()=>Wf,TileTableHeaderGroupByLookupCall:()=>Du,TileTableHeaderSortByLookupCall:()=>Mu,TileTableHierarchyFilter:()=>lc,TileTextFilter:()=>Tn,TimePicker:()=>Wa,TimePickerPopup:()=>Ka,TimePickerPopupLayout:()=>ac,TimePickerTouchPopup:()=>za,Tooltip:()=>lr,TooltipSupport:()=>da,TouchPopup:()=>el,TouchPopupLayout:()=>pa,Tree:()=>fe,TreeAdapter:()=>Rn,TreeBox:()=>R_,TreeBoxAdapter:()=>L_,TreeBoxLayout:()=>Ap,TreeBreadcrumbFilter:()=>hc,TreeCollapseAllKeyStroke:()=>cc,TreeCollapseOrDrillUpKeyStroke:()=>Ya,TreeExpandOrDrillDownKeyStroke:()=>ja,TreeField:()=>Dp,TreeFieldAdapter:()=>Mp,TreeLayout:()=>pl,TreeLayoutResetter:()=>op,TreeNavigationDownKeyStroke:()=>Ua,TreeNavigationEndKeyStroke:()=>qa,TreeNavigationUpKeyStroke:()=>Ga,TreeNode:()=>ts,TreeProposalChooser:()=>sp,TreeSet:()=>Kl,TreeSpaceKeyStroke:()=>uc,TreeVisitResult:()=>ye,TypeDescriptor:()=>zr,URL:()=>Et,UnsavedFormChangesForm:()=>In,UnsavedFormsLookupCall:()=>Vf,UserAgent:()=>sh,UuidPool:()=>wr,UuidPoolAdapter:()=>Tb,ValidationFailedStatus:()=>Wn,ValueField:()=>ge,ValueFieldAdapter:()=>Ot,VerticalGridMatrix:()=>Fl,VerticalSmartGrid:()=>dh,ViewButton:()=>Tf,ViewButtonActionKeyStroke:()=>vf,ViewButtonAdapter:()=>Sf,ViewButtonBox:()=>Fd,ViewMenuOpenKeyStroke:()=>Cf,ViewMenuPopup:()=>Pf,ViewMenuPopupEnterKeyStroke:()=>xf,ViewMenuTab:()=>Ff,ViewportScroller:()=>Gr,VirtualKeyStrokeEvent:()=>ra,VirtualScrolling:()=>Th,Widget:()=>I,WidgetEventTypeFilter:()=>oh,WidgetField:()=>$g,WidgetFieldAdapter:()=>Rg,WidgetFieldLayout:()=>yc,WidgetPopup:()=>tn,WidgetPopupAdapter:()=>xh,WidgetPopupLayout:()=>Fh,WidgetSupport:()=>Bl,WidgetTile:()=>Qp,WidgetTileAdapter:()=>U_,WidgetTooltip:()=>Dm,WizardProgressField:()=>I_,WizardProgressFieldAdapter:()=>k_,WizardProgressFieldLayout:()=>$p,WrappedFormField:()=>_n,WrappedFormFieldAdapter:()=>B_,YearPanel:()=>Sa,aggregation:()=>wt,ajax:()=>Di,arrays:()=>f,clipboard:()=>sr,codes:()=>Tt,colorSchemes:()=>Lt,comparators:()=>gt,cookies:()=>Gl,dates:()=>T,default:()=>Cb,defaultValues:()=>Ve,dragAndDrop:()=>Ae,events:()=>lt,fields:()=>ee,files:()=>Yr,filters:()=>ps,focusUtils:()=>Yi,fonts:()=>vt,graphics:()=>w,icons:()=>ve,inspector:()=>Vo,isPropertyChangeEvent:()=>Yf,keyStrokeModifier:()=>Se,keys:()=>_,locales:()=>bt,logging:()=>pi,lookupField:()=>fn,menuNavigationKeyStrokes:()=>vs,menus:()=>Ke,mimeTypes:()=>at,models:()=>cs,numbers:()=>Ge,objects:()=>v,promises:()=>om,router:()=>Yt,scout:()=>u,scrollbars:()=>x,strings:()=>y,styles:()=>L,texts:()=>Ce,tooltips:()=>G,webstorage:()=>Pe,widgets:()=>ke});const Mt=require("jquery");var a=xi.n(Mt);function Bn(i,e,t){return e=xb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xb(i){var e=Fb(i,"string");return typeof e=="symbol"?e:String(e)}function Fb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class $t{constructor(){Bn(this,"uniqueIdSeqNo",void 0),Bn(this,"_registry",void 0),Bn(this,"_objectTypeMap",void 0),this.uniqueIdSeqNo=0,this._registry=new Map,this._objectTypeMap=new Map}_createObjectByType(e,t){if(typeof e!="string"&&typeof e!="function")throw new Error("missing or invalid object type");t=t||{};let r=null,s=null;if(typeof e=="string")s=zr.parse(e),r=s.resolve(t);else if(typeof e=="function")r=e;else throw new Error("Invalid objectType "+e);let o=this.get(r||e);if(o){let n=o(t.model);if(!n)throw new Error('Failed to create object for objectType "'+e+'": Factory function did not return a valid object');return n}if(!r&&s)throw s.notFoundError();return new r(t.model)}create(e,t,r){let s,o;if(typeof e=="string"||typeof e=="function")r=r||{},o=t,s=e;else if(v.isPlainObject(e)){if(r=t||{},o=e,!o.objectType)throw new Error('Missing mandatory property "objectType" on model');s=o.objectType}else throw new Error("Invalid arguments");r.model=o;let n=this._createObjectByType(s,r);return v.isFunction(n.init)&&(o&&(o.id===void 0&&u.nvl(r.ensureUniqueId,!0)&&(o.id=this.createUniqueId()),o.objectType=this.getObjectType(s)),n.init(o)),n.id===void 0&&u.nvl(r.ensureUniqueId,!0)&&(n.id=this.createUniqueId()),n.objectType===void 0&&(n.objectType=this.getObjectType(s)),n}createUniqueId(){return"ui"+(++this.uniqueIdSeqNo).toString()}resolveTypedObjectType(e){if(typeof e!="string")return e;let t=zr.resolveType(e);return t||e}register(e,t){e=this.resolveTypedObjectType(e),this._registry.set(e,t),a().log.isDebugEnabled()&&a().log.debug("(ObjectFactory) registered create-function for objectType "+e)}unregister(e){e=this.resolveTypedObjectType(e),this._registry.delete(e),a().log.isDebugEnabled()&&a().log.debug("(ObjectFactory) unregistered objectType "+e)}get(e){return e=this.resolveTypedObjectType(e),this._registry.get(e)}getObjectType(e){return typeof e=="string"?e:this._objectTypeMap.get(e)}init(){for(let[e,t]of u.objectFactories)this.register(e,t)}registerNamespace(e,t,r){r=a().extend({allowedReplacements:[]},r),window[e]=window[e]||{};let s=e==="scout"?"":e+".";for(let[o,n]of Object.entries(t))if(o!=="default"){if(window[e][o]&&!r.allowedReplacements.includes(o))throw new Error("".concat(o," is already registered on namespace ").concat(e||"scout",". Use objectFactories if you want to replace the existing obj."));window[e][o]=n,!(!n.prototype||o[0].toUpperCase()!==o[0])&&this._objectTypeMap.set(n,s+o)}}static get(){return Uf}static _set(e){Uf=e}}Bn($t,"NAMESPACE_SEPARATOR","."),Bn($t,"MODEL_VARIANT_SEPARATOR",":");let Uf=new $t,Ll=null;function Eb(i,e,t){return $t.get().create(i,e,t)}function Ab(i,e){if(v.isNullOrUndefined(i))return null;let t=i;if(typeof i=="string"||typeof i=="number"){let r=typeof e=="string"?e:null,s=u.getSession(r);if(s){let o=y.asString(i);return s.root.widget(o)}}return ke.get(t)}const u={objectFactories:new Map,nvl(){let i;for(let e=0;e<arguments.length&&(i=e<0||arguments.length<=e?void 0:arguments[e],i==null);e++);return i},assertParameter(i,e,t){if(v.isNullOrUndefined(e))throw new Error("Missing required parameter '"+i+"'");if(t&&!(e instanceof t))throw new Error("Parameter '"+i+"' has wrong type");return e},assertProperty(i,e,t){let r=i[e];if(v.isNullOrUndefined(r))throw new Error("Missing required property '"+e+"'");if(t&&!(r instanceof t))throw new Error("Property '"+e+"' has wrong type");return r},assertValue(i,e){if(v.isNullOrUndefined(i))throw new Error(e||"Missing value");return i},assertInstance(i,e,t){if(!(i instanceof e))throw new Error(t||"Value has wrong type");return i},isOneOf(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];if(t.length===0)return!1;let s=t;return t.length===1&&Array.isArray(t[0])&&(s=t[0]),s.indexOf(i)!==-1},create:Eb,prepareDOM(i){if(i=i||document,a()("noscript",i).remove(),a()("scout-text",i).remove(),a()("scout-version",i).remove(),a()("body",i).addDeviceClass(),F.get().browser===F.Browser.CHROME){let e='<meta name="google" content="notranslate" />',t=a()("head > title",i);t.length===0?a()("head",i).append(e):t.after(e)}},installGlobalMouseDownInterceptor(i){i.addEventListener("mousedown",e=>{ge.invokeValueFieldAboutToBlurByMouseDown(e.target)},!0)},installSyntheticActiveStateHandler(i){F.get().requiresSyntheticActiveState()&&(Ll=[],a()(i).on("mousedown",e=>{let t=a()(e.target);for(;t.length;)Ll.push(t.addClass("active")),t=t.parent()}).on("mouseup",()=>{Ll.forEach(e=>{e.removeClass("active")}),Ll=[]}))},widget:Ab,adapter(i,e){if(v.isNullOrUndefined(i))return null;let t=u.getSession(e);return t&&t.modelAdapterRegistry?t.modelAdapterRegistry[i]:null},getSession(i){let e=ie.get().sessions;if(!e)return null;if(v.isNullOrUndefined(i))return e[0];for(let t=0;t<e.length;t++){let r=e[t];if(r.partId==i)return r}return null},exportAdapter(i,e){let t=u.getSession(e);if(t&&t.modelAdapterRegistry){let o=t.getModelAdapter(i);if(!o)return null;let n=r(i);return s(o,n),n.type="model",n}function r(o){let n=t.getAdapterData(o);return n=a().extend(!0,{},n),n}function s(o,n){let l,d;o.widget._widgetProperties.forEach(h=>{let p=n[h];if(!!p)if(Array.isArray(p)){let m=[];p.forEach(g=>{l=t.getModelAdapter(g),d=r(g),s(l,d),m.push(d)}),n[h]=m}else l=t.getModelAdapter(p),d=r(p),s(l,d),n[h]=d}),n=o.exportAdapterData(n)}return null},reloadPage(i){i=i||{},i.schedule?setTimeout(e):e();function e(){u.nvl(i.clearBody,!0)&&a()("body").html(""),i.redirectUrl?window.location.href=i.redirectUrl:window.location.reload()}},addObjectFactories(i){for(let[e,t]of Object.entries(i))u.addObjectFactory(e,t)},addObjectFactory(i,e){u.objectFactories.set(i,e)},cloneShallow(i,e,t){u.assertParameter("template",i);let r=Object.create(Object.getPrototypeOf(i));if(Object.getOwnPropertyNames(i).forEach(s=>{r[s]=i[s]}),e)for(let s in e)r[s]=e[s];return u.nvl(t,!0)&&(r.id=$t.get().createUniqueId()),r.cloneOf===void 0&&(r.cloneOf=i),r}};function Hd(i,e,t){return e=Db(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Db(i){var e=Mb(i,"string");return typeof e=="symbol"?e:String(e)}function Mb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Gt{constructor(e){Hd(this,"source",void 0),Hd(this,"defaultPrevented",void 0),Hd(this,"type",void 0),this.defaultPrevented=!1,a().extend(this,e)}preventDefault(){this.defaultPrevented=!0}}function $b(i,e,t){return e=Rb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Rb(i){var e=Lb(i,"string");return typeof e=="symbol"?e:String(e)}function Lb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ir{constructor(){$b(this,"events",void 0),this.events=this._createEventSupport()}_createEventSupport(){return new On}trigger(e,t){let r;return t instanceof Gt?r=t:r=new Gt(t),r.source=this,this.events.trigger(e,r),r}one(e,t){this.events.one(e,t)}on(e,t){return this.events.on(e,t)}off(e,t){this.events.off(e,t)}when(e){return this.events.when(e)}addListener(e){this.events.addListener(e)}removeListener(e){this.events.removeListener(e)}}class Il extends ir{constructor(){super(),this.events.registerSubTypePredicate("propertyChange",(e,t)=>e.propertyName===t)}setProperty(e,t){return v.equals(this[e],t)?!1:(this._callSetProperty(e,t),!0)}_callSetProperty(e,t){let r="_set"+y.toUpperCaseFirstLetter(e);this[r]?this[r](t):this._setProperty(e,t)}_setProperty(e,t){u.assertParameter("propertyName",e);let r=this[e];return v.equals(r,t)?!1:(this[e]=t,this.triggerPropertyChange(e,r,t).defaultPrevented?(this[e]=r,!1):!0)}triggerPropertyChange(e,t,r){return u.assertParameter("propertyName",e),this.trigger("propertyChange",{propertyName:e,oldValue:t,newValue:r})}callSetter(e,t){let r="set"+y.toUpperCaseFirstLetter(e);this[r]?this[r](t):this.setProperty(e,t)}}function qf(i,e,t){return e=Ib(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ib(i){var e=kb(i,"string");return typeof e=="symbol"?e:String(e)}function kb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class On{constructor(){qf(this,"_eventListeners",void 0),qf(this,"_subTypePredicates",void 0),this._eventListeners=[],this._subTypePredicates=v.createMap()}_assertFunc(e){if(!e)throw new Error("Missing callback function")}on(e,t,r){this._assertFunc(t);let s={type:e,func:t,origFunc:r};return this.addListener(s),s}one(e,t){this._assertFunc(t);let r=s=>{this.off(e,r),t(s)};return this.on(e,r,t)}off(e,t){if(!(!e&&!t))for(let r=this._eventListeners.length-1;r>=0;r--){let s=this._eventListeners[r],o=t===s.func||t===s.origFunc,n=e===s.type,l=!1;t&&e?l=o&&n:t?l=o:l=n,l&&this._eventListeners.splice(r,1)}}when(e){let t=a().Deferred();return this.one(e,t.resolve.bind(t)),t.promise()}addListener(e){this._eventListeners.push(e)}removeListener(e){f.remove(this._eventListeners,e)}count(e,t){let r=0;return this._eventListeners.forEach(s=>{e&&e!==s.type||t&&t!==s.func||r++}),r}trigger(e,t){t=t||{},t.type=e;let r=this._eventListeners.slice();for(let s=0;s<r.length;s++){let o=r[s];(!o.type||this._typeMatches(t,o.type))&&o.func(t)}}_typeMatches(e,t){let r=e.type,s=t.split(" ");for(let o=0;o<s.length;o++)if(r===s[o]||this._subTypeMatches(e,s[o]))return!0;return!1}_subTypeMatches(e,t){if(t.indexOf(":")<0)return!1;let r=t.split(":"),s=r[0],o=r[1],n=this._subTypePredicates[s];if(!!n)return n(e,o)}registerSubTypePredicate(e,t){u.assertParameter("type",e),u.assertParameter("predicate",t),this._subTypePredicates[e]=t}}function Tr(i,e,t){return e=Bb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Bb(i){var e=Ob(i,"string");return typeof e=="symbol"?e:String(e)}function Ob(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class gr{constructor(e,t,r){Tr(this,"source",void 0),Tr(this,"target",void 0),Tr(this,"callSetter",void 0),Tr(this,"delegateProperties",void 0),Tr(this,"excludeProperties",void 0),Tr(this,"delegateEvents",void 0),Tr(this,"delegateAllProperties",void 0),Tr(this,"delegateAllEvents",void 0),Tr(this,"_mirrorListener",void 0),Tr(this,"_destroyHandler",void 0),r=r||{},this.source=e,this.target=t,this.callSetter=u.nvl(r.callSetter,!0),this.delegateProperties=r.delegateProperties||[],this.excludeProperties=r.excludeProperties||[],this.delegateEvents=r.delegateEvents||[],this.delegateAllProperties=!!r.delegateAllProperties,this.delegateAllEvents=!!r.delegateAllEvents,this._mirrorListener=null,this._destroyHandler=null,this._installSourceListener()}destroy(){this._uninstallSourceListener()}_installSourceListener(){if(this._mirrorListener)throw new Error("source listeners already installed.");this._mirrorListener={func:this._onSourceEvent.bind(this)},this.source.events.addListener(this._mirrorListener),this._destroyHandler=this._uninstallSourceListener.bind(this),this.source.on("destroy",this._destroyHandler),this.target.on("destroy",this._destroyHandler)}_uninstallSourceListener(){this._mirrorListener&&(this.source.events.removeListener(this._mirrorListener),this._mirrorListener=null),this._destroyHandler&&(this.source.off("destroy",this._destroyHandler),this.target.off("destroy",this._destroyHandler),this._destroyHandler=null)}_onSourceEvent(e){e.type==="propertyChange"?this._onSourcePropertyChange(e):(this.delegateAllEvents||this.delegateEvents.indexOf(e.type)>-1)&&this.target.trigger(e.type,e)}_onSourcePropertyChange(e){if(!(this.excludeProperties.indexOf(e.propertyName)>-1)&&(this.delegateAllProperties||this.delegateProperties.indexOf(e.propertyName)>-1)){if(gr.equalsProperty(e.propertyName,this.target,e.newValue))return;this.callSetter?this.target.callSetter(e.propertyName,e.newValue):this.target.trigger(e.type,e)}}static equalsProperty(e,t,r){let s=t[e];return Array.isArray(r)&&Array.isArray(s)?f.equals(r,s):v.equals(s,r)}static create(e,t,r){return r.delegateProperties&&r.delegateProperties.length>0||r.delegateEvents&&r.delegateEvents.length>0||r.delegateAllProperties||r.delegateAllEvents?new gr(e,t,r):null}}function Yf(i){return i instanceof Gt&&!!i.propertyName}function Oo(i,e,t){return e=Hb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Hb(i){var e=Nb(i,"string");return typeof e=="symbol"?e:String(e)}function Nb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}let kl=null,Nd=[];class ie extends ir{static addListener(e,t){let r={type:e,func:t};return kl?kl.events.addListener(r):Nd.push(r),r}static get(){return kl}constructor(){super(),Oo(this,"remote",void 0),Oo(this,"initialized",void 0),Oo(this,"sessions",void 0),Oo(this,"errorHandler",void 0),Oo(this,"version",void 0),Oo(this,"_loadingTimeoutId",void 0),this.remote=!1,this.initialized=!1,this.sessions=[],this._loadingTimeoutId=null,Nd.forEach(e=>{this.addListener(e)}),Nd=[],kl=this,this.errorHandler=this._createErrorHandler()}init(e){return e=e||{},this._prepare(e).then(this._bootstrap.bind(this,e.bootstrap)).then(this._init.bind(this,e)).then(this._initDone.bind(this,e)).catch(this._fail.bind(this,e))}_prepare(e){return this._prepareLogging(e).done(()=>{this._prepareEssentials(e),this._prepareDone(e)})}_prepareEssentials(e){$t.get().init()}_prepareDone(e){this.trigger("prepare",{options:e}),a().log.isDebugEnabled()&&a().log.debug("App prepared")}_prepareLogging(e){return pi.bootstrap()}_bootstrap(e){e=e||{};let t=[];return this._doBootstrap(e).forEach(r=>{Array.isArray(r)?t.concat(r):r&&t.push(r)}),a().promiseAll(t).done(this._bootstrapDone.bind(this,e)).catch(this._bootstrapFail.bind(this,e))}_doBootstrap(e){return[F.get().bootstrap(),vt.bootstrap(e.fonts),bt.bootstrap(e.localesUrl),Ce.bootstrap(e.textsUrl),Tt.bootstrap(e.codesUrl)]}_bootstrapDone(e){Pe.removeItemFromSessionStorage("scout:timeoutPageReload"),this.trigger("bootstrap",{options:e}),a().log.isDebugEnabled()&&a().log.debug("App bootstrapped")}_bootstrapFail(e,t,r,s,o){if(a().log.isInfoEnabled()&&a().log.info("App bootstrap failed"),a().isJqXHR(t)){if(this._isSessionTimeoutStatus(t.status)){let l=o?o.url:"";this._handleBootstrapTimeoutError(t,l);return}}else if(v.isPlainObject(t)&&t.error&&t.error.code===ci.JsonResponseError.SESSION_TIMEOUT){this._handleBootstrapTimeoutError(t.error,t.url);return}let n=v.argumentsToArray(arguments).slice(1);return a().rejectedPromise(...n)}_isSessionTimeoutStatus(e){return e===401}_handleBootstrapTimeoutError(e,t){if(a().log.isInfoEnabled()&&a().log.info("Timeout error for resource "+t+". Reloading page..."),Pe.getItemFromSessionStorage("scout:timeoutPageReload"))throw a().log.isWarnEnabled()&&a().log.warn("Prevented automatic reload, startup will likely fail",e,t),Pe.removeItemFromSessionStorage("scout:timeoutPageReload"),new Error("Resource "+t+" could not be loaded due to a session timeout, even after a page reload");Pe.setItemToSessionStorage("scout:timeoutPageReload",!0+""),u.reloadPage()}_init(e){e=e||{},this.setLoading(!0);let t=this._checkBrowserCompatibility(e);return t?(this.setLoading(!1),t.then(r=>this._init(r))):(this._initVersion(e),this._prepareDOM(),this._installErrorHandler(),this._installGlobalMouseDownInterceptor(),this._installSyntheticActiveStateHandler(),this._ajaxSetup(),this._installExtensions(),this._load(e).then(this._loadSessions.bind(this,e.session)))}_load(e){return a().resolvedPromise()}_checkBrowserCompatibility(e){let t=F.get();if(a().log.isInfoEnabled()&&a().log.info("Detected browser "+t.browser+" version "+t.browserVersion),!u.nvl(e.checkBrowserCompatibility,!0)||t.isSupportedBrowser())return;let r=a().Deferred(),s=v.valueCopy(e);return s.checkBrowserCompatibility=!1,a()(".scout").each(function(){let n=a()(this).appendDiv();n.load("unsupported-browser.html",()=>{n.find("button").on("click",()=>{n.remove(),r.resolve(s)})})}),r.promise()}setLoading(e){e?this._loadingTimeoutId=setTimeout(()=>{this.sessions.some(t=>t.desktop&&t.desktop.rendered)||this._renderLoading()},200):(clearTimeout(this._loadingTimeoutId),this._loadingTimeoutId=null,this._removeLoading())}_renderLoading(){let e=a()("body"),t=e.children(".application-loading-root");t.length||(t=e.appendDiv("application-loading-root").addClass("application-loading-root").fadeIn()),this._renderLoadingElement(t,"application-loading01"),this._renderLoadingElement(t,"application-loading02"),this._renderLoadingElement(t,"application-loading03")}_renderLoadingElement(e,t){e.children("."+t).length||e.appendDiv(t).hide().fadeIn()}_removeLoading(){let e=a()("body").children(".application-loading-root");e.css("opacity",e.css("opacity")),e.oneAnimationEnd(()=>e.remove()),e.css("opacity")==="1"?e.addClass("fadeout and-more"):e.addClass("fadeout"),F.get().supportsCssAnimation()||e.remove()}_initVersion(e){this.version=u.nvl(this.version,e.version,a()("scout-version").data("value"))}_prepareDOM(){u.prepareDOM(document)}_installGlobalMouseDownInterceptor(){u.installGlobalMouseDownInterceptor(document)}_installSyntheticActiveStateHandler(){u.installSyntheticActiveStateHandler(document)}_installErrorHandler(){window.onerror=this.errorHandler.windowErrorHandler}_createErrorHandler(e){return e=a().extend({},e),u.create(vo,e)}_ajaxSetup(){let e=this._ajaxDefaults();e&&a().ajaxSetup(e)}_ajaxDefaults(){return{beforeSend:this._beforeAjaxCall.bind(this)}}_beforeAjaxCall(e,t){e.setRequestHeader("X-Scout-Correlation-Id",Ge.correlationId()),e.setRequestHeader("X-Requested-With","XMLHttpRequest")}_loadSessions(e){e=e||{};let t=[];return a()(".scout").each((r,s)=>{let o=a()(s);e.portletPartId=e.portletPartId||o.data("partid")||"0";let n=this._loadSession(o,e);t.push(n)}),a().promiseAll(t)}_loadSession(e,t){let r={$entryPoint:e},s=a().extend({},t,r);s.locale=s.locale||this._loadLocale();let o=this._createSession(s);this.sessions.push(o);let n=this._createDesktop(o.root);return this._triggerDesktopReady(n),o.render(()=>{o._renderDesktop(),o.layoutValidator.validate(),o.focusManager.validateFocus(),o.ready=!0,this._triggerSessionReady(o),a().log.isInfoEnabled()&&a().log.info("Session initialized. Detected "+F.get())}),a().resolvedPromise()}_triggerDesktopReady(e){this.trigger("desktopReady",{desktop:e})}_triggerSessionReady(e){this.trigger("sessionReady",{session:e})}_createSession(e){return u.create(ci,e,{ensureUniqueId:!1})}_createDesktop(e){return u.create(Ie,{parent:e})}_loadLocale(){return bt.getNavigatorLocale()}_initDone(e){this.initialized=!0,this.setLoading(!1),this.trigger("init",{options:e}),a().log.isInfoEnabled()&&a().log.info("App initialized")}_fail(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];a().log.error("App initialization failed."),this.setLoading(!1);let n=[];return this.sessions.length===0?n.push(this.errorHandler.handle(t,...s).then(l=>{this._appendStartupError(a()("body"),l.message)})):this.sessions.filter(l=>!l.ready&&!l.isFatalMessageShown()).forEach(l=>{l.$entryPoint.empty(),n.push(this._createErrorHandler({session:l}).handle(t))}),a().promiseAll(n).then(l=>a().rejectedPromise(t,...s))}_appendStartupError(e,t){let r=e.appendDiv("startup-error");r.appendDiv("startup-error-title").text("The application could not be started"),t&&r.appendDiv("startup-error-message").text(t)}_installExtensions(){}}var Vb=i=>{var e={};return xi.d(e,i),e},PU=i=>()=>i;const Wb=Vb({mapStackTrace:()=>Pb.mapStackTrace});function Ns(i,e,t){return e=Kb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Kb(i){var e=zb(i,"string");return typeof e=="symbol"?e:String(e)}function zb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vo{constructor(){Ns(this,"objectType",void 0),Ns(this,"logError",void 0),Ns(this,"displayError",void 0),Ns(this,"sendError",void 0),Ns(this,"session",void 0),Ns(this,"windowErrorHandler",void 0),this.logError=!0,this.displayError=!0,this.sendError=!1,this.windowErrorHandler=this._onWindowError.bind(this),this.session=null}init(e){a().extend(this,e)}_onWindowError(e,t,r,s,o){try{if(this._isIgnorableScriptError(e,t,r,s,o)){this.handleErrorInfo({log:"Ignoring error. Message: ".concat(e),level:je.INFO});return}if(o instanceof Error){this.handle(o).catch(d=>{console.error("Error in global JavaScript error handler",d)});return}let n="J00",l=e+" at "+t+":"+r+`
(Code `+n+")";this.handleErrorInfo({code:n,message:e,log:l})}catch(n){throw new Error("Error in global JavaScript error handler: "+n.message+" (original error: "+e+" at "+t+":"+r+")")}}_isIgnorableScriptError(e,t,r,s,o){return e&&e.toLowerCase().indexOf("script error")>-1&&!t&&!r&&!s&&!o}handle(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];let o=e;return e&&r.length===0&&(String(e)==="[object Arguments]"?(o=e[0],r=[...e].slice(1)):Array.isArray(e)&&(o=e[0],r=e.slice(1))),this.analyzeError(o,...r).then(this.handleErrorInfo.bind(this))}analyzeError(e){let t={code:null,message:null,stack:null,mappedStack:null,debugInfo:null,log:null,error:e};for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._analyzeError(t,...s)}_analyzeError(e){let t=e.error;if(t instanceof Error)return this.mapStack(t.stack).catch(n=>(e.mappingError=n.message+`
`+n.error.message+`
`+n.error.stack,null)).then(n=>(e.mappedStack=n,this._analyzeRegularError(e),e));if(a().isJqXHR(t)||Array.isArray(t)&&a().isJqXHR(t[0])||t instanceof Kn){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._analyzeAjaxError(e,...s),a().resolvedPromise(e)}return t?(this._analyzeOtherError(e),a().resolvedPromise(e)):(this._analyzeNoError(e),a().resolvedPromise(e))}_analyzeRegularError(e){let t=e.error;e.code=this.getJsErrorCode(t),e.message=String(t.message||t),t.stack&&(e.stack=String(t.stack)),t.debugInfo&&(e.debugInfo=t.debugInfo);let r=e.mappedStack||e.stack,s=[];(!r||r.indexOf(e.message)===-1)&&s.push(e.message),r&&s.push(r),e.mappingError&&s.push(e.mappingError),e.debugInfo&&s.push(`----- Additional debug information: -----
`+e.debugInfo),e.log=f.format(s,`
`)}_analyzeAjaxError(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];let o=e.error,n,l,d;o instanceof Kn?(n=o.jqXHR,l=o.errorThrown,d=o.requestOptions):(r=f.ensure(o).concat(r),n=r[0],l=r[2],d=r[3]);let h=d?y.join(" ",d.type,d.url):"",p=n.status?y.join(" ",n.status,l):"Connection error";e.code="X"+(n.status||"0"),e.message="AJAX call"+y.box(' "',h,'"')+" failed"+y.box(" [",p,"]"),e.log=e.message,n.responseText&&(e.debugInfo=`Response text:
`+n.responseText,e.log+=`
`+e.debugInfo)}_analyzeOtherError(e){let t=e.error,r=typeof t=="string"||typeof t=="number"?String(t):null;if(e.code="P4",e.message=r||"Unexpected error",!r)try{r=JSON.stringify(t)}catch{r=String(t)}e.log="Unexpected error: "+r}_analyzeNoError(e){e.code="P3",e.message="Unknown error",e.log="Unexpected error (no reason provided)"}mapStack(e){let t=a().Deferred();try{Wb.mapStackTrace(e,r=>{t.resolve(f.format(r,`
`))})}catch(r){return a().rejectedPromise({message:"Exception mapping failed",error:r})}return t.promise()}handleErrorInfo(e){e.level=u.nvl(e.level,je.ERROR),this.logError&&e.log&&this._logErrorInfo(e);let t=this.session||ie.get().sessions[0];return t&&(this.displayError&&e.level===je.ERROR&&this._showMessageBox(t,e.message,e.code,e.log),this.sendError&&this._sendErrorMessage(t,e.log,e.level)),e}_logErrorInfo(e){switch(e.level){case je.TRACE:a().log.trace(e.log);break;case je.DEBUG:a().log.debug(e.log);break;case je.INFO:a().log.info(e.log);break;case je.WARN:a().log.warn(e.log);break;default:a().log.error(e.log)}let t=vo.CONSOLE_OUTPUT;a().log instanceof Vl&&(t=!1),t&&window&&window.console&&(e.level===je.ERROR&&window.console.error?window.console.error(e.log):e.level===je.WARN&&window.console.warn?window.console.warn(e.log):window.console.log&&window.console.log(e.log))}getJsErrorCode(e){if(e){if(e.name==="EvalError")return"E1";if(e.name==="InternalError")return"I2";if(e.name==="RangeError")return"A3";if(e.name==="ReferenceError")return"R4";if(e.name==="SyntaxError")return"S5";if(e.name==="TypeError")return"T6";if(e.name==="URIError")return"U7"}return"J0"}_showMessageBox(e,t,r,s){let o={header:e.optText("ui.UnexpectedProblem","Internal UI Error"),body:y.join(`

`,e.optText("ui.InternalUiErrorMsg",t," ("+e.optText("ui.ErrorCodeX","Code "+r,r)+")"),e.optText("ui.UiInconsistentMsg","")),yesButtonText:e.optText("ui.Reload","Reload"),yesButtonAction:u.reloadPage,noButtonText:void 0,hiddenText:s,iconId:ve.SLIPPERY};e.inDevelopmentMode&&(o.noButtonText=e.optText("ui.Ignore","Ignore")),e.showFatalMessage(o,r)}_sendErrorMessage(e,t,r){e.sendLogRequest(t,r)}}Ns(vo,"CONSOLE_OUTPUT",!0);class jf extends ie{constructor(){super(),this.remote=!0}_doBootstrap(e){return super._doBootstrap(e).concat([this._doBootstrapDefaultValues()])}_doBootstrapDefaultValues(){return Ve.bootstrap()}_createErrorHandler(e){return e=a().extend({sendError:!0},e),super._createErrorHandler(e)}_loadSession(e,t){let r=t||{};r.$entryPoint=e;let s=this._createSession(r);return ie.get().sessions.push(s),s.start()}}function Xf(i,e,t){return e=Gb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Gb(i){var e=Ub(i,"string");return typeof e=="symbol"?e:String(e)}function Ub(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Jf{constructor(){Xf(this,"extended",void 0),Xf(this,"next",void 0)}extend(e,t){let r=e[t],s=this;e[t]=function(){return s.extended=this,s.next=r.bind(this),s[t](...arguments)}}static install(e){e.forEach(t=>{u.create(t)})}}function Hn(i,e,t){return e=qb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qb(i){var e=Yb(i,"string");return typeof e=="symbol"?e:String(e)}function Yb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zr{constructor(e,t,r){Hn(this,"typeDescriptor",void 0),Hn(this,"objectType",void 0),Hn(this,"modelVariant",void 0),Hn(this,"className",void 0),Hn(this,"namespaces",void 0),this.typeDescriptor=e,this.objectType=t,this.modelVariant=r,this.modelVariant?(this.className=this.modelVariant.name+this.objectType.name,this.namespaces=this.modelVariant.namespaces):(this.className=this.objectType.name,this.namespaces=this.objectType.namespaces)}resolve(e){let t=window.scout;if(e=e||{},this.namespaces.length){t=window;for(let r=0;r<this.namespaces.length;r++)if(t=t[this.namespaces[r]],!t)throw this.error('Could not resolve namespace "'+this.namespaces[r]+'"')}return t[this.className]?t[this.className]:e.variantLenient&&this.modelVariant?new zr(this.typeDescriptor,this.objectType,null).resolve(e):null}error(e){return new Error('Failed to create object for objectType "'+this.typeDescriptor+'": '+e)}notFoundError(){return this.error('Could not find "'+this.className+'" in namespace "'+this.namespaces.join(".")+'"')}static resolveType(e,t){return zr.parse(e).resolve(t)}static parse(e){let t=null,r=null;if(y.contains(e,$t.MODEL_VARIANT_SEPARATOR)){let n=e.split($t.MODEL_VARIANT_SEPARATOR);t=o(n[0]),r=o(n[1]),f.empty(r.namespaces)&&!f.empty(t.namespaces)&&(r.namespaces=t.namespaces)}else t=o(e);return new zr(e,t,r);function s(n,l){return{name:n,namespaces:u.nvl(l,[]),toString:()=>{let d=l.slice();return d.push(n),y.join($t.NAMESPACE_SEPARATOR,...d)}}}function o(n){let l=[];if(y.contains(n,$t.NAMESPACE_SEPARATOR)){let d=n.split($t.NAMESPACE_SEPARATOR);l=d.slice(0,d.length-1),n=f.last(d)}return s(n,l)}}}u.addObjectFactories({KeyStroke:()=>new oe,KeyStrokeAdapter:()=>new bs,ComposerField:()=>new Dp,ComposerFieldAdapter:()=>new Mp});function Vd(i,e,t){return e=jb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jb(i){var e=Xb(i,"string");return typeof e=="symbol"?e:String(e)}function Xb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bl{constructor(e){Vd(this,"options$Container",void 0),Vd(this,"widget",void 0),Vd(this,"$container",void 0),u.assertParameter("widget",e.widget),this.widget=e.widget,this.options$Container=e.$container}_ensure$Container(){typeof this.options$Container=="function"?this.$container=this.options$Container():this.options$Container?this.$container=this.options$Container:this.$container=this.widget.$container}}function Wd(i,e,t){return e=Jb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Jb(i){var e=Qb(i,"string");return typeof e=="symbol"?e:String(e)}function Qb(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class rr extends Bl{constructor(e){super(e),Wd(this,"loadingIndicatorDelay",void 0),Wd(this,"_$loadingIndicator",void 0),Wd(this,"_loadingIndicatorTimeoutId",void 0),this.loadingIndicatorDelay=u.nvl(e.loadingIndicatorDelay,250),this._$loadingIndicator=null,this._loadingIndicatorTimeoutId=null}setLoadingIndicatorDelay(e){this.loadingIndicatorDelay=e}_ensure$Container(){typeof this.options$Container=="function"?this.$container=this.options$Container():this.options$Container?this.$container=this.options$Container:this.$container=this.widget.$container}renderLoading(){clearTimeout(this._loadingIndicatorTimeoutId),this._ensure$Container(),this.widget.isLoading()?this.loadingIndicatorDelay&&!this.widget.rendering?this._loadingIndicatorTimeoutId=setTimeout(this._renderLoadingIndicator.bind(this),this.loadingIndicatorDelay):this._renderLoadingIndicator():this._removeLoadingIndicator()}_renderLoadingIndicator(){this._$loadingIndicator||!this.widget.rendered&&!this.widget.rendering||(this.$container.addClass("loading"),this._$loadingIndicator=this.$container.appendDiv("loading-indicator"))}_removeLoadingIndicator(){!this._$loadingIndicator||(this._$loadingIndicator.css("opacity",this._$loadingIndicator.css("opacity")),this._$loadingIndicator.addClass("animate-remove"),this._$loadingIndicator.oneAnimationEnd(()=>{this.remove(),this.widget.rendered&&(this.$container.removeClass("loading"),this.widget.invalidateLayoutTree())}))}remove(){this._$loadingIndicator&&(this._$loadingIndicator.remove(),this._$loadingIndicator=null)}}class Kd extends rr{_renderLoadingIndicator(){(this.widget.rendered||this.widget.rendering)&&this.$container.addClass("loading")}_removeLoadingIndicator(){(this.widget.rendered||this.widget.rendering)&&this.$container.removeClass("loading")}}var ye;(function(i){i.CONTINUE="continue",i.TERMINATE="terminate",i.SKIP_SUBTREE="skip_subtree"})(ye||(ye={}));function yt(i,e,t){return e=Zb(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Zb(i){var e=ey(i,"string");return typeof e=="symbol"?e:String(e)}function ey(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class B{constructor(){yt(this,"field",void 0),yt(this,"which",void 0),yt(this,"ctrl",void 0),yt(this,"inheritAccessibility",void 0),yt(this,"alt",void 0),yt(this,"shift",void 0),yt(this,"preventDefault",void 0),yt(this,"stopPropagation",void 0),yt(this,"stopImmediatePropagation",void 0),yt(this,"keyStrokeMode",void 0),yt(this,"repeatable",void 0),yt(this,"keyStrokeFirePolicy",void 0),yt(this,"enabledByFilter",void 0),yt(this,"renderingHints",void 0),yt(this,"invokeAcceptInputOnActiveValueField",void 0),yt(this,"preventInvokeAcceptInputOnActiveValueField",void 0),yt(this,"_handleExecuted",void 0),this.field=null,this.which=[],this.ctrl=!1,this.inheritAccessibility=!0,this.alt=!1,this.shift=!1,this.preventDefault=!0,this.stopPropagation=!1,this.stopImmediatePropagation=!1,this.keyStrokeMode=B.Mode.DOWN,this.repeatable=!1,this._handleExecuted=!1,this.keyStrokeFirePolicy=oe.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,this.enabledByFilter=!0,this.renderingHints={render:()=>this.field&&this.field.rendered!==void 0?this.field.rendered:!0,gap:4,offset:4,hAlign:ht.LEFT,text:null,$drawingArea:(e,t)=>e},this.invokeAcceptInputOnActiveValueField=!1,this.preventInvokeAcceptInputOnActiveValueField=!1}parseAndSetKeyStroke(e){this.alt=!1,this.ctrl=!1,this.shift=!1,this.which=[],e&&a().extend(this,B.parseKeyStroke(e))}accept(e){return!this._isEnabled()||!this._accept(e)?!1:(this._applyPropagationFlags(e),e.type===this.keyStrokeMode)}handle(e){throw new Error("keystroke event not handled: "+e)}invokeHandle(e){if(this.repeatable){this.handle(e);return}if(!this._handleExecuted&&(this.handle(e),e.type===B.Mode.DOWN)){this._handleExecuted=!0;let r=a()(e.target).window(),s=this,o={handleEvent:function(n){s._handleExecuted=!1,r[0].removeEventListener("keyup",this,!0)}};r[0].addEventListener("keyup",o,!0)}}_isEnabled(){return this.field?this.field.isRemovalPending()||!this.field.visible?!1:this.inheritAccessibility?this.field.enabledComputed:!0:!0}_accept(e){return B.acceptEvent(this,e)}_applyPropagationFlags(e){this.stopPropagation&&e.stopPropagation(),this.stopImmediatePropagation&&e.stopImmediatePropagation(),this.preventDefault&&e.preventDefault()}keys(){return this.which.map(e=>new qn(this,e))}renderKeyBox(e,t){if(e=this.renderingHints.$drawingArea(e,t),!e||!e.length)return null;let r=this._renderKeyBox(e,t.which);return this._postRenderKeyBox(e,r),e}_renderKeyBox(e,t){let r=a()(".key-box",e),s=this.renderingHints.text||_.codesToKeys[_.fromBrowser(t)],o=this.renderingHints.hAlign===ht.RIGHT?"right":"left",n=this.renderingHints.offset;if(r=r.filter(function(){return o==="right"?a()(this).hasClass("right"):!a()(this).hasClass("right")}),r.length>0){let p=r.first();this.renderingHints.hAlign===ht.RIGHT?n=e.outerWidth()-p.position().left+this.renderingHints.gap:n=p.position().left+this.renderingHints.gap+p.outerWidth()}this.shift&&(s="Shift "+s),this.alt&&(s="Alt "+s),this.ctrl&&(s="Ctrl "+s);let l=e.css("position");if(l==="absolute"||l==="relative"||l==="static"&&r.length>0)return h.call(this,n);let d=e.position();if(d)return h.call(this,d.left+n);a().log.warn("(keys#drawSingleKeyBoxItem) pos is undefined. $parent="+e);function h(p){return e.prependDiv("key-box",s).css(o,p+"px").toggleClass("disabled",!this.enabledByFilter).addClass(o)}}_postRenderKeyBox(e,t){}removeKeyBox(e){e&&(a()(".key-box",e).remove(),a()(".key-box-additional",e).remove())}static parseKeyStroke(e){if(!e)return null;let t={alt:!1,ctrl:!1,shift:!1,which:[]};return e.split("-").forEach(r=>{if(r==="alternate"||r==="alt")t.alt=!0;else if(r==="control"||r==="ctrl")t.ctrl=!0;else if(r==="shift")t.shift=!0;else{let s=_[r.toUpperCase()];t.which=s&&[s]}}),t}static acceptEvent(e,t){return e?B.acceptModifiers(e,t)&&u.isOneOf(t.which,e.which):!1}static acceptModifiers(e,t){return B._acceptModifier(e.ctrl,t.ctrlKey||t.metaKey)&&B._acceptModifier(e.alt,t.altKey)&&B._acceptModifier(e.shift,t.shiftKey)}static _acceptModifier(e,t){return e===void 0||t===void 0||e===t}}yt(B,"Mode",{UP:"keyup",DOWN:"keydown"});function ty(i,e,t){return e=iy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iy(i){var e=ry(i,"string");return typeof e=="symbol"?e:String(e)}function ry(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ol extends B{constructor(e){super(),ty(this,"virtualKeyStrokeWhich",void 0),this.field=e,this.renderingHints.$drawingArea=(t,r)=>r._$filterInput,this.virtualKeyStrokeWhich="a-Z;a-z;0-9",this.preventDefault=!1,this.keyStrokeMode=B.Mode.DOWN,this.stopPropagation=!0,this.inheritAccessibility=!1}_accept(e){if(!this._isKeyStrokeInRange(e))return!1;let t=this.field.$container.data("filter-field");return!t||!t.length||!t.is(":focusable")?!1:this.field.$container.activeElement()[0]!==t[0]?(e._$filterInput=t,this._isKeyStrokeInRange(e),!0):!1}handle(e){let t=e._$filterInput;if(this.field.session.focusManager.requestFocus(t)){t.focus();let r=u.nvl(t.val(),"").length;t[0].setSelectionRange(r,r)}}keys(){return[new qn(this,this.virtualKeyStrokeWhich)]}renderKeyBox(e,t){let r=t._$filterInput,o=r.position().left+r.cssMarginLeft()+4;return r.beforeDiv("key-box char","a - z").toggleClass("disabled",!this.enabledByFilter).cssLeft(o),r.parent()}_isKeyStrokeInRange(e){return e.which===this.virtualKeyStrokeWhich?!0:e.altKey||e.ctrlKey?!1:e.which>=_.A&&e.which<=_.Z||e.which>=_[0]&&e.which<=_[9]||e.which>=_.NUMPAD_0&&e.which<=_.NUMPAD_9}}function Fi(i,e,t){return e=sy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sy(i){var e=oy(i,"string");return typeof e=="symbol"?e:String(e)}function oy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ho extends Bl{constructor(e){super(e),Fi(this,"_cancelFilterFieldKeyStroke",void 0),Fi(this,"_createTextFilter",void 0),Fi(this,"_exitFilterFieldKeyStroke",void 0),Fi(this,"_filterElements",void 0),Fi(this,"_filterField",void 0),Fi(this,"_filterFieldDisplayTextChangedHandler",void 0),Fi(this,"_focusFilterFieldKeyStroke",void 0),Fi(this,"_focusInHandler",void 0),Fi(this,"_focusOutHandler",void 0),Fi(this,"_getElementText",void 0),Fi(this,"_getElementsForFiltering",void 0),Fi(this,"_textFilter",void 0),Fi(this,"_updateTextFilterText",void 0),e.filterElements?this._filterElements=e.filterElements:(this._filterElements=this._filter.bind(this),u.assertParameter("getElementsForFiltering",e.getElementsForFiltering),this._getElementsForFiltering=e.getElementsForFiltering),this._getElementText=e.getElementText||(t=>$(t).text()),e.createTextFilter?(u.assertParameter("updateTextFilterText",e.updateTextFilterText),this._createTextFilter=e.createTextFilter,this._updateTextFilterText=e.updateTextFilterText):(this._createTextFilter=this._createDefaultTextFilter.bind(this),this._updateTextFilterText=this._updateDefaultTextFilterText.bind(this)),this._filterField=null,this._filterFieldDisplayTextChangedHandler=this._onFilterFieldDisplayTextChanged.bind(this),this._focusInHandler=this._onFocusIn.bind(this),this._focusOutHandler=this._onFocusOut.bind(this),this._focusFilterFieldKeyStroke=null,this._cancelFilterFieldKeyStroke=null,this._exitFilterFieldKeyStroke=null,this._textFilter=null}_createDefaultTextFilter(){return{acceptedText:null,accept:e=>{if(y.empty(this._textFilter.acceptedText)||!this.widget.isTextFilterFieldVisible())return!0;let t=this._getElementText(e);return y.empty(t)?!1:y.contains(t.toLowerCase(),this._textFilter.acceptedText.toLowerCase())}}}_updateDefaultTextFilterText(e,t){return v.equals(e.acceptedText,t)?!1:(e.acceptedText=t,!0)}renderFilterField(){this.widget.isTextFilterFieldVisible()?this._renderFilterField():this._removeFilterField()}_renderFilterField(){this._ensure$Container(),this._filterField=u.create(Wi,{parent:this.widget,label:this.widget.session.text("ui.Filter"),labelVisible:!1,inheritAccessibility:!1,cssClass:"filter-field empty",fieldStyle:M.FieldStyle.CLASSIC,statusVisible:!1,clearable:ge.Clearable.ALWAYS,updateDisplayTextOnModify:!0,preventInitialFocus:!0}),this._filterField.render(this.$container),this._filterField.$field.attr("tabIndex",-1),this.widget.rendered?this._updateFilterFieldBackgroundColor():this.widget.session.layoutValidator.schedulePostValidateFunction(this._updateFilterFieldBackgroundColor.bind(this)),this._textFilter=this._createTextFilter(),this._textFilter.synthetic=!0,this.addFilter(this._textFilter),this._filterField.on("propertyChange:displayText",this._filterFieldDisplayTextChangedHandler),this.widget.$container.on("focusin",this._focusInHandler),this.widget.$container.on("focusout",this._focusOutHandler),this.widget.$container.data("filter-field",this._filterField.$field),this._focusFilterFieldKeyStroke=new Ol(this.widget),this.widget.keyStrokeContext.registerKeyStroke(this._focusFilterFieldKeyStroke),this._cancelFilterFieldKeyStroke=new B,this._cancelFilterFieldKeyStroke.field=this._filterField,this._cancelFilterFieldKeyStroke.which=[_.ESC],this._cancelFilterFieldKeyStroke.stopPropagation=!0,this._cancelFilterFieldKeyStroke.renderingHints.hAlign=ht.RIGHT,this._cancelFilterFieldKeyStroke.handle=this._cancelFilterField.bind(this),this._filterField.keyStrokeContext.registerKeyStroke(this._cancelFilterFieldKeyStroke),this._exitFilterFieldKeyStroke=new B,this._exitFilterFieldKeyStroke.field=this._filterField,this._exitFilterFieldKeyStroke.which=[_.ENTER],this._exitFilterFieldKeyStroke.stopPropagation=!0,this._exitFilterFieldKeyStroke.renderingHints.hAlign=ht.RIGHT,this._exitFilterFieldKeyStroke.handle=this._exitFilterField.bind(this),this._filterField.keyStrokeContext.registerKeyStroke(this._exitFilterFieldKeyStroke)}_updateFilterFieldBackgroundColor(){if(!this._filterField||!this._filterField.rendered)return;let e=L.getFirstOpaqueBackgroundColor(this._filterField.$container),t=$.extend(!0,{red:0,green:0,blue:0,alpha:1},L.rgb(e)),r="rgba("+t.red+", "+t.green+", "+t.blue+", "+.5+")",s="rgba("+t.red+", "+t.green+", "+t.blue+", "+.8+")";this._filterField.$container.css("--filter-field-background-color",e),this._filterField.$container.css("--filter-field-transparent-50-background-color",r),this._filterField.$container.css("--filter-field-transparent-80-background-color",s)}_onFilterFieldDisplayTextChanged(e){this._filterField&&this._filterField.rendered&&this._filterField.$container.toggleClass("empty",!e.newValue),this._updateTextFilterText(this._textFilter,e.newValue)&&this.filter()}_onFocusIn(e){this._updateFocusInsideWidget(e.target)}_onFocusOut(e){this._updateFocusInsideWidget(e.relatedTarget)}_updateFocusInsideWidget(e){let t=this.widget.$container.isOrHas(e);return this._filterField&&this._filterField.rendered&&this._filterField.$container.toggleClass("focus-inside-widget",t),t}_exitFilterField(){this.widget.focus()}_cancelFilterField(){this._resetFilterField(),this._exitFilterField()}_resetFilterField(){this._filterField&&this._filterField.setValue(null)}_removeFilterField(){!this._filterField||(this.widget.$container.off("focusin",this._focusInHandler),this.widget.$container.off("focusout",this._focusOutHandler),this.widget.keyStrokeContext.unregisterKeyStroke(this._focusFilterFieldKeyStroke),this._focusFilterFieldKeyStroke=null,this._resetFilterField(),this._filterField.destroy(),this._filterField=null,this.removeFilter(this._textFilter),this._textFilter=null)}remove(){this._removeFilterField()}addFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=f.ensure(e),s=this._getFilters().slice(),o=s.slice();if(r.forEach(l=>{this._hasFilter(s,l)||s.push(l)}),s.length===this._getFilters().length)return[];this._setFilters(s,t);let n=this._getFilters().slice();return f.removeAll(n,o),n}removeFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=f.ensure(e),s=this._getFilters().slice(),o=s.slice(),n=!1;if(r.forEach(d=>{d=this._findFilter(s,d),n=f.remove(s,d)||n}),!n)return[];this._setFilters(s,t);let l=this._getFilters().slice();return f.removeAll(o,l),o}setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e=f.ensure(e),this._addSyntheticFilters(e),this._getFilters().length===e.length&&e.every(n=>this._hasFilter(this._getFilters(),n)))return{filtersAdded:[],filtersRemoved:[]};let r=this._getFilters().slice();this._setFilters(e,t);let s=this._getFilters().filter(n=>!this._findFilter(r,n)),o=r.filter(n=>!this._findFilter(this._getFilters(),n));return{filtersAdded:s,filtersRemoved:o}}_setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.widget.setProperty("filters",e.map(r=>v.isFunction(r)?this._createFilterByFunction(r):r)),t&&this.filter()}_addSyntheticFilters(e){this._getFilters().filter(t=>t.synthetic).forEach(t=>this._addSyntheticFilter(e,t)),this._addSyntheticFilter(e,this._textFilter)}_addSyntheticFilter(e,t){!t||this._hasFilter(e,t)||e.push(t)}_getFilters(){return this.widget.filters}_findFilter(e,t){return v.isFunction(t)?this._getFilterCreatedByFunction(e,t):f.find(e,r=>v.equals(r,t))}_getFilterCreatedByFunction(e,t){return f.find(e,r=>typeof r!="function"&&r.createdByFunction&&r.accept===t)}_hasFilter(e,t){return!!this._findFilter(e,t)}_createFilterByFunction(e){return{createdByFunction:!0,accept:e}}filter(){let e=this._filterElements();if(e&&(f.ensure(e.newlyHidden).length||f.ensure(e.newlyShown).length)){this.widget.filteredElementsDirty=!0;let r={};this._filterField&&(r.textFilterText=this._filterField.displayText),this.widget.updateFilteredElements(e,r)}return e}_filter(){return this.applyFilters(this._getElementsForFiltering(),!0)}applyFilters(e,t){if(this._getFilters().length===0&&!u.nvl(t,!1))return;let r=[],s=[];return e.forEach(o=>{this.applyFiltersForElement(o)&&(o.filterAccepted?r.push(o):s.push(o))}),{newlyHidden:s,newlyShown:r}}applyFiltersForElement(e){if(this.elementAcceptedByFilters(e)){if(!e.filterAccepted)return e.setFilterAccepted(!0),!0}else if(e.filterAccepted)return e.setFilterAccepted(!1),!0;return!1}elementAcceptedByFilters(e){return this._getFilters().every(t=>t.accept(e))}}function Ki(i,e,t){return e=ny(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ny(i){var e=ly(i,"string");return typeof e=="symbol"?e:String(e)}function ly(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class He extends ir{constructor(){super(),Ki(this,"id",void 0),Ki(this,"objectType",void 0),Ki(this,"initialized",void 0),Ki(this,"attached",void 0),Ki(this,"destroyed",void 0),Ki(this,"widget",void 0),Ki(this,"session",void 0),Ki(this,"_enabledBeforeOffline",void 0),Ki(this,"_remoteProperties",void 0),Ki(this,"_widgetListener",void 0),Ki(this,"_propertyChangeEventFilter",void 0),Ki(this,"_widgetEventTypeFilter",void 0),this.id=null,this.objectType=null,this.initialized=!1,this.attached=!1,this.destroyed=!1,this.widget=null,this._enabledBeforeOffline=!0,this._remoteProperties=[],this._widgetListener=null,this._propertyChangeEventFilter=new th,this._widgetEventTypeFilter=new oh,this.session=null}init(e){this._init(e),this.initialized=!0}_init(e){u.assertParameter("id",e.id),u.assertParameter("session",e.session),a().extend(this,e),this.session.registerModelAdapter(this)}destroy(){this._detachWidget(),this.widget.destroy(),this.widget=null,this.session.unregisterModelAdapter(this),this.destroyed=!0}createWidget(e,t){let r=this._initModel(e,t);return this.widget=this._createWidget(r),this._attachWidget(),this._postCreateWidget(),this.widget}_postCreateWidget(){}_initModel(e,t){let r=this.session.adapterExportEnabled,s=a().extend(r,{},e);return Ve.applyTo(s),s.parent=t,s.owner=t,s.modelAdapter=this,s.global&&(s.owner=this.session.getModelAdapter("1").widget),this._initProperties(s),s}_initProperties(e){}_createWidget(e){let t=u.create(e);return t._addCloneProperties(["modelClass","classId"]),t}_attachWidget(){this._widgetListener||(this._widgetListener={func:this._onWidgetEventInternal.bind(this)},this.widget.addListener(this._widgetListener),this.attached=!0,this.trigger("attach"))}_detachWidget(){!this._widgetListener||(this.widget.removeListener(this._widgetListener),this._widgetListener=null,this.attached=!1,this.trigger("detach"))}goOffline(){this.widget.visitChildren(e=>{e.modelAdapter&&e.modelAdapter._goOffline()})}_goOffline(){}goOnline(){this.widget.visitChildren(e=>{e.modelAdapter&&e.modelAdapter._goOnline()})}_goOnline(){}isRemoteProperty(e){return this._remoteProperties.indexOf(e)>-1}_addRemoteProperties(e){this._addProperties("_remoteProperties",e)}_removeRemoteProperties(e){this._removeProperties("_remoteProperties",e)}_addProperties(e,t){Array.isArray(t)?this[e]=this[e].concat(t):this[e].push(t)}_removeProperties(e,t){t=f.ensure(t),f.removeAll(this[e],t)}_send(e,t,r){let s={};arguments.length>2&&(r!==null&&typeof r=="object"?s=r:(s.delay=arguments[2],s.coalesce=arguments[3],s.showBusyIndicator=arguments[4])),r=s;let o=new jl(this.id,e,t);r.coalesce!==void 0&&(o.coalesce=r.coalesce),r.showBusyIndicator!==void 0&&(o.showBusyIndicator=r.showBusyIndicator),r.newRequest!==void 0&&(o.newRequest=r.newRequest),this.session.sendEvent(o,r.delay)}_sendProperty(e,t){let r={};r[e]=t,this._send("property",r)}addFilterForWidgetEvent(e){this._widgetEventTypeFilter.addFilter(e)}addFilterForWidgetEventType(e){this._widgetEventTypeFilter.addFilterForEventType(e)}addFilterForProperties(e){this._propertyChangeEventFilter.addFilterForProperties(e)}addFilterForPropertyName(e){this._propertyChangeEventFilter.addFilterForPropertyName(e)}_isPropertyChangeEventFiltered(e,t){return t instanceof I&&(t=t.id),this._propertyChangeEventFilter.filter(e,t)}_isWidgetEventFiltered(e){return this._widgetEventTypeFilter.filter(e)}resetEventFilters(){this._propertyChangeEventFilter.reset(),this._widgetEventTypeFilter.reset()}_onWidgetPropertyChange(e){let t=e.propertyName,r=e.newValue;this._isPropertyChangeEventFiltered(t,r)||this.isRemoteProperty(t)&&(r=this._prepareRemoteProperty(t,r),this._callSendProperty(t,r))}_prepareRemoteProperty(e,t){return!t||!this.widget.isWidgetProperty(e)?t:Array.isArray(t)?t.map(r=>r.modelAdapter.id):t.modelAdapter.id}_callSendProperty(e,t){let r="_send"+y.toUpperCaseFirstLetter(e);this[r]?this[r](t):this._sendProperty(e,t)}_onWidgetDestroy(e){this.destroy()}_onWidgetEventInternal(e){this._isWidgetEventFiltered(e)||this._onWidgetEvent(e)}_onWidgetEvent(e){e.type==="destroy"?this._onWidgetDestroy(e):e.type==="propertyChange"&&this._onWidgetPropertyChange(e)}_syncPropertiesOnPropertyChange(e){this._orderPropertyNamesOnSync(e).forEach(r=>{let s=e[r],o="_sync"+y.toUpperCaseFirstLetter(r);this[o]?this[o](s):this.widget.callSetter(r,s)})}_orderPropertyNamesOnSync(e){return Object.keys(e)}_createPropertySortFunc(e){return(t,r)=>{let s=e.indexOf(t),o=e.indexOf(r);return s>-1&&o>-1?s-o:s>-1?-1:o>-1?1:gt.TEXT.compare(t,r)}}onModelEvent(e){!e||(e.type==="property"?this.onModelPropertyChange(e):this.onModelAction(e))}onModelPropertyChange(e){this.addFilterForProperties(e.properties),this._syncPropertiesOnPropertyChange(e.properties)}onModelAction(e){e.type==="scrollToTop"?this.widget.scrollToTop({animate:e.animate}):e.type==="reveal"?this.widget.reveal({animate:e.animate}):a().log.warn('Model action "'+e.type+'" is not supported by model-adapter '+this.objectType)}toString(){return"ModelAdapter[objectType="+this.objectType+" id="+this.id+"]"}exportAdapterData(e){let t=e.modelClass;if(t){let r=Math.max(0,t.lastIndexOf("$")+1,t.lastIndexOf(".")+1);e.id=t.substring(r)}return delete e.owner,delete e.classId,delete e.modelClass,e}static modifyWidgetPrototype(e){!ie.get().remote||v.replacePrototypeFunction(I,"_createChild",function(t){return t instanceof I?t:this.modelAdapter&&typeof t=="string"?this.session.getOrCreateWidget(t,this):this._createChildOrig(t)},!0)}}ie.addListener("bootstrap",He.modifyWidgetPrototype);function X(i,e,t){return e=ay(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ay(i){var e=dy(i,"string");return typeof e=="symbol"?e:String(e)}function dy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class I extends Il{constructor(){super(),X(this,"animateRemoval",void 0),X(this,"animateRemovalClass",void 0),X(this,"attached",void 0),X(this,"children",void 0),X(this,"cloneOf",void 0),X(this,"cssClass",void 0),X(this,"destroyed",void 0),X(this,"destroying",void 0),X(this,"disabledStyle",void 0),X(this,"enabled",void 0),X(this,"enabledComputed",void 0),X(this,"eventDelegators",void 0),X(this,"focused",void 0),X(this,"htmlComp",void 0),X(this,"id",void 0),X(this,"inheritAccessibility",void 0),X(this,"initialized",void 0),X(this,"keyStrokeContext",void 0),X(this,"loading",void 0),X(this,"loadingSupport",void 0),X(this,"logicalGrid",void 0),X(this,"modelClass",void 0),X(this,"classId",void 0),X(this,"objectType",void 0),X(this,"owner",void 0),X(this,"parent",void 0),X(this,"removalPending",void 0),X(this,"removing",void 0),X(this,"rendering",void 0),X(this,"scrollLeft",void 0),X(this,"scrollTop",void 0),X(this,"session",void 0),X(this,"trackFocus",void 0),X(this,"visible",void 0),X(this,"modelAdapter",void 0),X(this,"$container",void 0),X(this,"$parent",void 0),X(this,"_widgetProperties",void 0),X(this,"_cloneProperties",void 0),X(this,"_rendered",void 0),X(this,"_$lastFocusedElement",void 0),X(this,"_focusInListener",void 0),X(this,"_glassPaneContributions",void 0),X(this,"_parentDestroyHandler",void 0),X(this,"_parentRemovingWhileAnimatingHandler",void 0),X(this,"_postRenderActions",void 0),X(this,"_preserveOnPropertyChangeProperties",void 0),X(this,"_scrollHandler",void 0),X(this,"_storedFocusedWidget",void 0),this.id=null,this.objectType=null,this.session=null,this.modelClass=null,this.classId=null,this.owner=null,this.parent=null,this.children=[],this.initialized=!1,this.cloneOf=null,this.rendering=!1,this.removing=!1,this.removalPending=!1,this._rendered=!1,this.attached=!1,this.destroyed=!1,this.destroying=!1,this.enabled=!0,this.enabledComputed=!0,this.inheritAccessibility=!0,this.disabledStyle=I.DisabledStyle.DEFAULT,this.visible=!0,this.focused=!1,this.loading=!1,this.cssClass=null,this.scrollTop=null,this.scrollLeft=null,this.$parent=null,this.$container=null,this.htmlComp=null,this.animateRemoval=!1,this.animateRemovalClass="animate-remove",this._widgetProperties=[],this._cloneProperties=["visible","enabled","inheritAccessibility","cssClass"],this.eventDelegators=[],this._preserveOnPropertyChangeProperties=[],this._postRenderActions=[],this._focusInListener=this._onFocusIn.bind(this),this._parentDestroyHandler=this._onParentDestroy.bind(this),this._parentRemovingWhileAnimatingHandler=this._onParentRemovingWhileAnimating.bind(this),this._scrollHandler=this._onScroll.bind(this),this.loadingSupport=this._createLoadingSupport(),this.keyStrokeContext=this._createKeyStrokeContext(),this.logicalGrid=null,this.trackFocus=!1,this._$lastFocusedElement=null,this._storedFocusedWidget=null,this._glassPaneContributions=[]}init(e){let t=this._jsonModel();t&&(e=Mt.extend({},t,e)),e=e||{},e=this._prepareModel(e),this._init(e),this._initKeyStrokeContext(),this.recomputeEnabled(),this.initialized=!0,this.trigger("init")}_prepareModel(e){return e}_init(e){if(!e.parent)throw new Error("Parent expected: "+this);if(this.setOwner(e.owner||e.parent),this.setParent(e.parent),this.session=e.session||this.parent.session,!this.session)throw new Error("Session expected: "+this);this._eachProperty(e,(t,r,s)=>{r!==void 0&&(s&&(r=this._prepareWidgetProperty(t,r)),this._initProperty(t,r))}),this._setCssClass(this.cssClass),this._setLogicalGrid(this.logicalGrid),this._setEnabled(this.enabled)}_initProperty(e,t){this[e]=t}_jsonModel(){return null}_createChildren(e){if(!e)return null;if(!Array.isArray(e))return this._createChild(e);let t=[];return e.forEach((r,s)=>{t[s]=this._createChild(r)}),t}_createChild(e){if(e instanceof I)return e;if(typeof e=="string"){let r=this.widget(e);if(!r)throw new Error("Referenced widget not found: "+e);return r}let t=e;return t.parent=this,u.create(t)}_initKeyStrokeContext(){!this.keyStrokeContext||(this.keyStrokeContext.$scopeTarget=()=>this.$container,this.keyStrokeContext.$bindTarget=()=>this.$container)}destroy(){if(!this.destroyed){if(this.destroying=!0,this._rendered&&(this.animateRemoval||this._isRemovalPrevented())){this.one("remove",()=>{this.destroy()}),this.remove();return}this._destroyChildren(this.children.slice().reverse()),this.remove(),this._destroy(),this.owner._removeChild(this),this.owner=null,this.parent._removeChild(this),this.parent.off("destroy",this._parentDestroyHandler),this.parent=null,this.destroying=!1,this.destroyed=!0,this.trigger("destroy")}}_destroy(){}_destroyChildren(e){!e||(e=f.ensure(e),e.forEach(t=>this._destroyChild(t)))}_destroyChild(e){e.owner===this&&e.destroy()}render(e){if(Mt.log.isTraceEnabled()&&Mt.log.trace("Rendering widget: "+this),!this.initialized)throw new Error("Not initialized: "+this);if(this._rendered)throw new Error("Already rendered: "+this);if(this.destroyed)throw new Error("Widget is destroyed: "+this);this.rendering=!0,this.$parent=e||this.parent.$container,this._render(),this._renderProperties(),this._renderInspectorInfo(),this._linkWithDOM(),this.session.keyStrokeManager.installKeyStrokeContext(this.keyStrokeContext),this.rendering=!1,this.rendered=!0,this.attached=!0,this.trigger("render"),this.restoreFocus(),this._postRender()}_render(){}get rendered(){return this._rendered&&!this.isRemovalPending()}set rendered(e){this._rendered=e}_renderProperties(){this._renderCssClass(),this._renderEnabled(),this._renderVisible(),this._renderTrackFocus(),this._renderFocused(),this._renderLoading(),this._renderScrollTop(),this._renderScrollLeft()}_postRender(){let e=this._postRenderActions;this._postRenderActions=[],e.forEach(t=>{t()})}remove(){!this._rendered||this._isRemovalPrevented()||(this.animateRemoval?this._removeAnimated():this._removeInternal())}removeImmediately(){this._removeInternal()}_isRemovalPrevented(){return this.isRemovalPending()}_isRemovalPending(){return this.isRemovalPending()}isRemovalPending(){if(this.removalPending)return!0;let e=this.parent;if(!e||e.removing||e.rendering)return!1;for(;e;){if(e.removalPending)return!0;e=e.parent}return!1}_removeInternal(){!this._rendered||(Mt.log.isTraceEnabled()&&Mt.log.trace("Removing widget: "+this),this.removing=!0,this.removalPending=!1,this.trigger("removing"),this.$container&&this.$container.off("focusin",this._focusInListener),this._$lastFocusedElement&&(this._storedFocusedWidget=u.widget(this._$lastFocusedElement),this._$lastFocusedElement=null),this.children.slice().reverse().forEach(function(e){e.parent===this&&e.remove()},this),this._rendered&&(this._cleanup(),this._remove(),this.$parent=null,this.rendered=!1,this.attached=!1,this.removing=!1,this.trigger("remove")))}_removeAnimated(){let e=this._animateRemovalWhileRemovingParent();if(this.parent.removing&&!e||!F.get().supportsCssAnimation()||!this.$container||this.$container.isDisplayNone()){this._removeInternal();return}this.session.desktop.removePopupsFor(this),this.removalPending=!0,setTimeout(()=>{if(!!this._rendered){if(!this.$container.isVisible()||!this.$container.isEveryParentVisible()||!this.$container.isAttached()){this._removeInternal();return}this._removeAnimatedImpl()}}),e||this.parent.one("removing",this._parentRemovingWhileAnimatingHandler)}_removeAnimatedImpl(){if(!this.animateRemovalClass)throw new Error("Missing animate removal class. Cannot remove animated.");this.$container.addClass(this.animateRemovalClass),this.$container.oneAnimationEnd(()=>{this._removeInternal()})}_animateRemovalWhileRemovingParent(){return!1}_onParentRemovingWhileAnimating(){this._removeInternal()}_renderInspectorInfo(){!this.session.inspector||Vo.applyInfo(this)}_linkWithDOM(){this.$container&&this.$container.data("widget",this)}_cleanup(){this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.keyStrokeContext),this.loadingSupport&&this.loadingSupport.remove(),this._uninstallScrollbars(),this.$container&&this.session.layoutValidator.cleanupInvalidComponents(this.$container)}_remove(){this.$container&&(this.$container.remove(),this.$container=null)}setOwner(e){u.assertParameter("owner",e),e!==this.owner&&(this.owner&&this.owner._removeChild(this),this.owner=e,this.owner._addChild(this))}setParent(e){if(u.assertParameter("parent",e),e===this.parent)return;if(this.rendered&&!e.rendered&&(Mt.log.isInfoEnabled()&&Mt.log.info("rendered child "+this+" is added to not rendered parent "+e+". Removing child.",new Error("origin")),this.remove()),this.parent){if(this.parent.isRemovalPending()){this.parent.one("remove",()=>{this.setParent(e)});return}this.parent.off("destroy",this._parentDestroyHandler),this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.parent!==this.owner&&this.parent._removeChild(this)}let t=this.parent;this.parent=e,this.parent._addChild(this),this.trigger("hierarchyChange",{oldParent:t,parent:e}),this.initialized&&this.recomputeEnabled(this.parent.enabledComputed),this.parent.one("destroy",this._parentDestroyHandler)}_addChild(e){Mt.log.isTraceEnabled()&&Mt.log.trace("addChild("+e+") to "+this),f.pushSet(this.children,e)}_removeChild(e){Mt.log.isTraceEnabled()&&Mt.log.trace("removeChild("+e+") from "+this),f.remove(this.children,e)}ancestors(){let e=[],t=this.parent;for(;t;)e.push(t),t=t.parent;return e}isOrHas(e){return e===this?!0:this.has(e)}has(e){for(;e;){if(e.parent===this)return!0;e=e.parent}return!1}getForm(){return Y.findForm(this)}findNonWrappedForm(){return Y.findNonWrappedForm(this)}findDesktop(){return this.session.desktop?this.session.desktop:this.findParent(e=>e instanceof Ie)}setEnabled(e,t,r){this.setProperty("enabled",e),e&&t&&this.parent&&this.parent.setEnabled(!0,!0,!1),r&&this.visitChildren(s=>{s.setEnabled(e)})}_setEnabled(e){this._setProperty("enabled",e),this.initialized&&this.recomputeEnabled()}recomputeEnabled(e){e===void 0&&(e=!0,this.parent&&this.parent.initialized&&this.parent.enabledComputed!==void 0&&(e=this.parent.enabledComputed));let t=this._computeEnabled(this.inheritAccessibility,e);this._updateEnabledComputed(t)}_updateEnabledComputed(e,t){if(this.enabledComputed===e&&t===void 0)return;this.setProperty("enabledComputed",e),this.rendered&&this._renderEnabled();let r=u.nvl(t,e);this._childrenForEnabledComputed().forEach(s=>{s.inheritAccessibility&&s.recomputeEnabled(r)})}_childrenForEnabledComputed(){return this.children}_computeEnabled(e,t){return this.enabled&&(e?t:!0)}_renderEnabled(){!this.$container||(this.$container.setEnabled(this.enabledComputed),this._renderDisabledStyle())}setInheritAccessibility(e){this.setProperty("inheritAccessibility",e)}_setInheritAccessibility(e){this._setProperty("inheritAccessibility",e),this.initialized&&this.recomputeEnabled()}setDisabledStyle(e){this.setProperty("disabledStyle",e),this.children.forEach(t=>{t.setDisabledStyle(e)})}_renderDisabledStyle(){this._renderDisabledStyleInternal(this.$container)}_renderDisabledStyleInternal(e){!e||(this.enabledComputed?e.removeClass("read-only"):e.toggleClass("read-only",this.disabledStyle===I.DisabledStyle.READ_ONLY))}setVisible(e){this.setProperty("visible",e)}isVisible(){return this.visible}_renderVisible(){!this.$container||(this.$container.setVisible(this.isVisible()),this.invalidateParentLogicalGrid())}isEveryParentVisible(){let e=this.parent;for(;e;){if(!e.isVisible())return!1;e=e.parent}return!0}setFocused(e){this.setProperty("focused",e)}_renderFocused(){this.$container&&this.$container.toggleClass("focused",this.focused)}_setCssClass(e){this.rendered&&this._removeCssClass(),this._setProperty("cssClass",e)}_removeCssClass(){!this.$container||this.$container.removeClass(this.cssClass)}_renderCssClass(){!this.$container||(this.$container.addClass(this.cssClass),this.htmlComp&&this.invalidateLayoutTree())}setCssClass(e){this.setProperty("cssClass",e)}addCssClass(e){let t=this.cssClassAsArray();I.cssClassAsArray(e).forEach(s=>{t.indexOf(s)>=0||t.push(s)},this),this.setProperty("cssClass",f.format(t," "))}removeCssClass(e){let t=this.cssClassAsArray(),r=I.cssClassAsArray(e);f.removeAll(t,r)&&this.setProperty("cssClass",f.format(t," "))}toggleCssClass(e,t){t?this.addCssClass(e):this.removeCssClass(e)}cssClassAsArray(){return I.cssClassAsArray(this.cssClass)}_createLoadingSupport(){return null}setLoading(e){this.setProperty("loading",e)}isLoading(){return this.loading}_renderLoading(){!this.loadingSupport||this.loadingSupport.renderLoading()}pack(){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.pack()}}invalidateLayout(){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayout()}}validateLayout(){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayout()}}revalidateLayout(){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayout()}}invalidateLayoutTree(e){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayoutTree(e)}}validateLayoutTree(){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayoutTree()}}revalidateLayoutTree(e){if(!(!this.rendered||this.removing)){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayoutTree(e)}}setLayoutData(e){if(!!this.rendered){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.layoutData=e}}validateLogicalGrid(){this.logicalGrid&&this.logicalGrid.validate(this)}invalidateLogicalGrid(e){!this.initialized||!this.logicalGrid||(this.logicalGrid.setDirty(!0),u.nvl(e,!0)&&this.invalidateLayoutTree())}invalidateParentLogicalGrid(e){if(this.parent.invalidateLogicalGrid(!1),!(!this.rendered||!this.htmlComp)&&u.nvl(e,!0)){let t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}revalidateLogicalGrid(e){this.invalidateLogicalGrid(e),this.validateLogicalGrid()}setLogicalGrid(e){this.setProperty("logicalGrid",e)}_setLogicalGrid(e){(typeof e=="string"||typeof e=="function")&&(e=u.create(e)),this._setProperty("logicalGrid",e),this.invalidateLogicalGrid()}entryPoint(){let e=u.nvl(this.$container,this.parent.$container);if(!e||!e.length)throw new Error("Cannot resolve entryPoint, $element.length is 0 or undefined");return e.entryPoint()}window(e){let t=this.$container||this.$parent;return t?t.window(e):e?null:Mt()}document(e){let t=this.$container||this.$parent;return t?t.document(e):e?null:Mt()}attach(){this.attached||!this.rendered||(this._attach(),this._installFocusContext(),this.restoreFocus(),this.attached=!0,this._postAttach(),this._onAttach(),this._triggerChildrenOnAttach(this))}_attach(){}_postAttach(){}_triggerChildrenOnAttach(e){this.children.forEach(t=>{t._onAttach(),t._triggerChildrenOnAttach(e)})}_onAttach(){this.rendered&&this._renderOnAttach()}_renderOnAttach(){this._renderScrollTop(),this._renderScrollLeft()}detach(){this.rendering&&this._postRenderActions.push(this.detach.bind(this)),!(!this.attached||!this.rendered)&&(this._beforeDetach(),this._onDetach(),this._triggerChildrenOnDetach(),this._detach(),this.attached=!1)}_beforeDetach(){if(!this.$container)return;let e=this.$container.document(!0).activeElement,t=this.$container.isOrHas(e),r=this.session.focusManager;r.isFocusContextInstalled(this.$container)?this._uninstallFocusContext():t&&r.validateFocus(ps.outsideFilter(this.$container))}_triggerChildrenOnDetach(){this.children.forEach(e=>{e._onDetach(),e._triggerChildrenOnDetach()})}_onDetach(){this.rendered&&this._renderOnDetach()}_renderOnDetach(){}_detach(){}_uninstallFocusContext(){}_installFocusContext(){}_createKeyStrokeContext(){return null}updateKeyStrokes(e,t){this.unregisterKeyStrokes(t),this.registerKeyStrokes(e)}registerKeyStrokes(e){this.keyStrokeContext.registerKeyStrokes(e)}unregisterKeyStrokes(e){this.keyStrokeContext.unregisterKeyStrokes(e)}setProperty(e,t){return v.equals(this[e],t)?!1:(t=this._prepareProperty(e,t),this.rendered&&this._callRemoveProperty(e),this._callSetProperty(e,t),this.rendered&&this._callRenderProperty(e),!0)}_prepareProperty(e,t){return this.isWidgetProperty(e)?this._prepareWidgetProperty(e,t):t}_prepareWidgetProperty(e,t){let r=this._createChildren(t),s=this[e];return s&&Array.isArray(r)&&(s=f.diff(s,r)),this.isPreserveOnPropertyChangeProperty(e)||(this._destroyChildren(s),this.link(r)),r}_callRemoveProperty(e){if(!this.isWidgetProperty(e)||this.isPreserveOnPropertyChangeProperty(e))return;let t=this[e];if(!t)return;let r="_remove"+y.toUpperCaseFirstLetter(e);this[r]?this[r]():this._internalRemoveWidgets(t)}_internalRemoveWidgets(e){e=f.ensure(e),e.forEach(t=>{t.remove()})}_callRenderProperty(e){let t="_render"+y.toUpperCaseFirstLetter(e);!this[t]||this[t]()}link(e){!e||(e=f.ensure(e),e.forEach(t=>t.setParent(this)))}glassPaneTargets(e){let t=r=>f.flatMap(this._glassPaneContributions,o=>{let n=o(r);return n?f.ensure(n):[]}).concat(this._glassPaneTargets(r));return this.rendered?t(e):To.createFor(this,t.bind(this,e))}_glassPaneTargets(e){return[this.$container].concat(this.session.desktop.getPopupsFor(this).filter(t=>!e.has(t)).reduce((t,r)=>t.concat(r.glassPaneTargets()),[]))}addGlassPaneContribution(e){this._glassPaneContributions.push(e),this.trigger("glassPaneContributionAdded",{contribution:e})}removeGlassPaneContribution(e){f.remove(this._glassPaneContributions,e),this.trigger("glassPaneContributionRemoved",{contribution:e})}toString(){let e="";return e+="id="+this.id,e+=" objectType="+this.objectType,e+=" rendered="+this.rendered,this.$container&&(e+=" $container="+w.debugOutput(this.$container)),"Widget["+e.trim()+"]"}ancestorsToString(e){let t="",r=this.ancestors();return e=u.nvl(e,-1),r.some((s,o)=>e>-1&&o>=e?!0:(o>0&&o<r.length-1&&(t+=`
`),t+=s.toString(),!1)),t}resolveTextKeys(e){e.forEach(t=>{Ce.resolveTextProperty(this,t)})}resolveIconIds(e){e.forEach(t=>{ve.resolveIconProperty(this,t)})}resolveConsts(e){e.forEach(t=>v.resolveConstProperty(this,t))}_addWidgetProperties(e){this._addProperties("_widgetProperties",e)}isWidgetProperty(e){return this._widgetProperties.indexOf(e)>-1}_addCloneProperties(e){this._addProperties("_cloneProperties",e)}isCloneProperty(e){return this._cloneProperties.indexOf(e)>-1}_addPreserveOnPropertyChangeProperties(e){this._addProperties("_preserveOnPropertyChangeProperties",e)}isPreserveOnPropertyChangeProperty(e){return this._preserveOnPropertyChangeProperties.indexOf(e)>-1}_addProperties(e,t){t=f.ensure(t),t.forEach(r=>{if(this[e].indexOf(r)>-1)throw new Error(e+" already contains the property "+r);this[e].push(r)})}_eachProperty(e,t){let r,s,o;for(r in e)this._widgetProperties.indexOf(r)>-1||(s=e[r],t(r,s));for(o=0;o<this._widgetProperties.length;o++)r=this._widgetProperties[o],s=e[r],s!==void 0&&t(r,s,!0)}_removeWidgetProperties(e){Array.isArray(e)?f.removeAll(this._widgetProperties,e):f.remove(this._widgetProperties,e)}cloneAndMirror(e){return this.clone(e,{delegateAllPropertiesToClone:!0})}original(){let e=this;for(;e.cloneOf;)e=e.cloneOf;return e}clone(e,t){let r,s;return e=e||{},t=t||{},s=v.extractProperties(this,e,this._cloneProperties),r=u.create(this.objectType,s),r.cloneOf=this,this._mirror(r,t),this.logicalGrid?r.setLogicalGrid(this.logicalGrid.objectType):r.setLogicalGrid(null),r}_deepCloneProperties(e,t,r){if(!t)return e;t=f.ensure(t),t.forEach(s=>{let o=this[s],n=null;if(o===void 0)throw new Error("Property '"+s+"' is undefined. Deep copy not possible.");this._widgetProperties.indexOf(s)>-1?Array.isArray(o)?n=o.map(l=>l.clone({parent:e},r)):n=o.clone({parent:e},r):Array.isArray(o)?n=o.map(l=>l):n=o,e[s]=n})}mirror(e,t){if(t=t||this.cloneOf,!t)throw new Error("No target for mirroring.");this._mirror(t,e)}_mirror(e,t){let r=f.find(this.eventDelegators,s=>s.clone===e);if(r)throw new Error("_mirror can only be called on not mirrored widgets. call unmirror first.");t=t||{},r={clone:e,originalToClone:gr.create(this,e,{delegateProperties:t.delegatePropertiesToClone,delegateAllProperties:t.delegateAllPropertiesToClone}),cloneToOriginal:gr.create(e,this,{delegateProperties:t.delegatePropertiesToOriginal,delegateAllProperties:t.delegateAllPropertiesToOriginal,excludeProperties:t.excludePropertiesToOriginal,delegateEvents:t.delegateEventsToOriginal})},this.eventDelegators.push(r),e.one("destroy",()=>{this._unmirror(e)})}unmirror(e){if(e=e||this.cloneOf,!e)throw new Error("No target for unmirroring.");this._unmirror(e)}_unmirror(e){let t=f.findIndex(this.eventDelegators,s=>s.clone===e),r=t>-1?this.eventDelegators.splice(t,1)[0]:null;!r||(r.originalToClone&&r.originalToClone.destroy(),r.cloneToOriginal&&r.cloneToOriginal.destroy())}_onParentDestroy(){this.destroyed||this.setParent(this.owner)}widget(e,t){if(r(this))return this;return this.findChild(r);function r(s){return s.id===e}}nearestWidget(e,t){if(this.id===e)return this;let r=this.children.slice();for(;r.length;){let s=r.shift();if(s.id===e)return s;if(t)for(let o=0;o<s.children.length;o++){let n=s.children[o];n.parent===s&&r.push(n)}}return null}findParent(e){let t=this.parent;for(;t;){if(e(t))return t;t=t.parent}return t}findChild(e){let t=null;return this.visitChildren(r=>{if(e(r))return t=r,!0}),t}setTrackFocus(e){this.setProperty("trackFocus",e)}_renderTrackFocus(){!this.$container||(this.trackFocus?this.$container.on("focusin",this._focusInListener):this.$container.off("focusin",this._focusInListener))}restoreFocus(){this._$lastFocusedElement?this.session.focusManager.requestFocus(this._$lastFocusedElement):this._storedFocusedWidget&&(this._storedFocusedWidget.focus(),this._storedFocusedWidget=null)}_onFocusIn(e){this.rendering||this.$container.has(e.target)&&(this._$lastFocusedElement=Mt(e.target))}focus(e){return this.rendered?this.session.focusManager.requestFocus(this.getFocusableElement(),null,e):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this,e)),!1)}focusAndPreventDefault(e){return this.focus()?(e.preventDefault(),!0):!1}isFocused(){return this.rendered&&Yi.isActiveElement(this.getFocusableElement())}isFocusable(e){if(!this.rendered||!this.visible)return!1;let t=this.getFocusableElement();if(!t)return!1;let r=Mt.ensure(t);return r.is(":focusable")?u.nvl(e,!0)?r.is(":tabbable"):!0:!1}getFocusableElement(){return this.rendered&&this.$container?this.$container[0]:null}_installScrollbars(e){let t=this.get$Scrollable();if(!t)throw new Error("Scrollable is not defined, cannot install scrollbars");if(t.data("scrollable"))return;e=e||{parent:this};let r={parent:this},s=Mt.extend({},r,e);x.install(t,s),t.on("scroll",this._scrollHandler)}_uninstallScrollbars(){let e=this.get$Scrollable();!e||!e.data("scrollable")||(x.uninstall(e,this.session),e.off("scroll",this._scrollHandler),this.removing||(e[0].scrollTop===0&&(this.scrollTop=null),e[0].scrollLeft===0&&(this.scrollLeft=null)))}_onScroll(e){let t=this.get$Scrollable();this._setProperty("scrollTop",t[0].scrollTop),this._setProperty("scrollLeft",t[0].scrollLeft)}setScrollTop(e){if(this.getDelegateScrollable()){this.getDelegateScrollable().setScrollTop(e);return}this.setProperty("scrollTop",e)}_renderScrollTop(){let e=this.get$Scrollable();if(!(!e||this.scrollTop===null)){if(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting){this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollTop.bind(this));return}x.scrollTop(e,this.scrollTop)}}setScrollLeft(e){if(this.getDelegateScrollable()){this.getDelegateScrollable().setScrollLeft(e);return}this.setProperty("scrollLeft",e)}_renderScrollLeft(){let e=this.get$Scrollable();if(!(!e||this.scrollLeft===null)){if(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting){this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollLeft.bind(this));return}x.scrollLeft(e,this.scrollLeft)}}get$Scrollable(){return this.$container}hasScrollShadow(e){return x.hasScrollShadow(this.get$Scrollable(),e)}getDelegateScrollable(){return null}scrollToTop(e){if(this.getDelegateScrollable()){this.getDelegateScrollable().scrollToTop();return}let t=this.get$Scrollable();if(!!t){if(!this.rendered){this.session.layoutValidator.schedulePostValidateFunction(this.scrollToTop.bind(this));return}x.scrollTop(t,0,e)}}scrollToBottom(e){if(this.getDelegateScrollable()){this.getDelegateScrollable().scrollToBottom();return}let t=this.get$Scrollable();if(!!t){if(!this.rendered){this.session.layoutValidator.schedulePostValidateFunction(this.scrollToBottom.bind(this));return}x.scrollToBottom(t,e)}}reveal(e){if(!this.rendered)return;let t=this.$container.scrollParent();t.length!==0&&x.scrollTo(t,this.$container,e)}visitChildren(e){for(let t=0;t<this.children.length;t++){let r=this.children[t];if(r.parent===this){let s=e(r);if(s===!0||s===ye.TERMINATE)return ye.TERMINATE;if(s!==ye.SKIP_SUBTREE&&(s=r.visitChildren(e),s===!0||s===ye.TERMINATE))return ye.TERMINATE}}}isAttachedAndRendered(){return(this.rendered||this.rendering)&&this.$container.isAttached()}static cssClassAsArray(e){let t=[],r=e||"";return r=r.trim(),r.length>0&&(t=r.split(" ")),t}}X(I,"DisabledStyle",{DEFAULT:0,READ_ONLY:1});let hy=0;const ke={get(i){for(i=a().ensure(i);i&&i.length>0;){let e=i.data("widget");if(e)return e;i=i.parent()}return null},createUniqueId(i){return i=i||"sc",i+hy++},updateFirstLastMarker(i){i.filter((e,t,r)=>e.rendered&&e.isVisible()).forEach((e,t,r)=>{e.$container.toggleClass("first",t===0),e.$container.toggleClass("last",t===r.length-1)})},findFirstFocusableWidget(i,e,t){return e&&(!e.rendered||!e.visible)?null:f.find(i,r=>r.isFocusable(t))},preserveAndSetProperty(i,e,t,r){t[r]===null&&(t[r]=e()),i()},resetProperty(i,e,t){e[t]!=null&&(i(e[t]),e[t]=null)}};function uy(i,e,t){return e=cy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cy(i){var e=py(i,"string");return typeof e=="symbol"?e:String(e)}function py(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qf extends I{constructor(){super(),uy(this,"widgets",void 0),this.widgets=[],this._addWidgetProperties(["widgets"])}_render(){this.$container=this.$parent.appendDiv(),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderWidgets()}setWidgets(e){this.setProperty("widgets",e)}_renderWidgets(){this.widgets.forEach(e=>e.render()),this.invalidateLayoutTree()}}function fy(i,e,t){return e=my(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function my(i){var e=gy(i,"string");return typeof e=="symbol"?e:String(e)}function gy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Hl extends I{constructor(){super(),fy(this,"childWidget",void 0),this.childWidget=null,this._addWidgetProperties(["childWidget"])}setChildWidget(e){this.setProperty("childWidget",e)}}class Zf extends He{}const f={ensure(i){return i==null?[]:Array.isArray(i)?i:[i]},init(i,e){let t=[];for(let r=0;r<i;r++)t[r]=e;return t},remove(i,e){if(i){let t=i.indexOf(e);if(t!==-1)return i.splice(t,1),!0}return!1},removeAll(i,e){let t=!1;if(!e||e.length===0)return!1;for(let r=i.length-1;r>=0;r--)e.indexOf(i[r])>-1&&(i.splice(r,1),t=!0);return t},replace(i,e,t){let r=i.indexOf(e);return r!==-1&&(i[r]=t),r},insert(i,e,t){f.insertAll(i,[e],t)},insertAll(i,e,t){let r=f.ensure(e);i.splice(t,0,...r)},insertSorted(i,e,t){let r=0,s=i.length-1;for(;r<=s;){let o=r+Math.floor((s-r)/2),n=t(i[o],e);if(n<0)r=o+1;else if(n>0)s=o-1;else{for(r=o+1;r<i.length&&t(i[r],e)===0;)r++;break}}i.splice(r,0,e)},insertBefore(i,e,t,r){let s=f.findIndex(i,t,r);s===-1?i.unshift(e):f.insert(i,e,s)},insertAfter(i,e,t){let r=f.findIndex(i,t);r===-1?i.push(e):f.insert(i,e,r+1)},move(i,e,t){let r=i.splice(e,1)[0];f.insert(i,r,t)},contains(i,e){return i=f.ensure(i),i.indexOf(e)!==-1},containsAny(i,e){let t=f.ensure(i);return f.ensure(e).some(s=>t.indexOf(s)>=0)},containsAll(i,e){let t=f.ensure(i);return f.ensure(e).every(s=>t.indexOf(s)>=0)},first(i){return Array.isArray(i)?i[0]:i},last(i){return Array.isArray(i)?i[i.length-1]:i},hasElements(i){return!f.empty(i)},empty(i){return Array.isArray(i)?i.length===0:!0},length(i){return Array.isArray(i)?i.length:0},pushAll(i,e){let t=f.ensure(e);i.push(...t)},union(i,e){let t=[],r={};return i=f.ensure(i),e=f.ensure(e),i.forEach(s=>{let o=s;typeof s=="object"&&(o=s.id),r[o]=s,t.push(s)}),e.forEach(s=>{let o=s;typeof s=="object"&&(o=s.id),o in r||t.push(s)}),t},equalsIgnoreOrder(i,e){return i===e||(!i||i.length===0)&&(!e||e.length===0)?!0:!i||!e||i.length!==e.length?!1:f.containsAll(i,e)},equals(i,e){if(i===e||(!i||i.length===0)&&(!e||e.length===0))return!0;if(!i||!e||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0},greater(i,e){let t=0,r=0;return i&&(t=i.length),e&&(r=e.length),t>r},eachSibling(i,e,t){if(!(!i||!t))for(let r=0;r<i.length;r++){let s=i[r];s!==e&&t(s,r)}},findIndex(i,e,t){if(!i||!e)return-1;for(let r=0;r<i.length;r++)if(e.call(t,i[r],r,i))return r;return-1},find(i,e,t){let r=f.findIndex(i,e,t);return r===-1?null:i[r]},findFrom(i,e,t,r){return r?f.findFromReverse(i,e,t):f.findFromForward(i,e,t)},findIndexFrom(i,e,t,r){return r?f.findIndexFromReverse(i,e,t):f.findIndexFromForward(i,e,t)},findFromForward(i,e,t){let r=f.findIndexFromForward(i,e,t);return r===-1?null:i[r]},findIndexFromForward(i,e,t){if(!i||!t||e>=i.length)return-1;e<0&&(e=0);for(let r=e;r<i.length;r++){let s=i[r];if(t(s,r))return r}return-1},findFromReverse(i,e,t){let r=f.findIndexFromReverse(i,e,t);return r===-1?null:i[r]},findIndexFromReverse(i,e,t){if(!i||!t||e<0)return-1;e>=i.length&&(e=i.length-1);for(let r=e;r>=0;r--){let s=i[r];if(t(s,r))return r}return-1},pushIfDefined(i){if(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];f.pushAll(i,t.filter(s=>s!=null))}},pushSet(i,e){e&&i.indexOf(e)===-1&&i.push(e)},format(i,e,t){if(!i||i.length===0)return"";let r="";for(let s=0;s<i.length;s++){let o=i[s];e&&s>0&&s<i.length&&(r+=e),t&&(o=y.encode(o)),r+=o}return r},formatEncoded(i,e){return f.format(i,e,!0)},max(i){if(i==null)return Math.max(i);let e=i.filter(v.isNumber);return Math.max(...e)},min(i){if(i==null)return Math.min(i);let e=i.filter(v.isNumber);return Math.min(...e)},diff(i,e){let t=i.slice();return f.removeAll(t,e),t},flatMap(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r=>r,t=[];return f.ensure(i).forEach(r=>f.pushAll(t,e(r))),t},flattenRec(i,e){return f.ensure(i).reduce((t,r)=>(t.push(r),r&&e&&(t=t.concat(f.flattenRec(e(r),e))),t),[])},$indexOf(i,e){for(let t=0;t<i.length;t++)if(i[t][0]===e[0])return t},$remove(i,e){let t=f.$indexOf(i,e);t>=0&&i.splice(t,1)},randomElement(i){if(!!i){if(!Array.isArray(i))return i;if(!!i.length)return i[Math.floor(Math.random()*i.length)]}},toMap(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r=>r+"",t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r=>r;return v.createMap(f.ensure(i).reduce((r,s)=>(r[e(s)]=t(s),r),{}))},nullIfEmpty(i){return f.empty(i)?null:i},clear(i){return Array.isArray(i)?i.splice(0,i.length):[]}};function Rt(i,e,t){return e=_y(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _y(i){var e=by(i,"string");return typeof e=="symbol"?e:String(e)}function by(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class An{constructor(){Rt(this,"objectType",void 0),Rt(this,"retryIntervals",void 0),Rt(this,"minCallDuration",void 0),Rt(this,"callCounter",void 0),Rt(this,"maxRetries",void 0),Rt(this,"deferred",void 0),Rt(this,"aborted",void 0),Rt(this,"initialized",void 0),Rt(this,"pendingCall",void 0),Rt(this,"callTimeoutId",void 0),Rt(this,"callStartTimestamp",void 0),Rt(this,"type",void 0),Rt(this,"name",void 0),Rt(this,"uniqueName",void 0),Rt(this,"logPrefix",void 0),Rt(this,"result",void 0),this.initialized=!1,this.retryIntervals=[],this.maxRetries=0,this.minCallDuration=500,this.callCounter=0,this.deferred=a().Deferred(),this.aborted=!1,this.pendingCall=null,this.callTimeoutId=null,this.callStartTimestamp=null,this.type=null,this.name=null,this.uniqueName=null,this.logPrefix="",this.result=null}init(e){a().extend(this,e),v.isNullOrUndefined(this.maxRetries)?(this.retryIntervals=this.retryIntervals?this.retryIntervals.slice():[],this.maxRetries=this.retryIntervals.length):this.retryIntervals=f.init(this.maxRetries,0),this.uniqueName=u.nvl(this.type,"call")+"-"+An.GLOBAL_SEQ+++y.box(" ",this.name,""),this.initialized=!0}_checkInitialized(){if(!this.initialized)throw new Error("Not initialized")}_updateLogPrefix(){this.logPrefix=this.callCounter+"/"+(this.maxRetries+1)+" ["+this.uniqueName+"] "}_resolve(){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"[RESOLVE]"),this.deferred.resolve(...f.ensure(this.result))}_reject(){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"[REJECT]"),this.deferred.reject(...f.ensure(this.result))}_setResult(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.result=t}call(){return this._checkInitialized(),this._call(),this.deferred.promise()}abort(){this._checkInitialized(),this._abort()}_call(){if(this.aborted)throw new Error("Call is aborted");this.callTimeoutId=null,this.callStartTimestamp=Date.now(),this.callCounter++,this._updateLogPrefix(),this.pendingCall=this._callImpl().always(()=>{this.pendingCall=null}).done(this._setResultDone.bind(this)).done(this._onCallDone.bind(this)).fail(this._setResultFail.bind(this)).fail(this._onCallFail.bind(this))}_setResultDone(){this._setResult(...arguments)}_setResultFail(){this._setResult(...arguments)}_onCallDone(){this._resolve()}_onCallFail(){if(this.aborted){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"Call aborted"),this._reject();return}let e=this._nextRetryImpl(...arguments);if(typeof e!="number"){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"No retries remaining"),this._reject();return}let t=Date.now()-this.callStartTimestamp,r=Math.max(this.minCallDuration-t,0),s=e+r;a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"Try again in "+s+" ms..."),this.callTimeoutId=setTimeout(this._call.bind(this),s)}_nextRetryImpl(){return this.retryIntervals.length?this.retryIntervals.shift():!1}_abort(){if(this.aborted=!0,this.callTimeoutId){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"Cancelled scheduled retry"),clearTimeout(this.callTimeoutId),this.callTimeoutId=null,this._reject();return}this._abortImpl()}_abortImpl(){}}Rt(An,"GLOBAL_SEQ",0);const sr={copyText(i){u.assertParameter("options",i),i.parent&&!i.session&&(i.session=i.parent.session),u.assertProperty(i,"session");let e=sr._copyText(i);return i.parent&&u.nvl(i.showNotification,!0)?(sr._showNotification(i,e),null):e},_copyText(i){let e=a().Deferred();if(navigator.clipboard)return navigator.clipboard.writeText(i.text).then(function(){return e.resolve(...arguments)}).catch(function(){return e.reject(...arguments)}),e.promise();let t=i.parent&&i.parent.rendered?i.parent.document(!0):document,r=t.createElement("textarea");r.style.position="fixed",r.style.opacity="0.0",r.value=i.text,t.body.appendChild(r);let s=a()(r);i.session.focusManager.installFocusContext(s,It.AUTO),r.select();try{t.execCommand("copy")?e.resolve():e.reject()}catch(o){e.reject(o)}finally{i.session.focusManager.uninstallFocusContext(s),t.body.removeChild(r)}return e.promise()},_showNotification(i,e){let t=sr._successStatus(i.parent.session);e.catch(()=>{t=sr._failedStatus(i.parent.session)}).then(()=>{sr.showNotification(i.parent,t)})},_successStatus(i){return new E({message:i.text("ui.CopyToClipboardSuccessStatus"),severity:E.Severity.INFO})},_failedStatus(i){return new E({message:i.text("ui.CopyToClipboardFailedStatus"),severity:E.Severity.WARNING})},showNotification(i,e){u.assertParameter("parent",i),u.create(ii,{parent:i,closable:!1,duration:1234,status:e||sr._successStatus(i.session)}).show()}},Lt={ColorSchemeId:{DEFAULT:"default",ALTERNATIVE:"alternative",RAINBOW:"rainbow"},ensureColorScheme(i,e){let t={};return i&&typeof i=="object"?t=i:typeof i=="string"&&(y.startsWith(i,Lt.ColorSchemeId.DEFAULT)?t.scheme=Lt.ColorSchemeId.DEFAULT:y.startsWith(i,Lt.ColorSchemeId.ALTERNATIVE)?t.scheme=Lt.ColorSchemeId.ALTERNATIVE:y.startsWith(i,Lt.ColorSchemeId.RAINBOW)?t.scheme=Lt.ColorSchemeId.RAINBOW:t.scheme=y.removeSuffix(i,"-inverted"),t.inverted=y.endsWith(i,"-inverted")),v.isNullOrUndefined(e)||(t.tile=e),t},toggleColorSchemeClasses(i,e){if(!i||!e)return;let t=Lt.ensureColorScheme(e);i.toggleClass("color-alternative",t.scheme===Lt.ColorSchemeId.ALTERNATIVE),i.toggleClass("color-rainbow",t.scheme===Lt.ColorSchemeId.RAINBOW),i.toggleClass("inverted",!!t.inverted),i.toggleClass("tile",!!t.tile)},getCssClasses(i){let e=[];if(!i)return e;let t=Lt.ensureColorScheme(i);return t.scheme===Lt.ColorSchemeId.ALTERNATIVE?e.push("color-alternative"):t.scheme===Lt.ColorSchemeId.RAINBOW?e.push("color-rainbow"):t.scheme&&e.push(t.scheme),t.inverted&&e.push("inverted"),t.tile&&e.push("tile"),e}},T={shift(i,e,t,r){let s=new Date(i.getTime());return e&&(s.setFullYear(i.getFullYear()+e),T.compareMonths(s,i)!==e*12&&s.setDate(0)),t&&(s.setMonth(i.getMonth()+t),T.compareMonths(s,i)!==t+e*12&&s.setDate(0)),r&&s.setDate(i.getDate()+r),s},shiftTime(i,e,t,r,s){let o=new Date(i.getTime());return e&&o.setHours(i.getHours()+e),t&&o.setMinutes(i.getMinutes()+t),r&&o.setSeconds(i.getSeconds()+r),s&&o.setMilliseconds(i.getMilliseconds()+s),o},shiftToNextDayOfType(i,e){let t=e-i.getDay();return t<=0&&(t+=7),T.shift(i,0,0,t)},shiftToNextDayAndDate(i,e,t){let r=new Date(i.getTime());for(t<r.getDate()&&r.setMonth(r.getMonth()+1),r.setDate(t);r.getDay()!==e||r.getDate()!==t;)r=T.shift(r,0,1,0),r.setDate(t);return r},shiftToPreviousDayOfType(i,e){let t=e-i.getDay();return t>=0&&(t-=7),T.shift(i,0,0,t)},shiftToNextOrPrevDayOfType(i,e,t){return t>0?T.shiftToNextDayOfType(i,e):T.shiftToPreviousDayOfType(i,e)},shiftToNextOrPrevMonday(i,e){return T.shiftToNextOrPrevDayOfType(i,1,e)},ensure(i){return v.isNullOrUndefined(i)||i instanceof Date?i:T.parseJsonDate(i)},ensureMonday(i,e){return i.getDay()===1?i:T.shiftToNextOrPrevMonday(i,e)},isSameTime(i,e){return!i||!e?!1:i.getHours()===e.getHours()&&i.getMinutes()===e.getMinutes()&&i.getSeconds()===e.getSeconds()},isSameDay(i,e){return!i||!e?!1:i.getFullYear()===e.getFullYear()&&i.getMonth()===e.getMonth()&&i.getDate()===e.getDate()},isSameMonth(i,e){return!i||!e?!1:T.compareMonths(i,e)===0},compareMonths(i,e){let t=i.getMonth(),r=e.getMonth(),s=i.getFullYear(),o=e.getFullYear(),n=t-r;return s===o?n:(s-o)*12+n},compareDays(i,e){return(T.trunc(i).getTime()-T.trunc(e).getTime()-(i.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/(36e5*24)},orderWeekdays(i,e){let t=[];for(let r=0;r<7;r++)t[r]=i[(r+e)%7];return t},weekInYear(i,e){if(!i)return;let t=1;e instanceof Ft?t=e.symbols.firstDayOfWeek:e instanceof ti?t=e.dateFormatSymbols.firstDayOfWeek:typeof e=="number"&&(t=e);let r=T._thursdayOfWeek(i,t),s=new Date(r.getFullYear(),0,4),o=T.firstDayOfWeek(s,t);i.getTime()<o.getTime()&&(s=new Date(r.getFullYear()-1,0,4));let n=T._thursdayOfWeek(s,t),l=(r.getTime()-n.getTime())/864e5;return 1+Math.round(l/7)},_thursdayOfWeek(i,e){if(!i||typeof e!="number")return;let t=new Date(i.valueOf());return t.getDay()!==4&&(t.getDay()<e&&t.setDate(t.getDate()-7),t.setDate(t.getDate()-t.getDay()+4)),t},firstDayOfWeek(i,e){if(!i||typeof e!="number")return;let t=new Date(i.valueOf());return t.getDay()!==e&&t.setDate(t.getDate()-(t.getDay()+7-e)%7),t},parseJsonDate(i){if(!i)return null;let e=1970,t=1,r=1,s=0,o=0,n=0,l=0,d=!1,h=/^\+?(\d{4,5})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(i);if(h!==null)e=parseInt(h[1],10),t=parseInt(h[2],10),r=parseInt(h[3],10),s=parseInt(h[4],10),o=parseInt(h[5],10),n=parseInt(h[6],10),l=parseInt(h[7],10),d=h[8]==="Z";else if(h=/^\+?(\d{4,5})-(\d{2})-(\d{2})(Z?)$/.exec(i),h!==null)e=parseInt(h[1],10),t=parseInt(h[2],10),r=parseInt(h[3],10),d=h[4]==="Z";else if(h=/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(i),h!==null)s=parseInt(h[1],10),o=parseInt(h[2],10),n=parseInt(h[3],10),l=parseInt(h[4],10),d=h[5]==="Z";else throw new Error("Unparseable date: "+i);let p;return d?(p=new Date(Date.UTC(e,t-1,r,s,o,n,l)),e<100&&p.setUTCFullYear(e)):(p=new Date(e,t-1,r,s,o,n,l),e<100&&p.setFullYear(e)),p},toJsonDate(i,e,t,r){if(!i)return null;t===void 0&&(t=!0),r===void 0&&(r=!0);let s,o,n;e?(s=d(i)+"-"+y.padZeroLeft(i.getUTCMonth()+1,2)+"-"+y.padZeroLeft(i.getUTCDate(),2),o=y.padZeroLeft(i.getUTCHours(),2)+":"+y.padZeroLeft(i.getUTCMinutes(),2)+":"+y.padZeroLeft(i.getUTCSeconds(),2)+"."+y.padZeroLeft(i.getUTCMilliseconds(),3),n="Z"):(s=d(i)+"-"+y.padZeroLeft(i.getMonth()+1,2)+"-"+y.padZeroLeft(i.getDate(),2),o=y.padZeroLeft(i.getHours(),2)+":"+y.padZeroLeft(i.getMinutes(),2)+":"+y.padZeroLeft(i.getSeconds(),2)+"."+y.padZeroLeft(i.getMilliseconds(),3),n="");let l="";return t&&(l+=s,r&&(l+=" ")),r&&(l+=o),l+=n,l;function d(h){let p=h.getFullYear();return p>9999?"+"+p:y.padZeroLeft(p,4)}},toJsonDateRange(i){return{from:T.toJsonDate(i.from),to:T.toJsonDate(i.to)}},create(i){if(i){let e=/^(\d{4,5})(?:-(\d{2})(?:-(\d{2})(?: (\d{2})(?::(\d{2})(?::(\d{2})(?:\.(\d{3}))?(Z?))?)?)?)?)?/.exec(i);if(e===null)throw new Error("Unparsable date: "+i);let t;return e[8]==="Z"?t=new Date(Date.UTC(parseInt(e[1],10),(parseInt(e[2],10)||1)-1,parseInt(e[3],10)||1,parseInt(e[4],10)||0,parseInt(e[5],10)||0,parseInt(e[6],10)||0,parseInt(e[7],10)||0)):t=new Date(parseInt(e[1],10),(parseInt(e[2],10)||1)-1,parseInt(e[3],10)||1,parseInt(e[4],10)||0,parseInt(e[5],10)||0,parseInt(e[6],10)||0,parseInt(e[7],10)||0),t}},newDate(){return new Date},format(i,e,t){return new Ft(e,t).format(i)},formatDateTime(i,e){return new Ft(e,e.dateFormatPatternDefault+" "+e.timeFormatPatternDefault).format(i)},compare(i,e){if(!i&&!e)return 0;if(!i)return-1;if(!e)return 1;let t=i.getTime()-e.getTime();return t<-1?-1:t>1?1:t},equals(i,e){return T.compare(i,e)===0},combineDateTime(i,e){let t=new Date;return t.setHours(0,0,0,0),t.setFullYear(1970,0,1),i&&t.setFullYear(i.getFullYear(),i.getMonth(),i.getDate()),e&&(t.setHours(u.nvl(e.getHours(),0)),t.setMinutes(u.nvl(e.getMinutes(),0)),t.setSeconds(u.nvl(e.getSeconds(),0)),t.setMilliseconds(u.nvl(e.getMilliseconds(),0))),t},isLeapYear(i){return i==null?!1:new Date(i,1,29).getDate()===29},trunc(i,e){return i&&(u.nvl(e,!0)&&(i=new Date(i.getTime())),i.setHours(0,0,0,0)),i},ceil(i,e,t){let r,s,o=u.nvl(e,30);return i&&(u.nvl(t,!0)&&(i=new Date(i.getTime())),i.setSeconds(0,0),s=(i.getMinutes()+o)/o*o,r=i.getHours(),s>=60&&(r++,s=0),r>23&&(r=0,i.setDate(i.getDate()+1)),i.setHours(r,s)),i}},Ve={_defaults:{},_objectTypeHierarchyFlat:{},bootstrap(i){i=i||{};let e={url:"defaultValues"};return i=a().extend({},e,i),a().ajaxJson(i.url).done(Ve.init.bind(this))},init(i){Ve._objectTypeHierarchyFlat={},Ve._defaults=i.defaults||{};let e=i.objectTypeHierarchy||{};Ve._generateObjectTypeHierarchyRec(e,void 0,Ve._objectTypeHierarchyFlat),Object.keys(Ve._defaults).forEach(t=>{Ve._objectTypeHierarchyFlat[t]||(Ve._objectTypeHierarchyFlat[t]=[t])})},_generateObjectTypeHierarchyRec(i,e,t){if(!!i){if(!t)throw new Error("Argument 'targetMap' must not be null");Object.keys(i).forEach(r=>{let s=[r];if(e&&(s=s.concat(e)),typeof i[r]=="object"&&Ve._generateObjectTypeHierarchyRec(i[r],s,t),t[r])throw new Error("Object type '"+r+"' has ambiguous parent object types.");t[r]=s},this)}},applyTo(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)Ve.applyTo(i[t],e);else if(typeof i=="object"&&(e=e||i.objectType,e)){if(typeof e!="string"){let t=(e+"").substring(0,80);throw new Error("objectType has to be a string but is a "+typeof e+" ObjectType: "+t)}Ve._applyToInternal(i,e)}},_applyToInternal(i,e){let t=Ve._objectTypeHierarchyFlat[e];if(t||(e=zr.parse(e).objectType.toString(),t=Ve._objectTypeHierarchyFlat[e]),!!t)for(let r=0;r<t.length;r++){let s=t[r],o=Ve._defaults[s];Ve._extendWithDefaults(i,o)}},_extendWithDefaults(i,e){i===void 0||e===void 0||Object.keys(e).forEach(t=>{let r=t;if(y.startsWith(t,"~")&&(r=t.substring(1)),i[r]===void 0)i[r]=v.valueCopy(e[r]);else if(v.isPlainObject(i[r])&&v.isPlainObject(e[t]))Ve._extendWithDefaults(i[r],e[t]);else if(Array.isArray(i[r])&&v.isPlainObject(e[t])){let s=i[r];for(let o=0;o<s.length;o++)v.isPlainObject(s[o])&&Ve._extendWithDefaults(s[o],e[t])}})}};function em(i){return i&&y.startsWith(i.type,"touch")}const lt={pageX(i){return v.isNullOrUndefined(i.pageX)?i.originalEvent.touches[0].pageX:i.pageX},pageY(i){return v.isNullOrUndefined(i.pageY)?i.originalEvent.touches[0].pageY:i.pageY},touchdown(i,e){return lt.touchOrMouse(i,"touchstart","mousedown",e)},touchmove(i,e){return lt.touchOrMouse(i,"touchmove","mousemove",e)},touchendcancel(i,e){return lt.touchOrMouse(i,"touchend touchcancel","mouseup",e)},touchOrMouse(i,e,t,r){return r=r||"",r&&(r="."+r),i?e+r:t+r},isTouchEvent:em,fixTouchEvent(i){if(em(i)){let e=i.touches||(i.originalEvent?i.originalEvent.touches:null),t=e?e[0]:null;t&&(i.pageX=Math.round(t.pageX),i.pageY=Math.round(t.pageY))}},passiveOptions(){let i=!1;return F.get().supportsPassiveEventListener()&&(i={passive:!0}),i},onScrollStartEndDuringTouch(i,e,t){let r,s=!1,o=!1,n=p=>{s||(e(),s=!0),clearTimeout(r),d()},l=p=>{o=!0,d()};function d(){clearTimeout(r),r=setTimeout(()=>{o&&(h(),t())},50)}function h(){i.off("scroll",n),i.document(!1).off("touchend touchcancel",l)}i.on("scroll",n),i.document(!1).one("touchend touchcancel",l)},propagateEvent(i,e){if(typeof Event!="function")return;let t=new e.constructor(e.type,e);i.dispatchEvent(t)||e.preventDefault()},addPropagationListener(i,e,t,r){t=f.ensure(t),t.forEach(s=>{i.addEventListener(s,o=>{r&&!r(o)||lt.propagateEvent(e,o)})})},onSwipe(i,e,t,r,s){let o=i.window(!1),n=F.get().supportsOnlyTouch();i.on("touchmove",l=>l.preventDefault()),i.on("remove",l=>o.off("."+e)),i.on(lt.touchdown(n),l=>{let d=i.position().left;if(!(!t||!!t({originalEvent:l,originalLeft:d,deltaX:0,newLeft:d,direction:0})))return;let p=!0,m=lt.pageX(l),g=d,b=0;o.on(lt.touchmove(n,e),C=>{let R=lt.pageX(C)-m,k=d+R;if(k!==g&&(b=Math.sign(k-g)),r){let N=r({originalEvent:C,originalLeft:d,deltaX:R,newLeft:k,direction:b});g=typeof N=="number"?N:k}else g=k}),o.on(lt.touchendcancel(n,e),C=>{!p||(p=!1,o.off("."+e),s&&s({originalEvent:C,originalLeft:d,deltaX:g-d,newLeft:g,direction:b}))})})}},Yr={validateMaximumUploadSize(i,e){return i=f.ensure(i),i.length===0||e==null?!0:i.reduce((r,s)=>r+s.size,0)<=e},fileListToArray(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t]);return e}};function Ei(i,e,t){return e=yy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yy(i){var e=vy(i,"string");return typeof e=="symbol"?e:String(e)}function vy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}let zd;class F{constructor(e){Ei(this,"objectType",void 0),Ei(this,"userAgent",void 0),Ei(this,"features",void 0),Ei(this,"system",void 0),Ei(this,"type",void 0),Ei(this,"browser",void 0),Ei(this,"browserVersion",void 0),Ei(this,"systemVersion",void 0),Ei(this,"scrollbarWidth",void 0),this.userAgent=e.userAgent,this.features={},this.system=F.System.UNKNOWN,this.type=F.Type.DESKTOP,this.browser=F.Browser.UNKNOWN,this.browserVersion=0,this.scrollbarWidth=0,this.userAgent&&(this._parseSystem(),this._parseSystemVersion(),this._parseBrowser(),this._parseBrowserVersion())}bootstrap(){let e=[];return this.scrollbarWidth=this._detectScrollbarWidth(),this.type=this._detectType(this.userAgent),this.isIos()&&this._installActiveHandler(),this._needsIPhoneRotationHack()&&this._fixIPhoneRotationBug(),e}_loadScriptDeferred(e,t){return a().injectScript(e).done(t)}_installActiveHandler(){document.addEventListener("touchstart",()=>{},!1)}_needsIPhoneRotationHack(){return a().log.isDebugEnabled()&&a().log.debug("Activating iPhone rotation workaround."),this.isIphone()&&!this.isStandalone()&&a()(document.body).css("overflow")==="hidden"}_fixIPhoneRotationBug(){a().log.isDebugEnabled()&&a().log.debug("Enabling iPhone rotation workaround.");let e=this.orientation(),t=0,r=document.documentElement;window.addEventListener("resize",o=>{let n=F.get().orientation();e!==n&&(e=n,t=0,s())});function s(){setTimeout(()=>{r.scrollTop=0,++t<8&&s()},50)}}orientation(){return window.innerHeight>window.innerWidth?"portrait":"landscape"}hasOnScreenKeyboard(){return this.supportsFeature("_onScreenKeyboard",()=>this.isIos()||this.isAndroid()||this.isWindowsTabletMode())}isScrollWidthIncludingPadding(){return this.isInternetExplorer()||this.isFirefox()||this.isEdge()}isCustomEllipsisTooltipPossible(){return this.browser!==F.Browser.SAFARI}isIos(){return F.System.IOS===this.system}isEdge(){return F.Browser.EDGE===this.browser}cssClassForEdge(){return this.isEdge()?"ms-edge":""}cssClassForIphone(){return this.isIphone()?"iphone":""}isIphone(){return this.userAgent.indexOf("iPhone")>-1}isInternetExplorer(){return F.Browser.INTERNET_EXPLORER===this.browser}isFirefox(){return F.Browser.FIREFOX===this.browser}isChrome(){return F.Browser.CHROME===this.browser}isIosPlatform(){return/iPad|iPhone|iPod/.test(navigator.platform)}isAndroid(){return F.System.ANDROID===this.system}isWindowsTabletMode(){return F.System.WINDOWS===this.system&&this.systemVersion>=10&&this.scrollbarWidth===0}isStandalone(){return!!window.navigator.standalone}isSupportedBrowser(e,t){e=u.nvl(e,this.browser),t=u.nvl(t,this.browserVersion);let r=F.Browser;return e===r.CHROME&&t>=71||e===r.FIREFOX&&t>=69||e===r.SAFARI&&t>=12.1}_detectType(e){return F.System.ANDROID===this.system?e.indexOf("Mobile")>-1?F.Type.MOBILE:F.Type.TABLET:F.System.IOS===this.system?e.indexOf("iPad")>-1?F.Type.TABLET:F.Type.MOBILE:this.isWindowsTabletMode()?F.Type.TABLET:F.Type.DESKTOP}_parseSystem(){let e=this.userAgent;e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1?this.system=F.System.IOS:e.indexOf("Android")>-1?this.system=F.System.ANDROID:e.indexOf("Windows")>-1&&(this.system=F.System.WINDOWS)}_parseSystemVersion(){let e,t=F.System,r=this.userAgent;this.system===t.IOS?(e=/ OS ([0-9]+\.?[0-9]*)/,r=r.replace(/_/g,".")):this.system===t.WINDOWS&&(e=/Windows NT ([0-9]+\.?[0-9]*)/),e&&(this.systemVersion=this._parseVersion(r,e))}_parseBrowser(){let e=this.userAgent;e.indexOf("Firefox")>-1?this.browser=F.Browser.FIREFOX:e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1?this.browser=F.Browser.INTERNET_EXPLORER:e.indexOf("Edge")>-1?this.browser=F.Browser.EDGE:e.indexOf("Chrome")>-1?this.browser=F.Browser.CHROME:e.indexOf("Safari")>-1&&(this.browser=F.Browser.SAFARI)}_parseBrowserVersion(){let e,t=F.Browser,r=this.userAgent;if(this.browser===t.INTERNET_EXPLORER)r.indexOf("MSIE")>-1?e=/MSIE ([0-9]+\.?[0-9]*)/:e=/rv:([0-9]+\.?[0-9]*)/;else if(this.browser===t.EDGE)e=/Edge\/([0-9]+\.?[0-9]*)/;else if(this.browser===t.SAFARI){if(this.isIos()&&r.indexOf("Version/")<0){this.browserVersion=this.systemVersion;return}e=/Version\/([0-9]+\.?[0-9]*)/}else this.browser===t.FIREFOX?e=/Firefox\/([0-9]+\.?[0-9]*)/:this.browser===t.CHROME&&(e=/Chrome\/([0-9]+\.?[0-9]*)/);e&&(this.browserVersion=this._parseVersion(r,e))}_parseVersion(e,t){let r=t.exec(e);if(Array.isArray(r)&&r.length===2)return parseFloat(r[1])}supportsFeature(e,t){return this.features[e]===void 0&&(this.features[e]=t(e)),this.features[e]}supportsOnlyTouch(){return this.supportsFeature("_onlyTouch",this.hasOnScreenKeyboard.bind(this))}supportsTouch(){return this.supportsFeature("_touch",e=>"ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof window.DocumentTouch)}supportsFile(){return!!window.File}supportsFileConstructor(){return typeof File=="function"}supportsCssAnimation(){return this.supportsCssProperty("animation")}supportsHistoryApi(){return!!(window.history&&window.history.pushState)}supportsCssGradient(){let e="linear-gradient(to left, #000 0%, #000 50%, transparent 50%, transparent 100% )";return this.supportsFeature("gradient",this.checkCssValue.bind(this,"backgroundImage",e,t=>(t+"").indexOf("gradient")>0))}supportsInternationalization(){return window.Intl&&typeof window.Intl=="object"}supportsDownloadInSameWindow(){return F.Browser.FIREFOX!==this.browser}supportsWebcam(){return this.supportsFeature("_webcam",e=>{let t=v.optProperty(navigator,"mediaDevices","getUserMedia");return v.isFunction(t)})}supportsMicrotask(){return typeof queueMicrotask=="function"}supportsIntersectionObserver(){return typeof IntersectionObserver=="function"}hasPrettyScrollbars(){return this.supportsFeature("_prettyScrollbars",e=>this.scrollbarWidth===0)}canHideScrollbars(){return this.supportsFeature("_canHideScrollbars",e=>this._detectScrollbarWidth("hybrid-scrollable")===0)}supportsCopyFromDisabledInputFields(){return F.Browser.FIREFOX!==this.browser}loosesFocusIfPseudoElementIsRemoved(){return F.Browser.FIREFOX===this.browser}supportsCssProperty(e){return this.supportsFeature(e,t=>{if(document.body.style[t]!==void 0)return!0;t=t.charAt(0).toUpperCase()+t.slice(1);for(let r=0;r<F.VENDOR_PREFIXES.length;r++)if(document.body.style[F.VENDOR_PREFIXES[r]+t]!==void 0)return!0;return!1})}supportsGeolocation(){return!!navigator.geolocation}requiresSyntheticActiveState(){return this.isFirefox()}supportsPassiveEventListener(){return this.supportsFeature("_passiveEventListener",e=>{let t=!1;try{let r=Object.defineProperty({},"passive",{get:()=>(t=!0,!1)});window.addEventListener("test",r,r),window.removeEventListener("test",r,r)}catch{t=!1}return t})}checkCssValue(e,t,r){if(document.body.style[e]===void 0)return!1;let s=document.createElement("div");if(s.style[e]=t,r(s.style[e]))return!0;e=e.charAt(0).toUpperCase()+e.slice(1);for(let o=0;o<F.VENDOR_PREFIXES.length;o++){let n=F.VENDOR_PREFIXES[o]+e;if(document.body.style[n]!==void 0&&(s.style[n]=t,r(s.style[n])))return!0}return!1}hasTableCellZoomBug(){return this.browser===F.Browser.CHROME}_detectScrollbarWidth(e){let t=a()("body").appendDiv(e).attr("id","MeasureScrollbar").css("width",50).css("height",50).css("overflow-y","scroll"),r=t[0],s=r.offsetWidth-r.clientWidth;return t.remove(),s}toString(){return"scout.Device[system="+this.system+" browser="+this.browser+" browserVersion="+this.browserVersion+" type="+this.type+" scrollbarWidth="+this.scrollbarWidth+" features="+JSON.stringify(this.features)+"]"}static get(){return zd}}Ei(F,"VENDOR_PREFIXES",["Webkit","Moz","O","ms","Khtml"]),Ei(F,"Browser",{UNKNOWN:"Unknown",FIREFOX:"Firefox",CHROME:"Chrome",INTERNET_EXPLORER:"InternetExplorer",EDGE:"Edge",SAFARI:"Safari"}),Ei(F,"System",{UNKNOWN:"Unknown",IOS:"IOS",ANDROID:"ANDROID",WINDOWS:"WINDOWS"}),Ei(F,"Type",{DESKTOP:"DESKTOP",TABLET:"TABLET",MOBILE:"MOBILE"}),ie.addListener("prepare",()=>{zd||(zd=u.create(F,{userAgent:navigator.userAgent}))});function No(i,e,t){return e=wy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wy(i){var e=Ty(i,"string");return typeof e=="symbol"?e:String(e)}function Ty(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vs{constructor(e){No(this,"_lastPosX",void 0),No(this,"_lastPosY",void 0),No(this,"_lastTimestamp",void 0),No(this,"_maxDoubleClickInterval",void 0),No(this,"_maxDoubleClickDistance",void 0),No(this,"_doubleClicked",void 0),e=e||{},this._lastPosX=null,this._lastPosY=null,this._lastTimestamp=null,this._maxDoubleClickInterval=e.maxDoubleClickInterval||500,this._maxDoubleClickDistance=e.maxDoubleClickDistance||10,this._doubleClicked=!1}mousedown(e){if(e&&e.type==="mousedown"){let t=u.nvl(e.pageX,0),r=u.nvl(e.pageY,0),s=Date.now(),o=!1;this._lastTimestamp!==void 0&&s-this._lastTimestamp<=this._maxDoubleClickInterval&&Math.max(Math.abs(t-this._lastPosX),Math.abs(r-this._lastPosY))<=this._maxDoubleClickDistance&&(o=!0),this._lastPosX=t,this._lastPosY=r,this._lastTimestamp=s,this._doubleClicked=o}}doubleClicked(){return this._doubleClicked}}function Ai(i,e,t){return e=Sy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Sy(i){var e=Cy(i,"string");return typeof e=="symbol"?e:String(e)}function Cy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Gd{constructor(e){Ai(this,"additionalDropProperties",void 0),Ai(this,"allowedTypes",void 0),Ai(this,"dropType",void 0),Ai(this,"dropMaximumSize",void 0),Ai(this,"target",void 0),Ai(this,"onDrop",void 0),Ai(this,"validateFiles",void 0),Ai(this,"supportedScoutTypes",void 0),Ai(this,"$element",void 0),Ai(this,"selector",void 0),Ai(this,"_onDragEnterHandler",void 0),Ai(this,"_onDragOverHandler",void 0),Ai(this,"_onDropHandler",void 0),e=e||{},this.additionalDropProperties=null,this.allowedTypes=null,this.dropType=null,this.dropMaximumSize=null,this.target=null,this.onDrop=null,this.validateFiles=null,this.selector=null,this.$element=null,a().extend(this,e),this.supportedScoutTypes=f.ensure(e.supportedScoutTypes),this._onDragEnterHandler=this._onDragEnter.bind(this),this._onDragOverHandler=this._onDragOver.bind(this),this._onDropHandler=this._onDrop.bind(this)}install(e,t){if(this.$element)throw new Error("Already installed.");this.selector=t,this.$element=e,this.$element.on("dragenter",this.selector,this._onDragEnterHandler).on("dragover",this.selector,this._onDragOverHandler).on("drop",this.selector,this._onDropHandler)}uninstall(){this.$element.off("dragenter",this.selector,this._onDragEnterHandler).off("dragover",this.selector,this._onDragOverHandler).off("drop",this.selector,this._onDropHandler),this.$element=null,this.selector=null}_onDragEnter(e){this._onDragEnterOrOver(e)}_onDragOver(e){this._onDragEnterOrOver(e)}_onDragEnterOrOver(e){e.originalEvent.dataTransfer.dropEffect="copy",Ae.verifyDataTransferTypesScoutTypes(e,this.supportedScoutTypes,this.dropType())}_onDrop(e){if(this.supportedScoutTypes.indexOf(Ae.SCOUT_TYPES.FILE_TRANSFER)>=0&&(this.dropType()&Ae.SCOUT_TYPES.FILE_TRANSFER)===Ae.SCOUT_TYPES.FILE_TRANSFER&&Ae.dataTransferTypesContainsScoutTypes(e.originalEvent.dataTransfer,Ae.SCOUT_TYPES.FILE_TRANSFER)){if(!this.onDrop||!(e.originalEvent.dataTransfer.files instanceof FileList))return;let t=Yr.fileListToArray(e.originalEvent.dataTransfer.files);if(f.empty(t))return;try{this.validateFiles(t,this._validateFiles.bind(this))}catch(r){this._validationFailed(r);return}e.stopPropagation(),e.preventDefault(),this.onDrop({originalEvent:e,files:t})}}_validateFiles(e){if(!this.dropMaximumSize)return;let t=this.dropMaximumSize();if(!Yr.validateMaximumUploadSize(e,t))throw{title:this.target.session.text("ui.FileSizeLimitTitle"),message:this.target.session.text("ui.FileSizeLimit",t/1024/1024+"")}}_validationFailed(e){a().log.isDebugEnabled()&&a().log.debug("File validation failed",e);let t="",r="Invalid files";return e&&(t=e.title||t,r=e.message||r),as.createOk(this.target).withSeverity(E.Severity.ERROR).withHeader(t).withBody(r).buildAndOpen()}uploadFiles(e){e&&e.originalEvent&&e.files.length>=1&&this.target.session.uploadFiles(this.target,e.files,this.additionalDropProperties?this.additionalDropProperties(e.originalEvent):void 0,this.dropMaximumSize?this.dropMaximumSize():void 0,this.allowedTypes?this.allowedTypes():void 0)}}const Py={FILE_TRANSFER:1<<0,JAVA_ELEMENT_TRANSFER:1<<1,TEXT_TRANSFER:1<<2,IMAGE_TRANSFER:1<<3},Ae={SCOUT_TYPES:Py,DEFAULT_DROP_MAXIMUM_SIZE:50*1024*1024,scoutTypeToDragTypeMapping(i){i=f.ensure(i);let e=[];return i.indexOf(Ae.SCOUT_TYPES.FILE_TRANSFER)>=0&&e.push("Files"),e},verifyDataTransferTypesScoutTypes(i,e,t){e=f.ensure(e);let r=[];t!==void 0?e.forEach(s=>{(t&s)===s&&f.pushAll(r,Ae.scoutTypeToDragTypeMapping(e))}):r=Ae.scoutTypeToDragTypeMapping(e),Array.isArray(r)&&r.length>0&&Ae.verifyDataTransferTypes(i,r)},verifyDataTransferTypes(i,e){let t=i.originalEvent.dataTransfer;return Ae.dataTransferTypesContains(t,e)?(i.stopPropagation(),i.preventDefault(),!0):!1},dataTransferTypesContainsScoutTypes(i,e){e=f.ensure(e);let t=Ae.scoutTypeToDragTypeMapping(e);return Ae.dataTransferTypesContains(i,t)},dataTransferTypesContains(i,e){if(e=f.ensure(e),i&&i.types){if(Array.isArray(i.types)&&f.containsAny(i.types,e))return!0;if(i.types.contains)return e.some(t=>i.types.contains(t))}return!1},handler(i){return!i||!i.target?null:new Gd(i)},installOrUninstallDragAndDropHandler(i){!i.target||(i=$.extend({},Ae._createDragAndDropHandlerOptions(i.target),i),i.doInstall()?Ae._installDragAndDropHandler(i):Ae.uninstallDragAndDropHandler(i.target))},_installDragAndDropHandler(i){if(i.target.dragAndDropHandler||(i.target.dragAndDropHandler=Ae.handler(i),!i.target.dragAndDropHandler))return;let e=i.container();!e||i.target.dragAndDropHandler.install(e,i.selector)},_createDragAndDropHandlerOptions(i){return{target:i,supportedScoutTypes:Ae.SCOUT_TYPES.FILE_TRANSFER,validateFiles:(e,t)=>t(e),onDrop:e=>{},dropType:()=>Ae.SCOUT_TYPES.FILE_TRANSFER,dropMaximumSize:()=>i.dropMaximumSize,doInstall:()=>i.enabledComputed,container:()=>i.$container,additionalDropProperties:e=>{}}},uninstallDragAndDropHandler(i){!i||!i.dragAndDropHandler||(i.dragAndDropHandler.uninstall(),i.dragAndDropHandler=null)}},vt={_deferred:a().Deferred(),loadingComplete:!0,bootstrap(i){return i=i||vt.autoDetectFonts(),i.length===0?(vt.loadingComplete=!0,a().resolvedPromise()):(vt.loadingComplete=!1,vt.preload({fonts:i,onComplete:(e,t)=>{!e&&t&&t.length&&a().log.warn(`Timeout occurred while pre-loading the following fonts:

- `+t.join(`
- `)+`

Rendering will now continue, but font measurements may be inaccurate. To prevent unnecessary startup delays and layout problems, check the @font-face definitions and the referenced "src" URLs or programmatically add additional font-specific characters to TEST_STRING before calling app.init().`),vt.loadingComplete=!0,vt._deferred.resolve()}}),a().resolvedPromise())},preloader(){return vt._deferred.promise()},TEST_FONTS:"monospace",TEST_STRING:"ABC abc 123 .,_ LlIi1 oO0 !#@  ",TEST_TIMEOUT:12*1e3,preload(i){i=i||{fonts:null};let e=f.ensure(i.fonts);if(!i.onComplete)return;let t=[];if(e.forEach(h=>{if(typeof h=="string"){let b=y.splitMax(h,"|",3).map(C=>C.trim());h={family:b[0],style:b[1],testString:b[2]}}h.family=h.family||"",h.style=h.style||"",h.testString=h.testString||i.testString||vt.TEST_STRING;let p=h.testFonts||i.testFonts||vt.TEST_FONTS,m=a()("body").appendDiv("font-preloader").text(h.testString).css("display","block").css("visibility","hidden").css("position","absolute").css("top",0).css("left",0).css("width","auto").css("height","auto").css("margin",0).css("padding",0).css("white-space","nowrap").css("line-height","normal").css("font-variant","normal").css("font-size","20em").css("font-family",p),g=vt.measureSize(m);if(m.data("original-size",g),m.data("font-family",h.family),m.css("font-family","'"+h.family+"',"+p),h.style){let b=(m.attr("style")||"").trim(),C=(b.substr(-1)===";"?"":";")+(b?" ":"");m.attr("style",b+C+h.style)}vt.measureSize(m)!==g?m.remove():t.push(m)}),t.length===0){d(!0);return}let r=d,s=u.nvl(i.timeout,vt.TEST_TIMEOUT),o,n;s&&s>=0&&(n=setTimeout(()=>{clearTimeout(o),d(!1)},s),r=()=>{clearTimeout(n),d(!0)}),l(50,r);function l(h,p){let m=t.length;for(;m--;){let g=t[m];vt.measureSize(g)!==g.data("original-size")&&(t.splice(m,1),g.remove())}if(t.length===0){p(!0);return}o=setTimeout(()=>{h<1e3&&(h=h*1.2),l(h,p)},h)}function d(h){i.onComplete(h,t.map(p=>p.data("font-family")))}},measureSize(i){let e=w.size(i,{exact:!0});return e.width+"x"+e.height},autoDetectFonts(){let i=[],e=document.styleSheets;for(let t=0;t<e.length;t++){let r=e[t],s;try{s=r.cssRules}catch{a().log.info("Skipped automatic font detection for style sheet "+r.href+' (access blocked by browser). Use the bootstrap argument "fonts" to manually list fonts to pre-load.');continue}for(let o=0;o<r.cssRules.length;o++){let n=r.cssRules[o];if(n.type===window.CSSRule.FONT_FACE_RULE){let l=n.style,d=l.getPropertyValue("font-family"),h=l.getPropertyValue("font-weight"),p=l.getPropertyValue("font-style"),m=l.getPropertyValue("font-variant"),g=l.getPropertyValue("font-stretch");if(d){d=d.replace(/^["']|["']$/g,"");let b=[];h&&h!=="normal"&&b.push("font-weight:"+h),p&&p!=="normal"&&b.push("font-style:"+p),m&&m!=="normal"&&b.push("font-variant:"+m),g&&g!=="normal"&&b.push("font-stretch:"+g);let C={family:d};b.length&&(C.style=b.join(";")),i.push(C)}}}}return i}},ve={TABLE_SORT_ASC:"font:↑",TABLE_SORT_DESC:"font:↓",EXCLAMATION_MARK_BOLD:"font:",EXCLAMATION_MARK_CIRCLE:"font:",INFO:"font:",CALENDAR:"font:",FILE:"font:",CLOCK:"font:",CHECKED_BOLD:"font:",GROUP:"font:",GROUP_PLUS:"font:",ANGLE_DOUBLE_LEFT:"font:",ANGLE_DOUBLE_RIGHT:"font:",ANGLE_LEFT:"font:",ANGLE_RIGHT:"font:",ANGLE_DOWN:"font:",ANGLE_UP:"font:",LONG_ARROW_DOWN:"font:",LONG_ARROW_UP:"font:",LONG_ARROW_DOWN_PLUS:"font:",LONG_ARROW_UP_PLUS:"font:",MINUS:"font:",PLUS:"font:",LIST:"font:",TARGET:"font:",WORLD:"font:",CHART:"font:",GEAR:"font:",STAR:"font:",STAR_MARKED:"font:",STAR_BOLD:"font:",STAR_SOLID:"font:",PERSON_SOLID:"font:",SEARCH:"font:",FOLDER:"font:",SUM:"font:",AVG:"font:",MAX:"font:",MAX_BOLD:"font:",MIN:"font:",MIN_BOLD:"font:",EXPAND_ALL:"font:",COLLAPSE_ALL:"font:",COLLAPSE:"font:",ELLIPSIS_V:"font:",SLIPPERY:"font:",REMOVE:"font:",REMOVE_BOLD:"font:",PENCIL:"font:",PENCIL_UNDERLINE_SOLID:"font:",ROTATE_LEFT:"font:",ROTATE_RIGHT:"font:",HOURGLASS:"font:",DIAGRAM_AREA:"font:",DIAGRAM_BAR:"font:",DIAGRAM_BARS_HORIZONTAL:"font:",DIAGRAM_BARS_VERTICAL:"font:",DIAGRAM_DOUGHNUT:"font:",DIAGRAM_LINE:"font:",DIAGRAM_LINE_ANGULAR:"font:",DIAGRAM_LINE_SMOOTH:"font:",DIAGRAM_PIE:"font:",DIAGRAM_RADAR:"font:",DIAGRAM_SCATTER:"font:",CHEVRON_LEFT_BOLD:"font:",CHEVRON_RIGHT_BOLD:"font:",CHEVRON_UP_BOLD:"font:",CHEVRON_DOWN_BOLD:"font:",ARROW_RIGHT_BOLD:"font:",PLUS_BOLD:"font:",MINUS_BOLD:"font:",SQUARE_BOLD:"font:",CARET_DOWN:"font:",CARET_UP:"font:",CARET_LEFT:"font:",CARET_RIGHT:"font:",ANGLE_LEFT_BOLD:"font:",ANGLE_RIGHT_BOLD:"font:",ANGLE_UP_BOLD:"font:",ANGLE_DOWN_BOLD:"font:",CIRCLE_BOLD:"font:",LONG_ARROW_DOWN_BOLD:"font:",LONG_ARROW_UP_BOLD:"font:",LONG_ARROW_LEFT_BOLD:"font:",LONG_ARROW_RIGHT_BOLD:"font:",ICON_ID_REGEX:/\${iconId:([a-zA-Z0-9_.]*)}/,parseIconId(i){let e=new hi;if(y.startsWith(i,"font:"))if(e.iconType=hi.IconType.FONT_ICON,i=i.substr(5),y.countCodePoints(i)===1)e.font=hi.DEFAULT_FONT,e.iconCharacter=i;else{let t=i.split(" ");e.font=t[0],e.iconCharacter=t[1]}else e.iconType=hi.IconType.BITMAP,e.iconUrl=i;return e},resolveIconId(i){let e,t,r=ve.ICON_ID_REGEX.exec(i);return r&&r.length===2&&(e=r[1],t=e.split("."),t.length===1?i=ve[t]:t.length===2?i=window[t[0]].icons[t[1]]:a().log.warn("Invalid iconId: "+i)),i},resolveIconProperty(i,e){e=e||"iconId";let t=i[e],r=ve.resolveIconId(t);r!==t&&(i[e]=r)}},Vo={applyInfo(i,e){!i||(e=e||i.$container,e&&(e.toggleAttr("data-id",!!i.id,i.id),e.toggleAttr("data-modelclass",!!i.modelClass,i.modelClass),e.toggleAttr("data-classid",!!i.classId,i.classId)))}},bt={localesMap:{},bootstrap(i){return(i?a().ajaxJson(i):a().resolvedPromise([])).then(bt._preInit.bind(this,i))},_preInit(i,e){if(e&&e.error)throw{error:e.error,url:i};bt.init(e)},init(i){i.forEach(e=>{bt.localesMap[e.languageTag]=new ti(e)})},_get(i){return bt.localesMap[i]},has(i,e){return e=u.nvl(e,!1),e?!!bt._get(i):!!bt.get(i)},get(i){let e;return Ce.createOrderedLanguageTags(i).some(r=>(e=bt._get(r),!!e),this),e||null},getNavigatorLanguage(){return navigator.language||navigator.userLanguage},getNavigatorLocale(){let i=bt.getNavigatorLanguage();if(!i)return a().log.warn("Browser returned no language. Using default locale."),new ti;let e=bt.get(i);if(e)return e;a().log.isInfoEnabled()&&a().log.info("Locale for languageTag "+i+" not found. Trying to load best match.");let t=bt.splitLanguageTag(i)[0];return e=bt.findFirstForLanguage(t),e||(a().log.isInfoEnabled()&&a().log.info("Still no matching locale for languageTag "+i+" found. Using default locale."),new ti)},getAll(){return v.values(bt.localesMap)},getAllLanguageTags(){return Object.keys(bt.localesMap)},findFirstForLanguage(i){return u.assertParameter("language",i),f.find(bt.getAll(),e=>e.language===i,this)},splitLanguageTag(i){return i?i.split("-"):[]}};function Nl(i,e,t){return e=xy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xy(i){var e=Fy(i,"string");return typeof e=="symbol"?e:String(e)}function Fy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Nn{constructor(e){Nl(this,"objectType",void 0),Nl(this,"onInputFieldPaste",void 0),Nl(this,"target",void 0),Nl(this,"$textInputField",void 0),e=e||{},u.assertValue(e.target,"target is mandatory"),this.$textInputField=null,this.onInputFieldPaste=this._onInputFieldPaste.bind(this),this.target=null,a().extend(this,e)}install(e){this.uninstall(),!(!e||!e.is("input:text")&&!e.is("textarea"))&&e&&(this.$textInputField=e,this.$textInputField.on("paste",this.onInputFieldPaste))}uninstall(){this.$textInputField&&this.$textInputField.off("paste",this.onInputFieldPaste)}render(){if(!this.$textInputField||v.isNullOrUndefined(this.target.maxLength))return;this.$textInputField.attr("maxlength",this.target.maxLength);let e=this.$textInputField.val();e.length>this.target.maxLength&&this.$textInputField.val(e.slice(0,this.target.maxLength)),this.target.rendering||this.target.parseAndSetValue(this.target._readDisplayText())}_onInputFieldPaste(e){if(!this.$textInputField||v.isNullOrUndefined(this.target.maxLength))return;let r=this.$textInputField.val().length-this._getSelectionSize();this._getClipboardData(e,s=>{!s||r+s.length>this.target.maxLength&&this._showNotification("ui.PastedTextTooLong")})}_getSelectionSize(){let e=u.nvl(this.$textInputField[0].selectionStart,null),t=u.nvl(this.$textInputField[0].selectionEnd,null);return e===null||t===null?0:t-e}_getClipboardData(e,t){let r=e.originalEvent.clipboardData||this.target.$container.window(!0).clipboardData;if(r){if(r.items&&r.items.length){let s=f.find(r.items,o=>o.type==="text/plain");s&&s.getAsString(t);return}r.getData&&t(r.getData("Text"))}}_showNotification(e){u.create(ii,{parent:this.target,severity:E.Severity.WARNING,message:this.target.session.text(e)}).show()}}var je;(function(i){i.TRACE="trace",i.DEBUG="debug",i.INFO="info",i.WARN="warn",i.ERROR="error",i.FATAL="fatal"})(je||(je={}));const pi={_appendersToAdd:[],DEFAULT_LEVEL:je.TRACE,initialized:!1,showStackTraces:!0,bootstrap(i){let e=new Et,t=e.getParameter("logging"),r=e.getParameter("logLevel");i=u.nvl(i,{});let s=!!(i.enabled||t),o=!!(i.showPopup||t),n=y.nvl(i.resourceUrl);return a().log=new Vl,s?log4javascript?(pi.initLog4Javascript(r,o),a().resolvedPromise()):a().injectScript(n+"log4javascript-1.4.9/log4javascript.js").done(pi.initLog4Javascript.bind(this,r,o)):a().resolvedPromise()},initLog4Javascript(i,e){i=u.nvl(i,pi.DEFAULT_LEVEL),log4javascript.setShowStackTraces(pi.showStackTraces);let t=log4javascript.getDefaultLogger();t.setLevel(pi.parseLevel(i)),a().log=t,pi.initialized=!0,e?t.getEffectiveAppenders().forEach(r=>{r.setUseDocumentWrite(!1)}):t.removeAllAppenders(),pi._appendersToAdd.forEach(r=>{pi.addAppender(r.factoryName,r.options)}),pi._appendersToAdd=[]},parseLevel(i){if(!!i)switch(i=i.toLowerCase(),i){case je.TRACE:return log4javascript.Level.TRACE;case je.DEBUG:return log4javascript.Level.DEBUG;case je.INFO:return log4javascript.Level.INFO;case je.WARN:return log4javascript.Level.WARN;case je.ERROR:return log4javascript.Level.ERROR;case je.FATAL:return log4javascript.Level.FATAL}},addAppender(i,e){if(!pi.initialized){pi._appendersToAdd.push({factoryName:i,options:e});return}let t=u.create(i,e);a().log.addAppender(t.create())}};class Vl{trace(){}debug(){}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log(je.INFO,t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log(je.WARN,t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log(je.ERROR,t)}fatal(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log(je.FATAL,t)}isEnabledFor(){return!1}isTraceEnabled(){return!1}isDebugEnabled(){return!1}isInfoEnabled(){return!1}isWarnEnabled(){return!1}isErrorEnabled(){return!1}isFatalEnabled(){return!1}_log(e,t){let r=v.optProperty(window,"console");if(!r)return;let s;je.FATAL===e?s="error":s=e;let o=r[s];if(!!o){t.length>0&&(t[0]=this._formatTime()+" ["+e.toUpperCase()+"] "+t[0]);try{o.apply(r,t)}catch{}}}_formatTime(){let e=new Date;return y.padZeroLeft(e.getHours(),2)+":"+y.padZeroLeft(e.getMinutes(),2)+":"+y.padZeroLeft(e.getSeconds(),2)+"."+y.padZeroLeft(e.getMilliseconds(),3)}}const tm="application/json",im="application/javascript",rm="application/zip",at={TEXT_PLAIN:"text/plain",TEXT_HTML:"text/html",TEXT_CSS:"text/css",TEXT_JAVASCRIPT:"text/javascript",IMAGE_PNG:"image/png",IMAGE_JPG:"image/jpg",IMAGE_JPEG:"image/jpeg",IMAGE_GIF:"image/gif",APPLICATION_JSON:tm,APPLICATION_JAVASCRIPT:im,APPLICATION_ZIP:rm,JSON:tm,JAVASCRIPT:im,ZIP:rm,isTextMimeType(i){return u.isOneOf(i,at.TEXT_PLAIN,at.TEXT_HTML,at.TEXT_CSS,at.TEXT_JAVASCRIPT,at.APPLICATION_JAVASCRIPT,at.APPLICATION_JSON)},isJavaScript(i){return u.isOneOf(i,at.TEXT_JAVASCRIPT,at.APPLICATION_JAVASCRIPT)}};function Ey(i,e){let t=i();return e&&(t.parent=e),t}const cs={modelMap:{},init(i){cs.modelMap=i},get:Ey,getExtension(i){return cs._get(i,"extension")},_get(i,e){let t=cs.modelMap[i];if(!t)throw new Error("No model map entry found for id '"+i+"'");if(u.nvl(t.type,"model")!==e)throw new Error("Model '"+i+"' is not of type '"+e+"'");return a().extend(!0,{},t)},extend(i,e){let t;return typeof i=="string"?t=cs.getExtension(i):typeof i=="function"?t=i():t=i,u.assertParameter("extensions",t.extensions),t.extensions.forEach(r=>{let s=u.assertParameter("operation",r.operation),o=u.assertParameter("target",r.target),n;if(o.root?n=e:n=v.findChildObjectByKey(e,"id",o.id),!n)throw new Error("Extension target not found: [extension: "+t.id+", target: "+o.id+"]");if(s==="appendTo")a().extend(n,r.extension);else if(s==="insert"){let l=o;n[l.property]=n[l.property]||[];let d=n[l.property],h=f.ensure(r.extension);cs._bindExtensionsToBeforeOrAfter(l,h);let p=cs._findExtensionIndex(l,d);f.insertAll(d,h,p)}}),e},_findExtensionIndex(i,e){let t=e.length;return i.before?(t=f.findIndex(e,r=>r.id===i.before||r.groupedWith===i.before),t===-1&&(t=e.length)):i.after&&(t=f.findIndex(e,r=>r.id===i.after||r.groupedWith===i.after),t===-1?t=e.length:t++),Ge.isNumber(i.index)&&(t=i.index),t},_bindExtensionsToBeforeOrAfter(i,e){let t=i.before||i.after;t&&i.groupWithTarget&&e.forEach(r=>{r.groupedWith=t})}},Ge={toBase62(i){if(i===void 0)return;let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=62,r="",s;for(;i>=1;)s=Math.floor(i/t),r=e[i-t*s]+r,i=s;return r},randomId(i){i=i||8;let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let r=0;r<i;r++)t+=e[Math.floor(Math.random()*e.length)];return t},_correlationCounter:1,correlationId(i){i=i||11;let e="abcdefghjkmnpqrstuvwxyzABCDEFGHJKMNPQRSTUVWXYZ",t="23456789",r="";for(let s=0;s<i;s++)(s+1)%3===0?r+=t[Math.floor(Math.random()*t.length)]:r+=e[Math.floor(Math.random()*e.length)];return r+"/"+Ge._correlationCounter++},round(i,e,t){if(i==null)return i;switch(t=t||0,i=Ge.shiftDecimalPoint(i,t),e){case or.UP:i<0?i=-Math.ceil(Math.abs(i)):i=Math.ceil(i);break;case or.DOWN:i<0?i=-Math.floor(Math.abs(i)):i=Math.floor(i);break;case or.CEILING:i=Math.ceil(i);break;case or.FLOOR:i=Math.floor(i);break;case or.HALF_DOWN:i<0?i=Math.round(i):i=-Math.round(-i);break;default:i<0?i=-Math.round(Math.abs(i)):i=Math.round(i)}return Ge.shiftDecimalPoint(i,-t)},shiftDecimalPoint(i,e){if(i==null||!e)return i;let t=i?i<0?-1:1:0,r=Math.abs(e);i=Math.abs(i);let s=y.asString(i);s.indexOf("e")!==-1&&(s=i.toFixed(20));let o;return e<0?(s=y.repeat("0",r)+s,o=s.split(".",2),o.length===1?s=s.substr(0,s.length-r)+"."+s.substr(s.length-r):s=o[0].substr(0,o[0].length-r)+"."+o[0].substr(o[0].length-r)+o[1]):e>0&&(s+=y.repeat("0",r),o=s.split(".",2),o.length===2&&(s=o[0]+o[1].substr(0,r)+"."+o[1].substr(r))),s=s.replace(/^0*(\d)/g,"$1"),Number(s)*t},ensure(i){return v.isNullOrUndefined(i)?i:Number(i)},isNumber(i){return typeof i=="number"&&!isNaN(i)},isInteger(i){return Ge.isNumber(i)&&isFinite(i)&&Math.floor(i)===i},_setCorrelationCounter(i){Ge._correlationCounter=i}};var or;(function(i){i.UP="UP",i.DOWN="DOWN",i.CEILING="CEILING",i.FLOOR="FLOOR",i.HALF_UP="HALF_UP",i.HALF_DOWN="HALF_DOWN",i.HALF_EVEN="HALF_EVEN",i.UNNECESSARY="UNNECESSARY"})(or||(or={}));const Ay=/\${const:([^}]*)}/,v={createMap(i){let e=Object.create(null);return i&&a().extend(e,i),e},copyProperties(i,e,t){let r;t=f.ensure(t);for(r in i)(t.length===0||t.indexOf(r)!==-1)&&(e[r]=i[r]);return e},copyOwnProperties(i,e,t){let r;t=f.ensure(t);for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t.length===0||t.indexOf(r)!==-1)&&(e[r]=i[r]);return e},countOwnProperties(i){if(!Object.getPrototypeOf(i))return Object.keys(i).length;let e=0;for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e},extractProperties(i,e,t){return t.forEach(r=>{e[r]===void 0&&(e[r]=i[r])}),e},someOwnProperties(i,e){return f.ensure(e).some(r=>Object.prototype.hasOwnProperty.call(i,r))},someProperties(i,e){return f.ensure(e).some(r=>r in i)},valueCopy(i){if(i==null||typeof i!="object")return i;let e;if(Array.isArray(i)){e=[];for(let t=0;t<i.length;t++)e[t]=v.valueCopy(i[t]);return e}e={};for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=v.valueCopy(i[t]));return e},findChildObjectByKey(i,e,t){if(i==null||typeof i!="object")return null;if(i[e]===t)return i;let r;if(Array.isArray(i)){for(let s=0;s<i.length;s++)if(r=v.findChildObjectByKey(i[s],e,t),r)return r}for(let s in i)if(Object.prototype.hasOwnProperty.call(i,s)&&(r=v.findChildObjectByKey(i[s],e,t),r))return r;return null},getByPath(i,e){u.assertParameter("object",i,Object),u.assertParameter("path",e);const t="(\\w+)(?:\\[((?:\\w|\\.|-)+)\\])?";if(!new RegExp("^"+t+"(?:\\."+t+")*$").test(e))throw new Error('Malformed path expression "'+e+'"');const s=new RegExp(t);let o="",n=i;return e.split(/\.(?![^[]*])/).forEach(l=>{if(v.isNullOrUndefined(n))throw new Error('Value selected by matched path "'+o+'" is null or undefined. Further traversal not possible.');let d=s.exec(l),h=d[1],p=d[2],m=o.length===0?"root level of the provided object.":'matched path "'+o+'".';if(!n.hasOwnProperty(h))throw new Error('Property "'+h+'" does not exist at the '+m);let g=n[h];if(p){if(!Array.isArray(g))throw new Error('Path element "'+l+'" contains array filter but property "'+h+'" does not contain an array at the '+m);let b=g.filter(C=>C.id===p);if(b.length===0)throw new Error('No object found with id property "'+p+'" in array property "'+h+'" at the '+m);if(b.length>1)throw new Error('More than one object found with id property "'+p+'" in array property "'+h+'" at the '+m);n=b[0]}else n=g;o&&(o+="."),o+=l}),n},isPlainObject(i){return typeof i=="object"&&!v.isNullOrUndefined(i)&&!Array.isArray(i)},optProperty(i){if(!i)return null;for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];let s=t.length;if(s===0)return i;if(s===1)return i[t[0]];for(let o=0;o<s-1;o++)if(i=i[t[o]],!i)return null;return i[t[s-1]]},isNumber(i){return i!==null&&!isNaN(i)&&isFinite(i)&&!isNaN(parseFloat(i))},isString(i){return typeof i=="string"||i instanceof String},isNullOrUndefined(i){return i==null},isFunction(i){return a().isFunction(i)},isNullOrUndefinedOrEmpty(i){return v.isNullOrUndefined(i)?!0:v.isArray(i)?f.empty(i):v.isEmpty(i)},isArray(i){return Array.isArray(i)},isPromise(i){return!!i&&typeof i=="object"&&typeof i.then=="function"},values(i,e){let t=[];if(i){typeof i.hasOwnProperty!="function"&&(e=!0);for(let r in i)(e||i.hasOwnProperty(r))&&t.push(i[r])}return t},keyByValue(i,e){return Object.keys(i)[v.values(i).indexOf(e)]},equals(i,e){return i===e?!0:i&&e&&i.equals&&e.equals?i.equals(e):!1},equalsRecursive(i,e){let t;if(v.isPlainObject(i)&&v.isPlainObject(e)){if(v.isFunction(i.equals)&&v.isFunction(e.equals))return i.equals(e);let r=Object.keys(i),s=Object.keys(e);if(!f.equalsIgnoreOrder(r,s))return!1;for(t=0;t<r.length;t++)if(!v.equalsRecursive(i[r[t]],e[r[t]]))return!1;return!0}else if(v.isArray(i)&&v.isArray(e)){if(i.length!==e.length)return!1;for(t=0;t<i.length;t++)if(!v.equalsRecursive(i[t],e[t]))return!1;return!0}return i===e},propertiesEquals(i,e,t){let r,s;for(r=0;r<t.length;r++)if(s=t[r],!v.equals(i[s],e[s]))return!1;return!0},mandatoryFunction(i,e){let t=i[e];if(!t||typeof t!="function")throw new Error("Function '"+e+"' does not exist on object. Check if it has been renamed or moved. Object: "+i);return t},replacePrototypeFunction(i,e,t,r){let s=i.prototype;v.mandatoryFunction(s,e),r&&(s[e+"Orig"]=s[e]),s[e]=t},argumentsToArray(i){return i?Array.prototype.slice.call(i):[]},forEachArgument(i,e){return v.argumentsToArray(i).forEach(e)},checkFunctionOverrides(){let i=["ModelAdapter.init","ModelAdapter._init","Calendar.init"],e=["Legend:","[!] Function includes super call, and parent function uses arguments"," ~  Function includes super call, but parent function does not use arguments","    Function does not include super call","","Wrong number of arguments:"],t=["Different argument names:"];for(let o in u){if(!u.hasOwnProperty(o))continue;let n=u[o];if(typeof n=="function"&&n.parent)for(let l in n.prototype){if(!n.prototype.hasOwnProperty(l))continue;let d=n.prototype[l];if(l==="constructor"||!n.prototype.hasOwnProperty(l)||typeof d!="function")continue;let h=r(d),p=n.parent;for(;p;){let m=p.prototype[l];if(p.prototype.hasOwnProperty(l)&&typeof m=="function"){let g=r(m),b=!1;for(let P=0;P<g.length;P++)if(h.length<P||h[P]!==g[P]){b=!0;break}let C=o+"."+l;if(b&&i.indexOf(C)===-1){let P=C+"("+h.join(", ")+") does not correctly override "+s(m)+"."+l+"("+g.join(", ")+")",R=d.toString().match(new RegExp("scout."+y.quote(o)+".parent.prototype."+y.quote(l)+".call\\("))!==null,k=!1;if(R)for(let N=0;N<g.length;N++){let be=m.toString().match(new RegExp("[^.\\w]"+y.quote(g[N])+"[^\\w]","g"));if(be!==null&&be.length>1){k=!0;break}}P=(R?k?"[!]":" ~ ":"   ")+" "+P,h.length!==g.length?e.push(P):t.push(P)}}p=p.parent}}}return e.push(""),e.concat(t);function r(o){let n=/\/\*.*?\*\/|\/\/.*$/mg,l=/^function[^(]*\((.*?)\)/m;if(typeof o!="function")throw new Error("Argument is not a function: "+o);let d=o.toString().replace(n,"").match(l),h=[];return d!==null&&d[1].split(",").forEach((p,m)=>{p=p.trim(),p.length>0&&h.push(p)}),h}function s(o){for(let n in u){if(!u.hasOwnProperty(n))continue;let l=u[n];if(typeof l=="function")for(let d in l.prototype){if(!l.prototype.hasOwnProperty(d))continue;let h=l.prototype[d];if(!(d==="constructor"||!l.prototype.hasOwnProperty(d)||typeof h!="function")&&h===o)return n}}return""}},resolveConst(i,e){if(!v.isString(i))return i;let t=Ay.exec(i);if(t&&t.length===2){let r=t[1].split("."),s=e||window;for(let o=0;o<r.length;o++)if(s=s[r[o]],s===void 0)return window.console.log("Failed to resolve constant '"+t[1]+"', object is undefined"),i;return s}return i},resolveConstProperty(i,e){u.assertProperty(e,"property"),u.assertProperty(e,"constType");let t=i[e.property],r=v.resolveConst(t,e.constType);t!==r&&(i[e.property]=r)},removeEmptyProperties(i){if(v.isNullOrUndefined(i))return i;if(!v.isPlainObject(i))throw new Error("Not an object: "+i);return Object.keys(i).forEach(e=>{v.isNullOrUndefinedOrEmpty(i[e])&&delete i[e]}),i},isEmpty(i){if(v.isNullOrUndefined(i))return!0;if(!!v.isPlainObject(i))return Object.keys(i).length===0},ensureValidKey(i){return i===void 0?"undefined":v.isString(i)?i:JSON.stringify(i)}};function Vn(i,e,t){return e=Dy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Dy(i){var e=My(i,"string");return typeof e=="symbol"?e:String(e)}function My(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sm{constructor(e){Vn(this,"results",void 0),Vn(this,"error",void 0),Vn(this,"items",void 0),Vn(this,"currentItem",void 0),Vn(this,"aborted",void 0),this.results=[],this.error=null,this.items=e,this.currentItem=0,this.aborted=!1}hasNext(){return this.error||this.aborted?!1:this.currentItem<this.items.length}next(){var e=this;let t=this.currentItem;return this.createPromise().done(function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];e._addResults.apply(e,[t,s])}).fail(function(){this.error=arguments.length>0?arguments:new Error("Promise execution failed")}.bind(this))}createPromise(){if(this.currentItem>=this.items.length)throw new Error("items out of bounds");let e=this._createPromise();return this.currentItem++,e}_createPromise(){return this.items[this.currentItem]()}_addResults(e,t){t.length===0?t=void 0:t.length===1&&(t=t[0]),this.results[e]=t}abort(){this.aborted=!0}}const om={oneByOne(i){let e=a().Deferred();return s(i),e.promise();function t(){setTimeout(s.bind(this,i))}function r(){e.reject.apply(e,i.error)}function s(o){o.hasNext()?o.next().done(t).fail(r):e.resolve.apply(e,o.results)}},groupwise(i,e){let t=a().Deferred();return o(e),t.promise();function r(){setTimeout(o.bind(this,e))}function s(){t.reject.apply(t,e.error)}function o(n){if(n.hasNext()){let l=[];for(;l.length<i&&n.hasNext();)l.push(n.next());a().promiseAll(l,!0).done(r).fail(s)}else t.resolve.apply(t,n.results)}},parallel(i,e,t){t=t||0;let r=a().Deferred(),s=0;return l(e),r.promise();function o(){s--,setTimeout(l.bind(this,e),t)}function n(){r.reject.apply(r,e.error)}function l(d){if(r.state()==="pending"){for(;d.hasNext()&&s<i;)s++,d.next().done(o).fail(n);s===0&&r.resolve.apply(r,[d.results])}}}};function nm(i,e,t){return e=$y(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $y(i){var e=Ry(i,"string");return typeof e=="symbol"?e:String(e)}function Ry(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class O{constructor(e,t){nm(this,"from",void 0),nm(this,"to",void 0),this.from=e,this.to=t}equals(e){return this.from===e.from&&this.to===e.to}subtract(e){if(e.size()===0)return[new O(this.from,this.to)];if(this.from>=e.from&&this.to<=e.to)return[new O(0,0)];if(e.from>=this.from&&e.to<=this.to){let t=new O(this.from,e.from),r=new O(e.to,this.to);return t.size()===0?[r]:r.size()===0?[t]:[t,r]}return e.from>this.from&&e.from<this.to?[new O(this.from,e.from)]:this.from>e.from&&this.from<e.to?[new O(e.to,this.to)]:[new O(this.from,this.to)]}subtractAll(e){let t=e.shift(),r=[this],s=[];for(;t;)r.forEach(o.bind(t)),r=s,s=[],t=e.shift();r=r.filter(n=>n.size()>0),r.length===0&&r.push(new O(0,0));function o(n){f.pushAll(s,n.subtract(t))}return r}shrink(e){return e.size()===0?new O(this.from,this.to):this.from>=e.from&&this.to<=e.to?new O(0,0):e.from>=this.from&&e.to<=this.to?new O(this.from,e.to):e.from>=this.from&&e.from<this.to?new O(this.from,e.from):this.from>e.from&&this.from<e.to?new O(e.to,this.to):e.to<this.from?new O(this.from-e.size()-1,this.to-e.size()-1):new O(this.from,this.to)}union(e){if(this.to<e.from||e.to<this.from){let t=new O(this.from,this.to),r=new O(e.from,e.to);return t.size()===0?[r]:r.size()===0?[t]:[t,r]}return[new O(Math.min(this.from,e.from),Math.max(this.to,e.to))]}add(e){if(this.to<e.from||e.to<this.from){let t=new O(this.from,this.to),r=new O(e.from,e.to);if(t.size()===0)return r;if(r.size()===0)return t;throw new Error("Range to add has to border on the existing range. "+this+", "+e)}return new O(Math.min(this.from,e.from),Math.max(this.to,e.to))}intersect(e){return this.to<=e.from||e.to<=this.from?new O(0,0):new O(Math.max(this.from,e.from),Math.min(this.to,e.to))}size(){return this.to-this.from}contains(e){return this.from<=e&&e<this.to}toString(){return"scout.Range[from="+(this.from===null?"null":this.from)+" to="+(this.to===null?"null":this.to)+"]"}}function Sr(i,e,t){return e=Ly(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ly(i){var e=Iy(i,"string");return typeof e=="symbol"?e:String(e)}function Iy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class E{constructor(e){if(Sr(this,"objectType",void 0),Sr(this,"message",void 0),Sr(this,"severity",void 0),Sr(this,"iconId",void 0),Sr(this,"code",void 0),Sr(this,"children",void 0),Sr(this,"deletable",void 0),Sr(this,"uiState",void 0),this.message=null,this.severity=E.Severity.ERROR,this.iconId=null,this.code=0,this.children=null,this.deletable=!0,a().extend(this,e),typeof this.severity=="string"){let t=this.severity;this.severity=E.Severity[t.toUpperCase()]}e&&e.children&&Array.isArray(e.children)&&(this.children=e.children.map(t=>E.ensure(t)))}cssClass(){return E.cssClassForSeverity(this.severity)}isValid(){return this.severity===E.Severity.OK||this.severity===E.Severity.INFO}isError(){return this.severity===E.Severity.ERROR}isWarning(){return this.severity===E.Severity.WARNING}isInfo(){return this.severity===E.Severity.INFO}isOk(){return this.severity===E.Severity.OK}asFlatList(){return E.asFlatList(this)}clone(){let e=a().extend({},this);return new E(e)}equals(e){return!(e instanceof E)||!v.equalsRecursive(this.children,e.children)?!1:v.propertiesEquals(this,e,["severity","message","invalidDate","invalidTime"])}containsStatus(e){return this.containsStatusByPredicate(t=>t instanceof e)}containsStatusByPredicate(e){return this.asFlatList().some(e)}addStatus(e){this.hasChildren()?this.children.push(e):this.children=[e],this._updateProperties()}removeAllStatus(e){this.removeAllStatusByPredicate(t=>t instanceof e)}removeAllStatusByPredicate(e){this.hasChildren()&&(this.children.forEach(t=>{t.removeAllStatusByPredicate(e)}),this.children=this.children.filter(t=>t.deletable?!e(t):!0),this._updateProperties())}_updateProperties(){if(!this.hasChildren()){this.message=null,this.severity=E.Severity.OK,this.code=0;return}let e=this.asFlatList().sort((t,r)=>{return s(r)-s(t);function s(o){let n=1;return o instanceof vi?n=4:o instanceof Wn&&(n=2),n*o.severity}})[0];this.message=e.message,this.severity=e.severity,this.code=e.code}hasChildren(){return!!(this.children&&this.children.length>0)}ensureChildren(){if(v.isArray(this.children))return this.clone();let e=this,t=this.clone();return t.children=[e],t._updateProperties(),t}static clone(e){return e?e.clone():null}static cssClassForSeverity(e){let t,r=E.Severity;switch(e){case r.OK:t="ok";break;case r.INFO:t="info";break;case r.WARNING:t="warning";break;case r.ERROR:t="error";break}return t}static animateStatusMessage(e,t){if(y.endsWith(t,"...")){let r=e.makeSpan("ellipsis");for(let s=0;s<3;s++)r.append(e.makeSpan("animate-dot delay-"+s,"."));t=t.substring(0,t.length-3),e.empty().text(t).append(r)}else e.text(t)}static ok(e){return new E(E.ensureModel(e,E.Severity.OK))}static info(e){return new E(E.ensureModel(e,E.Severity.INFO))}static warning(e){return new E(E.ensureModel(e,E.Severity.WARNING))}static error(e){return new E(E.ensureModel(e,E.Severity.ERROR))}static ensureModel(e,t){return typeof e=="string"?e={message:e}:e=e||{},a().extend({},e,{severity:t})}static asFlatList(e){if(!e)return[];let t=[];return e.hasChildren()?(e.children.forEach(r=>{f.pushAll(t,E.asFlatList(r))}),t.sort((r,s)=>r instanceof Kr?s instanceof Kr?0:-1:s instanceof Kr?1:0)):t.push(e),t}static classForName(e){return{Status:E,DefaultStatus:Lo,NotificationBadgeStatus:Kr,ParsingFailedStatus:vi,ValidationFailedStatus:Wn}[e]}static ensure(e){return!e||e instanceof E?e:(e.objectType||(e.objectType=E),u.create(e))}}Sr(E,"Severity",{OK:1,INFO:256,WARNING:65536,ERROR:16777216}),Sr(E,"SEVERITY_CSS_CLASSES","error warning info ok");class Lo extends E{constructor(e){super(e)}static error(e){return new Lo(E.ensureModel(e,E.Severity.ERROR))}static warning(e){return new Lo(E.ensureModel(e,E.Severity.WARNING))}static info(e){return new Lo(E.ensureModel(e,E.Severity.INFO))}}class Kr extends E{constructor(e){super(a().extend(!0,{severity:E.Severity.INFO},e))}cssClass(){return y.join(" ",E.cssClassForSeverity(this.severity),"notification-badge")}clone(){let e=a().extend({},this);return new Kr(e)}equals(e){return e instanceof Kr?super.equals(e):!1}}class vi extends E{constructor(e){super(e)}static error(e){return new vi(E.ensureModel(e,E.Severity.ERROR))}}class Wn extends E{constructor(e){super(e)}}function lm(i,e,t){return e=ky(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ky(i){var e=By(i,"string");return typeof e=="symbol"?e:String(e)}function By(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wl{constructor(e){lm(this,"tagName",void 0),lm(this,"cachedElement",void 0),this.tagName=e,this.cachedElement=null}get(){return this.cachedElement||(this.cachedElement=document.createElement(this.tagName)),this.cachedElement}}function Oy(i,e,t){return e=Hy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Hy(i){var e=Ny(i,"string");return typeof e=="symbol"?e:String(e)}function Ny(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ud{constructor(){Oy(this,"cache",void 0),this.cache=new Wl("textarea")}encode(e,t){if(t=t||{},!e)return e;e=y.asString(e),e=e.replace(/<br>|<br\/>|<\/p>|<p\/>|<\/div>|<\/li>|<\/tr>/gi,`
`),e=e.replace(/<\/td>/gi," "),t.removeFontIcons&&(e=e.replace(/<span\s+class="[^"]*font-icon[^"]*">[^<]*<\/span>/gmi,"")),e=e.replace(/<[^>]+>/gi,""),e=e.replace(/^[ ]+/gm,""),e=e.replace(/[ ]+$/gm,""),t.compact&&(e=e.replace(/\n{3,}/gm,`

`)),t.trim&&(e=e.trim());let r=this.cache.get();return r.innerHTML=e,r.value}}function Vy(i,e,t){return e=Wy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Wy(i){var e=Ky(i,"string");return typeof e=="symbol"?e:String(e)}function Ky(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qd{constructor(){Vy(this,"cache",void 0),this.cache=new Wl("div")}encode(e){if(!e)return e;let t=this.cache.get();return t.textContent=e,t.innerHTML}}let Yd=null,jd=null,zy=/\n/g,Gy=/\r/g,Uy=/^\s*$/;const y={nl2br(i,e){return i&&(i=y.asString(i),e=u.nvl(e,!0),e&&(i=y.encode(i)),i.replace(zy,"<br>").replace(Gy,""))},insertAt(i,e,t){return i&&(i=y.asString(i),e=y.asString(e),e&&(typeof t=="number"||t instanceof Number)&&t>=0?i.substr(0,t)+e+i.substr(t):i)},hasText(i){return i==null||(i=y.asString(i),typeof i!="string"||i.length===0)?!1:!Uy.test(i)},empty(i){return!y.hasText(i)},repeat(i,e){if(i==null)return i;if(typeof e!="number"||e<1)return"";let t="";for(let r=0;r<e;r++)t+=i;return t},padZeroLeft(i,e){let t=y.asString(i);return t==null||typeof e!="number"||e<1||t.length>=e?t:(y.repeat("0",e)+t).slice(-e)},contains(i,e){return i?i.indexOf(e)>-1:!1},startsWith(i,e){return i==null||e===void 0||e===null?!1:(i=y.asString(i),e=y.asString(e),e.length===0?!0:i.length===0?!1:i.substr(0,e.length)===e)},endsWith(i,e){return i==null||e===void 0||e===null?!1:(i=y.asString(i),e=y.asString(e),e.length===0?!0:i.length===0?!1:i.substr(-e.length)===e)},count(i,e){return!i||e===void 0||e===null?0:(i=y.asString(i),e=y.asString(e),i.split(e).length-1)},encode(i){return Yd||(Yd=new qd),Yd.encode(i)},plainText(i,e){return jd||(jd=new Ud),jd.encode(i,e)},join(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];let s=t;t[0]&&v.isArray(t[0])&&(s=t[0]),i=y.asString(i);let o="";for(let n=0;n<s.length;n++){let l=y.asString(s[n]);l&&(o&&i&&(o+=i),o+=l)}return o},box(i,e,t){i=y.asString(i),e=y.asString(e),t=y.asString(t);let r="";return y.hasText(e)&&(i&&(r+=i),r+=e,t&&(r+=t)),r},quote(i){return i==null?i:(i=y.asString(i),i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))},asString(i){return i==null||typeof i=="string"||i instanceof String?i:String(i)},nvl(i){if(arguments.length>1)throw new Error("strings.nvl only accepts one argument. Use scout.nvl if you need to handle multiple arguments");return u.nvl(i,"")},length(i){return i=y.asString(i),i?i.length:0},trim(i){return i=y.asString(i),i&&i.trim()},toUpperCase(i){return i=y.asString(i),i&&i.toUpperCase()},toLowerCase(i){return i=y.asString(i),i&&i.toLowerCase()},toUpperCaseFirstLetter(i){return i=y.asString(i),i&&i.substring(0,1).toUpperCase()+i.substring(1)},toLowerCaseFirstLetter(i){return i=y.asString(i),i&&i.substring(0,1).toLowerCase()+i.substring(1)},countCodePoints(i){return i.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},splitMax(i,e,t){if(i==null)return[];i=y.asString(i),e=y.asString(e),t=Number(t);let r=i.split(e);if(isNaN(t)||t<=0||t>=r.length)return r;let s=r.slice(0,t-1),o=r.slice(t-1).join(e);return s.push(o),s},nullIfEmpty(i){return y.empty(i)?null:i},equals(i,e,t){return i=y.nullIfEmpty(i),e=y.nullIfEmpty(e),!i&&!e?!0:!i||!e?!1:t?i.toLowerCase()===e.toLowerCase():i===e},equalsIgnoreCase(i,e){return y.equals(i,e,!0)},removePrefix(i,e){let t=i;return y.startsWith(i,e)&&(t=i.substring(e.length)),t},removeSuffix(i,e){let t=i;return y.endsWith(i,e)&&(t=i.substring(0,i.length-e.length)),t},truncateText(i,e,t){if(i&&e&&t&&e>0&&t(i).width>e){if(i=i.trim(),t(i).width<=e)return i;let r=i.length,s=0;for(;s+1<r;){let o=Math.round((r+s)/2);t(i.slice(0,o)+"...").width>e?r=o:s=o}return i.slice(0,s).trim()+"..."}return i}},L={styleMap:{},element:null,get(i,e,t){let r=L.element;r||(r=window.document.createElement("div"),r.style.display="none",window.document.body.appendChild(r),L.element=r);let s=r.style.cssText;t=a().extend(!0,{},t,{display:""}),Object.keys(t).sort().forEach(b=>{r.style[b]=t[b]});let o=r.style.cssText;r.style.display="none";let n=r.style.cssText;r.style.cssText=s;let l=f.ensure(i),d=o?[...l,o]:l,h=L.styleMap[d.toString()];e=f.ensure(e);let p=e.map(b=>({name:b,nameCamelCase:b.replace(/-(.)/g,(C,P)=>P.toUpperCase())}));h||(h={},L.put(d.toString(),h));let m=p.filter(b=>!(b.nameCamelCase in h));if(m.length===0)return h;r.className=l[0];for(let b=1;b<l.length;b++){let C=r.children[0];C||(C=window.document.createElement("div"),C.style.display="none",r.appendChild(C)),r=C,r.className=l[b]}r.style.cssText=n;let g=window.getComputedStyle(r);m.forEach(b=>{h[b.nameCamelCase]=g[b.name]}),r.style.cssText=s,r=L.element;do r.className="",r=r.children[0];while(r);return h},getFirstOpaqueBackgroundColor(i){if(!i)return;let e=i.document(!0);for(;i&&i.length&&e!==i[0];){let t=i.css("background-color"),r=L.rgb(t);if(r&&r.alpha===1)return t;i=i.parent()}},getSize(i,e,t,r){let s=L.get(i,e)[t];return s==="auto"?r:a().pxToNumber(s)},put(i,e){L.styleMap[i]=e},clearCache(){L.styleMap={}},RGB_BLACK:{red:0,green:0,blue:0},RGB_WHITE:{red:255,green:255,blue:255},rgb(i){if(!i)return;let e=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?(\d+(\.\d+)?)?/i);if(e!==null)return{red:parseInt(e[1],10),green:parseInt(e[2],10),blue:parseInt(e[3],10),alpha:parseFloat(u.nvl(e[4],1))}},hexToRgb(i){if(!i)return;let e=0,t=0,r=0,s=255;return(i.length===4||i.length===5)&&(e=parseInt("0x"+i[1]+i[1]),t=parseInt("0x"+i[2]+i[2]),r=parseInt("0x"+i[3]+i[3]),i.length===5&&(s=parseInt("0x"+i[4]+i[4]))),(i.length===7||i.length===9)&&(e=parseInt("0x"+i[1]+i[2]),t=parseInt("0x"+i[3]+i[4]),r=parseInt("0x"+i[5]+i[6]),i.length===9&&(s=parseInt("0x"+i[7]+i[8]))),s=+(s/255).toFixed(3),"rgba("+ +e+","+ +t+","+ +r+","+s+")"},rgbToHex(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!i)return null;const t=i.replace(/^rgba?\(|\s+|\)$/g,"").split(","),r=[];for(let s=0;s<t.length;s++){if(e&&s===3)continue;let o=parseFloat(t[s]);s===3&&(o=Math.round(o*255));let n=o.toString(16);n.length===1&&(n="0"+n),r[s]=n}return"#"+r.join("")},darkerColor(i,e){let t=L.rgb(i);if(!!t)return e=u.nvl(e,.2),L.mergeRgbColors(L.RGB_BLACK,e,t,1-e)},lighterColor(i,e){let t=L.rgb(i);if(!!t)return e=u.nvl(e,.2),L.mergeRgbColors(L.RGB_WHITE,e,t,1-e)},mergeRgbColors(i,e,t,r){let s,o;if(typeof i=="string"?s=L.rgb(i):s=i,typeof t=="string"?o=L.rgb(t):o=t,!(!s&&!o))return e=u.nvl(e,0),r=u.nvl(r,0),s||(s=L.RGB_BLACK,e=0),o||(o=L.RGB_BLACK,r=0),e===0&&r===0?"rgb(0,0,0)":"rgb("+Ge.round((e*s.red+r*o.red)/(e+r))+","+Ge.round((e*s.green+r*o.green)/(e+r))+","+Ge.round((e*s.blue+r*o.blue)/(e+r))+")"},parseFontSpec(i){let e={};if(y.hasText(i)){let t=i.split(/[-_,/.;]/);for(let r=0;r<t.length;r++){let s=t[r].toUpperCase();s==="NULL"||s==="0"||s==="PLAIN"||(s==="BOLD"?e.bold=!0:s==="ITALIC"?e.italic=!0:/^\d+$/.test(s)?e.size=parseInt(s):s!=="NULL"&&(e.name=t[r]))}}return e},modelToCssColor(i){if(!i)return"";let e="";return/^[A-Fa-f0-9]{3}([A-Fa-f0-9]{3})?$/.test(i)?e="#"+i:/^[A-Za-z0-9().,%-]+$/.test(i)&&(e=i),e},legacyStyle(i,e,t){let r="";return r+=L.legacyForegroundColor(i,e,t),r+=L.legacyBackgroundColor(i,e,t),r+=L.legacyFont(i,e,t),r},legacyForegroundColor(i,e,t){t=t||"";let r="";if(i){let o=y.toLowerCaseFirstLetter(t+"ForegroundColor");r=L.modelToCssColor(i[o])}e&&e.css("color",r);let s="";return r&&(s+="color: "+r+"; "),s},legacyBackgroundColor(i,e,t){t=t||"";let r="";if(i){let o=y.toLowerCaseFirstLetter(t+"BackgroundColor");r=L.modelToCssColor(i[o])}e&&e.css("background-color",r);let s="";return r&&(s+="background-color: "+r+"; "),s},legacyFont(i,e,t){t=t||"";let r="",s="",o="",n="";if(i){let d=y.toLowerCaseFirstLetter(t+"Font"),h=L.parseFontSpec(i[d]);h.bold&&(r="bold"),h.italic&&(s="italic"),h.size&&(o=h.size+"pt"),h.name&&(n=h.name)}e&&e.css("font-weight",r).css("font-style",s).css("font-size",o).css("font-family",n);let l="";return r&&(l+="font-weight: "+r+"; "),s&&(l+="font-style: "+s+"; "),o&&(l+="font-size: "+o+"; "),n&&(l+="font-family: "+n+"; "),l},_getElement(){return L.element}};function Xd(i,e,t){return e=qy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qy(i){var e=Yy(i,"string");return typeof e=="symbol"?e:String(e)}function Yy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Kl{constructor(){Xd(this,"array",void 0),Xd(this,"properties",void 0),Xd(this,"comparator",void 0),this.array=[],this.properties=v.createMap(),this.comparator=gt.ALPHANUMERIC}add(e){this.contains(e)||(this.array.push(e),this.array.sort((t,r)=>this.comparator.compare(t,r)),this.properties[e]=!0)}size(){return this.array.length}contains(e){return e in this.properties}last(){return this.array[this.array.length-1]}}function zl(i,e,t){return e=jy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jy(i){var e=Xy(i,"string");return typeof e=="symbol"?e:String(e)}function Xy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Et{constructor(e){zl(this,"baseUrlRaw",void 0),zl(this,"queryPartRaw",void 0),zl(this,"hashPartRaw",void 0),zl(this,"parameterMap",void 0),e===void 0&&(e=window.location.href);let t=/^([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/.exec(e||"");this.baseUrlRaw=t[1],this.queryPartRaw=t[2],this.hashPartRaw=t[3],this.parameterMap=Et._parse(this.queryPartRaw)}hasParameter(e){return this.parameterMap.hasOwnProperty(e)}getParameter(e){if(typeof e!="string")throw new Error("Illegal argument type: "+e);let t=this.parameterMap[e];return Array.isArray(t)?t.sort(Et._sorter):t}removeParameter(e){if(typeof e!="string")throw new Error("Illegal argument type: "+e);return delete this.parameterMap[e],this}setParameter(e,t){if(typeof e!="string")throw new Error("Illegal argument type: "+e);if(e!=="")return this.parameterMap[e]=t,this}addParameter(e,t){if(typeof e!="string")throw new Error("Illegal argument type: "+e);if(e!=="")return Et._addToMap(this.parameterMap,e,t),this}toString(e){let t=this.baseUrlRaw;if(Object.keys(this.parameterMap).length){e=e||{};let r=e.sorter||Et._sorter;if(e.alwaysFirst||e.alwaysLast){e.alwaysFirst=f.ensure(e.alwaysFirst),e.alwaysLast=f.ensure(e.alwaysLast);let o=r;r=(n,l)=>{let d=e.alwaysFirst.indexOf(n),h=e.alwaysFirst.indexOf(l),p=e.alwaysLast.indexOf(n),m=e.alwaysLast.indexOf(l);return d!==-1?h===-1?-1:d-h:h!==-1?1:p!==-1?m===-1?1:p-m:m!==-1?-1:o(n,l)}}let s=Object.keys(this.parameterMap).sort(r).map(o=>{let n=this.getParameter(o);return Array.isArray(n)?n.map((l,d)=>Et._formatQueryParam(o,n[d])).join("&"):Et._formatQueryParam(o,n)}).join("&");t+="?"+s}return this.hashPartRaw&&(t+="#"+this.hashPartRaw),t}clone(){return new Et(this.toString())}static _sorter(e,t){return e===null?-1:t===null?1:e.toString().localeCompare(t)}static _formatQueryParam(e,t){let r=encodeURIComponent(e);return t!=null&&(r+="="+encodeURIComponent(t)),r}static _addToMap(e,t,r){if(e===void 0)throw new Error("Argument 'map' must not be null");if(t===void 0)throw new Error("Argument 'key' must not be null");if(t in e){let s=e[t];Array.isArray(s)?s.push(r):e[t]=[s,r]}else e[t]=r}static _parse(e){let t=(e||"").replace(/\+/g," "),r=/([^&=]+)(=?)([^&]*)/g,s={},o,n,l;for(;o=r.exec(t);)n=decodeURIComponent(o[1]),l=decodeURIComponent(o[3]),l===""&&o[2]!=="="&&(l=null),Et._addToMap(s,n,l);return s}}const ps={returnTrue(){return!0},returnFalse(){return!1},outsideFilter(i){let e=i instanceof a()?i[0]:i;return function(){return this!==e&&!a().contains(e,this)}},notSameFilter(i){let e=i instanceof a()?i[0]:i;return function(){return this!==e}}};var ht;(function(i){i.LEFT="left",i.RIGHT="right",i.CENTER="center"})(ht||(ht={}));const wt={sumSymbol:ve.SUM,minSymbol:ve.MIN_BOLD,avgSymbol:ve.AVG,maxSymbol:ve.MAX_BOLD,sumStart(){return null},sumStep(i,e){return e?(i||0)+e:i},sumFinish(i){return i},avgStart(){return{sum:0,count:0}},avgStep(i,e){return v.isNullOrUndefined(e)||(i.sum+=e,i.count+=1),i},avgFinish(i){return i.count?i.sum/i.count:null},minStart(){return null},minStep(i,e){return v.isNullOrUndefined(e)||(v.isNullOrUndefined(i)||e<i)&&(i=e),i},minFinish(i){return i},maxStart(){return null},maxStep(i,e){return v.isNullOrUndefined(e)||(v.isNullOrUndefined(i)||e>i)&&(i=e),i},maxFinish(i){return i}},Pe={getItem(i,e){if(!!i)try{return i.getItem(e)}catch(t){a().log.error('Error while reading "'+e+'" from web storage: '+t)}},getItemFromSessionStorage(i){try{return Pe.getItem(sessionStorage,i)}catch(e){a().log.error('Error while reading "'+i+'" from session storage: '+e)}},getItemFromLocalStorage(i){try{return Pe.getItem(localStorage,i)}catch(e){a().log.error('Error while reading "'+i+'" from local storage: '+e)}},setItem(i,e,t){if(!!i)try{return i.setItem(e,t)}catch(r){a().log.error('Error while storing "'+e+'" in web storage: '+r)}},setItemToSessionStorage(i,e){try{return Pe.setItem(sessionStorage,i,e)}catch(t){a().log.error('Error while storing "'+i+'" in session storage: '+t)}},setItemToLocalStorage(i,e){try{return Pe.setItem(localStorage,i,e)}catch(t){a().log.error('Error while storing "'+i+'" in local storage: '+t)}},removeItem(i,e){if(!!i)try{return i.removeItem(e)}catch(t){a().log.error('Error while removing "'+e+'" from web storage: '+t)}},removeItemFromSessionStorage(i){try{return Pe.removeItem(sessionStorage,i)}catch(e){a().log.error('Error while removing "'+i+'" from session storage: '+e)}},removeItemFromLocalStorage(i){try{return Pe.removeItem(localStorage,i)}catch(e){a().log.error('Error while removing "'+i+'" from local storage: '+e)}},clear(i){if(!!i)try{return i.clear()}catch(e){a().log.error("Error while clearing web storage: "+e)}},clearSessionStorage(){try{return Pe.clear(sessionStorage)}catch(i){a().log.error("Error while clearing session storage: "+i)}},clearLocalStorage(){try{return Pe.clear(localStorage)}catch(i){a().log.error("Error while clearing local storage: "+i)}}},Gl={get(i,e){e=e||document;let t=i+"=",r=e.cookie.split(";");for(let s=0;s<r.length;s++){let o=r[s].trim();if(o.indexOf(t)===0)return o.substring(t.length)}return null},set(i,e,t,r){e=u.nvl(e,""),t=u.nvl(t,-1);let s=i+"="+e;if(t>-1){let o=new Date;o.setTime(o.getTime()+t*1e3),s+=";max-age="+t+";expires="+o}r&&(s+=";path="+r),document.cookie=s}};function Ut(i,e,t){return e=Jy(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Jy(i){var e=Qy(i,"string");return typeof e=="symbol"?e:String(e)}function Qy(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Gr{constructor(e){Ut(this,"objectType",void 0),Ut(this,"viewportWidth",void 0),Ut(this,"viewportHeight",void 0),Ut(this,"e",void 0),Ut(this,"f",void 0),Ut(this,"initialDelay",void 0),Ut(this,"active",void 0),Ut(this,"scroll",void 0),Ut(this,"dx",void 0),Ut(this,"dy",void 0),Ut(this,"started",void 0),Ut(this,"moved",void 0),Ut(this,"_timeoutId",void 0),this.viewportWidth=0,this.viewportHeight=0,this.e=30,this.f=-30,this.initialDelay=500,this.active=()=>!0,this.scroll=(t,r)=>{},$.extend(this,e),this.dx=0,this.dy=0,this.started=!1,this.moved=!1,this._timeoutId=null}_tick(){if(!this.active())return;this.started&&(this.dx||this.dy)&&(this.scroll(this.dx,this.dy),this.moved=!0);let e=this.moved?16:this.initialDelay;this._timeoutId=setTimeout(()=>this._tick(),e)}start(){clearTimeout(this._timeoutId),this._tick(),this.started=!0}stop(){clearTimeout(this._timeoutId),this._timeoutId=null,this.started=!1,this.moved=!1,this.dx=0,this.dy=0}update(e){let t=this.e,r=this.f,s=Math.floor((t+r)/2),o=t,n=this.viewportWidth-t,l=t,d=this.viewportHeight-t;const h=Gr.SPEED_FACTOR_SLOW,p=Gr.SPEED_FACTOR_MEDIUM,m=Gr.SPEED_FACTOR_FAST;let g=0,b=0,C=0,P=0;e.x<o?(C=-(o-e.x),g=e.x>s?h:e.x>r?p:m):e.x>n&&(C=e.x-n,g=e.x>this.viewportWidth-r?m:e.x>this.viewportWidth-s?p:h),e.y<l?(P=-(l-e.y),b=e.y>s?h:e.y>r?p:m):e.y>d&&(P=e.y-d,b=e.y>this.viewportHeight-r?m:e.y>this.viewportHeight-s?p:h);let R=Math.abs(C),k=Math.abs(P),N=Math.max(R,k);if(N===0){this.stop();return}let be=1+Math.floor(R*g),st=1+Math.floor(k*b);this.dx=Math.sign(C)*be,this.dy=Math.sign(P)*st,this.started||this.start(),!this.moved&&N>t&&this.start()}}Ut(Gr,"SPEED_FACTOR_SLOW",1/20),Ut(Gr,"SPEED_FACTOR_MEDIUM",1/10),Ut(Gr,"SPEED_FACTOR_FAST",1/5);const Di={get(i,e){let t=a().extend({},{url:i,type:"GET"},e);return Di.call(t)},post(i,e,t){let r=a().extend({},{url:i,type:"POST",data:e},t);return Di.call(r)},put(i,e,t){let r=a().extend({},{url:i,type:"PUT",data:e},t);return Di.call(r)},remove(i,e){let t=a().extend({},{url:i,type:"DELETE"},e);return Di.call(t)},getJson(i,e){let t=a().extend({},{url:i,type:"GET"},e);return Di.callJson(t)},postJson(i,e,t){e&&typeof e!="string"&&(e=JSON.stringify(e));let r=a().extend({},{url:i,type:"POST",data:e},t);return Di.callJson(r)},putJson(i,e,t){e&&typeof e!="string"&&(e=JSON.stringify(e));let r=a().extend({},{url:i,type:"PUT",data:e},t);return Di.callJson(r)},removeJson(i,e){let t=a().extend({},{url:i,type:"DELETE"},e);return Di.callJson(t)},callJson(i){return Di.createCallJson(i).call()},call(i){return Di.createCall(i).call()},createCallJson(i){let e=a().extend({},{type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"},i);return Di.createCall(e)},createCall(i){let e=a().extend({},{cache:!1},i);return u.create(Is,{ajaxOptions:e},{ensureUniqueId:!1})}};function Zy(i,e,t){return e=ev(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ev(i){var e=tv(i,"string");return typeof e=="symbol"?e:String(e)}function tv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Is extends An{constructor(){super(),Zy(this,"ajaxOptions",void 0),this.type="ajax",this.ajaxOptions=null}init(e){if(!e)throw new Error('Missing argument "model"');if(!e.ajaxOptions)throw new Error('Missing model property "ajaxOptions"');e.name||(e.name=e.ajaxOptions.url),super.init(e)}_callImpl(){return this.callCounter!==1&&(this.ajaxOptions.url=new Et(this.ajaxOptions.url).setParameter("retry",this.callCounter-1+"").toString({alwaysLast:["retry"]})),a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+(this.callCounter===1?"--- ":"")+this.ajaxOptions.type+' "'+this.ajaxOptions.url+'"'+(this.callCounter===1?" ---":"")),a().ajax(this.ajaxOptions)}_setResultFail(e,t,r){this._setResult(new Kn({jqXHR:e,textStatus:t,errorThrown:r,requestOptions:this.ajaxOptions}))}_onCallDone(e,t,r){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"AJAX success"),super._onCallDone(e,t,r)}_onCallFail(e,t,r){a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"AJAX fail: type="+t+", httpStatus="+e.status+(r?' "'+r+'"':"")),super._onCallFail(e,t,r)}_nextRetryImpl(e,t,r){return Is.isOfflineError(e,t,r)?super._nextRetryImpl():(a().log.isTraceEnabled()&&a().log.trace(this.logPrefix+"Unexpected HTTP error"),!1)}static isOfflineError(e,t,r){return!e.status||e.status>=12e3||e.status===502||e.status===503||e.status===504}_abortImpl(){this.pendingCall&&typeof this.pendingCall.abort=="function"&&this.pendingCall.abort()}}function Ul(i,e,t){return e=iv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iv(i){var e=rv(i,"string");return typeof e=="symbol"?e:String(e)}function rv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Kn{constructor(e){Ul(this,"jqXHR",void 0),Ul(this,"textStatus",void 0),Ul(this,"errorThrown",void 0),Ul(this,"requestOptions",void 0),this.jqXHR=null,this.textStatus=null,this.errorThrown=null,this.requestOptions=null,a().extend(this,e)}}function Mi(i,e,t){return e=sv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sv(i){var e=ov(i,"string");return typeof e=="symbol"?e:String(e)}function ov(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ei{constructor(){Mi(this,"id",void 0),Mi(this,"objectType",void 0),Mi(this,"session",void 0),Mi(this,"hierarchical",void 0),Mi(this,"loadIncremental",void 0),Mi(this,"batch",void 0),Mi(this,"queryBy",void 0),Mi(this,"searchText",void 0),Mi(this,"key",void 0),Mi(this,"keys",void 0),Mi(this,"parentKey",void 0),Mi(this,"active",void 0),Mi(this,"maxRowCount",void 0),this.session=null,this.hierarchical=!1,this.loadIncremental=!1,this.batch=!1,this.queryBy=null,this.searchText=null,this.key=null,this.keys=null,this.parentKey=null,this.active=null,this.maxRowCount=100}init(e){u.assertParameter("session",e.session),this._init(e)}_init(e){a().extend(this,e)}setLoadIncremental(e){this.loadIncremental=e}setHierarchical(e){this.hierarchical=e}setBatch(e){this.batch=e}setMaxRowCount(e){this.maxRowCount=e}textByKey(e){return v.isNullOrUndefined(e)?a().resolvedPromise(""):this._textByKey(e)}_textByKey(e){return this.cloneForKey(e).execute().then(t=>{let r=ei.firstLookupRow(t);return r?r.text:""})}textsByKeys(e){return f.empty(e)?a().resolvedPromise({}):this._textsByKeys(e)}_textsByKeys(e){return this.cloneForKeys(e).execute().then(t=>{if(!t||!v.isArray(t.lookupRows))return{};const r={};return t.lookupRows.forEach(s=>{r[v.ensureValidKey(s.key)]=s.text}),r})}getAll(){return this.queryBy=me.ALL,this._getAll()}_getAll(){throw new Error("_getAll() not implemented")}getByText(e){return this.queryBy=me.TEXT,this.searchText=e,this._getByText(e)}_getByText(e){throw new Error("_getByText() not implemented")}getByKey(e){return this.queryBy=me.KEY,this.key=e,this._getByKey(e)}_getByKey(e){throw new Error("getByKey() not implemented")}getByKeys(e){return this.queryBy=me.KEYS,this.keys=e,this._getByKeys(e)}_getByKeys(e){throw new Error("_getByKeys() not implemented")}getByRec(e){return this.queryBy=me.REC,this.parentKey=e,v.isNullOrUndefined(e)?this._emptyRecResult(e):this._getByRec(e)}_emptyRecResult(e){return a().resolvedPromise({queryBy:me.REC,rec:e,lookupRows:[]})}_getByRec(e){throw new Error("_getByRec() not implemented")}execute(){if(me.KEY===this.queryBy)return this._getByKey(this.key);if(me.ALL===this.queryBy)return this._getAll();if(me.KEYS===this.queryBy)return this._getByKeys(this.keys);if(me.TEXT===this.queryBy)return this._getByText(this.searchText);if(me.REC===this.queryBy)return v.isNullOrUndefined(this.parentKey)?this._emptyRecResult(this.parentKey):this._getByRec(this.parentKey);throw new Error("cannot execute a non-clone LookupCall. Use one of the cloneFor*-methods before executing.")}clone(e){return u.cloneShallow(this,e,!0)}cloneForAll(){return this.clone({queryBy:me.ALL})}cloneForText(e){return this.clone({queryBy:me.TEXT,searchText:e})}cloneForKey(e){return this.clone({queryBy:me.KEY,key:e})}cloneForKeys(e){return this.clone({queryBy:me.KEYS,keys:e})}cloneForRec(e){return this.clone({queryBy:me.REC,parentKey:e})}abort(){}static ensure(e,t){return!e||e instanceof ei?e:typeof e=="string"||typeof e=="function"?u.create(e,{session:t}):(e.session=t,u.create(e))}static firstLookupRow(e){return!e||!v.isArray(e.lookupRows)||e.lookupRows.length===0?null:e.lookupRows[0]}}function zi(i,e,t){return e=nv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nv(i){var e=lv(i,"string");return typeof e=="symbol"?e:String(e)}function lv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class jr{constructor(){zi(this,"key",void 0),zi(this,"text",void 0),zi(this,"parentKey",void 0),zi(this,"enabled",void 0),zi(this,"active",void 0),zi(this,"additionalTableRowData",void 0),zi(this,"cssClass",void 0),zi(this,"iconId",void 0),zi(this,"tooltipText",void 0),zi(this,"backgroundColor",void 0),zi(this,"foregroundColor",void 0),zi(this,"font",void 0),this.key=null,this.text=null,this.parentKey=null,this.enabled=!0,this.active=!0,this.additionalTableRowData=null,this.cssClass=null,this.iconId=null,this.tooltipText=null,this.backgroundColor=null,this.foregroundColor=null,this.font=null}init(e){a().extend(this,e)}setKey(e){this.key=e}setText(e){this.text=e}setParentKey(e){this.parentKey=e}setCssClass(e){this.cssClass=e}setAdditionalTableRowData(e){this.additionalTableRowData=e}setIconId(e){this.iconId=e}setTooltipText(e){this.tooltipText=e}setBackgroundColor(e){this.backgroundColor=e}setForegroundColor(e){this.foregroundColor=e}setFont(e){this.font=e}equals(e){return v.propertiesEquals(this,e,Object.keys(this))}toString(){return"scout.LookupRow[key="+this.key+" text="+this.text+"]"}}function Wo(i,e,t){return e=av(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function av(i){var e=dv(i,"string");return typeof e=="symbol"?e:String(e)}function dv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class am extends ei{constructor(){super(),Wo(this,"resourceUrl",void 0),Wo(this,"maxTextLength",void 0),Wo(this,"restriction",void 0),Wo(this,"_restriction",void 0),Wo(this,"_ajaxCall",void 0),Wo(this,"_deferred",void 0),this.resourceUrl=null,this.maxTextLength=null,this.restriction=null,this._restriction=null,this._ajaxCall=null,this._deferred=null,this.batch=!0}addRestriction(e,t){this._restriction||(this._restriction={}),this._restriction[e]=t}_addRestrictionIfAbsent(e,t){(!this.restriction||v.isNullOrUndefined(this.restriction[e]))&&this.addRestriction(e,t)}_getAll(){return this._call()}_getByText(e){return this.addRestriction("text",e),this._call()}_getByKey(e){return this.addRestriction("ids",f.ensure(e)),this._call()}_getByKeys(e){return this.addRestriction("ids",f.ensure(e)),this._call()}cloneForAll(){let e=super.cloneForAll();return e._addRestrictionIfAbsent("active",!0),e._addRestrictionIfAbsent("maxRowCount",this.maxRowCount),e}cloneForText(e){let t=super.cloneForText(e);return t._addRestrictionIfAbsent("active",!0),t._addRestrictionIfAbsent("maxRowCount",this.maxRowCount),t}cloneForRec(e){let t=super.cloneForRec(e);return t._addRestrictionIfAbsent("active",!0),t._addRestrictionIfAbsent("maxRowCount",this.maxRowCount),t}_acceptLookupRow(e){return!0}_createLookupRowFromDo(e){let t=a().extend({},e);if(t.key=t.id,delete t.id,t.parentKey=t.parentId,delete t.parentId,delete t._type,this.maxTextLength){let r=t.text;r.length>this.maxTextLength&&(t.text=r.substr(0,this.maxTextLength)+"...",t.tooltipText=r)}return u.create(jr,t,{ensureUniqueId:!1})}_call(){return this._deferred=a().Deferred(),this._ajaxCall=this._createAjaxCall(),this._ajaxCall.call().then((e,t,r)=>{let s=f.ensure(e?e.rows:null).filter(this._acceptLookupRow.bind(this)).map(this._createLookupRowFromDo.bind(this));this._deferred.resolve({queryBy:this.queryBy,text:this.searchText,key:this.key,lookupRows:s})}).catch(e=>{this._deferred.resolve({queryBy:this.queryBy,text:this.searchText,key:this.key,lookupRows:[],exception:this.session.text("ErrorWhileLoadingData")})}),this._deferred.promise()}abort(){this._deferred.reject({canceled:!0}),this._ajaxCall.abort(),super.abort()}_getCallUrl(){return this.resourceUrl}_getRestrictionForAjaxCall(){if(!this.restriction&&!this._restriction)return null;let e=s=>typeof s=="function"?s(this):s,t={},r=a().extend({},this.restriction,this._restriction);return Object.keys(r).forEach(s=>{let o=r[s],n;Array.isArray(o)?(n=f.flatMap(o,e).filter(Boolean),n=n.length?n:null):n=e(o),v.isNullOrUndefined(n)||(t[s]=n)}),t}_createAjaxCall(){let e=this._getCallUrl(),t=this._getRestrictionForAjaxCall(),s={type:"POST",data:t?JSON.stringify(t):null,dataType:"json",contentType:"application/json; charset=UTF-8",cache:!1,url:e,timeout:0};return u.create(Is,{ajaxOptions:s,name:"RestLookupCall",retryIntervals:[100,500,500,500]},{ensureUniqueId:!1})}}function dm(i,e,t){return e=hv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hv(i){var e=uv(i,"string");return typeof e=="symbol"?e:String(e)}function uv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ql extends ei{constructor(e){super(),dm(this,"adapter",void 0),dm(this,"deferred",void 0),this.adapter=e,this.deferred=null}_getAll(){return this._newDeferred(new ns(me.ALL)),this.adapter.sendLookup(me.ALL),this.deferred.promise()}_getByText(e){return this._newDeferred(new ns(me.TEXT,e)),this.adapter.sendLookup(me.TEXT,e),this.deferred.promise()}_getByKey(e){return this._newDeferred(new ns(me.KEY,e)),this.adapter.sendLookup(me.KEY,e),this.deferred.promise()}_getByRec(e){return this._newDeferred(new ns(me.REC,e)),this.adapter.sendLookup(me.REC,e),this.deferred.promise()}resolveLookup(e){if(!this._belongsToLatestRequest(e)){a().log.isTraceEnabled()&&a().log.trace("(RemoteLookupCall#resolveLookup) ignore lookupResult. Does not belong to latest request",v.optProperty(this.deferred,"requestParameter"));return}e.lookupRows=f.ensure(e.lookupRows).map(t=>u.create(jr,t)),this.deferred.resolve(e)}_belongsToLatestRequest(e){if(!this.deferred)return!1;let t=e.queryBy.toLowerCase(),r=e[t],s=new ns(e.queryBy,r);return this.deferred.requestParameter.equals(s)}_newDeferred(e){this.deferred&&this.deferred.reject({canceled:!0}),this.deferred=a().Deferred(),this.deferred.requestParameter=e}}function hm(i,e,t){return e=cv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cv(i){var e=pv(i,"string");return typeof e=="symbol"?e:String(e)}function pv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ns{constructor(e,t){if(hm(this,"requestType",void 0),hm(this,"requestData",void 0),!me.hasOwnProperty(e))throw new Error("Invalid enum value");this.requestType=e,this.requestData=t}equals(e){return!e||!(e instanceof ns)?!1:v.propertiesEquals(this,e,["requestType","requestData"])}}var me;(function(i){i.ALL="ALL",i.TEXT="TEXT",i.KEY="KEY",i.KEYS="KEYS",i.REC="REC"})(me||(me={}));function um(i,e,t){return e=fv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fv(i){var e=mv(i,"string");return typeof e=="symbol"?e:String(e)}function mv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ko extends ei{constructor(){super(),um(this,"delay",void 0),um(this,"data",void 0),this.delay=0,this.data=null,this.active=!0}_init(e){super._init(e),this.data||(this.data=this._data())}refreshData(e){e===void 0?this.data=this._data():this.data=e}_getAll(){let e=a().Deferred();return setTimeout(this._queryByAll.bind(this,e),this.delay),e.promise()}_queryByAll(e){e.resolve({queryBy:me.ALL,lookupRows:this._lookupRowsByAll()})}_lookupRowsByAll(){return this.data.slice(0,this.maxRowCount).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}_filterActiveLookupRow(e){return v.isNullOrUndefined(this.active)?!0:this.active===u.nvl(e.active,!0)}_getByText(e){let t=a().Deferred();return setTimeout(this._queryByText.bind(this,t,e),this.delay),t.promise()}_queryByText(e,t){let r=this._lookupRowsByText(t);this.hierarchical||e.resolve({queryBy:me.TEXT,text:t,lookupRows:r});let s,o=new Jd(this);this.loadIncremental?s=a().resolvedPromise(r):s=o.addChildLookupRows(r),s.then(n=>o.addParentLookupRows(n)).done(n=>{e.resolve({queryBy:me.TEXT,text:t,lookupRows:n})}).fail(n=>{throw n})}_lookupRowsByText(e){let t=this._createSearchPattern(e);return this.data.filter(s=>t.test(s[1].toLowerCase())).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}_createSearchPattern(e){const t="*",r="@wildcard@";e=y.nvl(e),e=e.toLowerCase(),e=e.replace(new RegExp(y.quote(t),"g"),r),e=y.quote(e);let s=r+r;for(;y.contains(e,s);)e=e.replace(s,r);return y.endsWith(e,r)||(e+=r),e=e.replace(new RegExp(y.quote(r),"g"),".*"),new RegExp("^"+e+"$","s")}_getByKey(e){let t=a().Deferred();return setTimeout(this._queryByKey.bind(this,t,e),this.delay),t.promise()}_queryByKey(e,t){let r=this._lookupRowByKey(t);r?e.resolve({queryBy:me.KEY,lookupRows:[r]}):e.reject()}_lookupRowByKey(e){let t=f.find(this.data,r=>r[0]===e);return t?this._dataToLookupRow(t):null}_getByRec(e){let t=a().Deferred();return setTimeout(this._queryByRec.bind(this,t,e),this.delay),t.promise()}_queryByRec(e,t){e.resolve({queryBy:me.REC,rec:t,lookupRows:this._lookupRowsByRec(t)})}_lookupRowsByRec(e){return this.data.reduce((t,r)=>(r[2]===e&&t.push(this._dataToLookupRow(r)),t),[]).filter(this._filterActiveLookupRow,this)}setDelay(e){this.delay=e}_dataToLookupRow(e,t){return u.create(jr,{key:e[0],text:e[1],parentKey:e[2]})}_data(){return[]}}function gv(i,e,t){return e=_v(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _v(i){var e=bv(i,"string");return typeof e=="symbol"?e:String(e)}function bv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class cm extends ei{constructor(){super(),gv(this,"lookupRows",void 0),this.lookupRows=[]}setLookupRows(e){this.lookupRows=f.ensure(e)}_filterActiveLookupRow(e){return!!u.nvl(e.active,!0)}_getAll(){let e=a().Deferred();return setTimeout(this._queryByAll.bind(this,e)),e.promise()}_queryByAll(e){e.resolve({queryBy:me.ALL,lookupRows:this._lookupRowsByAll()})}_lookupRowsByAll(){return this.lookupRows.filter(this._filterActiveLookupRow,this).slice(0,this.maxRowCount)}_getByText(e){let t=a().Deferred();return setTimeout(this._queryByText.bind(this,t,e)),t.promise()}_queryByText(e,t){e.resolve({queryBy:me.TEXT,text:t,lookupRows:this._lookupRowsByText(t)})}_lookupRowsByText(e){let t=String(u.nvl(e,"")).trim().toLowerCase();return this.lookupRows.filter(r=>y.startsWith(u.nvl(r.text,"").toLowerCase(),t)).filter(this._filterActiveLookupRow,this).slice(0,this.maxRowCount)}_getByKey(e){let t=a().Deferred();return setTimeout(this._queryByKey.bind(this,t,e)),t.promise()}_queryByKey(e,t){let r=this._lookupRowByKey(t);r?e.resolve({queryBy:me.KEY,lookupRows:[r]}):e.reject()}_lookupRowByKey(e){return f.find(this.lookupRows,t=>t.key===e)}_getByRec(e){let t=a().Deferred();return setTimeout(this._queryByRec.bind(this,t,e)),t.promise()}_queryByRec(e,t){e.resolve({queryBy:me.REC,rec:t,lookupRows:this._lookupRowsByRec(t)})}_lookupRowsByRec(e){return this.lookupRows.reduce((t,r)=>(r.parentKey===e&&t.push(r),t),[]).filter(this._filterActiveLookupRow,this).slice(0,this.maxRowCount)}}function pm(i,e,t){return e=yv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yv(i){var e=vv(i,"string");return typeof e=="symbol"?e:String(e)}function vv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Jd{constructor(e){pm(this,"lookupCall",void 0),pm(this,"_lookupRowMap",void 0),u.assertParameter("lookupCall",e),this.lookupCall=e,this._lookupRowMap={}}addParentLookupRows(e){this._fillMap(e);let t=e.map(this._addParent.bind(this));return a().promiseAll(t).then(()=>v.values(this._lookupRowMap))}_addParent(e){let t=e.parentKey;return t?this._lookupRowMap.hasOwnProperty(t+"")?(e=this._lookupRowMap[t+""],this._addParent(e)):this.lookupCall.cloneForKey(t).execute().then(r=>{let s=ei.firstLookupRow(r);return this._lookupRowMap[s.key+""]=s,this._addParent(s)}):a().resolvedPromise()}_fillMap(e){e.forEach(t=>{this._lookupRowMap[t.key+""]=t})}addChildLookupRows(e){this._fillMap(e);let t=e.map(this._addChildren.bind(this));return a().promiseAll(t).then(()=>v.values(this._lookupRowMap))}_addChildren(e){return this.lookupCall.cloneForRec(e.key).execute().then(t=>{if(t.lookupRows.length)return this.addChildLookupRows(t.lookupRows)})}}function fs(i,e,t){return e=wv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wv(i){var e=Tv(i,"string");return typeof e=="symbol"?e:String(e)}function Tv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fm{constructor(){fs(this,"objectType",void 0),fs(this,"active",void 0),fs(this,"id",void 0),fs(this,"parent",void 0),fs(this,"children",void 0),fs(this,"sortCode",void 0),fs(this,"modelClass",void 0),fs(this,"_text",void 0),this.children=[]}init(e){if(u.assertParameter("id",e.id),this.active=e.active,this.id=e.id,this.sortCode=e.sortCode,this._text=e.text,this.modelClass=e.modelClass,e.texts){if(this._text)throw new Error("Either set texts or text property, not both.");let t=Tt.registerTexts(this,e.texts);this._text=Ce.buildKey(t)}}text(e){return typeof e=="object"?Ce.resolveText(this._text,e.languageTag):Ce.resolveText(this._text,e)}visitChildren(e){for(let t=0;t<this.children.length;t++){let r=this.children[t],s=e(r);if(s===!0||s===ye.TERMINATE||s!==ye.SKIP_SUBTREE&&(s=r.visitChildren(e),s===!0||s===ye.TERMINATE))return ye.TERMINATE}}}function zn(i,e,t){return e=Sv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Sv(i){var e=Cv(i,"string");return typeof e=="symbol"?e:String(e)}function Cv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class kn{constructor(){zn(this,"objectType",void 0),zn(this,"id",void 0),zn(this,"modelClass",void 0),zn(this,"codes",void 0),zn(this,"codeMap",void 0),this.codes=[],this.codeMap={}}init(e){if(u.assertParameter("id",e.id),this.id=e.id,this.modelClass=e.modelClass,e.codes)for(let t=0;t<e.codes.length;t++)this._initCode(e.codes[t])}_initCode(e,t){let r=u.create(e);if(this.add(r,t),e.children)for(let s=0;s<e.children.length;s++)this._initCode(e.children[s],r)}add(e,t){this.codes.push(e),this.codeMap[e.id+""]=e,t&&(t.children.push(e),e.parent=t)}get(e){let t=this.optGet(e);if(!t)throw new Error("No code found for id="+e);return t}optGet(e){return this.codeMap[e+""]}getCodes(e){if(e){let t=[];for(let r=0;r<this.codes.length;r++)this.codes[r].parent||t.push(this.codes[r]);return t}return this.codes}visitChildren(e){let t=this.getCodes(!0);for(let r=0;r<t.length;r++){let s=t[r],o=e(s);if(o===!0||o===ye.TERMINATE||o!==ye.SKIP_SUBTREE&&(o=s.visitChildren(e),o===!0||o===ye.TERMINATE))return ye.TERMINATE}}static ensure(e){return!e||e instanceof kn?e:u.create(kn,e)}}const Tt={defaultLanguage:"en",registry:{},bootstrap(i){return(i?a().ajaxJson(i):a().resolvedPromise({})).then(Tt._preInit.bind(this,i))},_preInit(i,e){if(e&&e.error)throw{error:e.error,url:i};Tt.init(e)},init(i){i=i||{},Object.keys(i).forEach(e=>Tt.add(i[e]))},add(i){f.ensure(i).forEach(t=>{let r=kn.ensure(t);Tt.registry[r.id]=r})},remove(i){f.ensure(i).forEach(t=>{let r;typeof t=="string"?r=t:r=t.id,delete Tt.registry[r]})},get(i,e){return Tt._get("get",v.argumentsToArray(arguments))},optGet(i,e){return Tt._get("optGet",v.argumentsToArray(arguments))},_get(i,e){let t,r;if(e.length===2)t=e[0],r=e[1];else{let s=e[0].split(" ");if(s.length!==2)throw new Error('Invalid string. Must have format "[CodeType.id] [Code.id]"');t=s[0],r=s[1]}return u.assertParameter("codeTypeId",t),u.assertParameter("codeId",r),Tt.codeType(t)[i](r)},codeType(i,e){let t=Tt.registry[i];if(!e&&!t)throw new Error("No CodeType found for id="+i);return t},generateTextKey(i){return"__code."+i.id},registerTexts(i,e){let t=Tt.generateTextKey(i);Ce.get("default").remove(t);for(let r in e){let s=e[r];r&&r===Tt.defaultLanguage&&(r="default"),Ce.get(r).add(t,s)}return t}};function Pv(i,e,t){return e=xv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xv(i){var e=Fv(i,"string");return typeof e=="symbol"?e:String(e)}function Fv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Yl extends Ko{constructor(){super(),Pv(this,"codeType",void 0),this.codeType=null}_lookupRowByKey(e){let t=Tt.codeType(this.codeType,!0);return t?this._createLookupRow(t.optGet(e)):null}_lookupRowsByAll(){return this._collectLookupRows()}_lookupRowsByText(e){return this._collectLookupRows(t=>{let r=t.text||"";return y.startsWith(r.toLowerCase(),e.toLowerCase())})}_lookupRowsByRec(e){return this._collectLookupRows(t=>t.parentKey===e)}_collectLookupRows(e){let t=Tt.codeType(this.codeType,!0);if(!t)return[];let r=[];return t.visitChildren(s=>{let o=this._createLookupRow(s);(!e||e(o))&&r.push(o)}),r}_createLookupRow(e){return e?u.create(jr,{key:e.id,text:e.text(this.session.locale),parentKey:e.parent&&e.parent.id}):null}}var Gi;(function(i){i.STOPPED="stopped",i.RUNNING="running",i.FAILURE="failure"})(Gi||(Gi={}));function mm(i,e,t){return e=Ev(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ev(i){var e=Av(i,"string");return typeof e=="symbol"?e:String(e)}function Av(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qd{constructor(e){mm(this,"enabled",void 0),mm(this,"status",void 0),this.enabled=!!e,this.status=Gi.STOPPED}setFailed(){this.status=Gi.FAILURE}setRunning(){this.status=Gi.RUNNING}setStopped(){this.status=Gi.STOPPED}isFailed(){return this.status===Gi.FAILURE}isRunning(){return this.status===Gi.RUNNING}isStopped(){return this.status===Gi.STOPPED}}function Ui(i,e,t){return e=Dv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Dv(i){var e=Mv(i,"string");return typeof e=="symbol"?e:String(e)}function Mv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zd extends I{constructor(){super(),Ui(this,"cancellable",void 0),Ui(this,"showTimeout",void 0),Ui(this,"label",void 0),Ui(this,"details",void 0),Ui(this,"cancelButton",void 0),Ui(this,"boxButtons",void 0),Ui(this,"_glassPaneRenderer",void 0),Ui(this,"$content",void 0),Ui(this,"$buttons",void 0),Ui(this,"$label",void 0),Ui(this,"$details",void 0),Ui(this,"_busyIndicatorTimeoutId",void 0),this.cancellable=!0,this.showTimeout=2500,this.label=null,this.details=null,this.cancelButton=null,this.boxButtons=null,this._glassPaneRenderer=null,this.inheritAccessibility=!1,this.$content=null,this.$buttons=null,this.$label=null,this.$details=null,this._busyIndicatorTimeoutId=0,this._addWidgetProperties(["boxButtons","cancelButton"])}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new jn(this,[_.SPACE,_.ENTER]),new Jo(this,()=>this.cancelButton?this.cancelButton.$container:null)])}_init(e){super._init(e),this.label=u.nvl(this.label,this.session.text("ui.PleaseWait_")),this.cancellable&&(this.boxButtons=u.create(Xn,{parent:this}),this.cancelButton=this.boxButtons.addButton({text:this.session.text("Cancel")}),this.cancelButton.one("action",t=>this._onCancelClick(t)))}render(e){e=e||this.entryPoint(),super.render(e)}_render(){this.$container=this.$parent.appendDiv("busyindicator invisible");let e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$content=this.$container.appendDiv("busyindicator-content"),this.$label=this.$content.appendDiv("busyindicator-label"),this.$details=this.$content.appendDiv("busyindicator-details"),this.cancellable?(this.boxButtons.render(),this.$buttons=this.boxButtons.$container,this.$buttons.addClass("busyindicator-buttons")):this.$content.addClass("no-buttons"),this._renderLabel(),this._renderDetails(),this.$container.addClass("calc-helper"),this.$container.css("min-width",this.$container.width()),this.$container.removeClass("calc-helper"),this._position(),this._busyIndicatorTimeoutId=setTimeout(()=>{this.$container.removeClass("invisible").addClassForAnimation("animate-open"),this.session.focusManager.validateFocus()},this.showTimeout),this._glassPaneRenderer=new js(this),this._glassPaneRenderer.renderGlassPanes(),this._glassPaneRenderer.eachGlassPane(t=>t.addClass("busy"))}_postRender(){super._postRender(),this.session.focusManager.installFocusContext(this.$container,It.AUTO)}_remove(){clearTimeout(this._busyIndicatorTimeoutId),this._glassPaneRenderer.eachGlassPane(e=>e.removeClass("busy")),this._glassPaneRenderer.removeGlassPanes(),this.session.focusManager.uninstallFocusContext(this.$container),super._remove()}setLabel(e){this.setProperty("label",e)}_renderLabel(){this.$label.text(this.label||"")}setDetails(e){this.setProperty("details",e)}_renderDetails(){this.$details.html(y.nl2br(this.details)).setVisible(!!this.details)}_position(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}close(){this.cancelButton&&this.cancelButton.$container&&this.session.focusManager.requestFocus(this.cancelButton.$container)&&(this.cancelButton.$container.focus(),this.cancelButton.doAction())}_onCancelClick(e){this.trigger("cancel",e)}cancelled(){this.rendered&&(this.$label.addClass("cancelled"),this.$buttons&&this.$buttons.remove(),this.$content.addClass("no-buttons"))}}function zo(i,e,t){return e=$v(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $v(i){var e=Rv(i,"string");return typeof e=="symbol"?e:String(e)}function Rv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class jl{constructor(e,t,r){zo(this,"target",void 0),zo(this,"type",void 0),zo(this,"showBusyIndicator",void 0),zo(this,"coalesce",void 0),zo(this,"newRequest",void 0),zo(this,"properties",void 0),u.assertParameter("target",e),u.assertParameter("type",t),a().extend(this,r),this.target=e,this.type=t}}function $i(i,e,t){return e=Lv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Lv(i){var e=Iv(i,"string");return typeof e=="symbol"?e:String(e)}function Iv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ti{constructor(e){$i(this,"languageTag",void 0),$i(this,"language",void 0),$i(this,"country",void 0),$i(this,"displayLanguage",void 0),$i(this,"displayCountry",void 0),$i(this,"decimalFormatPatternDefault",void 0),$i(this,"decimalFormatSymbols",void 0),$i(this,"decimalFormat",void 0),$i(this,"dateFormatPatternDefault",void 0),$i(this,"dateFormatSymbols",void 0),$i(this,"timeFormatPatternDefault",void 0),$i(this,"dateFormat",void 0),e=u.nvl(e,ti.DEFAULT),this.languageTag=e.languageTag;let t=bt.splitLanguageTag(this.languageTag);this.language=t[0],this.country=t[1],this.displayLanguage=e.displayLanguage,this.displayCountry=e.displayCountry,this.decimalFormatPatternDefault=e.decimalFormatPatternDefault,this.decimalFormatSymbols=e.decimalFormatSymbols,this.decimalFormatPatternDefault&&this.decimalFormatSymbols&&(this.decimalFormat=new Ur(this,this.decimalFormatPatternDefault)),this.dateFormatPatternDefault=e.dateFormatPatternDefault,this.dateFormatSymbols=e.dateFormatSymbols,this.timeFormatPatternDefault=e.timeFormatPatternDefault,this.dateFormatPatternDefault&&this.dateFormatSymbols&&(this.dateFormat=new Ft(this,this.dateFormatPatternDefault))}static ensure(e){return!e||e instanceof ti?e:new ti(e)}}$i(ti,"DEFAULT",{languageTag:"en-US",decimalFormatPatternDefault:"#,##0.###",dateFormatPatternDefault:"MM/dd/yyyy",timeFormatPatternDefault:"h:mm a",decimalFormatSymbols:{decimalSeparator:".",groupingSeparator:",",minusSign:"-"},dateFormatSymbols:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],am:"AM",pm:"PM"}});function eh(i,e,t){return e=kv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kv(i){var e=Bv(i,"string");return typeof e=="symbol"?e:String(e)}function Bv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class th{constructor(){eh(this,"filters",void 0),eh(this,"_filterProperties",void 0),eh(this,"_defaultFilter",void 0),this._filterProperties={},this._defaultFilter=this._propertiesFilter.bind(this),this.filters=[this._defaultFilter]}addFilterForProperties(e){v.copyProperties(e,this._filterProperties)}addFilter(e){this.filters.push(e)}filter(e,t){return this.filters.some(r=>r(e,t))}addFilterForPropertyName(e){this.filters.push((t,r)=>t===e)}_propertiesFilter(e,t){if(!this._filterProperties.hasOwnProperty(e))return!1;let r=this._filterProperties[e];return v.equals(r,t)}reset(){this._filterProperties={},this.filters=[this._defaultFilter]}}function Go(i,e,t){return e=Ov(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ov(i){var e=Hv(i,"string");return typeof e=="symbol"?e:String(e)}function Hv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ih{constructor(e){Go(this,"session",void 0),Go(this,"started",void 0),Go(this,"initialDelay",void 0),Go(this,"interval",void 0),Go(this,"minPingDuration",void 0),Go(this,"pingStartTimestamp",void 0),this.session=e,this.started=!1,this.initialDelay=1e3,this.interval=3e3,this.minPingDuration=1e3}start(){this.started||(a().log.isTraceEnabled()&&a().log.trace("[ajax reconnector] start"),this.started=!0,this._schedulePing(this.initialDelay))}stop(){this.started=!1}_schedulePing(e){a().log.isTraceEnabled()&&a().log.trace("[ajax reconnector] schedule ping() in "+e+" ms"),setTimeout(this._ping.bind(this),e)}_ping(){this.session.onReconnecting();let e=this.session.defaultAjaxOptions(this.session._newRequest({ping:!0}));a().log.isTraceEnabled()&&a().log.trace("[ajax reconnector] "+e.type+' "'+e.url+'"'),this.pingStartTimestamp=Date.now(),a().ajax(e).done(this._onPingDone.bind(this)).fail(this._onPingFail.bind(this))}_onPingDone(e,t,r){a().log.isTraceEnabled()&&a().log.trace("[ajax reconnector] ping success -> connection re-established!"),this.session.onReconnectingSucceeded(),this.stop()}_onPingFail(e,t,r){let s=function(){a().log.isTraceEnabled()&&a().log.trace("[ajax reconnector] ping failed"),this.session.onReconnectingFailed(),this._schedulePing(this.interval)}.bind(this),o=Date.now()-this.pingStartTimestamp;o<this.minPingDuration?setTimeout(s,this.minPingDuration-o):s()}}function Ws(i,e,t){return e=Nv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Nv(i){var e=Vv(i,"string");return typeof e=="symbol"?e:String(e)}function Vv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fo{constructor(e){Ws(this,"session",void 0),Ws(this,"queue",void 0),Ws(this,"lastProcessedSequenceNo",void 0),Ws(this,"nextExpectedSequenceNo",void 0),Ws(this,"force",void 0),Ws(this,"forceTimeoutId",void 0),this.session=e,this.queue=[],this.lastProcessedSequenceNo=0,this.nextExpectedSequenceNo=1,this.force=!1,this.forceTimeoutId=null}add(e){let t=e&&e["#"];if(!(t&&t<=this.lastProcessedSequenceNo))if(t&&e.combined&&(this.lastProcessedSequenceNo=Math.max(t-1,this.lastProcessedSequenceNo),this.nextExpectedSequenceNo=Math.max(t,this.nextExpectedSequenceNo)),!t||this.queue.length===0)this.queue.push(e);else{let r=[],s=e;for(let o=0;o<this.queue.length;o++){let n=this.queue[o];n["#"]&&(s&&n["#"]>t&&(r.push(e),s=null),n["#"]<=this.lastProcessedSequenceNo)||r.push(n)}s&&r.push(s),this.queue=r}}process(e){e&&this.add(e);let t=!0,r=!1,s=[];for(let o=0;o<this.queue.length;o++){let n=this.queue[o],l=n["#"];if(l&&(this.nextExpectedSequenceNo&&!this.force&&!r&&(r=this.nextExpectedSequenceNo!==l),r)){s.push(n);continue}let d=this.session.processJsonResponseInternal(n);e&&n===e&&(t=d),l&&(this.lastProcessedSequenceNo=l,this.nextExpectedSequenceNo=l+1)}return this.queue=s,this._checkTimeout(),t}size(){return this.queue.length}_checkTimeout(){this.queue.length===0?(clearTimeout(this.forceTimeoutId),this.forceTimeoutId=null):this.forceTimeoutId||(this.forceTimeoutId=setTimeout(()=>{try{let e="[";for(let t=0;t<this.queue.length;t++)t>0&&(e+=", "),e+=y.box("#",this.queue[t]["#"]+"")||"<none>";e+="]",this.session.sendLogRequest("Expected response #"+this.nextExpectedSequenceNo+" still missing after "+Fo.FORCE_TIMEOUT+" ms. Forcing response queue to process "+this.size()+" elements: "+e)}catch{}this.force=!0;try{this.process()}finally{this.force=!1,this.forceTimeoutId=null}},Fo.FORCE_TIMEOUT))}prepareRequest(e){e["#ACK"]=this.lastProcessedSequenceNo}prepareHttpRequest(e){e.headers=e.headers||{},e.headers["X-Scout-#ACK"]=this.lastProcessedSequenceNo+""}}Ws(Fo,"FORCE_TIMEOUT",10*1e3);function U(i,e,t){return e=Wv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Wv(i){var e=Kv(i,"string");return typeof e=="symbol"?e:String(e)}function Kv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ci extends ir{constructor(){super(),U(this,"objectType",void 0),U(this,"partId",void 0),U(this,"url",void 0),U(this,"userAgent",void 0),U(this,"locale",void 0),U(this,"textMap",void 0),U(this,"ready",void 0),U(this,"unloading",void 0),U(this,"unloaded",void 0),U(this,"loggedOut",void 0),U(this,"inspector",void 0),U(this,"persistent",void 0),U(this,"offline",void 0),U(this,"inDevelopmentMode",void 0),U(this,"desktop",void 0),U(this,"layoutValidator",void 0),U(this,"focusManager",void 0),U(this,"keyStrokeManager",void 0),U(this,"uiSessionId",void 0),U(this,"clientSessionId",void 0),U(this,"forceNewClientSession",void 0),U(this,"remoteUrl",void 0),U(this,"unloadUrl",void 0),U(this,"modelAdapterRegistry",void 0),U(this,"ajaxCalls",void 0),U(this,"asyncEvents",void 0),U(this,"currentEvent",void 0),U(this,"responseQueue",void 0),U(this,"requestsPendingCounter",void 0),U(this,"suppressErrors",void 0),U(this,"requestTimeoutCancel",void 0),U(this,"requestTimeoutPoll",void 0),U(this,"requestTimeoutPing",void 0),U(this,"backgroundJobPollingSupport",void 0),U(this,"reconnector",void 0),U(this,"processingEvents",void 0),U(this,"adapterExportEnabled",void 0),U(this,"requestSequenceNo",void 0),U(this,"ajaxCallOptions",void 0),U(this,"rootAdapter",void 0),U(this,"root",void 0),U(this,"widget",void 0),U(this,"$entryPoint",void 0),U(this,"_adapterDataCache",void 0),U(this,"_busy",void 0),U(this,"_busyIndicator",void 0),U(this,"_busyIndicatorTimeoutId",void 0),U(this,"_deferredEventTypes",void 0),U(this,"_deferred",void 0),U(this,"_fatalMessagesOnScreen",void 0),U(this,"_retryRequest",void 0),U(this,"_queuedRequest",void 0),U(this,"_asyncDelay",void 0),U(this,"_sendTimeoutId",void 0),this.$entryPoint=null,this.partId="0",this.url=new Et,this.userAgent=new sh({deviceType:F.get().type,touch:F.get().supportsOnlyTouch(),standalone:F.get().isStandalone()}),this.locale=new ti,this.textMap=new Vr,this.ready=!1,this.unloading=!1,this.unloaded=!1,this.loggedOut=!1,this.inspector=!1,this.persistent=!1,this.offline=!1,this.inDevelopmentMode=!1,this.desktop=null,this.layoutValidator=new nh,this.focusManager=null,this.keyStrokeManager=null,this.uiSessionId=null,this.clientSessionId=this._getClientSessionIdFromStorage(),this.forceNewClientSession=!1,this.remoteUrl="json",this.unloadUrl="unload",this.modelAdapterRegistry={},this.ajaxCalls=[],this.asyncEvents=[],this.currentEvent=null,this.responseQueue=new Fo(this),this.requestsPendingCounter=0,this.suppressErrors=!1,this.requestTimeoutCancel=5e3,this.requestTimeoutPoll=75e3,this.requestTimeoutPing=5e3,this.backgroundJobPollingSupport=new Qd(!0),this.reconnector=new ih(this),this.processingEvents=!1,this.adapterExportEnabled=!1,this._adapterDataCache={},this._busy=!1,this._busyIndicator=null,this._busyIndicatorTimeoutId=null,this._deferred=null,this._fatalMessagesOnScreen={},this._retryRequest=null,this._queuedRequest=null,this.requestSequenceNo=0,this.rootAdapter=new He,this.ajaxCallOptions=null,this.rootAdapter.init({session:this,id:"1",objectType:"RootAdapter"});let e=new Hl;e.session=this,e.initialized=!0,this.root=this.rootAdapter.createWidget({session:this,id:"1",objectType:"NullWidget"},e),this.widget=this.root}init(e){let t=e||{};if(!t.$entryPoint)throw new Error("$entryPoint is not defined");this.$entryPoint=t.$entryPoint,this.partId=u.nvl(t.portletPartId,this.partId),this.forceNewClientSession=u.nvl(this.url.getParameter("forceNewClientSession"),t.forceNewClientSession),this.forceNewClientSession?this.clientSessionId=null:this.clientSessionId=u.nvl(t.clientSessionId,this.clientSessionId),this.userAgent=u.nvl(t.userAgent,this.userAgent),this.suppressErrors=u.nvl(t.suppressErrors,this.suppressErrors),t.locale&&(this.locale=ti.ensure(t.locale),this.textMap=Ce.get(this.locale.languageTag)),t.backgroundJobPollingEnabled===!1&&(this.backgroundJobPollingSupport.enabled=!1),a().extend(this.reconnector,t.reconnectorOptions),this.ajaxCallOptions=t.ajaxCallOptions,(this.url.getParameter("debug")==="true"||this.url.getParameter("inspector")==="true")&&(this.inspector=!0),this.url.getParameter("adapterExportEnabled")==="true"&&(this.adapterExportEnabled=!0),this.focusManager=new vh({session:this,active:t.focusManagerActive}),this.keyStrokeManager=u.create(mh,{session:this})}_throwError(e){if(!this.suppressErrors)throw new Error(e)}unregisterModelAdapter(e){delete this.modelAdapterRegistry[e.id]}registerModelAdapter(e){if(e.id===void 0)throw new Error("modelAdapter.id must be defined");this.modelAdapterRegistry[e.id]=e}getModelAdapter(e){return this.modelAdapterRegistry[e]}getWidget(e){if(!e)return null;if(typeof e!="string")throw new Error("typeof adapterId must be string");let t=this.getModelAdapter(e);return t?t.widget:null}getOrCreateWidget(e,t,r){if(!e)return null;if(typeof e!="string")throw new Error("typeof adapterId must be string");let s=this.getWidget(e);if(s)return s;let o=this._getAdapterData(e);if(!o){if(u.nvl(r,!0))throw new Error("no adapterData found for adapterId="+e);return null}return this.createModelAdapter(o).createWidget(o,t)}createModelAdapter(e){let t=e.objectType,r={},s=zr.parse(t);s.modelVariant?(t=s.objectType.toString()+"Adapter"+$t.MODEL_VARIANT_SEPARATOR+s.modelVariant.toString(),r.variantLenient=!0):t=s.objectType.toString()+"Adapter";let o={id:e.id,session:this},n=u.create(t,o,r);return a().log.isTraceEnabled()&&a().log.trace("created new adapter "+n),n}sendEvent(e,t){t=t||0,this.asyncEvents=this._coalesceEvents(this.asyncEvents,e),this.asyncEvents.push(e),this._asyncDelay=Math.min(t,u.nvl(this._asyncDelay,t)),clearTimeout(this._sendTimeoutId),this._sendTimeoutId=setTimeout(()=>{this._sendTimeoutId=null,this._asyncDelay=null,!this.areRequestsPending()&&this._sendNow()},this._asyncDelay)}_sendStartupRequest(){let e=this._newRequest({startup:!0});this.partId&&(e.partId=this.partId),this.clientSessionId&&(e.clientSessionId=this.clientSessionId),ie.get().version&&(e.version=ie.get().version),e.userAgent=this.userAgent,e.sessionStartupParams=this._createSessionStartupParams();let t=this.defaultAjaxOptions(e);return a().ajax(t).catch(s.bind(this)).then(r.bind(this));function r(o){if(this._processStartupResponse(o),o.error)return a().rejectedPromise(o)}function s(o,n,l){this._processErrorResponse(o,n,l,e);for(var d=arguments.length,h=new Array(d>3?d-3:0),p=3;p<d;p++)h[p-3]=arguments[p];return a().rejectedPromise(o,n,l,...h)}}_createSessionStartupParams(){let e={url:this.url.baseUrlRaw,geolocationServiceAvailable:F.get().supportsGeolocation()},t=this.url.parameterMap;for(let r in t)e[r]=t[r];return e}_processStartupResponse(e){if(e.error&&this._processErrorJsonResponse(e.error))return;if(Pe.removeItemFromSessionStorage("scout:versionMismatch"),!e.startupData)throw new Error("Missing startupData");if(this.persistent=e.startupData.persistent,this.inDevelopmentMode=!!e.startupData.inDevelopmentMode,this.clientSessionId=e.startupData.clientSessionId,this._storeClientSessionIdInStorage(this.clientSessionId),this.uiSessionId=e.startupData.uiSessionId,a()(window).on("beforeunload."+this.uiSessionId,this._onWindowBeforeUnload.bind(this)).on("unload."+this.uiSessionId,this._onWindowUnload.bind(this)),e.startupData.reloadPage){u.reloadPage();return}e.startupData.inspector&&(this.inspector=!0),this.requestTimeoutPoll=(e.startupData.pollingInterval+15)*1e3,this.modelAdapterRegistry[this.uiSessionId]=this,e.adapterData&&this._copyAdapterData(e.adapterData),this.locale=new ti(e.startupData.locale),this.textMap=Ce.get(this.locale.languageTag),this.textMap.addAll(e.startupData.textMap);let t=this._getAdapterData(e.startupData.clientSession);this.desktop=this.getOrCreateWidget(t.desktop,this.rootAdapter.widget),ie.get()._triggerDesktopReady(this.desktop);let r=function(){if(this._renderDesktop(),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}this.layoutValidator.validate(),this.focusManager.validateFocus(),this._resumeBackgroundJobPolling(),this.ready=!0,ie.get()._triggerSessionReady(this),a().log.isInfoEnabled()&&a().log.info("Session initialized. Detected "+F.get()),a().log.isDebugEnabled()&&(a().log.isDebugEnabled()&&a().log.debug("size of _adapterDataCache after session has been initialized: "+v.countOwnProperties(this._adapterDataCache)),a().log.isDebugEnabled()&&a().log.debug("size of modelAdapterRegistry after session has been initialized: "+v.countOwnProperties(this.modelAdapterRegistry)))}.bind(this);this.render(r)}_storeClientSessionIdInStorage(e){let t="scout:clientSessionId";Pe.removeItemFromSessionStorage(t),Pe.removeItemFromLocalStorage(t),this.persistent?Pe.setItemToLocalStorage(t,e):Pe.setItemToSessionStorage(t,e)}_getClientSessionIdFromStorage(){let e="scout:clientSessionId",t=Pe.getItemFromSessionStorage(e);return t||(t=Pe.getItemFromLocalStorage(e)),t}render(e){vt.loadingComplete?e():vt.preloader().then(e)}_sendUnloadRequest(){let e=this._newRequest({unload:!0,showBusyIndicator:!1});this._sendRequest(e)}_sendNow(){if(this.asyncEvents.length===0)return;let e=[];this.asyncEvents.some((r,s)=>r.newRequest&&e.length>0?!0:(e.push(r),!1));let t=this._newRequest({events:e});t.showBusyIndicator=t.events.some(r=>u.nvl(r.showBusyIndicator,!0)),this.responseQueue.prepareRequest(t),this._sendRequest(t),this.asyncEvents=this.asyncEvents.slice(e.length)}_coalesceEvents(e,t){if(!t.coalesce)return e;let r=a().negate(t.coalesce).bind(t);return e.filter(r)}_sendRequest(e){if(!e||this.loggedOut)return;if(this.offline&&!e.unload){this._handleSendWhenOffline(e);return}if(e.unload&&navigator.sendBeacon){navigator.sendBeacon(this.unloadUrl+"/"+this.uiSessionId,"");return}let t=this.defaultAjaxOptions(e),r=u.nvl(e.showBusyIndicator,!0);e.unload&&(t.async=!1),this._performUserAjaxRequest(t,r,e)}_handleSendWhenOffline(e){!e.events||(this._queuedRequest?this._queuedRequest.events?(e.events.forEach(t=>{this._queuedRequest.events=this._coalesceEvents(this._queuedRequest.events,t)}),this._queuedRequest.events=this._queuedRequest.events.concat(e.events)):this._queuedRequest.events=e.events:this._queuedRequest=e,this.layoutValidator.validate())}defaultAjaxOptions(e){e=e||this._newRequest();let r={type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",cache:!1,url:this._decorateUrl(this.remoteUrl,e),data:this._requestToJson(e)};return r.timeout=0,e.cancel&&(r.timeout=this.requestTimeoutCancel),e.ping&&(r.timeout=this.requestTimeoutPing),e.pollForBackgroundJobs&&(r.timeout=this.requestTimeoutPoll),r}_decorateUrl(e,t){let r=null;return t.unload?r="unload":t.pollForBackgroundJobs?r="poll":t.ping?r="ping":t.cancel?r="cancel":t.log?r="log":t.syncResponseQueue&&(r="sync"),r&&(e=new Et(e).addParameter(r).toString()),e}_getRequestName(e,t){if(e){if(e.unload)return"unload";if(e.pollForBackgroundJobs)return"pollForBackgroundJobs";if(e.ping)return"ping";if(e.cancel)return"cancel";if(e.log)return"log";if(e.syncResponseQueue)return"syncResponseQueue"}return t}_requestToJson(e){return JSON.stringify(e,function(t,r){return this===e&&t==="showBusyIndicator"||this instanceof jl&&u.isOneOf(t,"showBusyIndicator","coalesce","newRequest")?void 0:r})}_callAjax(e){let t={retryIntervals:[100,500,500,500]},r=u.create(Is,a().extend(t,e,this.ajaxCallOptions),{ensureUniqueId:!1});return this.registerAjaxCall(r),r.call().always(this.unregisterAjaxCall.bind(this,r))}_performUserAjaxRequest(e,t,r){t&&this.setBusy(!0),this.setRequestPending(!0);let s=null,o=!1;this._callAjax({ajaxOptions:e,name:this._getRequestName(r,"user request")}).done(n.bind(this)).fail(l.bind(this)).always(d.bind(this));function n(h){try{t&&!this.areBusyIndicatedEventsQueued()&&this.setBusy(!1),o=this.responseQueue.process(h)}catch(p){s=s||p}}function l(h){try{t&&this.setBusy(!1),this._processErrorResponse(h.jqXHR,h.textStatus,h.errorThrown,r)}catch(p){s=s||p}}function d(h,p,m){if(this.setRequestPending(!1),o){if(this._resumeBackgroundJobPolling(),this._fireRequestFinished(h),this._retryRequest){let g=this._retryRequest;this._retryRequest=null,this.responseQueue.prepareRequest(g),this._sendRequest(g)}else if(this._queuedRequest){let g=this._queuedRequest;this._queuedRequest=null,this.responseQueue.prepareRequest(g),this._sendRequest(g)}this._sendTimeoutId||this._sendNow()}else this.setBusy(!1);if(this.layoutValidator.validate(),s)throw s}}registerAjaxCall(e){this.ajaxCalls.push(e)}unregisterAjaxCall(e){f.remove(this.ajaxCalls,e)}interruptAllAjaxCalls(){this.ajaxCalls.slice().forEach(e=>e.pendingCall&&e.pendingCall.abort())}abortAllAjaxCalls(){this.ajaxCalls.slice().forEach(e=>e.abort())}_resumeBackgroundJobPolling(){this.backgroundJobPollingSupport.enabled&&this.backgroundJobPollingSupport.status!==Gi.RUNNING&&(a().log.isInfoEnabled()&&a().log.info("Resume background jobs polling request, status was="+this.backgroundJobPollingSupport.status),this._pollForBackgroundJobs())}_pollForBackgroundJobs(){this.backgroundJobPollingSupport.setRunning();let e=this._newRequest({pollForBackgroundJobs:!0});this.responseQueue.prepareRequest(e);let t=this.defaultAjaxOptions(e);this._callAjax({ajaxOptions:t,name:this._getRequestName(e,"request")}).done(r.bind(this)).fail(s.bind(this));function r(o){if(o.error)a().log.warn("Polling request failed. Interrupt polling until the next user-initiated request succeeds"),this.backgroundJobPollingSupport.setFailed(),this.areRequestsPending()?this.responseQueue.add(o):this.responseQueue.process(o);else if(o.sessionTerminated)a().log.info("Session terminated, stopped polling for background jobs"),this.backgroundJobPollingSupport.setStopped(),!this.loggedOut&&o.redirectUrl&&this.logout(o.redirectUrl);else try{this.areRequestsPending()?this.responseQueue.add(o):(this.responseQueue.process(o),this.layoutValidator.validate()),setTimeout(this._pollForBackgroundJobs.bind(this))}catch(n){throw this.backgroundJobPollingSupport.setFailed(),n}}function s(o){this.backgroundJobPollingSupport.setFailed(),this._processErrorResponse(o.jqXHR,o.textStatus,o.errorThrown,e)}}processJsonResponseInternal(e){let t=!0;return e.error&&(t=!this._processErrorJsonResponse(e.error)),t&&this._processSuccessResponse(e),t}_processSuccessResponse(e){if(e.adapterData&&this._copyAdapterData(e.adapterData),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}if(a().log.isDebugEnabled()){let t=v.countOwnProperties(this._adapterDataCache);a().log.trace("size of _adapterDataCache after response has been processed: "+t),t=v.countOwnProperties(this.modelAdapterRegistry),a().log.trace("size of modelAdapterRegistry after response has been processed: "+t)}}_copyAdapterData(e){let t=0,r;for(r in e)this._adapterDataCache[r]=e[r],t++;t>0&&a().log.isTraceEnabled()&&a().log.trace("Stored "+t+" properties in adapterDataCache")}_processErrorResponse(e,t,r,s){if(a().log.error("errorResponse: status="+e.status+", textStatus="+t+", errorThrown="+r),Is.isOfflineError(e,t,r)){if(this.ready){this.goOffline(),s&&!s.pollForBackgroundJobs&&!this._retryRequest&&(this._retryRequest=s);return}r=r||this.optText("ui.ConnectionInterrupted","Connection interrupted")}let n={header:this.optText("ui.NetworkError","Network error"),body:y.join(" ",e.status+""||"",r),yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:()=>u.reloadPage(),iconId:ve.SLIPPERY};this.showFatalMessage(n,e.status+".net")}_processErrorJsonResponse(e){let t=!0;if(e.code===ci.JsonResponseError.VERSION_MISMATCH){if(!Pe.getItemFromSessionStorage("scout:versionMismatch"))return Pe.setItemToSessionStorage("scout:versionMismatch","yes"),u.reloadPage(),t;Pe.removeItemFromSessionStorage("scout:versionMismatch")}if(this.loggedOut)return t;let r={header:this.optText("ui.ServerError","Server error")+" ("+this.optText("ui.ErrorCodeX","Code "+e.code,e.code+"")+")",body:e.message,yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:()=>{u.reloadPage()}};return e.code===ci.JsonResponseError.STARTUP_FAILED?(r.header=e.message,r.body=null,r.yesButtonText="Retry",r.iconId=ve.SLIPPERY):e.code===ci.JsonResponseError.SESSION_TIMEOUT?(r.header=this.optText("ui.SessionTimeout",r.header),r.body=this.optText("ui.SessionExpiredMsg",r.body),r.iconId=ve.HOURGLASS):e.code===ci.JsonResponseError.UI_PROCESSING?(r.header=this.optText("ui.UnexpectedProblem",r.header),r.body=y.join(`

`,this.optText("ui.InternalProcessingErrorMsg",r.body," ("+this.optText("ui.ErrorCodeX","Code 20","20")+")"),this.optText("ui.UiInconsistentMsg","")),r.iconId=ve.SLIPPERY,this.inDevelopmentMode&&(r.noButtonText=this.optText("ui.Ignore","Ignore"))):e.code===ci.JsonResponseError.UNSAFE_UPLOAD?(r.header=this.optText("ui.UnsafeUpload",r.header),r.body=this.optText("ui.UnsafeUploadMsg",r.body),r.yesButtonText=this.optText("ui.Ok","Ok"),t=!1):e.code===ci.JsonResponseError.REJECTED_UPLOAD&&(r.header=this.optText("ui.RejectedUpload",r.header),r.body=this.optText("ui.RejectedUploadMsg",r.body),r.yesButtonText=this.optText("ui.Ok","Ok"),t=!1),this.showFatalMessage(r,e.code+""),t}_fireRequestFinished(e){if(!!this._deferred){if(e.events)for(let t=0;t<e.events.length;t++)this._deferredEventTypes.push(e.events[t].type);this.requestsPendingCounter===0&&(this._deferred.resolve(this._deferredEventTypes),this._deferred=null,this._deferredEventTypes=null)}}showFatalMessage(e,t){if(t||(t=ie.get().errorHandler.getJsErrorCode()),this._fatalMessagesOnScreen[t])return;this._fatalMessagesOnScreen[t]=!0,e=e||{};let r={session:this,parent:this.desktop||new Hl,iconId:e.iconId,severity:u.nvl(e.severity,E.Severity.ERROR),header:e.header,body:e.body,hiddenText:e.hiddenText,yesButtonText:e.yesButtonText,noButtonText:e.noButtonText,cancelButtonText:e.cancelButtonText},s=u.create(Ti,r),o=e.entryPoint||this.$entryPoint;s.on("action",n=>{delete this._fatalMessagesOnScreen[t],s.destroy();let l=n.option;l===Ti.Buttons.YES&&e.yesButtonAction?e.yesButtonAction.apply(this):l===Ti.Buttons.NO&&e.noButtonAction?e.noButtonAction.apply(this):l===Ti.Buttons.CANCEL&&e.cancelButtonAction&&e.cancelButtonAction.apply(this)}),s.render(o)}isFatalMessageShown(){return Object.keys(this._fatalMessagesOnScreen).length>0}uploadFiles(e,t,r,s,o){let n=new FormData,l=[];if(r&&a().each(r,(p,m)=>{n.append(p,m)}),a().each(t,(p,m)=>{if(!o||o.length===0||u.isOneOf(m.type,o)){let g=u.nvl(m.scoutName,m.name,ci.EMPTY_UPLOAD_FILENAME);n.append("files",m,g),l.push(m)}}),s=u.nvl(s,wi.DEFAULT_MAXIMUM_UPLOAD_SIZE),!Yr.validateMaximumUploadSize(l,s)){let p={header:this.text("ui.FileSizeLimitTitle"),body:this.text("ui.FileSizeLimit",s/1024/1024+""),yesButtonText:this.optText("Ok","Ok")};return this.showFatalMessage(p),!1}let d={type:"POST",url:"upload/"+this.uiSessionId+"/"+e.id,cache:!1,processData:!1,contentType:!1,data:n};this.responseQueue.prepareHttpRequest(d);let h=!this.areRequestsPending();return this._performUserAjaxRequest(d,h),!0}goOffline(){this.offline||(this.offline=!0,this.abortAllAjaxCalls(),setTimeout(()=>{this.unloading||this.unloaded||(this.rootAdapter.goOffline(),this.reconnector.start())},100))}goOnline(){this.offline=!1,this.rootAdapter.goOnline();let e=this._newRequest({syncResponseQueue:!0});this.responseQueue.prepareRequest(e),this._sendRequest(e)}onReconnecting(){this.desktop&&this.desktop.onReconnecting()}onReconnectingSucceeded(){this.desktop&&this.desktop.onReconnectingSucceeded(),this.goOnline()}onReconnectingFailed(){this.desktop&&this.desktop.onReconnectingFailed()}listen(){return this._deferred||(this._deferred=a().Deferred(),this._deferredEventTypes=[]),this._deferred}onRequestsDone(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.areRequestsPending()||this.areEventsQueued()?this.listen().done(o):e.apply(this,r);function o(){e.apply(this,r)}}onEventsProcessed(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.processingEvents?this.one("eventsProcessed",o):o();function o(){e.apply(this,r)}}areEventsQueued(){return this.asyncEvents.length>0}areBusyIndicatedEventsQueued(){return this.asyncEvents.some(e=>u.nvl(e.showBusyIndicator,!0))}areResponsesQueued(){return this.responseQueue.size()>0}areRequestsPending(){return this.requestsPendingCounter>0}setRequestPending(e){e?this.requestsPendingCounter++:this.requestsPendingCounter--,this.inspector&&this.$entryPoint.toggleAttr("data-request-pending",e,"true")}setBusy(e){e?(this._busy||this._renderBusy(),this._busy=!0):(this._busy&&this._removeBusy(),this._busy=!1)}_renderBusy(){this._busyIndicatorTimeoutId!==null&&this._busyIndicatorTimeoutId!==void 0||(this._busyIndicatorTimeoutId=setTimeout(()=>{this._busyIndicator||!this.desktop||!this.desktop.rendered||(this._busyIndicator=u.create(Zd,{parent:this.desktop}),this._busyIndicator.on("cancel",this._onCancelProcessing.bind(this)),this._busyIndicator.render(this.$entryPoint))},500))}_removeBusy(){clearTimeout(this._busyIndicatorTimeoutId),this._busyIndicatorTimeoutId=null,this._busyIndicator&&(this._busyIndicator.destroy(),this._busyIndicator=null)}_onCancelProcessing(e){let t=this._busyIndicator;!t||(t.off("cancel"),setTimeout(()=>{t.cancelled()},100),this._sendCancelRequest())}_sendCancelRequest(){let e=this._newRequest({cancel:!0,showBusyIndicator:!1});this._sendRequest(e)}sendLogRequest(e,t){let r=this._newRequest({log:!0,message:e,level:u.nvl(t,je.ERROR)});this.currentEvent&&(r.event={target:this.currentEvent.target,type:this.currentEvent.type}),a().ajax(this.defaultAjaxOptions(r))}_newRequest(e){let t=a().extend({uiSessionId:this.uiSessionId},e);return!t.log&&!t.syncResponseQueue&&(t["#"]=this.requestSequenceNo++),t}_processEvents(e){let t=0;for(;t<e.length;){let r=e[t];this.currentEvent=r;let s=this.getModelAdapter(r.target);if(!s){a().log.isDebugEnabled()&&a().log.debug("Postponing '"+r.type+"' for adapter with ID "+r.target),t++;continue}e.splice(t,1),t=0,a().log.isDebugEnabled()&&a().log.debug("Processing event '"+r.type+"' for adapter with ID "+r.target),s.onModelEvent(r),s.resetEventFilters()}if(this.currentEvent=null,e.length)throw new Error("Could not resolve event targets: ["+e.map(r=>{let s="target: "+r.target+", type: "+r.type;return r.properties&&(s+=", properties: "+Object.keys(r.properties)),'"'+s+'"'},this).join(", ")+"]");this.trigger("eventsProcessed")}start(){return a().log.isInfoEnabled()&&a().log.info("Session starting..."),this._sendStartupRequest()}onModelEvent(e){e.type==="localeChanged"?this._onLocaleChanged(e):e.type==="logout"?this._onLogout(e):e.type==="disposeAdapter"?this._onDisposeAdapter(e):e.type==="reloadPage"?this._onReloadPage(e):a().log.warn('Model action "'+e.type+'" is not supported by UI session')}resetEventFilters(){}destroy(){}exportAdapterData(e){return e}_onLocaleChanged(e){let t=new ti(e.locale),r=new Vr(e.textMap);this.switchLocale(t,r)}switchLocale(e,t){u.assertParameter("locale",e,ti),this.locale=e,this.textMap=Ce.get(e.languageTag),t&&v.copyOwnProperties(t,this.textMap),this.trigger("localeSwitch",{locale:this.locale})}_renderDesktop(){this.desktop.render(this.$entryPoint),this.desktop.invalidateLayoutTree(!1)}_onLogout(e){this.logout(e.redirectUrl)}logout(e){if(this.loggedOut=!0,this.forceNewClientSession)this.desktop.$container.window(!0).close();else{let t=new Et;t.removeParameter("dl"),t.removeParameter("i"),Pe.setItemToSessionStorage("scout:loginUrl",t.toString()),setTimeout(()=>{u.reloadPage({redirectUrl:e})})}}_onDisposeAdapter(e){let t=this.getModelAdapter(e.adapter);t&&t.destroy()}_onReloadPage(e){u.reloadPage({clearBody:!1})}_onWindowBeforeUnload(e){a().log.isInfoEnabled()&&a().log.info("Session before unloading..."),this.unloading=!0,setTimeout(()=>{this.unloading=!1},200)}_onWindowUnload(){a().log.isInfoEnabled()&&a().log.info("Session unloading..."),this.unloaded=!0,this.desktop&&this.desktop.formController&&this.desktop.formController.closePopupWindows(),this.loggedOut||this._sendUnloadRequest(),this.loggedOut&&this.persistent&&Pe.removeItemFromLocalStorage("scout:clientSessionId")}_getAdapterData(e){let t=this._adapterDataCache[e];return!this.adapterExportEnabled&&delete this._adapterDataCache[e],t}getAdapterData(e){return this._adapterDataCache[e]}text(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return this.textMap.get(e,...r)}optText(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];return this.textMap.optGet(e,t,...s)}textExists(e){return this.textMap.exists(e)}}U(ci,"JsonResponseError",{STARTUP_FAILED:5,SESSION_TIMEOUT:10,UI_PROCESSING:20,UNSAFE_UPLOAD:30,REJECTED_UPLOAD:31,VERSION_MISMATCH:40}),U(ci,"EMPTY_UPLOAD_FILENAME","*empty*");function rh(i,e,t){return e=zv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zv(i){var e=Gv(i,"string");return typeof e=="symbol"?e:String(e)}function Gv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sh{constructor(e){if(rh(this,"deviceType",void 0),rh(this,"touch",void 0),rh(this,"standalone",void 0),e=e||{},!e.deviceType)throw new Error("deviceType needs to be defined");this.deviceType=e.deviceType,this.touch=u.nvl(e.touch,!1),this.standalone=u.nvl(e.standalone,!1)}}function Uv(i,e,t){return e=qv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qv(i){var e=Yv(i,"string");return typeof e=="symbol"?e:String(e)}function Yv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class oh{constructor(){Uv(this,"filters",void 0),this.filters=[]}addFilter(e){this.filters.push(e)}addFilterForEventType(e){this.filters.push(t=>t.type===e)}filter(e){return this.filters.some(t=>t(e))}reset(){this.filters=[]}}function gm(i,e,t){return e=jv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jv(i){var e=Xv(i,"string");return typeof e=="symbol"?e:String(e)}function Xv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class A{constructor(e,t){gm(this,"width",void 0),gm(this,"height",void 0),e instanceof A?(this.width=e.width,this.height=e.height):(this.width=e||0,this.height=t||0)}toString(){return"Dimension[width="+this.width+" height="+this.height+"]"}equals(e){return e?this.width===e.width&&this.height===e.height:!1}clone(){return new A(this.width,this.height)}subtract(e){return new A(this.width-e.horizontal(),this.height-e.vertical())}add(e){return new A(this.width+e.horizontal(),this.height+e.vertical())}floor(){return new A(Math.floor(this.width),Math.floor(this.height))}ceil(){return new A(Math.ceil(this.width),Math.ceil(this.height))}}function Xl(i,e,t){return e=Jv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Jv(i){var e=Qv(i,"string");return typeof e=="symbol"?e:String(e)}function Qv(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qe{constructor(e,t,r,s){Xl(this,"top",void 0),Xl(this,"right",void 0),Xl(this,"bottom",void 0),Xl(this,"left",void 0),e instanceof qe?(this.top=e.top,this.right=e.right,this.bottom=e.bottom,this.left=e.left):(this.top=e||0,this.right=t||0,this.bottom=r||0,this.left=s||0)}toString(){return"Insets[top="+this.top+" right="+this.right+" bottom="+this.bottom+" left="+this.left+"]"}equals(e){return this.top===e.top&&this.right===e.right&&this.bottom===e.bottom&&this.left===e.left}clone(){return new qe(this.top,this.right,this.bottom,this.left)}horizontal(){return this.right+this.left}vertical(){return this.top+this.bottom}floor(){return new qe(Math.floor(this.top),Math.floor(this.right),Math.floor(this.bottom),Math.floor(this.left))}ceil(){return new qe(Math.ceil(this.top),Math.ceil(this.right),Math.ceil(this.bottom),Math.ceil(this.left))}}function _m(i,e,t){return e=Zv(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Zv(i){var e=ew(i,"string");return typeof e=="symbol"?e:String(e)}function ew(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Z{constructor(e,t){_m(this,"x",void 0),_m(this,"y",void 0),e instanceof Z?(this.x=e.x,this.y=e.y):(this.x=e||0,this.y=t||0)}toString(){return"Point[x="+this.x+" y="+this.y+"]"}equals(e){return e?this.x===e.x&&this.y===e.y:!1}clone(){return new Z(this.x,this.y)}add(e){return new Z(this.x+e.x,this.y+e.y)}subtract(e){return new Z(this.x-e.x,this.y-e.y)}floor(){return new Z(Math.floor(this.x),Math.floor(this.y))}ceil(){return new Z(Math.ceil(this.x),Math.ceil(this.y))}}function Jl(i,e,t){return e=tw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tw(i){var e=iw(i,"string");return typeof e=="symbol"?e:String(e)}function iw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class re{constructor(e,t,r,s){Jl(this,"x",void 0),Jl(this,"y",void 0),Jl(this,"width",void 0),Jl(this,"height",void 0),e instanceof re?(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height):(this.x=e||0,this.y=t||0,this.width=r||0,this.height=s||0)}toString(){return"Rectangle[x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"}equals(e){return e?this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height:!1}clone(){return new re(this.x,this.y,this.width,this.height)}center(){return new Z(this.x+this.width/2,this.y+this.height/2)}right(){return this.x+this.width}bottom(){return this.y+this.height}contains(e,t){return t>=this.y&&t<this.y+this.height&&e>=this.x&&e<this.x+this.width}intersects(e){return e?e.width>0&&e.height>0&&this.width>0&&this.height>0&&e.x<this.right()&&e.right()>this.x&&e.y<this.bottom()&&e.bottom()>this.y:!1}subtract(e){return new re(this.x+e.left,this.y+e.top,this.width-e.horizontal(),this.height-e.vertical())}subtractFromDimension(e){return new re(this.x,this.y,this.width-e.horizontal(),this.height-e.vertical())}translate(e,t){return new re(this.x+e,this.y+t,this.width,this.height)}point(){return new Z(this.x,this.y)}dimension(){return new A(this.width,this.height)}union(e){let t=this.width,r=this.height;if(t<0||r<0)return new re(e.x,e.y,e.width,e.height);let s=e.width,o=e.height;if(s<0||o<0)return new re(this.x,this.y,this.width,this.height);let n=this.x,l=this.y;t+=n,r+=l;let d=e.x,h=e.y;return s+=d,o+=h,n>d&&(n=d),l>h&&(l=h),t<s&&(t=s),r<o&&(r=o),t-=n,r-=l,t>Number.MAX_VALUE&&(t=Number.MAX_VALUE),r>Number.MAX_VALUE&&(r=Number.MAX_VALUE),new re(n,l,t,r)}floor(){return new re(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height))}ceil(){return new re(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.width),Math.ceil(this.height))}}function rw(i,e,t,r,s){let o=e instanceof re?e:new re(e,t,r,s);i.cssLeft(o.x).cssTop(o.y).cssWidth(o.width).cssHeight(o.height)}function sw(i,e,t){let r=e instanceof A?e:new A(e,t);i.cssWidth(r.width).cssHeight(r.height)}function ow(i,e,t){let r=e instanceof Z?e:new Z(e,t);i.cssLeft(r.x).cssTop(r.y)}const w={prefSize(i,e){if(!i[0]||i.isDisplayNone())return new A(0,0);typeof e=="boolean"?e={includeMargin:e}:e=e||{};let t={includeMargin:!1,useCssSize:!1,widthHint:void 0,heightHint:void 0,restoreScrollPositions:!0};if(e=a().extend({},t,e),e.animateClasses&&e.animateClasses.length>0)return w.prefSizeWithoutAnimation(i,e);let r=i.attr("style"),s=i.scrollLeft(),o=i.scrollTop();e.restoreScrollPositions&&x.storeScrollPositions(i);let n=e.useCssSize?"":u.nvl(e.widthHint,"auto"),l=e.useCssSize?"":u.nvl(e.heightHint,"auto"),d={width:n,height:l};u.nvl(e.enforceSizeHints,!1)&&(v.isNumber(n)&&(d["max-width"]=n,d["min-width"]=n),v.isNumber(l)&&(d["max-height"]=l,d["min-height"]=l)),i.css(d);let h=i[0].getBoundingClientRect(),p=new A(h.width,h.height);return e.includeMargin&&(p.width+=i.cssMarginX(),p.height+=i.cssMarginY()),i.attrOrRemove("style",r),i.scrollLeft(s),i.scrollTop(o),e.restoreScrollPositions&&x.restoreScrollPositions(i),w.exactPrefSize(p,e)},exactPrefSize(i,e){return u.nvl(e.exact,!1)||(i.width=Math.ceil(i.width),i.height=Math.ceil(i.height)),i},prefSizeWithoutAnimation(i,e){let t=f.ensure(e.animateClasses);if(t=t.filter(n=>i.hasClass(n)),e=a().extend({},e),e.animateClasses=null,t.length===0)return w.prefSize(i,e);let r=f.format(t," "),s=i.clone().removeClass(r).appendTo(i.parent()),o=w.prefSize(s,e);return s.remove(),o},size(i,e){if(!i[0]||i.isDisplayNone())return new A(0,0);typeof e=="boolean"?e={includeMargin:e}:e=e||{};let t=i[0].getBoundingClientRect(),r=new A(t.width,t.height);return u.nvl(e.includeMargin,!1)&&(r.width+=i.cssMarginX(),r.height+=i.cssMarginY()),u.nvl(e.exact,!1)||(r.width=Math.ceil(r.width),r.height=Math.ceil(r.height)),r},cssSize(i){return new A(i.cssWidth(),i.cssHeight())},cssMaxSize(i){return new A(i.cssMaxWidth(),i.cssMaxHeight())},cssMinSize(i){return new A(i.cssMinWidth(),i.cssMinHeight())},setSize:sw,insets(i,e){let t;typeof e=="boolean"?t={includeMargin:e}:t=e||{};let r,s=["top","right","bottom","left"],o=[0,0,0,0],n=u.nvl(t.includeMargin,!1),l=u.nvl(t.includePadding,!0),d=u.nvl(t.includeBorder,!0);for(r=0;r<s.length;r++)n&&(o[r]+=i.cssPxValue("margin-"+s[r])),l&&(o[r]+=i.cssPxValue("padding-"+s[r])),d&&(o[r]+=i.cssPxValue("border-"+s[r]+"-width"));return new qe(o[0],o[1],o[2],o[3])},margins(i){return w.insets(i,{includeMargin:!0,includePadding:!1,includeBorder:!1})},setMargins(i,e){i.css({marginLeft:e.left,marginRight:e.right,marginTop:e.top,marginBottom:e.bottom})},paddings(i){return w.insets(i,{includeMargin:!1,includePadding:!0,includeBorder:!1})},borders(i){return w.insets(i,{includeMargin:!1,includePadding:!1,includeBorder:!0})},setLocation:ow,location(i){return new Z(i.cssLeft(),i.cssTop())},bounds(i,e){return w._bounds(i,i.position(),e)},position(i){let e=i.position();return new Z(e.left,e.top)},offsetBounds(i,e){return w._bounds(i,i.offset(),e)},offset(i){let e=i.offset();return new Z(e.left,e.top)},_bounds(i,e,t){let r=w.size(i,t);return new re(e.left,e.top,r.width,r.height)},setBounds:rw,cssBounds(i){return new re(i.cssLeft(),i.cssTop(),i.cssWidth(),i.cssHeight())},debugOutput(i){if(!i)return"$comp is undefined";if(i=a().ensure(i),i.length===0)return"$comp doesn	 match any elements";let e="";if(i.attr("id")&&(e+="id="+i.attr("id")),i.attr("class")&&(e+=" class="+i.attr("class")),i.attr("data-modelclass")&&(e+=" data-modelclass="+i.attr("data-modelclass")),e.length===0){let t=u.nvl(i.html(),"");t.length>30&&(t=t.substring(0,30)+"..."),e=t}return i.isAttached()||(e+=" attached=false"),"Element["+e.trim()+"]"}};function ms(i,e,t){return e=nw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nw(i){var e=lw(i,"string");return typeof e=="symbol"?e:String(e)}function lw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}let Ql;class ue extends ir{constructor(){super(),ms(this,"formRowHeight",void 0),ms(this,"formRowGap",void 0),ms(this,"formColumnWidth",void 0),ms(this,"formColumnGap",void 0),ms(this,"smallColumnGap",void 0),ms(this,"fieldLabelWidth",void 0),ms(this,"fieldMandatoryIndicatorWidth",void 0),ms(this,"fieldStatusWidth",void 0),this.formRowHeight=30,this.formRowGap=10,this.formColumnWidth=420,this.formColumnGap=32,this.smallColumnGap=4,this.fieldLabelWidth=140,this.fieldMandatoryIndicatorWidth=8,this.fieldStatusWidth=20}init(e){e=e?" "+e:"",this.formRowHeight=L.getSize("html-env-logical-grid-row"+e,"height","height",this.formRowHeight),this.formRowGap=L.getSize("html-env-logical-grid-row"+e,"margin-bottom","marginBottom",this.formRowGap),this.formColumnWidth=L.getSize("html-env-logical-grid-column"+e,"width","width",this.formColumnWidth),this.formColumnGap=L.getSize("html-env-logical-grid-column"+e,"margin-right","marginRight",this.formColumnGap),this.smallColumnGap=L.getSize("html-env-logical-grid-column"+e,"margin-left","marginLeft",this.smallColumnGap),this.fieldLabelWidth=L.getSize("html-env-field-label"+e,"width","width",this.fieldLabelWidth),this.fieldMandatoryIndicatorWidth=L.getSize("html-env-field-mandatory-indicator"+e,"width","width",this.fieldMandatoryIndicatorWidth),this.fieldStatusWidth=L.getSize("html-env-field-status"+e,"width","width",this.fieldStatusWidth),this.trigger("propertyChange")}static get(){return Ql}}ie.addListener("prepare",()=>{Ql||(Ql=u.create(ue),Ql.init())});function bm(i,e,t){return e=aw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aw(i){var e=dw(i,"string");return typeof e=="symbol"?e:String(e)}function dw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class te{constructor(){bm(this,"animateClasses",void 0),bm(this,"cssClass",void 0),this.animateClasses=[]}invalidate(e){}layout(e){}_revertSizeHintsAdjustments(e,t){let r=S.get(e);t.widthHint&&(t.widthHint+=r.insets().horizontal()),t.heightHint&&(t.heightHint+=r.insets().vertical())}preferredLayoutSize(e,t){return t=a().extend({},t),this.animateClasses.length>0&&(t.animateClasses=this.animateClasses),this._revertSizeHintsAdjustments(e,t),w.prefSize(e,t)}}function fi(i,e,t){return e=hw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hw(i){var e=uw(i,"string");return typeof e=="symbol"?e:String(e)}function uw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class S{constructor(e,t){if(fi(this,"$comp",void 0),fi(this,"layout",void 0),fi(this,"layoutData",void 0),fi(this,"layouted",void 0),fi(this,"layouting",void 0),fi(this,"pixelBasedSizing",void 0),fi(this,"prefSizeCached",void 0),fi(this,"scrollable",void 0),fi(this,"session",void 0),fi(this,"sizeCached",void 0),fi(this,"suppressInvalidate",void 0),fi(this,"suppressValidate",void 0),fi(this,"valid",void 0),fi(this,"validateRoot",void 0),!t)throw new Error("session must be defined for "+this.debug());this.$comp=e,this.layout=new jo,this.layoutData=null,this.valid=!1,this.validateRoot=!1,this.layouted=!1,this.layouting=!1,this.suppressInvalidate=!1,this.suppressValidate=!1,this.pixelBasedSizing=!0,this.sizeCached=null,this.prefSizeCached={},this.session=t,this.scrollable=!1}getParent(){let e=this.$comp.parent();return e.length===0?null:S.optGet(e)}isDescendantOf(e){let t=this.$comp.parent();for(;t.length>0;){if(S.optGet(t)===e)return!0;t=t.parent()}return!1}availableSize(e){e=e||{};let t=this.size({exact:e.exact});if(this.scrollable){let r=this.prefSize({widthHint:t.width,removeMarginFromHints:!1});r.height>t.height&&(t.height=r.height)}return t}invalidateLayout(e){this.valid=!1,this.prefSizeCached={},this.layout&&this.layout.invalidate(e)}validateLayout(){if(!this.layout)throw new Error("Called layout() but component has no layout");return this.valid?!0:this.suppressValidate||this.layouting||!this._checkValidationPossible()?!1:(this.layouting=!0,this.layout.layout(this.$comp),this.layouting=!1,this.layouted=!0,this.sizeCached=this.size({exact:!0}),this.valid=!0,!0)}_checkValidationPossible(){if(!this.isAttachedAndVisible())return!1;if(this.$comp.hasAnimationClass())return this._validateLayoutAfterAnimation(this.$comp),!1;let e=this.getParent();if(!e||!e.layouting){let t=!0,r=null;if(this.$comp.parents().each(function(){let s=a()(this);if(!s.isVisible())return t=!1,!1;if(s.hasAnimationClass())return r=s,!1}),!t)return!1;if(r)return this._validateLayoutAfterAnimation(r),!1}return!0}_validateLayoutAfterAnimation(e){e.oneAnimationEnd(this.validateLayout.bind(this))}revalidateLayout(){this.invalidateLayout(),this.validateLayout()}invalidateLayoutTree(e){this.suppressInvalidate||(u.nvl(e,!0)?this.session.layoutValidator.invalidateTree(this):(this.invalidateLayout(),this.session.layoutValidator.invalidate(this)))}validateLayoutTree(){this.suppressValidate||this.session.layoutValidator.validate()}revalidateLayoutTree(e){this.suppressInvalidate||(this.invalidateLayoutTree(e),this.validateLayoutTree())}isValidateRoot(){return this.validateRoot?!0:!this.layoutData||!this.layoutData.isValidateRoot?!1:this.layoutData.isValidateRoot()}setLayout(e){this.layout=e,e.cssClass&&this.$comp.addClass(e.cssClass)}prefSize(e){if(!this.isVisible())return new A(0,0);typeof e=="boolean"?e={includeMargin:e}:e=a().extend({},e);let t=u.nvl(e.includeMargin,!1);if(e.includeMargin=null,!this.layout)throw new Error("Called prefSize() but component has no layout");let r=this.computePrefSizeKey(e),s=this.prefSizeCached[r];if(!a().isEmptyObject(s))return a().log.isTraceEnabled()&&a().log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSizeCached="+s),t&&(s=s.add(this.margins())),s.clone();let o=this.cssMinSize(),n=this.cssMaxSize();(e.widthHint||e.heightHint)&&this._adjustSizeHintsForPrefSize(e,o,n);let l=this.layout.preferredLayoutSize(this.$comp,e);return this._adjustPrefSizeWithMinMaxSize(l,o,n),this.prefSizeCached[r]=l,a().log.isTraceEnabled()&&a().log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSize="+l),t&&(l=l.add(this.margins())),l.clone()}computePrefSizeKey(e){return"wHint"+u.nvl(e.widthHint,"-1")+"hHint"+u.nvl(e.heightHint,"-1")+"wOnly"+u.nvl(e.widthOnly,"-1")}_adjustSizeHintsForPrefSize(e,t,r){let s=u.nvl(e.removeMarginFromHints,!0),o=u.nvl(e.removeInsetsFromHints,!0);if(e.removeMarginFromHints=null,e.removeInsetsFromHints=null,!e.widthHint&&!e.heightHint)return;let n=s?this.margins():new qe,l=o?this.insets():new qe;e.widthHint&&(e.widthHint-=n.horizontal(),e.widthHint=Math.max(e.widthHint,t.width),e.widthHint=Math.min(e.widthHint,r.width),e.widthHint-=l.horizontal()),e.heightHint&&(e.heightHint-=n.vertical(),e.heightHint=Math.max(e.heightHint,t.height),e.heightHint=Math.min(e.heightHint,r.height),e.heightHint-=l.vertical())}_adjustPrefSizeWithMinMaxSize(e,t,r){t=t||this.cssMinSize(),r=r||this.cssMaxSize(),e.height=Math.max(e.height,t.height),e.height=Math.min(e.height,r.height),e.width=Math.max(e.width,t.width),e.width=Math.min(e.width,r.width)}insets(e){return w.insets(this.$comp,e)}margins(){return w.margins(this.$comp)}borders(){return w.borders(this.$comp)}cssMinSize(){return w.cssMinSize(this.$comp)}cssMaxSize(){return w.cssMaxSize(this.$comp)}size(e){return w.size(this.$comp,e)}setSize(e){if(!this.isAttachedAndVisible())return;let t=this.sizeCached;e.equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&w.setSize(this.$comp,e),this.validateLayout()}bounds(e){return w.bounds(this.$comp,e)}position(){return w.position(this.$comp)}offsetBounds(e){return w.offsetBounds(this.$comp,e)}offset(){return w.offset(this.$comp)}setLocation(e){w.setLocation(this.$comp,e)}location(){return w.location(this.$comp)}setBounds(e){if(!this.isAttachedAndVisible())return;let t=this.sizeCached;e.dimension().equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&w.setBounds(this.$comp,e),this.validateLayout()}pack(){let e=this.prefSize();this.setSize(e)}isAttached(){return this.$comp.isAttached()&&!!this.$comp.window(!0)}isVisible(){return this.$comp.isVisible()}isAttachedAndVisible(){return this.isAttached()&&this.isVisible()}debug(){return w.debugOutput(this.$comp)}static install(e,t){if(!e)throw new Error('Missing argument "$comp"');if(!t)throw new Error('Missing argument "session"');let r=new S(e,t);return e.data("htmlComponent",r),r}static get(e){let t=this.optGet(e);if(!t){let r="";throw e&&(r=`
Class: `+e.attr("class"),r+=`
Id: `+e.attr("id"),r+=`
Attached: `+e.isAttached()),new Error('data "htmlComponent" is undefined.'+r)}return t}static optGet(e){return e&&e.data("htmlComponent")}}const qi={MIN:0,PREF:1,MAX:2,EPS:1e-6};function Zl(i,e,t){return e=cw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cw(i){var e=pw(i,"string");return typeof e=="symbol"?e:String(e)}function pw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class nh{constructor(){Zl(this,"_invalidComponents",void 0),Zl(this,"_validateTimeoutId",void 0),Zl(this,"_postValidateFunctions",void 0),Zl(this,"_suppressValidate",void 0),this._invalidComponents=[],this._validateTimeoutId=null,this._postValidateFunctions=[],this._suppressValidate=!1}invalidateTree(e){let t,r=e,s=e;for(;r;){if(e=r,e.invalidateLayout(s),e.isValidateRoot()){t=e;break}r=e.getParent()}r||(t=e),this.invalidate(t)}invalidate(e){let t=0;if(this._invalidComponents.indexOf(e)>=0){this._scheduleValidation();return}this._invalidComponents.forEach((r,s)=>{r.isDescendantOf(e)||t++},this),f.insert(this._invalidComponents,e,t),this._scheduleValidation()}_scheduleValidation(){this._validateTimeoutId===null&&(F.get().supportsMicrotask()?(this._validateTimeoutId=!0,queueMicrotask(()=>{if(this._validateTimeoutId)try{this.validate()}catch(e){ie.get().errorHandler.handle(e)}})):this._validateTimeoutId=setTimeout(()=>this.validate()))}validate(){F.get().supportsMicrotask()||clearTimeout(this._validateTimeoutId),this._validateTimeoutId=null,!this._suppressValidate&&(this._invalidComponents.slice().forEach(e=>{e.validateLayout()&&f.remove(this._invalidComponents,e)}),this._postValidateFunctions.slice().forEach(e=>{e(),f.remove(this._postValidateFunctions,e)}))}suppressValidate(){this._suppressValidate=!0}unsuppressValidate(){this._suppressValidate=!1,this._scheduleValidation()}cleanupInvalidComponents(e){this._invalidComponents.slice().forEach(t=>{t.$comp.closest(e).length>0&&f.remove(this._invalidComponents,t)})}schedulePostValidateFunction(e){e&&this._postValidateFunctions.push(e)}}function lh(i,e,t){return e=fw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fw(i){var e=mw(i,"string");return typeof e=="symbol"?e:String(e)}function mw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ea{constructor(e){lh(this,"dirty",void 0),lh(this,"gridConfig",void 0),lh(this,"objectType",void 0),e=u.nvl(e,{}),this.dirty=!0,this._setGridConfig(e.gridConfig||null)}setDirty(e){this.dirty=e}setGridConfig(e){this._setGridConfig(e)}_setGridConfig(e){e&&!(e instanceof gs)&&(e=u.create(gs,e)),this.gridConfig=e}validate(e){!this.dirty||(this._validate(e),this.setDirty(!1))}}function gw(i,e,t){return e=_w(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _w(i){var e=bw(i,"string");return typeof e=="symbol"?e:String(e)}function bw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class gs{constructor(){gw(this,"widget",void 0),this.widget=null}setWidget(e){this.widget=e}getGridColumnCount(){return this.widget.gridColumnCount}getGridWidgets(){return this.widget.widgets}}function qt(i,e,t){return e=yw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yw(i){var e=vw(i,"string");return typeof e=="symbol"?e:String(e)}function vw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function ww(i){return i instanceof I}class Nr{constructor(e){qt(this,"fillHorizontal",void 0),qt(this,"fillVertical",void 0),qt(this,"gridh",void 0),qt(this,"gridw",void 0),qt(this,"gridx",void 0),qt(this,"gridy",void 0),qt(this,"heightHint",void 0),qt(this,"horizontalAlignment",void 0),qt(this,"logicalRowHeightAddition",void 0),qt(this,"useUiHeight",void 0),qt(this,"useUiWidth",void 0),qt(this,"verticalAlignment",void 0),qt(this,"weightx",void 0),qt(this,"weighty",void 0),qt(this,"widget",void 0),qt(this,"widthHint",void 0),this.gridx=0,this.gridy=0,this.gridw=1,this.gridh=1,this.weightx=0,this.weighty=0,this.useUiWidth=!1,this.useUiHeight=!1,this.widthHint=0,this.heightHint=0,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,e instanceof Nr?v.copyProperties(e,this):ww(e)&&(this.widget=e)}validate(){if(!this.widget)return;let e=this.widget.gridData;this.gridx=e.x,this.gridy=e.y,this.gridw=e.w,this.gridh=e.h,this.weightx=e.weightX,this.weighty=e.weightY,this.weightx<0&&(this.weightx=Math.max(1,this.gridw)),this.weighty<0&&(this.weighty=this._inheritWeightY()),this.useUiWidth=e.useUiWidth,this.useUiHeight=e.useUiHeight,this.horizontalAlignment=e.horizontalAlignment,this.verticalAlignment=e.verticalAlignment,this.fillHorizontal=e.fillHorizontal,this.fillVertical=e.fillVertical,this.widthHint=e.widthInPixel,this.heightHint=e.heightInPixel,this.widget.labelVisible&&this.widget.$label&&this.widget.labelPosition===M.LabelPosition.TOP?this.logicalRowHeightAddition=w.prefSize(this.widget.$label,!0).height:this.logicalRowHeightAddition=0}_inheritWeightY(){let e=this._inheritWeightYRec(this.widget);if(e===null){let t=this.widget.gridData;t.weightY>=0?e=t.weightY:e=t.h>=2?t.h:0}return e}_inheritWeightYRec(e){let t=!1,r=0;if(e.validateLogicalGrid(),e instanceof xs){let s,o,n,l=e.getFields();for(s=0;s<l.length;s++)if(n=l[s],n.isVisible()){let d=n.gridData;d.weightY<0?(o=this._inheritWeightYRec(n),o!==null&&(t=!0,r+=o)):(t=!0,r+=d.weightY)}}else r=e.gridData.h>=2?e.gridData.h:0,t=!0;return t?r:null}isValidateRoot(){return!this.useUiHeight&&!this.useUiWidth&&this.fillVertical&&this.fillHorizontal}}function nr(i,e,t){return e=Tw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Tw(i){var e=Sw(i,"string");return typeof e=="symbol"?e:String(e)}function Sw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Uo extends te{constructor(e,t){super(),nr(this,"validityBasedOnContainerSize",void 0),nr(this,"valid",void 0),nr(this,"widget",void 0),nr(this,"info",void 0),nr(this,"layoutConfig",void 0),nr(this,"htmlPropertyChangeHandler",void 0),nr(this,"hgap",void 0),nr(this,"vgap",void 0),nr(this,"columnWidth",void 0),nr(this,"rowHeight",void 0),nr(this,"minWidth",void 0),this.cssClass="logical-grid-layout",this.validityBasedOnContainerSize=new A,this.valid=!1,this.widget=e,this.info=null,this._initDefaults(),this.layoutConfig=di.ensure(t||{}),this.layoutConfig.applyToLayout(this),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this.widget.one("remove",()=>{ue.get().off("propertyChange",this.htmlPropertyChangeHandler)})}_initDefaults(){let e=ue.get();this.hgap=e.formColumnGap,this.vgap=e.formRowGap,this.columnWidth=e.formColumnWidth,this.rowHeight=e.formRowHeight,this.minWidth=0}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this.layoutConfig.applyToLayout(this),this.widget.invalidateLayoutTree(),this.widget.invalidateLogicalGrid()}validateLayout(e,t){let r=[],s=[];this.widget.logicalGrid?(this.widget.validateLogicalGrid(),this.widget.logicalGrid.gridConfig.getGridWidgets().forEach(function(n){if(!!n.rendered){if(!n.htmlComp){a().log.isWarnEnabled()&&a().log.warn("(LogicalGridLayout#validateLayout) no htmlComp found, widget cannot be layouted. Widget: "+n);return}o.call(this,n.htmlComp)}},this)):e.children().each((n,l)=>{let d=a()(l),h=S.optGet(d);!h||o.call(this,h)});function o(n){this._validateGridData(n)&&(r.push(n.$comp),s.push(n.layoutData))}this.info=new ah({$components:r,cons:s,hgap:this.hgap,vgap:this.vgap,rowHeight:this.rowHeight,columnWidth:this.columnWidth,widthHint:t.widthHint,widthOnly:t.widthOnly}),a().log.isTraceEnabled()&&a().log.trace("(LogicalGridLayout#validateLayout) $container="+S.get(e).debug())}_validateGridData(e){let t=e.$comp,r=t.data("widget");if(r?r.isVisible():t.isVisible())return e.layoutData.validate(),!0}layout(e){this._layout(e)}_layout(e){let t=S.get(e),r=t.availableSize(),s=t.insets();this.validateLayout(e,{widthHint:r.width-s.horizontal(),heightHint:r.height-s.vertical()}),this.minWidth>0&&r.width<this.minWidth&&(r.width=this.minWidth),a().log.isTraceEnabled()&&a().log.trace("(LogicalGridLayout#layout) container "+t.debug()+" size="+r+" insets="+s);let o=this._layoutCellBounds(r,s),n,l,d,h,p,m,g,b,C,P;for(m=0;m<this.info.$components.length;m++)p=this.info.$components[m],g=S.get(p),b=this.info.gridDatas[m],n=o[b.gridy][b.gridx],l=o[b.gridy+b.gridh-1][b.gridx+b.gridw-1],d=n.union(l),P=g.margins(),d.width-=P.horizontal(),d.height-=P.vertical(),b.fillHorizontal&&b.fillVertical||(h=this.info.compSize[m],!b.fillHorizontal&&h.width<d.width&&(C=d.width-h.width,d.width=h.width,b.horizontalAlignment===0?d.x+=Math.ceil(C/2):b.horizontalAlignment>0&&(d.x+=C)),!b.fillVertical&&h.height<d.height&&(C=d.height-h.height,b.heightHint===0?d.height=h.height:d.height=b.heightHint,b.verticalAlignment===0?d.y+=Math.ceil(C/2):b.verticalAlignment>0&&(d.y+=C))),a().log.isTraceEnabled()&&a().log.trace("(LogicalGridLayout#layout) comp="+g.debug()+" bounds="+d),g.setBounds(d)}_layoutCellBounds(e,t){return this.info.layoutCellBounds(e,t)}preferredLayoutSize(e,t){this.validateLayout(e,t);let r=qi.PREF,s=new A,o,n,l,d=0;for(o=0;o<this.info.cols;o++)n=this.info.width[o][r],d>0&&(s.width+=this.hgap),s.width+=n,d++;for(d=0,o=0;o<this.info.rows;o++)l=this.info.height[o][r],d>0&&(s.height+=this.vgap),s.height+=l,d++;let h=S.get(e).insets();return s.width+=h.horizontal(),s.height+=h.vertical(),s}}function Gn(i,e,t){return e=Cw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Cw(i){var e=Pw(i,"string");return typeof e=="symbol"?e:String(e)}function Pw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class di{constructor(e){Gn(this,"hgap",void 0),Gn(this,"vgap",void 0),Gn(this,"columnWidth",void 0),Gn(this,"rowHeight",void 0),Gn(this,"minWidth",void 0),e=e||{},e.hgap>-1&&(this.hgap=e.hgap),e.vgap>-1&&(this.vgap=e.vgap),e.columnWidth>-1&&(this.columnWidth=e.columnWidth),e.rowHeight>-1&&(this.rowHeight=e.rowHeight),e.minWidth>-1&&(this.minWidth=e.minWidth)}clone(){return new di(this)}applyToLayout(e){e.layoutConfig=this,this.hgap!==null&&this.hgap!==void 0&&(e.hgap=this.hgap),this.vgap!==null&&this.vgap!==void 0&&(e.vgap=this.vgap),this.columnWidth!==null&&this.columnWidth!==void 0&&(e.columnWidth=this.columnWidth),this.rowHeight!==null&&this.rowHeight!==void 0&&(e.rowHeight=this.rowHeight),this.minWidth!==null&&this.minWidth!==void 0&&(e.minWidth=this.minWidth)}static ensure(e){return e?e instanceof di?e:new di(e):null}}function St(i,e,t){return e=xw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xw(i){var e=Fw(i,"string");return typeof e=="symbol"?e:String(e)}function Fw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ah{constructor(e){St(this,"gridDatas",void 0),St(this,"cons",void 0),St(this,"cols",void 0),St(this,"compSize",void 0),St(this,"rows",void 0),St(this,"width",void 0),St(this,"widthHints",void 0),St(this,"height",void 0),St(this,"weightX",void 0),St(this,"weightY",void 0),St(this,"hgap",void 0),St(this,"vgap",void 0),St(this,"rowHeight",void 0),St(this,"columnWidth",void 0),St(this,"cellBounds",void 0),St(this,"widthHint",void 0),St(this,"widthOnly",void 0),St(this,"$components",void 0),this.gridDatas=[],this.$components=null,this.cols=0,this.compSize=[],this.rows=0,this.width=[],this.widthHints=[],this.height=[],this.weightX=[],this.weightY=[],this.hgap=0,this.vgap=0,this.rowHeight=0,this.columnWidth=0,this.cellBounds=[],this.widthHint=null,this.widthOnly=!1,a().extend(this,e);let t,r,s,o;for(t=0;t<this.cons.length;t++)this.gridDatas[t]=new Nr(this.cons[t]);if(this.$components.length===0)return;let n=new Kl,l=new Kl;for(t=0;t<this.gridDatas.length;t++){for(r=this.gridDatas[t],r.gridx<0&&(r.gridx=0),r.gridy<0&&(r.gridy=0),r.gridw<1&&(r.gridw=1),r.gridh<1&&(r.gridh=1),s=r.gridx;s<r.gridx+r.gridw;s++)n.add(s);for(o=r.gridy;o<r.gridy+r.gridh;o++)l.add(o)}let d=n.last();for(s=d;s>=0;s--)if(!n.contains(s))for(t=0;t<this.gridDatas.length;t++)r=this.gridDatas[t],r.gridx>s&&r.gridx--;let h=l.last();for(o=h;o>=0;o--)if(!l.contains(o))for(t=0;t<this.gridDatas.length;t++)r=this.gridDatas[t],r.gridy>o&&r.gridy--;this.cols=n.size(),this.rows=l.size(),a().log.isTraceEnabled()&&a().log.trace("(LogicalGridLayoutInfo#CTOR) $components.length="+this.$components.length+" usedCols="+this.cols+" usedRows="+this.rows),this._initializeInfo()}_initializeInfo(){let e=this.$components.length,t=[];for(let r=0;r<e;r++){let s=this.$components[r],o=this.gridDatas[r];o.gridx<0&&(o.gridx=0),o.gridy<0&&(o.gridy=0),o.gridw<1&&(o.gridw=1),o.gridh<1&&(o.gridh=1),o.gridx>=this.cols&&(o.gridx=this.cols-1),o.gridy>=this.rows&&(o.gridy=this.rows-1),o.gridx+o.gridw-1>=this.cols&&(o.gridw=this.cols-o.gridx),o.gridy+o.gridh>=this.rows&&(o.gridh=this.rows-o.gridy);let n=new A(0,0);o.widthHint>0?n.width=o.widthHint:(o.useUiWidth||!o.fillHorizontal)&&(n=this.uiSizeInPixel(s)),o.heightHint>0?n.height=o.heightHint:(o.useUiHeight||!o.fillVertical)&&t.push({cons:o,$comp:s,index:r}),this.compSize[r]=n}if(this._initializeColumns(),this.widthOnly){this.height=f.init(this.rows,[0,0,0]);return}if(this.widthHint&&t.length>0){let r=Math.max(0,(this.cols-1)*this.hgap);this.widthHints=this.layoutSizes(this.widthHint-r,this.width,this.weightX)}t.forEach(function(r){let s=r.$comp,o=r.cons,n=this.widthHintForGridData(o);o.fillHorizontal||(n=Math.min(n,this.compSize[r.index].width)),this.compSize[r.index]=this.uiSizeInPixel(s,{widthHint:n})},this),this._initializeRows()}_initializeColumns(){let e=this.compSize,t=e.length,r=f.init(this.cols,0),s=f.init(this.cols,!1),o,n,l,d,h;for(o=0;o<t;o++)if(h=this.gridDatas[o],h.gridw===1)for(h.widthHint>0?d=h.widthHint:h.useUiWidth?d=e[o].width:d=this.logicalWidthInPixel(h),d=Math.floor(d),n=h.gridx;n<h.gridx+h.gridw&&n<this.cols;n++)r[n]=Math.max(r[n],d),h.weightx===0&&(s[n]=!0);for(o=0;o<t;o++)if(h=this.gridDatas[o],h.gridw>1){let g=h.gridw,b=0,C;for(n=h.gridx;n<h.gridx+h.gridw&&n<this.cols;n++)s[n]||(b+=r[n]);if(h.widthHint>0?C=h.widthHint-b-(g-1)*this.hgap:h.useUiWidth?C=e[o].width-b-(g-1)*this.hgap:C=this.logicalWidthInPixel(h)-b-(g-1)*this.hgap,C>0){let P=Math.floor((C+b)/g),R=(C+b)%g,k=-1;for(n=h.gridx;n<h.gridx+h.gridw&&n<this.cols;n++)k=n,s[n]||(r[n]=Math.max(P,r[n])),h.weightx===0&&(s[n]=!0);k>-1&&(r[k]+=R)}}let p=qi;for(o=0;o<this.cols;o++)this.width[o]=[],s[o]?(this.width[o][p.MIN]=r[o],this.width[o][p.PREF]=r[o],this.width[o][p.MAX]=r[o]):(this.width[o][p.MIN]=0,this.width[o][p.PREF]=r[o],this.width[o][p.MAX]=10240);for(o=0;o<this.cols;o++)if(s[o])this.weightX[o]=0;else{let g=0,b=0;for(l=0;l<t;l++)h=this.gridDatas[l],h.weightx>0&&h.gridx<=o&&o<=h.gridx+h.gridw-1&&(g+=h.weightx/h.gridw,b++);this.weightX[o]=b>0?g/b:0}let m=0;for(o=0;o<this.cols;o++)m+=this.weightX[o];if(m>=1e-6){let g=1/m;for(o=0;o<this.cols;o++)this.weightX[o]=this.weightX[o]*g}}_initializeRows(){let e=this.compSize,t=e.length,r=f.init(this.rows,0),s=f.init(this.rows,!1),o,n,l,d,h;for(o=0;o<t;o++)if(h=this.gridDatas[o],h.gridh===1)for(h.heightHint>0?d=h.heightHint:h.useUiHeight?d=e[o].height:d=this.logicalHeightInPixel(h),d=Math.floor(d),n=h.gridy;n<h.gridy+h.gridh&&n<this.rows;n++)r[n]=Math.max(r[n],d),h.weighty===0&&(s[n]=!0);for(o=0;o<t;o++)if(h=this.gridDatas[o],h.gridh>1){let g=h.gridh,b=0,C;for(n=h.gridy;n<h.gridy+h.gridh&&n<this.rows;n++)s[n]||(b+=r[n]);if(h.heightHint>0?C=h.heightHint-b-(g-1)*this.vgap:h.useUiHeight?C=e[o].height-b-(g-1)*this.vgap:C=this.logicalHeightInPixel(h)-b-(g-1)*this.vgap,C>0){let P=Math.floor((C+b)/g),R=(C+b)%g,k=-1;for(n=h.gridy;n<h.gridy+h.gridh&&n<this.rows;n++)k=n,s[n]||(r[n]=Math.max(P,r[n])),h.weighty===0&&(s[n]=!0);k>-1&&(r[k]+=R)}}let p=qi;for(o=0;o<this.rows;o++)this.height[o]=[],s[o]?(this.height[o][p.MIN]=r[o],this.height[o][p.PREF]=r[o],this.height[o][p.MAX]=r[o]):(this.height[o][p.MIN]=0,this.height[o][p.PREF]=r[o],this.height[o][p.MAX]=10240);for(o=0;o<this.rows;o++)if(s[o])this.weightY[o]=0;else{let g=0,b=0;for(l=0;l<t;l++)h=this.gridDatas[l],h.weighty>0&&h.gridy<=o&&o<=h.gridy+h.gridh-1&&(g+=h.weighty/h.gridh,b++);this.weightY[o]=b>0?g/b:0}let m=0;for(o=0;o<this.rows;o++)m+=this.weightY[o];if(m>=1e-6){let g=1/m;for(o=0;o<this.rows;o++)this.weightY[o]=this.weightY[o]*g}}layoutCellBounds(e,t){let r=this.layoutSizes(e.width-t.horizontal()-Math.max(0,(this.cols-1)*this.hgap),this.width,this.weightX),s=this.layoutSizes(e.height-t.vertical()-Math.max(0,(this.rows-1)*this.vgap),this.height,this.weightY);this.cellBounds=f.init(this.rows,null);let o=t.top,n,l,d;for(n=0;n<this.rows;n++){for(l=t.left,this.cellBounds[n]=f.init(this.cols,null),d=0;d<this.cols;d++)this.cellBounds[n][d]=new re(l,o,r[d],s[n]),l+=r[d],l+=this.hgap;o+=s[n],o+=this.vgap}return this.cellBounds}layoutSizes(e,t,r){let s=f.init(t.length,0);if(e<=0){for(let h=0;h<t.length;h++)s[h]=t[h][qi.MIN];return s}let o=0,n=f.init(r.length,0),l=0;for(let h=0;h<t.length;h++)s[h]=t[h][qi.PREF],o+=s[h],n[h]=r[h],n[h]<qi.EPS&&(t[h][qi.MAX]>t[h][qi.MIN]?n[h]=1:n[h]=0),l+=n[h];if(l>0)for(let h=0;h<n.length;h++)n[h]=n[h]/l;let d=e-o;if(Math.abs(d)>0){let h=f.init(n.length,0),p;if(d>0)for(p=!0;d>0&&p;){p=!1;for(let m=0;m<s.length&&d>0;m++)n[m]>0&&s[m]<t[m][qi.MAX]&&(p=!0,h[m]+=n[m],h[m]>0&&(h[m]-=1,s[m]+=1,d-=1))}else for(p=!0;d<0&&p;){p=!1;for(let m=0;m<s.length&&d<0;m++)n[m]>0&&s[m]>t[m][qi.MIN]&&(p=!0,h[m]+=n[m],h[m]>0&&(h[m]-=1,s[m]-=1,d+=1))}}return s}logicalWidthInPixel(e){let t=e.gridw;return this.columnWidth*t+this.hgap*Math.max(0,t-1)}logicalHeightInPixel(e){let t=e.gridh,r=e.logicalRowHeightAddition||0;return this.rowHeight*t+this.vgap*Math.max(0,t-1)+r}uiSizeInPixel(e,t){let r=S.get(e);return r.prefSize(t).add(r.margins())}widthHintForGridData(e){if(this.widthHints.length===0)return null;let t=(e.gridw-1)*this.hgap;for(let r=e.gridx;r<e.gridx+e.gridw;r++)t+=this.widthHints[r];return t}}function ym(i,e,t){return e=Ew(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ew(i){var e=Aw(i,"string");return typeof e=="symbol"?e:String(e)}function Aw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qo extends ea{constructor(e){super(e),ym(this,"gridRows",void 0),ym(this,"gridColumns",void 0),this.gridRows=0,this.gridColumns=0}_validate(e){this.gridRows=0,this.gridConfig.setWidget(e),this.gridColumns=this.gridConfig.getGridColumnCount();let t=0,r=0,s=[];this.gridConfig.getGridWidgets().forEach(o=>{if(o.isVisible()){s.push(o);let n=o.gridDataHints;n&&n.x>=0&&n.y>=0?t++:r++}else o.gridData=ze.createFromHints(o,1)}),t>0&&r===0?this.layoutAllStatic(s):this.layoutAllDynamic(s)}layoutAllStatic(e){let t=[];e.forEach(o=>{t.push(ze.createFromHints(o,1))});let r=t.reduce((o,n)=>{let l=n.x+n.w;return l>o?l:o},1),s=t.reduce((o,n)=>{let l=n.y+n.h;return l>o?l:o},0);e.forEach(o=>{o.gridData=ze.createFromHints(o,r)}),this.gridRows=s,this.gridColumns=r}layoutAllDynamic(e){}getGridColumnCount(){return this.gridColumns}getGridRowCount(){return this.gridRows}static getGridDataFromHints(e,t){let r=ze.createFromHints(e,t);return r.w=Math.min(t,r.w),r}}class Ks extends qo{layoutAllDynamic(e){let t=new hh(this.getGridColumnCount());t.computeGridData(e),this.gridRows=t.getRowCount()}}class dh extends qo{layoutAllDynamic(e){let t=0;e.forEach(o=>{let n=qo.getGridDataFromHints(o,this.getGridColumnCount());t+=n.w*n.h});let r=Math.floor((t+this.getGridColumnCount()-1)/this.getGridColumnCount()),s=new Fl(this.getGridColumnCount(),r);for(;!s.computeGridData(e);)s.resetAll(this.getGridColumnCount(),++r);e.forEach(o=>{o.gridData=s.getGridData(o)}),this.gridRows=s.getRowCount()}}function vm(i,e,t){return e=Dw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Dw(i){var e=Mw(i,"string");return typeof e=="symbol"?e:String(e)}function Mw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ta{constructor(e){vm(this,"_cursor",void 0),vm(this,"_assignedCells",void 0),this._cursor=e,this._assignedCells=[]}getColumnCount(){return this._cursor.columnCount}getRowCount(){return this._cursor.rowCount}_setAssignedCell(e,t){this._assignedCells[e.x]||(this._assignedCells[e.x]=[]),this._assignedCells[e.x][e.y]=t}_getAssignedCell(e){return this._assignedCells[e.x]?this._assignedCells[e.x][e.y]:null}_nextFree(e,t){if(!this._cursor.increment())return!1;let r=this._cursor.currentIndex();return this._isAllCellFree(r.x,r.y,e,t)?!0:(this._getAssignedCell(r)||this._setAssignedCell(r,new Yo),this._nextFree(e,t))}_isAllCellFree(e,t,r,s){return e+r>this._cursor.startX+this._cursor.columnCount||t+s>this._cursor.startY+this._cursor.rowCount?!1:this._assignedCells.slice(e,e+r).every(o=>(o||[]).slice(t,t+s).every(n=>!n))}toString(){let e="----Group Box Grid Matrix [orientation="+this._cursor.orientation+", columnCount="+this.getColumnCount()+", rowCount="+this.getRowCount()+`]--------------
`,t=new Hi(0,0,this.getColumnCount(),this.getRowCount(),this._cursor.orientation);for(;t.increment();){let r=this._getAssignedCell(t.currentIndex());e+="cell["+t.currentIndex().x+", "+t.currentIndex().y+"] ",r?r.widget?e+=r.widget+(r.widget?", ["+r.widget.label+"]":""):e+="Placeholder":e+="NULL",e+=`
`}return e}}function wm(i,e,t){return e=$w(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $w(i){var e=Rw(i,"string");return typeof e=="symbol"?e:String(e)}function Rw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Yo{constructor(e,t){wm(this,"widget",void 0),wm(this,"data",void 0),this.widget=e,this.data=t}isEmpty(){return!this.widget}}function zs(i,e,t){return e=Lw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Lw(i){var e=Iw(i,"string");return typeof e=="symbol"?e:String(e)}function Iw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Hi{constructor(e,t,r,s,o){zs(this,"startX",void 0),zs(this,"startY",void 0),zs(this,"columnCount",void 0),zs(this,"rowCount",void 0),zs(this,"orientation",void 0),zs(this,"_currentIndex",void 0),this.startX=e,this.startY=t,this.columnCount=r,this.rowCount=s,this.orientation=o,this.reset()}reset(){this._currentIndex=new Z(-1,-1)}currentIndex(){return new Z(this._currentIndex.x,this._currentIndex.y)}increment(){return this._currentIndex.x<0||this._currentIndex.y<0?(this._currentIndex.x=this.startX,this._currentIndex.y=this.startY):this.orientation===Hi.Orientation.HORIZONTAL?(this._currentIndex.x++,this._currentIndex.x>=this.startX+this.columnCount&&(this._currentIndex.x=this.startX,this._currentIndex.y++)):(this._currentIndex.y++,this._currentIndex.y>=this.startY+this.rowCount&&(this._currentIndex.y=this.startY,this._currentIndex.x++)),!(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount)}decrement(){return!(this._currentIndex.x<0||this._currentIndex.y<0||(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount?(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y=this.startY+this.rowCount-1):this.orientation===Hi.Orientation.HORIZONTAL?(this._currentIndex.x--,this._currentIndex.x<this.startX&&(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y--)):(this._currentIndex.y--,this._currentIndex.y<this.startY&&(this._currentIndex.y=this.startY+this.rowCount-1,this._currentIndex.x--)),this._currentIndex.x<this.startX||this._currentIndex.y<this.startY))}toString(){let e=[];return e.push("MatrixCursor ["),e.push("orientation="+this.orientation),e.push(", startX="+this.startX),e.push(", startY="+this.startY),e.push(", columnCount="+this.columnCount),e.push(", currentIndex="+this._currentIndex.x+", "+this._currentIndex.y),e.push("]"),e.join("")}}zs(Hi,"Orientation",{HORIZONTAL:0,VERTICAL:1});function kw(i,e,t){return e=Bw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Bw(i){var e=Ow(i,"string");return typeof e=="symbol"?e:String(e)}function Ow(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hh extends ta{constructor(e){super(new Hi(0,0,e,Number.MAX_SAFE_INTEGER,Hi.Orientation.HORIZONTAL)),kw(this,"rowCount",void 0),this.rowCount=0}computeGridData(e){return e.forEach(t=>{let r=ze.createFromHints(t,this.getColumnCount()),s=new ze(r);s.w=Math.min(r.w,this.getColumnCount()),this._add(t,r,s),t.gridData=s}),this._cursor.rowCount=this.rowCount,!0}_add(e,t,r){this._nextFree(r.w,r.h);let s=this._cursor.currentIndex();if(r.w<=this.getColumnCount()-s.x){r.x=s.x,r.y=s.y;for(let o=s.x;o<s.x+r.w;o++)for(let n=s.y;n<s.y+r.h;n++)this._setAssignedCell(new Z(o,n),new Yo(e,r));this.rowCount=s.y+r.h}else this._setAssignedCell(this._cursor.currentIndex(),new Yo),this._add(e,t,r)}}function uh(i,e,t){return e=Hw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Hw(i){var e=Nw(i,"string");return typeof e=="symbol"?e:String(e)}function Nw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fl extends ta{constructor(e,t,r,s){super(new Hi(r||0,s||0,e,t,Hi.Orientation.VERTICAL)),uh(this,"_widgets",void 0),uh(this,"_widgetGridDatas",void 0),uh(this,"_widgetIndexes",void 0),this._widgets=[],this._widgetGridDatas=[],this._widgetIndexes=[]}resetAll(e,t){this._widgetGridDatas=[],this._assignedCells=[],this._widgetIndexes=[],this._cursor=new Hi(this._cursor.startX,this._cursor.startY,e,t,Hi.Orientation.VERTICAL)}computeGridData(e){return this._widgets=e,e.every((t,r)=>(this._widgetGridDatas[r]=qo.getGridDataFromHints(t,this._cursor.columnCount),this._add(t,this._widgetGridDatas[r])))}getGridData(e){return this._widgetGridDatas[this._widgets.indexOf(e)]}_addAssignedCells(e){e.forEach((t,r)=>{t&&t.forEach((s,o)=>{s&&this._setAssignedCell(new Z(r,o),s)})})}_getAssignedCells(){return this._assignedCells}_add(e,t){let r=this._cursor.currentIndex();if(t.w>1){let s=r.x,o=r.y;for(;s+t.w>this._cursor.startX+this._cursor.columnCount;)s--,o=this._cursor.rowCount-1;this._reorganizeGridAbove(s,o,t.w)}if(!this._nextFree(t.w,t.h))return!1;r=this._cursor.currentIndex(),t.x=r.x,t.y=r.y;for(let s=r.x;s<r.x+t.w;s++)for(let o=r.y;o<r.y+t.h;o++)this._setAssignedCell(new Z(s,o),new Yo(e,t));return!0}_reorganizeGridAbove(e,t,r){let s=[],o=b=>{s.indexOf(b)===-1&&s.push(b)},n=[],l=(b,C,P)=>{n[b]||(n[b]=[]),n[b][C]=P},d={x:e,y:0,w:r,h:t+1},h=t,p=0,m=!0;for(let b=t;b>=0&&m;b--)for(let C=e;C<e+r&&m;C++){let P=new Z(C,b),R=this._getAssignedCell(P);if(R&&!R.isEmpty()){let k=R.data;this._horizontalMatchesOrOverlaps(d,k)?m=!1:this._horizontalOverlapsOnSide(d,k)?(l(P.x,P.y,R),p++,h=Math.min(P.y,h)):(this._setAssignedCell(P,null),o(R.widget),p++,h=Math.min(P.y,h))}}if(s.length===0)return;s.sort((b,C)=>this._widgets.indexOf(b)<this._widgets.indexOf(C)?-1:1),d.y=h;let g=new Fl(d.w,Math.floor((p+d.w-1)/d.w),d.x,d.y);for(g._addAssignedCells(n);!g.computeGridData(s);)g.resetAll(g.getColumnCount(),g.getRowCount()+1);this._cursor.reset(),this._addAssignedCells(g._getAssignedCells()),g._widgetGridDatas.forEach((b,C)=>{this._widgetGridDatas[this._widgets.indexOf(g._widgets[C])]=b})}_horizontalMatchesOrOverlaps(e,t){return e.x>=t.x&&e.x+e.w<=t.x+t.w}_horizontalOverlapsOnSide(e,t){return e.x>t.x||e.x+e.w<t.x+t.w}}function Tm(i,e,t){return e=Vw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Vw(i){var e=Ww(i,"string");return typeof e=="symbol"?e:String(e)}function Ww(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ch extends te{constructor(e){super(),Tm(this,"stretch",void 0),Tm(this,"useCssWidth",void 0),e=e||{},this.stretch=u.nvl(e.stretch,!0),this.useCssWidth=u.nvl(e.useCssWidth,!1)}_getChildren(e){return e.children()}layout(e){let t=S.get(e),r=t.availableSize().subtract(t.insets());this._getChildren(e).each((s,o)=>{let n=a()(o),l=S.optGet(n);if(!l||!n.isVisible())return;let d=l.prefSize({useCssSize:!0});this.stretch&&(d.height=r.height-l.margins().vertical()),l.layoutData&&l.layoutData.widthHint&&(d.width=l.layoutData.widthHint),this.useCssWidth?(l.$comp.cssHeight(d.height),l.revalidateLayout()):l.setSize(d)})}preferredLayoutSize(e,t){let r=new A,s=S.get(e),o={useCssSize:!0};return this._getChildren(e).each((n,l)=>{let d=a()(l),h=S.optGet(d);if(!h||!d.isVisible())return;let p=h.prefSize(o);h.layoutData&&h.layoutData.widthHint&&(p.width=h.layoutData.widthHint),p=p.add(h.margins()),r.width=r.width+p.width,r.height=Math.max(r.height,p.height)}),r=r.add(s.insets()),r}}class jo extends te{layout(e){e.children().each(function(){let t=S.optGet(a()(this));t&&t.revalidateLayout()})}}function Sm(i,e,t){return e=Kw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Kw(i){var e=zw(i,"string");return typeof e=="symbol"?e:String(e)}function zw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ri extends te{constructor(e){super(),Sm(this,"stretch",void 0),Sm(this,"pixelBasedSizing",void 0),e=e||{},this.pixelBasedSizing=u.nvl(e.pixelBasedSizing,!0),this.stretch=u.nvl(e.stretch,!0)}_getChildren(e){return e.children()}layout(e){let t=S.get(e),r=t.availableSize().subtract(t.insets());this._getChildren(e).each((s,o)=>{let n=a()(o),l=S.optGet(n);if(!l||!n.isVisible())return;if(!this.pixelBasedSizing){l.validateLayout();return}let d=l.prefSize({widthHint:r.width});this.stretch&&(d.width=r.width-l.margins().horizontal()),l.setSize(d)})}preferredLayoutSize(e,t){let r=new A,s=S.get(e),o=0;return this._getChildren(e).each((n,l)=>{let d=a()(l),h=S.optGet(d);if(!h||!d.isVisible())return;let p=h.prefSize(t).add(h.margins());o=Math.max(p.width,o),r.height+=p.height,r.width=o}),r=r.add(s.insets()),r}}function Cm(i,e,t){return e=Gw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Gw(i){var e=Uw(i,"string");return typeof e=="symbol"?e:String(e)}function Uw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cr extends te{constructor(e,t){super(),Cm(this,"exact",void 0),Cm(this,"_htmlChild",void 0),this._htmlChild=e,t=t||{},this.exact=u.nvl(t.exact,!1)}layout(e){let t=S.get(e),r=t.availableSize({exact:this.exact}).subtract(t.insets()),s=this._htmlChild;s||(s=this._getHtmlSingleChild(e)),s&&s.setSize(r)}preferredLayoutSize(e,t){let r=this._htmlChild;return r||(r=this._getHtmlSingleChild(e)),r?r.prefSize(t).add(w.insets(e)):new A(1,1)}_getHtmlSingleChild(e){let t=null;return e.children().each((r,s)=>{let o=S.optGet(a()(s));if(o)return t=o,!1}),t}}function Un(i,e,t){return e=qw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qw(i){var e=Yw(i,"string");return typeof e=="symbol"?e:String(e)}function Yw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ls extends te{constructor(e,t){super(),Un(this,"childrenLayoutDatas",void 0),Un(this,"cacheKey",void 0),Un(this,"_getDimensionValue",void 0),Un(this,"_layoutFromLayoutData",void 0),this.childrenLayoutDatas=[],this.cacheKey=null,this.setCacheKey(t),e===ls.Direction.ROW?(this.preferredLayoutSize=this.preferredLayoutSizeRow,this._getDimensionValue=this._getWidth,this._layoutFromLayoutData=this._layoutFromLayoutDataRow):(this.preferredLayoutSize=this.preferredLayoutSizeColumn,this._getDimensionValue=this._getHeight,this._layoutFromLayoutData=this._layoutFromLayoutDataColumn)}setCacheKey(e){this.cacheKey=e,this.cacheKey&&this.cacheKey.length>0&&this.cacheKey.unshift("scout.flexboxLayout")}_readCache(e){if(!this.cacheKey||this.cacheKey.length===0||e<2)return;let t=this.cacheKey.slice(),r=Pe.getItemFromLocalStorage(t[0]),s=1,o;for(t.push(""+e),r&&(o=JSON.parse(r));o&&s<t.length;)o=o[t[s]],s++;return o}_writeCache(e,t){if(!this.cacheKey||this.cacheKey.length===0||e<2)return;let r=this.cacheKey.slice(),s=Pe.getItemFromLocalStorage(r[0]),o=1,n,l;for(r.push(""+e),s?n=JSON.parse(s):n={},l=n;o<r.length-1;)l[r[o]]||(l[r[o]]={}),l=l[r[o]],o++;l[r[o]]=t,Pe.setItemToLocalStorage(r[0],JSON.stringify(n))}_computeCacheKey(e){if(!(!this.cacheKey||e<2))return this.cacheKey+"-"+e}layout(e){let t=this._getChildren(e),r=S.get(e),s=r.availableSize({exact:!0}),o;s=s.subtract(r.insets()),o=t.filter(n=>n.layoutData.diff)[0],o?this._layoutDelta(t,o,s):this._layoutComponents(t,s)}_getChildren(e){let t=[];return e.children().each(function(){let r=S.optGet(a()(this));r&&t.push(r)}),t=t.sort((r,s)=>(r.layoutData.order||0)-(s.layoutData.order||0)),t}reset(){this.childrenLayoutDatas.forEach(e=>{e.sizePx=0,e.initialPx=0,e.diff=null}),this.childrenLayoutDatas=[]}_layoutDelta(e,t,r){this.ensureInitialValues(e,r);let s=t.layoutData.diff,o=e.slice(0,e.indexOf(t)).reverse(),n=e.slice(e.indexOf(t)+1),l,d;l=h(o,s,!1),d=-h(n,-s,!1),s=Math.sign(s)*Math.min(Math.abs(s-l),Math.abs(s-d)),s!==0&&(h(o,s,!0),h(n,-s,!0)),this._layoutFromLayoutDataWithCache(e,r);function h(p,m,g){return p.reduce((b,C)=>(b!==0&&(b=C.layoutData.acceptDelta(b,g)),b),m)}}_layoutComponents(e,t){let r=this.ensureInitialValues(e,t);r<0?this._adjust(e,r,s=>s.shrink):r>0&&this._adjust(e,r,s=>s.grow),this._layoutFromLayoutDataWithCache(e,t)}_adjust(e,t,r){let s,o,n=e.map(l=>l.layoutData).filter(l=>l.acceptDelta(Math.sign(t))===0);n.length<1||(s=n.reduce((l,d)=>l+r(d),0),o=t/s,t=n.reduce((l,d)=>d.acceptDelta(o*r(d),!0),t),Math.abs(t)>.2&&this._adjust(e,t,r))}_getPreferredSize(e){return e.prefSize({useCssSize:!0}).add(e.margins())}ensureInitialValues(e,t){let r=this._getDimensionValue(t),s=0,o=0,n=e.map(h=>h.layoutData),l=this._readCache(e.length)||[];e.forEach((h,p)=>{let m=h.layoutData;m.sizePx?s+=m.sizePx:m.initial<0?(m.initialPx=this._getDimensionValue(this._getPreferredSize(h)),s+=m.initialPx):m.relative?o+=m.initial:(m.initialPx=m.initial,s+=m.initialPx)});let d=(r-s)/o;return n.filter(h=>h.relative&&h.initial>-1&&!h.sizePx).reduce((h,p)=>(p.initialPx=Math.max(30,d*p.initial),h-p.initialPx),r-s),n.reduce((h,p,m)=>(p.sizePx||(l[m]?p.sizePx=p.validate(Math.round(r*l[m])):p.sizePx=p.initialPx),this.childrenLayoutDatas.push(p),h-p.sizePx),r)}_layoutFromLayoutDataWithCache(e,t){this._cacheSizes(e,t),this._layoutFromLayoutData(e,t)}_cacheSizes(e,t){let r=this._getDimensionValue(t),s=e.map(o=>o.layoutData.sizePx/r);this._writeCache(e.length,s)}preferredLayoutSizeColumn(e,t){return this._getChildren(e).reduce((r,s)=>{let o=this._getPreferredSize(s);return r.width=Math.max(o.width,r.width),r.height+=o.height,r},new A(0,0))}preferredLayoutSizeRow(e,t){return this._getChildren(e).reduce((r,s)=>{let o=this._getPreferredSize(s);return r.height=Math.max(o.height,r.height),r.width+=o.width,r},new A(0,0))}_getWidth(e){return e.width}_getHeight(e){return e.height}_layoutFromLayoutDataRow(e,t){e.reduce((r,s)=>{let o=s.margins(),n=s.insets(),l=s.layoutData.sizePx,d=new re(r-n.left-o.left,0,l+n.left+n.right,t.height);return s.setBounds(d),r+l},0)}_layoutFromLayoutDataColumn(e,t){e.reduce((r,s)=>{let o=s.margins(),n=s.insets(),l=s.layoutData.sizePx,d=new re(0,r-n.top-o.top,t.width,l+n.top+n.bottom);return s.setBounds(d),r+l},0)}}Un(ls,"Direction",{COLUMN:0,ROW:1});function _s(i,e,t){return e=jw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jw(i){var e=Xw(i,"string");return typeof e=="symbol"?e:String(e)}function Xw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ks{constructor(e){_s(this,"grow",void 0),_s(this,"initial",void 0),_s(this,"order",void 0),_s(this,"relative",void 0),_s(this,"shrink",void 0),_s(this,"sizePx",void 0),_s(this,"initialPx",void 0),_s(this,"diff",void 0),this.relative=!0,this.grow=1,this.shrink=1,this.initial=1,this.order=0,a().extend(this,e),this.sizePx=null,this.initialPx=null,this.diff=null}withOrder(e){return this.order=e,this}acceptDelta(e,t){return e>0?this._grow(e,t):this._shrink(e,t)}validate(e){return this.grow===0&&(e=Math.min(this.initialPx,e)),this.shrink===0&&(e=Math.max(this.initialPx,e)),e}_grow(e,t){let r=0,s=0;return this.grow>0?r=e:this.initialPx>this.sizePx&&(r=this.initialPx-this.sizePx),s=Math.min(e,r),t&&(this.sizePx=this.sizePx+s),e-s}_shrink(e,t){let r=0,s=0;return this.shrink>0?r=-this.sizePx+20:this.initialPx<this.sizePx&&(r=this.initialPx-this.sizePx),s=Math.max(e,r),t&&(this.sizePx=this.sizePx+s),e-s}static fixed(e){let t=new ks;return t.relative=!1,t.initial=e||-1,t.grow=0,t.shrink=0,t}}function Gs(i,e,t){return e=Jw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Jw(i){var e=Qw(i,"string");return typeof e=="symbol"?e:String(e)}function Qw(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wo{constructor(){Gs(this,"tabBox",void 0),Gs(this,"tabArea",void 0),Gs(this,"_viewAddHandler",void 0),Gs(this,"_viewRemoveHandler",void 0),Gs(this,"_viewActivateHandler",void 0),Gs(this,"_viewDeactivateHandler",void 0),Gs(this,"_viewTabSelectHandler",void 0),this.tabBox=null,this._viewAddHandler=this._onViewAdd.bind(this),this._viewRemoveHandler=this._onViewRemove.bind(this),this._viewActivateHandler=this._onViewActivate.bind(this),this._viewDeactivateHandler=this._onViewDeactivate.bind(this),this.tabArea=null,this._viewTabSelectHandler=this._onViewTabSelect.bind(this)}init(e){a().extend(this,e)}install(e,t){this.uninstall(),this.tabBox=u.assertParameter("tabBox",e),this.tabArea=u.nvl(t,this.tabBox.tabArea),this.tabArea||(this.tabArea=this.createTabArea()),this._installListeners()}uninstall(){this._uninstallListeners()}_installListeners(){this.tabBox.on("viewAdd",this._viewAddHandler),this.tabBox.on("viewRemove",this._viewRemoveHandler),this.tabBox.on("viewActivate",this._viewActivateHandler),this.tabBox.on("viewDeactivate",this._viewDeactivateHandler),this.tabArea.on("tabSelect",this._viewTabSelectHandler)}_uninstallListeners(){this.tabBox&&(this.tabBox.off("viewAdd",this._viewAddHandler),this.tabBox.off("viewRemove",this._viewRemoveHandler),this.tabBox.off("viewActivate",this._viewActivateHandler),this.tabBox.off("viewDeactivate",this._viewDeactivateHandler)),this.tabArea&&this.tabArea.off("tabSelect",this._viewTabSelectHandler)}createTabArea(){return u.create(Ni,{parent:this.tabBox})}_onViewAdd(e){let t=e.view;if(!wo.hasViewTab(t))return;let r=this.getTab(t);if(!r&&this._shouldCreateTabForView(t)){let s=e.siblingView,o=this.getTab(s);r=this._createTab(t),this.tabArea.addTab(r,o)}}_shouldCreateTabForView(e){return!0}_onViewRemove(e){let t=e.view;if(!t)return;let r=this.getTab(t);r&&this.tabArea.destroyTab(r)}_onViewActivate(e){let t=this.getTab(e.view);this.tabArea.selectTab(t)}_onViewDeactivate(e){let t=this.getTab(e.view);this.tabArea.deselectTab(t)}_onViewTabSelect(e){if(!e.viewTab)return;let t=e.viewTab.view;this.tabBox.activateView(t)}_createTab(e){return u.create(yd,{parent:this.tabArea,view:e})}getTab(e){if(!e)return;let t=null;return this.tabArea.getTabs().some(r=>r.view===e?(t=r,!0):!1),t}getTabs(){return this.tabArea.getTabs()}static hasViewTab(e){return e&&(!v.isNullOrUndefined(e.title)||!v.isNullOrUndefined(e.subTitle)||!v.isNullOrUndefined(e.iconId))}}function Pr(i,e,t){return e=Zw(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Zw(i){var e=eT(i,"string");return typeof e=="symbol"?e:String(e)}function eT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ia extends I{constructor(){super(),Pr(this,"tabArea",void 0),Pr(this,"viewStack",void 0),Pr(this,"currentView",void 0),Pr(this,"controller",void 0),Pr(this,"layoutData",void 0),Pr(this,"viewContent",void 0),Pr(this,"$viewContent",void 0),Pr(this,"$tabArea",void 0),Pr(this,"_removeViewInProgress",void 0),Pr(this,"_viewDestroyedHandler",void 0),this._addWidgetProperties(["tabArea"]),this.tabArea=null,this.viewStack=[],this.currentView=null,this.controller=null,this._removeViewInProgress=0}_init(e){super._init(e),this.cssClass=e.cssClass,this.controller||(this.controller=u.create(wo)),this.controller.install(this,this.tabArea),this.tabArea=this.controller.tabArea,this._viewDestroyedHandler=this._onViewDestroyed.bind(this)}_render(){this.$container=this.$parent.appendDiv("simple-tab-box"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new ph(this)),this.htmlComp.layoutData=this.layoutData,this.$viewContent=this.$container.appendDiv("tab-content"),this.viewContent=S.install(this.$viewContent,this.session),this.viewContent.setLayout(new fh(this))}_renderProperties(){super._renderProperties(),this._renderTabArea(),this._renderView(this.currentView)}_renderTabArea(){this.tabArea.render(),this.$tabArea=this.tabArea.$container,this.$tabArea.insertBefore(this.$viewContent)}_renderView(e){!e||e.rendered||(e.render(this.$viewContent),e.$container.addClass("view"))}postRender(){this.viewStack.length>0&&!this.currentView&&this.activateView(this.viewStack[this.viewStack.length-1])}activateView(e){e!==this.currentView&&(this.currentView&&(this.currentView.detach(),this.trigger("viewDeactivate",{view:this.currentView}),this.currentView=null),this.rendered&&this._renderView(e),e&&!e.attached&&e.attach(),this.currentView=e,this.trigger("viewActivate",{view:e}),this.rendered&&this.viewContent.invalidateLayoutTree())}setLayoutData(e){super.setLayoutData(e),this.layoutData=e}getLayoutData(){return this.layoutData}addView(e,t){let r=u.nvl(t,!0),s=this._addToViewStack(e,r);e.setTrackFocus(!0),e.setParent(this),this.trigger("viewAdd",{view:e,siblingView:s}),r&&this.activateView(e)}_addToViewStack(e,t){let r,s=this.viewStack.indexOf(e);if(s>-1)return this.viewStack[s-1];if(!wo.hasViewTab(e))return this.viewStack.unshift(e),this._addDestroyListener(e),r;if(!this.currentView||!t)return r=this.viewStack[this.viewStack.length-1],this.viewStack.push(e),this._addDestroyListener(e),r;let o=this.viewStack.indexOf(this.currentView);return r=this.viewStack[o],this.viewStack.splice(o+1,0,e),r}_addDestroyListener(e){e.one("destroy",this._viewDestroyedHandler)}_removeDestroyListener(e){e.off("destroy",this._viewDestroyedHandler)}_onViewDestroyed(e){let t=e.source;f.remove(this.viewStack,t),this.currentView===t&&(this.rendered&&t.remove(),this.currentView=null)}removeView(e,t){if(!e)return;e.setTrackFocus(!1),t=u.nvl(t,!0);let r=this.viewStack.indexOf(e),s;this.currentView===e?this.currentView=null:t=!1,r>-1&&(t&&(r-1>=0?s=this.viewStack[r-1]:r+1<this.viewStack.length&&(s=this.viewStack[r+1])),this.viewStack.splice(r,1),e.rendered&&(this._removeViewInProgress++,e.remove(),this._removeViewInProgress--),this.trigger("viewRemove",{view:e}),this._removeViewInProgress===0&&(s&&this.activateView(s),this.rendered&&this.viewContent.invalidateLayoutTree()))}getController(){return this.controller}viewCount(){return this.viewStack.length}hasViews(){return this.viewStack.length>0}hasView(e){return this.viewStack.filter(t=>t===e).length>0}getViews(e){return this.viewStack.filter(t=>e?e===t.displayViewId:!0)}}function tT(i,e,t){return e=iT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iT(i){var e=rT(i,"string");return typeof e=="symbol"?e:String(e)}function rT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ph extends te{constructor(e){super(),tT(this,"tabBox",void 0),this.tabBox=e}layout(e){let t=S.get(e),r=S.get(this.tabBox.$viewContent),s=t.availableSize({exact:!0}).subtract(t.insets()),o=this._layoutTabArea(s),n=s.subtract(r.margins());n.height-=o.height,r.setSize(n)}_layoutTabArea(e){if(!this.tabBox.rendered)return new A(0,0);let t=S.get(this.tabBox.$tabArea),r=t.prefSize(),s=t.margins(),o=new A(e.width,r.height+s.top+s.bottom);return t.setSize(o),o}preferredLayoutSize(e,t){t=t||{};let r=S.get(e),s=S.get(this.tabBox.$viewContent),o=S.get(this.tabBox.$tabArea),n=new A,l=new A;return t.heightHint=null,o.isVisible()&&(n=o.prefSize().add(o.margins())),l=s.prefSize(t).add(r.insets()).add(s.margins()),new A(Math.max(n.width,l.width),l.height+n.height)}}function sT(i,e,t){return e=oT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function oT(i){var e=nT(i,"string");return typeof e=="symbol"?e:String(e)}function nT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fh extends te{constructor(e){super(),sT(this,"tabBox",void 0),this.tabBox=e}layout(e){let t=this.tabBox.currentView;if(!t||!t.rendered||!t.htmlComp)return;let r=S.get(e),s=r.availableSize({exact:!0}).subtract(r.insets()).subtract(t.htmlComp.margins());t.htmlComp.setSize(s)}preferredLayoutSize(e,t){let r=this.tabBox.currentView;if(!r||!r.rendered||!r.htmlComp)return new A;let s=S.get(e);return r.htmlComp.prefSize().add(s.insets()).add(r.htmlComp.margins())}}const _={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,PRINT_SCREEN:44,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WIN_LEFT:91,WIN_RIGHT:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL_POINT:110,DIVIDE:111,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,DASH:189,COMMA:188,POINT:190,FORWARD_SLASH:191,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222,ANGULAR_BRACKET:226,codesToKeys:{8:"Backspace",9:"Tab",13:"Enter",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSE",20:"Caps lock",27:"Esc",33:"Page up",34:"Page down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",32:"Space",44:"Print screen",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"WIN_LEFT",92:"WIN_RIGHT",93:"SELECT",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",96:"NUMPAD_0",97:"NUMPAD_1",98:"NUMPAD_2",99:"NUMPAD_3",100:"NUMPAD_4",101:"NUMPAD_5",102:"NUMPAD_6",103:"NUMPAD_7",104:"NUMPAD_8",105:"NUMPAD_9",106:"MULTIPLY",107:"+",109:"SUBTRACT",110:"DECIMAL_POINT",111:"/",144:"Num lock",145:"Scroll lock",186:"ü",189:"-",188:",",190:".",191:"§",219:"'",220:"ä",221:"^",222:"ö",226:"<"},browserMap:{[F.Browser.FIREFOX]:{226:60},[F.Browser.SAFARI]:{226:188,ctrl:{226:192}}},browserMapReverse:{},forBrowser:(i,e)=>_.mapKey(_.browserMap,i,e),fromBrowser:i=>_.mapKey(_.browserMapReverse,i),mapKey:(i,e,t)=>{let r=i[F.get().browser];return r&&t&&(r=r[t]),r&&r.hasOwnProperty(e)?r[e]:e}};for(let i in _.browserMap){let e={},t=_.browserMap[i];for(let r in t){let s=t[r];e[s]=parseInt(r,10)}_.browserMapReverse[i]=e}function Us(i,e,t){return e=lT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lT(i){var e=aT(i,"string");return typeof e=="symbol"?e:String(e)}function aT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qn{constructor(e,t){Us(this,"keyStroke",void 0),Us(this,"which",void 0),Us(this,"ctrl",void 0),Us(this,"alt",void 0),Us(this,"shift",void 0),Us(this,"keyStrokeMode",void 0),Us(this,"$drawingArea",void 0),this.keyStroke=e,this.which=t,this.ctrl=e.ctrl,this.alt=e.alt,this.shift=e.shift,this.keyStrokeMode=e.keyStrokeMode}render(e,t){return this.$drawingArea=this.keyStroke.renderKeyBox(e,t),!!this.$drawingArea}remove(){this.keyStroke.removeKeyBox(this.$drawingArea),this.$drawingArea=null}toKeyStrokeString(){let e="";this.ctrl&&(e+="Ctrl-"),this.alt&&(e+="Alt-"),this.shift&&(e+="Shift-");let t=_.codesToKeys[this.which];return t===void 0&&(t=this.which),e+=t,e}}const Se={NONE:0,CTRL:1<<0,CTRL_UNDEFINED:1<<1,SHIFT:1<<2,SHIFT_UNDEFINED:1<<3,ALT:1<<4,ALT_UNDEFINED:1<<5,isCtrl(i){return Se._eval(i,Se.CTRL,Se.CTRL_UNDEFINED)},isShift(i){return Se._eval(i,Se.SHIFT,Se.SHIFT_UNDEFINED)},isAlt(i){return Se._eval(i,Se.ALT,Se.ALT_UNDEFINED)},_eval(i,e,t){if(!((t&i)>0))return(e&i)>0},toModifierBitMask(i){let e=0;return e|=i.ctrlKey?Se.CTRL:0,e|=i.altKey?Se.ALT:0,e|=i.shiftKey?Se.SHIFT:0,e}};function xr(i,e,t){return e=dT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dT(i){var e=hT(i,"string");return typeof e=="symbol"?e:String(e)}function hT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ra{constructor(e,t,r,s,o,n){xr(this,"which",void 0),xr(this,"ctrlKey",void 0),xr(this,"metaKey",void 0),xr(this,"altKey",void 0),xr(this,"shiftKey",void 0),xr(this,"target",void 0),xr(this,"type",void 0),xr(this,"_propagationStopped",void 0),xr(this,"_immediatePropagationStopped",void 0),xr(this,"_defaultPrevented",void 0),this.which=e,this.ctrlKey=t,this.metaKey=!1,this.altKey=r,this.shiftKey=s,this.target=n,this.type=o,this._propagationStopped=!1,this._immediatePropagationStopped=!1,this._defaultPrevented=!1}stopPropagation(){this._propagationStopped=!0}stopImmediatePropagation(){this._immediatePropagationStopped=!0}preventDefault(){this._defaultPrevented=!0}isPropagationStopped(){return this._propagationStopped}isImmediatePropagationStopped(){return this._immediatePropagationStopped}isDefaultPrevented(){return this._defaultPrevented}isAnyPropagationStopped(){return this._propagationStopped||this._immediatePropagationStopped}}function Xo(i,e,t){return e=uT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function uT(i){var e=cT(i,"string");return typeof e=="symbol"?e:String(e)}function cT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mh extends ir{constructor(){super(),Xo(this,"session",void 0),Xo(this,"helpKeyStroke",void 0),Xo(this,"swallowF1",void 0),Xo(this,"filters",void 0),Xo(this,"_helpRendered",void 0),Xo(this,"_renderedKeys",void 0),this.session=null,this.helpKeyStroke=B.parseKeyStroke("F1"),this.swallowF1=!0,this._helpRendered=!1,this._renderedKeys=[],this.filters=[]}init(e){this.session=e.session,this.installTopLevelKeyStrokeHandlers(this.session.$entryPoint)}installTopLevelKeyStrokeHandlers(e){let t=e.window(!0),r=o=>o.which!==_.F1,s=o=>o.which!==_.BACKSPACE;this.swallowF1&&e.keydown(r).keyup(r),e.keydown(s).keyup(s),"onhelp"in t&&(t.onhelp=ps.returnFalse)}installKeyStrokeContext(e){if(!e)return;let t=e._handler;if(!t){if(!e.$getBindTarget())throw new Error("missing bind-target for KeyStrokeContext: "+e);t=this._onKeyEvent.bind(this,e),t.$target=e.$getBindTarget(),t.$target.on("keydown",t),t.$target.on("keyup",t),e._handler=t}}uninstallKeyStrokeContext(e){if(!e)return;let t=e._handler;!t||(t.$target.off("keydown",t),t.$target.off("keyup",t),t.$target=null,e._handler=null)}_renderKeys(e,t){let r=t.originalEvent.keyStrokeContexts||[],s=[];e.keyStrokes.filter(o=>{let n=o.renderingHints.render;return typeof n=="function"?n.call(o):n}).forEach(o=>{o.enabledByFilter=this._filter(o);let n=(o.field?o.field.$container:null)||e.$getScopeTarget();o.keys().forEach(d=>{let h=new ra(d.which,d.ctrl,d.alt,d.shift,d.keyStrokeMode,t.target);s.indexOf(d.toKeyStrokeString())<0&&e.accept(h)&&o.accept(h)&&!this._isPreventedByDescendantContext(d,t.target,r)&&(d.render(n,h)&&this._renderedKeys.push(d),h.isImmediatePropagationStopped()&&s.push(d.toKeyStrokeString()))})}),r.push(e),t.originalEvent.keyStrokeContexts=r}_isPreventedByDescendantContext(e,t,r){let s=new ra(e.which,e.ctrl,e.alt,e.shift,e.keyStrokeMode,t);return r.some(o=>(o.accept(s),s.isAnyPropagationStopped()?!0:o.keyStrokes.some(n=>(n.accept(s),s.isAnyPropagationStopped()))))}_handleKeyStrokeEvent(e,t){if(!e.accept(t)||e.keyStrokes.length<1)return;t.which>=96&&t.which<=105&&(t.which=t.which-48),e.keyStrokes.slice().some(s=>s.accept(t)?(this.invokeAcceptInputOnActiveValueField(s,e)&&ge.invokeValueFieldAcceptInput(t.target),this._filter(s)?(this.trigger("keyStroke",{keyStroke:s,keyStrokeContext:e}),s.invokeHandle(t),t.isImmediatePropagationStopped()):!0):!1)}_filter(e){for(let t=0;t<this.filters.length;t++)if(!this.filters[t].filter(e))return!1;return!0}invokeAcceptInputOnActiveValueField(e,t){return!e.preventInvokeAcceptInputOnActiveValueField&&(e.invokeAcceptInputOnActiveValueField||t.invokeAcceptInputOnActiveValueField)}_isHelpKeyStroke(e){return B.acceptEvent(this.helpKeyStroke,e)}_installHelpDisposeListener(e){let t,r=a()(e.currentTarget),s=r.window(),o=r.entryPoint();return t=function(){o.off("keyup",t),s.off("blur",t),this._helpRendered=!1,this._renderedKeys.forEach(n=>n.remove()),this._renderedKeys=[]}.bind(this),o.on("keyup",t),s.on("blur",t),!1}_onKeyEvent(e,t){if(this.session.focusManager.isElementCovertByGlassPane(e.$getScopeTarget())){let r=a().grep(e.keyStrokes,s=>s.keyStrokeFirePolicy===oe.KeyStrokeFirePolicy.ALWAYS);if(r.length===0)return;e=e.clone(),e.keyStrokes=r}this._isHelpKeyStroke(t)?(t.originalEvent.renderingHelp||!this._helpRendered)&&(t.originalEvent.renderingHelp=!0,this._helpRendered=!0,this._installHelpDisposeListener(t),this._renderKeys(e,t)):this._handleKeyStrokeEvent(e,t)}addFilter(e){f.pushSet(this.filters,e)}removeFilter(e){f.remove(this.filters,e)}}function qs(i,e,t){return e=pT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pT(i){var e=fT(i,"string");return typeof e=="symbol"?e:String(e)}function fT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Oe{constructor(e){qs(this,"invokeAcceptInputOnActiveValueField",void 0),qs(this,"keyStrokes",void 0),qs(this,"stopPropagationInterceptors",void 0),qs(this,"$bindTarget",void 0),qs(this,"$scopeTarget",void 0),qs(this,"_handler",void 0),qs(this,"_stopPropagationKeys",void 0),this.$bindTarget=null,this.$scopeTarget=null,this.keyStrokes=[],this.stopPropagationInterceptors=[],this._stopPropagationKeys={},this.invokeAcceptInputOnActiveValueField=!1,e=e||{},a().extend(this,e)}registerStopPropagationKeys(e,t){this._stopPropagationKeys[e]=this._stopPropagationKeys[e]||[],f.pushAll(this._stopPropagationKeys[e],t)}unregisterStopPropagationKeys(e,t){!this._stopPropagationKeys[e]||f.removeAll(this._stopPropagationKeys[e],t)}registerStopPropagationInterceptor(e){this.stopPropagationInterceptors.push(e)}accept(e){return this._accept(e)?(this._applyPropagationFlags(e),!0):!1}_applyPropagationFlags(e){let t=Se.toModifierBitMask(e),r=this._stopPropagationKeys[t];r&&u.isOneOf(e.which,r)&&e.stopPropagation(),this.stopPropagationInterceptors.forEach(s=>s(e))}_accept(e){return!0}registerKeyStroke(e){this.registerKeyStrokes(e)}registerKeyStrokes(e){f.ensure(e).map(this._resolveKeyStroke,this).filter(t=>this.keyStrokes.indexOf(t)===-1).forEach(t=>{this.keyStrokes.push(t);let r;r=t,r.field&&!r.destroyListener&&(r.destroyListener=s=>{this.unregisterKeyStroke(r),r.destroyListener=null},r.field.one("destroy",r.destroyListener))})}unregisterKeyStroke(e){this.unregisterKeyStrokes(e)}unregisterKeyStrokes(e){f.ensure(e).map(this._resolveKeyStroke,this).forEach(t=>{let r;r=t,f.remove(this.keyStrokes,r)&&r.field&&r.destroyListener&&(r.field.off("destroy",r.destroyListener),r.destroyListener=null)})}_resolveKeyStroke(e){if(e instanceof B)return e;if(e instanceof oe)return e.actionKeyStroke;throw new Error("unsupported keystroke: "+e)}$getBindTarget(){return typeof this.$bindTarget=="function"?this.$bindTarget():this.$bindTarget}$getScopeTarget(){return typeof this.$scopeTarget=="function"?this.$scopeTarget():this.$scopeTarget}clone(){return new Oe(a().extend({},this))}}class Fr extends Oe{constructor(e){super(),this.invokeAcceptInputOnActiveValueField=!0;let t=[_.RIGHT,_.LEFT,_.HOME,_.END];this.registerStopPropagationKeys(Se.CTRL,[_.A,_.C,_.Y,_.V,_.Z,_.BACKSPACE].concat(t)),this.registerStopPropagationKeys(Se.CTRL|Se.SHIFT,t),this.registerStopPropagationKeys(Se.SHIFT,t),this.registerStopPropagationKeys(Se.NONE,[_.SEMICOLON,_.DASH,_.COMMA,_.POINT,_.FORWARD_SLASH,_.OPEN_BRACKET,_.BACK_SLASH,_.CLOSE_BRACKET,_.SINGLE_QUOTE,_.MULTIPLY,_.ADD,_.SUBTRACT,_.DECIMAL_POINT,_.DIVIDE,_.NUMPAD_0,_.NUMPAD_1,_.NUMPAD_2,_.NUMPAD_3,_.NUMPAD_4,_.NUMPAD_5,_.NUMPAD_6,_.NUMPAD_7,_.NUMPAD_8,_.NUMPAD_9,_.MULTIPLY,_.BACKSPACE,_.DELETE,_.SPACE].concat(t)),this.setMultiline(e)}setMultiline(e){let t=[_.UP,_.DOWN];e?(this.registerStopPropagationKeys(Se.CTRL,t),this.registerStopPropagationKeys(Se.CTRL|Se.SHIFT,t),this.registerStopPropagationKeys(Se.SHIFT,t),this.registerStopPropagationKeys(Se.NONE,t)):(this.unregisterStopPropagationKeys(Se.CTRL,t),this.unregisterStopPropagationKeys(Se.CTRL|Se.SHIFT,t),this.unregisterStopPropagationKeys(Se.SHIFT,t),this.unregisterStopPropagationKeys(Se.NONE,t))}_applyPropagationFlags(e){super._applyPropagationFlags(e),!e.isPropagationStopped()&&this._isInputField(e.target)&&(this._isLetterKeyStroke(e)||this._isNumberKeyStroke(e))&&e.stopPropagation()}_isInputField(e){if(e&&e.isContentEditable)return!0;let t=a()(e);return t.is("input:text")||t.is("input:file")||t.is("textarea")}_isNumberKeyStroke(e){return!e.ctrlKey&&e.which>=_[0]&&e.which<=_[9]}_isLetterKeyStroke(e){return!e.ctrlKey&&e.which>=_.A&&e.which<=_.Z}}function mT(i,e,t){return e=gT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gT(i){var e=_T(i,"string");return typeof e=="symbol"?e:String(e)}function _T(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Yn extends B{constructor(){super(),mT(this,"ranges",void 0),this.ranges=[]}registerRange(e,t){this.ranges.push({from:e,to:t})}_accept(e){return(e.ctrlKey||e.metaKey)!==this.ctrl||e.altKey!==this.alt||e.shiftKey!==this.shift?!1:this.ranges.some(t=>e.which>=this._getRangeFrom(t)&&e.which<=this._getRangeTo(t))}keys(){let e=[];return this.ranges.forEach(t=>{let r=this._getRangeFrom(t),s=this._getRangeTo(t);for(let o=r;o<=s;o++)e.push(new qn(this,o))}),e}_getRangeFrom(e){return typeof e.from=="function"?e.from():e.from}_getRangeTo(e){return typeof e.to=="function"?e.to():e.to}}function Pm(i,e,t){return e=bT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bT(i){var e=yT(i,"string");return typeof e=="symbol"?e:String(e)}function yT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sa extends B{constructor(e,t,r){super(),Pm(this,"_contextFunction",void 0),Pm(this,"_bindObject",void 0),this._contextFunction=t,this._bindObject=r||this,this.field=e,this.renderingHints.render=!1,this.which=[_.SELECT],this.ctrl=!1,this.shift=!1,this.stopPropagation=!0,this.inheritAccessibility=!1}handle(e){this._contextFunction.call(this._bindObject,e)}}class jn extends B{constructor(e,t){super(),this.field=e,this.which=t,this.stopPropagation=!0,this.renderingHints.render=!0,this.renderingHints.$drawingArea=(r,s)=>s._$activeElement}_accept(e){return super._accept(e)?(e._$activeElement=this.field.$container.activeElement(),!0):!1}handle(e){e._$activeElement.trigger($.Event("click",{which:1}))}}function vT(i,e,t){return e=wT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wT(i){var e=TT(i,"string");return typeof e=="symbol"?e:String(e)}function TT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class oa extends B{constructor(e,t){super(),vT(this,"session",void 0),this.session=e,this.field=t,this.which=[_.LEFT,_.RIGHT],this.renderingHints.render=!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN}handle(e){let t=this.field.$container.activeElement(!0),r=this.field.$container.find(":focusable");switch(e.which){case _.RIGHT:this._handleNext(t,r);break;case _.LEFT:this._handlePrevious(t,r);break}}_handleNext(e,t){let r;e===t.last()[0]?r=t.first():r=$(t[t.index(e)+1]),this.session.focusManager.requestFocus(r),r.addClass("keyboard-navigation")}_handlePrevious(e,t){let r;e===t.first()[0]?r=t.last():r=$(t[t.index(e)-1]),this.session.focusManager.requestFocus(r),r.addClass("keyboard-navigation")}}class Jo extends B{constructor(e,t){super(),this.field=e,this.which=[_.ESC],this.stopPropagation=!0,this.renderingHints={render:!!t,$drawingArea:t},this.inheritAccessibility=!1}handle(e){this.field.close()}}class na extends Jo{constructor(e,t){super(e,t)}handle(e){this.field.abort()}}class gh extends B{constructor(e,t){super(),this.field=t,this.parseAndSetKeyStroke(e),this.renderingHints.offset=16,this.renderingHints.hAlign=ht.RIGHT,this.renderingHints.render=()=>{let r=this.field.getTab();return r&&r.rendered},this.renderingHints.$drawingArea=(r,s)=>this.field.getTab().$container,this.inheritAccessibility=!1}handle(e){this.field.select()}}function Qo(i,e,t){return e=ST(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ST(i){var e=CT(i,"string");return typeof e=="symbol"?e:String(e)}function CT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _h extends I{constructor(){super(),Qo(this,"comparator",void 0),Qo(this,"collapseStyle",void 0),Qo(this,"exclusiveExpand",void 0),Qo(this,"groups",void 0),Qo(this,"scrollable",void 0),Qo(this,"_groupPropertyChangeHandler",void 0),this.comparator=null,this.collapseStyle=null,this.exclusiveExpand=!0,this.groups=[],this.scrollable=!0,this.$container=null,this.htmlComp=null,this._addWidgetProperties(["groups"]),this._groupPropertyChangeHandler=this._onGroupPropertyChange.bind(this)}_init(e){super._init(e),this._initGroups(this.groups),this._setExclusiveExpand(this.exclusiveExpand)}_createLoadingSupport(){return new rr({widget:this})}_render(){this.$container=this.$parent.appendDiv("accordion"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}_createLayout(){return new la}_renderProperties(){super._renderProperties(),this._renderScrollable(),this._renderGroups()}insertGroup(e){this.insertGroups([e])}insertGroups(e){let t=f.ensure(e),r=this.groups;this.setGroups(r.concat(t))}deleteGroup(e){this.deleteGroups([e])}deleteGroups(e){e=f.ensure(e);let t=this.groups.slice();f.removeAll(t,e),this.setGroups(t)}deleteAllGroups(){this.setGroups([])}_initGroups(e){this.groups.forEach(t=>{this._initGroup(t)})}setGroups(e){let t=f.ensure(e);if(v.equals(this.groups,e))return;let r=this._createChildren(t),s=f.diff(this.groups,r),o=f.diff(r,this.groups);this._deleteGroups(s),this._insertGroups(o),this._sort(r),this._updateGroupOrder(r),this._setProperty("groups",r),o.length>0&&this._updateExclusiveExpand(),this.rendered&&(this._updateFirstLastMarker(),this.invalidateLayoutTree())}_insertGroups(e){e.forEach(t=>{this._insertGroup(t)})}_insertGroup(e){this._initGroup(e),this.rendered&&this._renderGroup(e)}_initGroup(e){e.setParent(this),e.on("propertyChange",this._groupPropertyChangeHandler),this.collapseStyle!==null&&e.setCollapseStyle(this.collapseStyle),this.setProperty("collapseStyle",e.collapseStyle)}_renderGroup(e){e.render()}_deleteGroups(e){e.forEach(t=>{this._deleteGroup(t)})}_deleteGroup(e){e.off("propertyChange",this._groupPropertyChangeHandler),e.owner===this?e.destroy():this.rendered&&e.remove()}_renderGroups(){this.groups.forEach(e=>{this._renderGroup(e)}),this._updateFirstLastMarker(),this.invalidateLayoutTree()}setComparator(e){this.comparator!==e&&(this.comparator=e)}sort(){let e=this.groups.slice();this._sort(e),this._updateGroupOrder(e),this._setProperty("groups",e)}_sort(e){this.comparator!==null&&e.sort(this.comparator)}_updateGroupOrder(e){if(!this.rendered)return;let t=!1;e.forEach((r,s)=>{(this.groups[s]!==r||t)&&(t=!0,r.$container.appendTo(this.$container))})}_updateFirstLastMarker(){ke.updateFirstLastMarker(this.groups)}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars(),this.$container.toggleClass("scrollable",this.scrollable),this.invalidateLayoutTree()}getFocusableElement(){let e=ke.findFirstFocusableWidget(this.groups,this);return e?e.getFocusableElement():null}setExclusiveExpand(e){this.setProperty("exclusiveExpand",e)}_setExclusiveExpand(e){this._setProperty("exclusiveExpand",e),this._updateExclusiveExpand()}_updateExclusiveExpand(){if(!this.exclusiveExpand)return;let e=f.find(this.groups,t=>t.visible&&!t.collapsed);this._collapseOthers(e)}setCollapseStyle(e){this.groups.forEach(t=>{t.setCollapseStyle(e)}),this.setProperty("collapseStyle",e)}_collapseOthers(e){!e||!e.collapsible||this.groups.forEach(t=>{t!==e&&t.collapsible&&t.setCollapsed(!0)})}_onGroupPropertyChange(e){e.propertyName==="collapsed"?this._onGroupCollapsedChange(e):e.propertyName==="visible"&&this._updateFirstLastMarker()}_onGroupCollapsedChange(e){!e.newValue&&this.exclusiveExpand&&this._collapseOthers(e.source)}}class bh extends He{}class la extends Ri{_getChildren(e){return e.children(".group")}layout(e){super.layout(e),x.update(e,!0)}}function xm(i,e,t){return e=PT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function PT(i){var e=xT(i,"string");return typeof e=="symbol"?e:String(e)}function xT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Xn extends I{constructor(){super(),xm(this,"buttons",void 0),xm(this,"defaultButtonIndex",void 0),this._addWidgetProperties(["buttons"]),this._addPreserveOnPropertyChangeProperties(["defaultButtonIndex"]),this.$container=null,this.buttons=[],this.defaultButtonIndex=0}_render(){this.$container=this.$parent.appendDiv("box-buttons")}_renderProperties(){super._renderProperties(),this._renderButtons(),this._renderDefaultButtonIndex()}_renderButtons(){this.buttons.filter(e=>!e.rendered).forEach(e=>{e.render(),e.$container.unfocusable().addClass("button box-button")})}_renderDefaultButtonIndex(){for(let e=0;e<this.buttons.length;e++){let t=this.buttons[e];t.$container.toggleClass("default",t.isVisible()&&t.enabledComputed&&this.isDefaultButtonIndex(e))}}isDefaultButtonIndex(e){return e===this.defaultButtonIndex}addButton(e,t){e=e||{},e.parent=this,e.tabbable=!0,e.actionStyle=oe.ActionStyle.BUTTON,e.preventDoubleClick=!0;let r=u.create(oe,e,t);return this.buttons.push(r),r}setDefaultButtonIndex(e){this.setProperty("defaultButtonIndex",e)}buttonCount(){return this.buttons.length}}function Li(i,e,t){return e=FT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FT(i){var e=ET(i,"string");return typeof e=="symbol"?e:String(e)}function ET(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fm extends I{constructor(){super(),Li(this,"statusEnabled",void 0),Li(this,"statusItemHtml",void 0),Li(this,"gridData",void 0),Li(this,"moveThreshold",void 0),Li(this,"widgets",void 0),Li(this,"currentItem",void 0),Li(this,"positionX",void 0),Li(this,"$carouselItems",void 0),Li(this,"$carouselStatusItems",void 0),Li(this,"$carouselFilmstrip",void 0),Li(this,"$carouselStatus",void 0),Li(this,"htmlCompFilmstrip",void 0),Li(this,"htmlCompStatus",void 0),this.statusEnabled=!0,this.statusItemHtml="&bull;",this.currentItem=0,this.moveThreshold=.25,this.widgets=[],this.$carouselItems=[],this.$carouselStatusItems=[],this.positionX=0,this._addWidgetProperties(["widgets"])}_init(e){super._init(e),this._setGridData(this.gridData),this.widgets=f.ensure(this.widgets)}_setGridData(e){this._setProperty("gridData",new ze(e))}_render(){this.$container=this.$parent.appendDiv("carousel"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new yh(this)),this.$carouselFilmstrip=this.$container.appendDiv("carousel-filmstrip"),this._registerCarouselFilmstripEventListeners(),this.htmlCompFilmstrip=S.install(this.$carouselFilmstrip,this.session)}_remove(){this._removeStatus(),super._remove()}_renderProperties(){super._renderProperties(),this._renderWidgets(),this._renderCurrentItem(),this._renderStatusEnabled()}setStatusEnabled(e){this.setProperty("statusEnabled",e)}_renderStatusEnabled(){this.statusEnabled?(this._renderStatus(),this._renderStatusItems(),this._renderCurrentStatusItem()):this._removeStatus(),this.invalidateLayoutTree()}_renderStatus(){this.$carouselStatus||(this.$carouselStatus=this.$container.appendDiv("carousel-status"),this.htmlCompStatus=S.install(this.$carouselStatus,this.session))}_removeStatus(){this.$carouselStatus&&(this.$carouselStatus.remove(),this.$carouselStatus=null)}_renderStatusItems(){!this.$carouselStatus||(this.$carouselStatusItems=[],this.$carouselStatus.empty(),this.$carouselItems.forEach(()=>{let e=this.$carouselStatus.appendDiv("status-item");e.html(this.statusItemHtml),this.$carouselStatusItems.push(e)}))}_renderCurrentStatusItem(){!this.$carouselStatus||this.$carouselStatusItems.forEach((e,t)=>{e.toggleClass("current-item",t===this.currentItem)})}recalcTransformation(){this.positionX=this.currentItem*this.$container.width()*-1,this.$carouselFilmstrip.css({transform:"translateX("+this.positionX+"px)"})}setCurrentItem(e){this.setProperty("currentItem",e)}_renderCurrentItem(){this._renderItemsInternal(void 0,!1),this._renderCurrentStatusItem(),this.invalidateLayoutTree()}_renderItemsInternal(e,t){e=e||this.currentItem,t||this.widgets.forEach((r,s)=>{r.rendered&&(s<e-1||s>e+1)&&r.remove()});for(let r=Math.max(e-1,0);r<Math.min(e+2,this.widgets.length);r++){let s=this.widgets[r];s.rendered||(s.render(this.$carouselItems[r]),s.htmlComp.revalidateLayout())}}setWidgets(e){this.setProperty("widgets",e)}_renderWidgets(){this.$carouselFilmstrip.empty(),this.$carouselItems=this.widgets.map(e=>{let t=this.$carouselFilmstrip.appendDiv("carousel-item");return S.install(t,this.session).setLayout(new Cr),e.cssClassAsArray().forEach(o=>t.addClass(o+"-carousel-item")),t}),this._renderStatusItems(),this.setCurrentItem(0)}_registerCarouselFilmstripEventListeners(){let e=this.$carouselFilmstrip.window();this.$carouselFilmstrip.on("mousedown touchstart",t=>{let r=lt.pageX(t),s=this.positionX,o=this.$container.width()-this.$carouselFilmstrip.width(),n=this.$container.width();e.on("mousemove.carouselDrag touchmove.carouselDrag",l=>{let h=lt.pageX(l)-r,p=s+h;if(p!==this.positionX&&p<=0&&p>=o){this.$carouselFilmstrip.css({transform:"translateX("+p+"px)"}),this.positionX=p;let m=p/n*-1;this._renderItemsInternal(p<s?Math.floor(m):Math.ceil(m),!0)}}),e.on("mouseup.carouselDrag touchend.carouselDrag touchcancel.carouselDrag",l=>{e.off(".carouselDrag");let d=this.positionX%n,h=this.currentItem;this.positionX<s&&d/n<0-this.moveThreshold?h=Math.ceil(this.positionX/n*-1):this.positionX>s&&d/n>=this.moveThreshold-1&&(h=Math.floor(this.positionX/n*-1)),this.setCurrentItem(h),d!==0&&(this.positionX=h*n*-1,this.recalcTransformation())})})}}function AT(i,e,t){return e=DT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DT(i){var e=MT(i,"string");return typeof e=="symbol"?e:String(e)}function MT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yh extends te{constructor(e){super(),AT(this,"carousel",void 0),this.carousel=e}layout(e){this.carousel.recalcTransformation();let t=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins()),r=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins());if(this.carousel.statusEnabled&&this.carousel.htmlCompStatus){let o=this.carousel.htmlCompStatus.size().add(this.carousel.htmlCompStatus.margins());t.height-=o.height,r.height-=o.height}let s=this.carousel.$carouselItems;t.width=s.length*t.width,this.carousel.htmlCompFilmstrip.setSize(t),s.forEach(o=>{S.get(o).setSize(r)})}preferredLayoutSize(e,t){let r=this.carousel.currentItem,s=new A(1,1);return r<this.carousel.$carouselItems.length&&r>=0&&(s=S.get(this.carousel.$carouselItems[r]).prefSize()),s.height+=this.carousel.htmlCompStatus.size().height,s}}function Ct(i,e,t){return e=$T(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $T(i){var e=RT(i,"string");return typeof e=="symbol"?e:String(e)}function RT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Pt{constructor(){Ct(this,"cssClass",void 0),Ct(this,"editable",void 0),Ct(this,"errorStatus",void 0),Ct(this,"horizontalAlignment",void 0),Ct(this,"htmlEnabled",void 0),Ct(this,"iconId",void 0),Ct(this,"mandatory",void 0),Ct(this,"text",void 0),Ct(this,"flowsLeft",void 0),Ct(this,"empty",void 0),Ct(this,"value",void 0),Ct(this,"tooltipText",void 0),Ct(this,"foregroundColor",void 0),Ct(this,"backgroundColor",void 0),Ct(this,"font",void 0),Ct(this,"sortCode",void 0),Ct(this,"field",void 0),Ct(this,"_cachedEncodedText",void 0),this.cssClass=null,this.editable=null,this.errorStatus=null,this.horizontalAlignment=null,this.htmlEnabled=null,this.iconId=null,this.mandatory=null,this._cachedEncodedText=null,this.text=null,this.value=null,this.tooltipText=null,this.sortCode=null}init(e){this._init(e)}_init(e){a().extend(this,e)}update(e){this.setText(e.text),a().extend(this,e)}setEditable(e){this.editable=e}setMandatory(e){this.mandatory=e}setHorizontalAlignment(e){this.horizontalAlignment=e}setValue(e){this.value=e}setErrorStatus(e){this.errorStatus=e}setText(e){let t=this.text;this.text=e,t!==this.text&&(this._cachedEncodedText=null)}setIconId(e){this.iconId=e}encodedText(){return this._cachedEncodedText||(this._cachedEncodedText=y.encode(this.text)),this._cachedEncodedText}setCssClass(e){this.cssClass=e}setSortCode(e){this.sortCode=e}}function Zo(i,e,t){return e=LT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LT(i){var e=IT(i,"string");return typeof e=="symbol"?e:String(e)}function IT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class er extends I{constructor(){super(),Zo(this,"leftVisible",void 0),Zo(this,"rightVisible",void 0),Zo(this,"horizontalAlignment",void 0),Zo(this,"$left",void 0),Zo(this,"$right",void 0),this.leftVisible=!0,this.rightVisible=!0,this.horizontalAlignment=er.HorizontalAlignment.LEFT,this.$left=null,this.$right=null}_render(){this.$container=this.$parent.appendDiv("collapse-handle"),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$left=this.$container.appendDiv("collapse-handle-body left"),this.$right=this.$container.appendDiv("collapse-handle-body right")}_renderProperties(){super._renderProperties(),this._renderLeftVisible(),this._renderRightVisible(),this._renderHorizontalAlignment()}setHorizontalAlignment(e){this.setProperty("horizontalAlignment",e)}_renderHorizontalAlignment(){this.$container.removeClass("left-aligned right-aligned"),this.horizontalAlignment===er.HorizontalAlignment.LEFT?this.$container.addClass("left-aligned"):this.horizontalAlignment===er.HorizontalAlignment.RIGHT&&this.$container.addClass("right-aligned")}setLeftVisible(e){this.setProperty("leftVisible",e)}_renderLeftVisible(){this.$left.setVisible(this.leftVisible),this._updateVisibilityClasses()}setRightVisible(e){this.setProperty("rightVisible",e)}_renderRightVisible(){this.$right.setVisible(this.rightVisible),this._updateVisibilityClasses()}_updateVisibilityClasses(){let e=this.leftVisible&&this.rightVisible;this.$container.toggleClass("both-visible",e),this.$left.toggleClass("both-visible",e),this.$right.toggleClass("both-visible",e),this.$container.toggleClass("one-visible",(this.leftVisible||this.rightVisible)&&!e)}_onMouseDown(e){let t=e.target;if(this.$left.isOrHas(t)){this.trigger("action",{left:!0});return}if(this.$right.isOrHas(t)){this.trigger("action",{right:!0});return}this.$container.hasClass("one-visible")&&this.trigger("action",{left:this.leftVisible,right:this.rightVisible})}}Zo(er,"HorizontalAlignment",{LEFT:"left",RIGHT:"right"});function Ys(i,e,t){return e=kT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kT(i){var e=BT(i,"string");return typeof e=="symbol"?e:String(e)}function BT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vh{constructor(e){Ys(this,"session",void 0),Ys(this,"active",void 0),Ys(this,"restrictedFocusGain",void 0),Ys(this,"_glassPaneDisplayParents",void 0),Ys(this,"_glassPaneTargets",void 0),Ys(this,"_focusContexts",void 0),Ys(this,"_glassPaneRenderers",void 0);let t={active:!F.get().supportsOnlyTouch(),restrictedFocusGain:!F.get().supportsOnlyTouch(),session:null};if(a().extend(this,t,e),!this.session)throw new Error("Session expected");this._focusContexts=[],this._glassPaneTargets=[],this._glassPaneDisplayParents=[],this._glassPaneRenderers=[];let r=this.session.$entryPoint,s=r.data("partid")||"0";r.attr("tabindex",s),this.restrictedFocusGain&&this.installTopLevelMouseHandlers(r),this.installFocusContext(r,It.AUTO)}installTopLevelMouseHandlers(e){e.on("mousedown",t=>(this._acceptFocusChangeOnMouseDown(a()(t.target))||t.preventDefault(),!0))}activate(e){this.active!==e&&(this.active=e,a().log.isDebugEnabled()&&a().log.isDebugEnabled()&&a().log.debug("Focus manager active: "+this.active),this.active&&this.validateFocus())}installFocusContext(e,t){let r=this.evaluateFocusRule(e,t),s=new aa(e,this);return It.PREPARE!==t&&s.ready(),this._pushIfAbsentElseMoveTop(s),r&&s.validateAndSetFocus(r),s}evaluateFocusRule(e,t){let r;return!t||t===It.AUTO||t===It.PREPARE?r=this.findFirstFocusableElement(e):t===It.NONE?r=null:r=t,r}uninstallFocusContext(e,t){t=a().extend({},{preventScroll:!0},t);let r=this.getFocusContext(e);if(!r)return;let s=ps.outsideFilter(r.$container);f.remove(this._focusContexts,r),r.dispose();let o=this._findActiveContext();o&&o.validateAndSetFocus(o.lastValidFocusedElement,s,t)}isFocusContextInstalled(e){return!!this.getFocusContext(e)}activateFocusContext(e){let t;e instanceof aa?t=e:t=this.getFocusContext(e),!(!t||this.isElementCovertByGlassPane(t.$container))&&(this._pushIfAbsentElseMoveTop(t),this.validateFocus())}isElementCovertByGlassPane(e,t){let r=this._glassPaneTargets;return t&&(r=this._glassPaneTargets.filter(t)),r.length?this._glassPaneDisplayParents.indexOf(u.widget(e))>=0?!0:r.some(s=>a()(e).closest(s).length!==0):!1}registerGlassPaneTarget(e){this._glassPaneTargets.push(e),this.validateFocus()}registerGlassPaneDisplayParent(e){this._glassPaneDisplayParents.push(e)}registerGlassPaneRenderer(e){this._glassPaneRenderers.push(e)}unregisterGlassPaneTarget(e){f.$remove(this._glassPaneTargets,e),this.validateFocus()}unregisterGlassPaneDisplayParent(e){f.remove(this._glassPaneDisplayParents,e)}unregisterGlassPaneRenderer(e){f.remove(this._glassPaneRenderers,e)}rerenderGlassPanes(){this._glassPaneRenderers.slice().forEach(t=>{t.removeGlassPanes(),t.renderGlassPanes()})}validateFocus(e){let t=this._findActiveContext();t&&t.validateFocus(e)}requestFocusIfReady(e,t){return this.requestFocus(e,t,{onlyIfReady:!0})}requestFocus(e,t,r){typeof r=="boolean"?r={onlyIfReady:r}:r=r||{};let s=e instanceof a()?e[0]:e;if(!s)return!1;let o=this._findFocusContextFor(s);if(o){if(u.nvl(r.onlyIfReady,!1)&&!o.prepared)return!1;o.validateAndSetFocus(s,t,r)}return Yi.isActiveElement(s)}findFirstFocusableElement(e,t){let r,s,o,n,l,d,h,p,m,g=e.entryPoint(),b=e.find(":focusable").addBack(":focusable").not(g).filter(t||ps.returnTrue);for(n=0;n<b.length;n++)if(l=b[n],d=a()(l),!this.isElementCovertByGlassPane(l)&&!(d.is(".prevent-initial-focus")||d.closest(".prevent-initial-focus").length>0)){if(!r&&!(d.hasClass("button")||d.hasClass("menu-item"))&&(r=l),!s&&d.is(".default")&&(s=l),h=d.parents(".menubar"),p=d.parents(".tab-box-header"),m=d.parents(".box-buttons"),(h.length>0||p.length>0||m.length>0)&&!o&&(d.hasClass("button")||d.hasClass("menu-item")))o=l;else if(!h.length&&!p.length&&!m.length&&typeof l.focus=="function")return l}if(s)return s;if(o){if(o!==r&&r){let C=a()(o).parents(".tab-box-header"),P=a()(r);if(a()(r).parents(".tab-box-header").length>0&&C.length>0&&P.is(".tab-item"))return r}return o}return r}_findActiveContext(){return f.last(this._focusContexts)}getFocusContext(e){return f.find(this._focusContexts,t=>t.$container===e)}_findFocusContextFor(e){let t=a().ensure(e),r=null,s=Number.MAX_VALUE;return this._focusContexts.forEach(o=>{if(!o.$container.isOrHas(t))return;t.parentsUntil(o.$container).length<s&&(r=o)}),r}_acceptFocusChangeOnMouseDown(e){return e.hasClass("glasspane")||this.isElementCovertByGlassPane(e)||!Yi.isFocusableByMouse(e)?!1:!!(e.is(":focusable")||Yi.isSelectableText(e)||Yi.containsParentFocusableByMouse(e,e.entryPoint()))}_pushIfAbsentElseMoveTop(e){f.remove(this._focusContexts,e),this._focusContexts.push(e)}}function Er(i,e,t){return e=OT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function OT(i){var e=HT(i,"string");return typeof e=="symbol"?e:String(e)}function HT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class aa{constructor(e,t){Er(this,"focusManager",void 0),Er(this,"lastValidFocusedElement",void 0),Er(this,"focusedElement",void 0),Er(this,"prepared",void 0),Er(this,"$container",void 0),Er(this,"_keyDownListener",void 0),Er(this,"_focusInListener",void 0),Er(this,"_focusOutListener",void 0),Er(this,"_unfocusableListener",void 0),Er(this,"_removeListener",void 0),this.$container=e,this.focusManager=t,this.lastValidFocusedElement=null,this.focusedElement=null,this.prepared=!1,this._keyDownListener=this._onKeyDown.bind(this),this._focusInListener=this._onFocusIn.bind(this),this._focusOutListener=this._onFocusOut.bind(this),this._unfocusableListener=this._onUnfocusable.bind(this),this._removeListener=this._onRemove.bind(this)}ready(){this.prepared||(this.$container.on("keydown",this._keyDownListener).on("focusin",this._focusInListener).on("focusout",this._focusOutListener).on("hide disable",this._unfocusableListener),this.prepared=!0,this.lastValidFocusedElement&&this.restoreFocus())}dispose(){!this.prepared||(this.$container.off("keydown",this._keyDownListener).off("focusin",this._focusInListener).off("focusout",this._focusOutListener).off("hide disable",this._unfocusableListener),a()(this.focusedElement).off("remove",this._removeListener))}_onKeyDown(e){if(e.which===_.TAB){let t=this.$container.activeElement(!0),r=this.$container.find(":tabbable:visible"),s=r.first()[0],o=r.last()[0],n=r.index(t),l;if(e.shiftKey?o&&(t===s||t===this.$container[0])?(a().suppressEvent(e),this.validateAndSetFocus(o),l=o):n>0&&(l=r.get(n-1)):s&&(t===o||t===this.$container[0])?(a().suppressEvent(e),this.validateAndSetFocus(s),l=s):n<r.length-1&&(l=r.get(n+1)),!l)return;let d=a()(l);d.addClass("keyboard-navigation");let h=w.offsetBounds(d),p=d.scrollParent();x.isLocationInView(new Z(h.x,h.y),p)||x.scrollTo(p,d)}}_onFocusIn(e){a()(e.target).on("remove",this._removeListener),this.focusedElement=e.target,e.target!==this.$container.entryPoint(!0)&&(this.focusManager._pushIfAbsentElseMoveTop(this),this.validateAndSetFocus(e.target),e.stopPropagation())}_onFocusOut(e){a()(e.target).off("remove",this._removeListener),a()(this.focusedElement).removeClass("keyboard-navigation"),this.focusedElement=null,e.stopPropagation()}_onRemove(e){this.validateAndSetFocus(null,ps.notSameFilter(e.target)),e.stopPropagation()}_onUnfocusable(e){a()(e.target).isOrHas(this.lastValidFocusedElement)&&(this.validateAndSetFocus(null,ps.notSameFilter(e.target)),e.stopPropagation())}validateAndSetFocus(e,t,r){e&&!a().contains(this.$container[0],e)&&(e=null);let s=null;e?!t||t.call(e)?s=e:s=this.focusManager.findFirstFocusableElement(this.$container,t):s=this.focusManager.findFirstFocusableElement(this.$container,t),this.lastValidFocusedElement=s,this._focus(s,r)}validateFocus(e){this.validateAndSetFocus(this.lastValidFocusedElement,e)}restoreFocus(){this.lastValidFocusedElement&&this._focus(this.lastValidFocusedElement)}_focus(e,t){if(t=t||{},!!this.focusManager.active&&!!this.prepared){if(this.focusManager.isElementCovertByGlassPane(e)){let r=this.$container.activeElement(!0);if(e&&(!r||!this.focusManager.isElementCovertByGlassPane(r)))return;e=null}e=e||this.$container.entryPoint(!0),e.focus||(e=this.$container.entryPoint(!0)),!Yi.isActiveElement(e)&&(e.focus({preventScroll:u.nvl(t.preventScroll,!1)}),a().log.isDebugEnabled()&&a().log.debug("Focus set to "+w.debugOutput(e)))}}}const Yi={isFocusableByMouse(i){let e=a()(i);return!e.hasClass("unfocusable")&&!e.closest(".unfocusable").length},containsParentFocusableByMouse(i,e){return a()(i).parentsUntil(".focus-boundary",":focusable").not(e).filter(()=>Yi.isFocusableByMouse(this)).length>0},isSelectableText(i){let e=a()(i),t=e;for(;t.css("user-select")==="auto";)if(t=t.parent(),t.is("body"))return!1;return t.css("user-select")==="none"?!1:e.is("input[disabled][type=text], textarea[disabled]")?!0:e.text().trim().length>0},isActiveElement(i){if(!i)return!1;let e;if(i instanceof a())e=i.activeElement(!0),i=i[0];else{let t=i;e=(t instanceof Document?t:t.ownerDocument).activeElement}return e===i}};var It;(function(i){i.AUTO="auto",i.NONE="none",i.PREPARE="prepare"})(It||(It={}));class Em extends I{_render(){this.$container=this.$parent.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this)),this.$parent.addClass("glasspane-parent"),this.$parent.css("position")==="static"&&this.$parent.css("position","relative"),this.session.focusManager.registerGlassPaneTarget(this.$parent)}_remove(){this.$parent.removeClass("glasspane-parent"),this.session.focusManager.unregisterGlassPaneTarget(this.$parent),super._remove()}_onMouseDown(e){a().suppressEvent(e)}}function Am(i,e,t){return e=NT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NT(i){var e=VT(i,"string");return typeof e=="symbol"?e:String(e)}function VT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class To{constructor(){Am(this,"glassPaneRenderer",void 0),Am(this,"$glassPaneTargets",void 0),this.$glassPaneTargets=null,this.glassPaneRenderer=null}ready(e){this.$glassPaneTargets=e,this.renderWhenReady()}rendererReady(e){this.glassPaneRenderer=e,this.renderWhenReady()}removeGlassPaneRenderer(e){this.glassPaneRenderer===e&&(this.glassPaneRenderer=null)}renderWhenReady(){this.glassPaneRenderer&&this.$glassPaneTargets&&this.$glassPaneTargets.length>0&&this.$glassPaneTargets.forEach(e=>this.glassPaneRenderer.renderGlassPane(e))}static createFor(e,t){if(e.rendered)throw new Error("Don't call this function if widget is already rendered.");let r=new To,s=o=>{let n=t();r.ready(n)};return e.one("render",s),e.one("destroy",()=>{e.off("render",s)}),[r]}}function Ar(i,e,t){return e=WT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WT(i){var e=KT(i,"string");return typeof e=="symbol"?e:String(e)}function KT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class js{constructor(e,t){Ar(this,"session",void 0),Ar(this,"_widget",void 0),Ar(this,"_enabled",void 0),Ar(this,"_$glassPanes",void 0),Ar(this,"_deferredGlassPanes",void 0),Ar(this,"_resolvedDisplayParent",void 0),Ar(this,"_registeredDisplayParent",void 0),Ar(this,"_displayParentRenderHandler",void 0),Ar(this,"_glassPaneRemoveHandler",void 0),Ar(this,"_glassPaneRendererRegistered",void 0),this._widget=e,this.session=e.session,this._enabled=u.nvl(t,!0),this._$glassPanes=[],this._deferredGlassPanes=[],this._resolvedDisplayParent=null,this._registeredDisplayParent=null,this._displayParentRenderHandler=this._onDisplayParentRender.bind(this),this._glassPaneRemoveHandler=this._onGlassPaneRemove.bind(this),this._glassPaneRendererRegistered=!1}renderGlassPanes(){this.findGlassPaneTargets().forEach(e=>this.renderGlassPane(e)),this._glassPaneRendererRegistered||(this.session.focusManager.registerGlassPaneRenderer(this),this._glassPaneRendererRegistered=!0)}renderGlassPane(e){if(e instanceof To){e.rendererReady(this),this._deferredGlassPanes.push(e);return}let t=a().ensure(e);if(this._widget.$container&&this._widget.$container[0]===t[0]||this._$glassPanes.some(n=>n.parent()[0]===t[0]))return;let s=t.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this));this._adjustGlassPaneSize(s,t);let o=s.window(!0);o&&o[Bs.PROP_POPUP_WINDOW]&&s.addClass("dark"),this._$glassPanes.push(s),this.session.focusManager.registerGlassPaneTarget(t),s.one("remove",this._glassPaneRemoveHandler),this._registerDisplayParent()}_adjustGlassPaneSize(e,t){let r=-t.cssBorderTopWidth(),s=-t.cssBorderBottomWidth(),o=-t.cssBorderLeftWidth(),n=-t.cssBorderRightWidth();t.children().each((l,d)=>{let h=a()(d);r=Math.min(r,(h.cssTop()||0)+(h.cssMarginTop()||0)),s=Math.min(s,(h.cssBottom()||0)+(h.cssMarginBottom()||0)),o=Math.min(o,(h.cssLeft()||0)+(h.cssMarginLeft()||0)),n=Math.min(n,(h.cssRight()||0)+(h.cssMarginRight()||0))}),e.cssTop(r).cssBottom(s).cssLeft(o).cssRight(n)}removeGlassPanes(){this._$glassPanes.slice().forEach(e=>this._removeGlassPane(e)),this._deferredGlassPanes.forEach(e=>e.removeGlassPaneRenderer(this)),this._deferredGlassPanes=[],this._unregisterDisplayParent(),this.session.focusManager.unregisterGlassPaneRenderer(this),this._glassPaneRendererRegistered=!1}_removeGlassPane(e){let t=e.parent();e.off("remove",this._glassPaneRemoveHandler),e.remove(),f.$remove(this._$glassPanes,e),t.removeClass("glasspane-parent"),this.session.focusManager.unregisterGlassPaneTarget(t)}eachGlassPane(e){this._$glassPanes.forEach(t=>e(t))}findGlassPaneTargets(){if(!this._enabled)return[];let e=this._resolveDisplayParent();return!e||!e.glassPaneTargets?[]:e.glassPaneTargets(this._widget)}_resolveDisplayParent(){return this._resolvedDisplayParent||(this._resolvedDisplayParent=this._widget.displayParent||this.session.desktop),this._resolvedDisplayParent}_registerDisplayParent(){this._resolvedDisplayParent||this._resolveDisplayParent(),this._resolvedDisplayParent&&(this._registeredDisplayParent||(this.session.focusManager.registerGlassPaneDisplayParent(this._resolvedDisplayParent),this._registeredDisplayParent=this._resolvedDisplayParent,this._registeredDisplayParent.on("render",this._displayParentRenderHandler)))}_unregisterDisplayParent(){this._registeredDisplayParent&&(this.session.focusManager.unregisterGlassPaneDisplayParent(this._registeredDisplayParent),this._registeredDisplayParent.off("render",this._displayParentRenderHandler),this._registeredDisplayParent=null)}_onMouseDown(e){let t=null,r=this._resolveDisplayParent();if(r.onGlassPaneMouseDown&&r.onGlassPaneMouseDown(this._widget,a()(e.target)),this._widget instanceof Y&&this._widget.isView()){let s=this.session.desktop.bench.getViewTab(this._widget);s&&(t=s.$container,t.isVisible()||(t=t.siblings(".overflow-tab-item")))}else this._widget.$container&&(t=this._widget.$container);if(t){let s=this._widget.$container.children(".glasspane");s.length?s.trigger("mousedown"):t.addClassForAnimation("animate-modality-highlight",{classesToRemove:"animate-modality-highlight animate-open"})}a().suppressEvent(e)}_onDisplayParentRender(e){this.renderGlassPanes()}_onGlassPaneRemove(e){let t=a()(e.target);this._removeGlassPane(t)}}function Xs(i,e,t){return e=zT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zT(i){var e=GT(i,"string");return typeof e=="symbol"?e:String(e)}function GT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wh extends I{constructor(){super(),Xs(this,"location",void 0),Xs(this,"sandboxEnabled",void 0),Xs(this,"sandboxPermissions",void 0),Xs(this,"scrollBarEnabled",void 0),Xs(this,"trackLocation",void 0),Xs(this,"wrapIframe",void 0),Xs(this,"$iframe",void 0),this.location=null,this.sandboxEnabled=!0,this.sandboxPermissions=null,this.scrollBarEnabled=!0,this.trackLocation=!1,this.wrapIframe=F.get().isIosPlatform(),this.$iframe=null}_render(){let e="iframe "+F.get().cssClassForIphone();this.session.layoutValidator.suppressValidate(),this.wrapIframe?(this.$container=this.$parent.appendDiv("iframe-wrapper"),this.$iframe=this.$container.appendElement("<iframe>",e)):(this.$iframe=this.$parent.appendElement("<iframe>",e),this.$container=this.$iframe),this.session.layoutValidator.unsuppressValidate(),this.htmlComp=S.install(this.$container,this.session),this.$iframe.on("load",this._onLoad.bind(this))}_renderProperties(){super._renderProperties(),this._renderScrollBarEnabled(),this._renderSandboxEnabled(),this._renderLocation()}setLocation(e){this.setProperty("location",e)}_renderLocation(){let e=this.location||"about:blank";this.$iframe.attr("src",e)}setTrackLocation(e){this.setProperty("trackLocation",e)}_contentDocument(){return this.$iframe&&this.$iframe[0]?this.$iframe[0].contentDocument:null}_onLoad(e){!this.rendered||(this.trackLocation&&this._updateLocation(),this._propagateKeyEvents())}_updateLocation(){let e=this._contentDocument();if(!e)return;let t=e.location.href;t==="about:blank"&&(t=null),this._setProperty("location",t)}_propagateKeyEvents(){let e=this._contentDocument();if(!e)return;let t=this.wrapIframe?this.$container[0]:this.$parent[0];!t||lt.addPropagationListener(e,t,["keydown","keyup","keypress"],r=>r.which!==_.TAB)}setScrollBarEnabled(e){this.setProperty("scrollBarEnabled",e)}_renderScrollBarEnabled(){this.$container.toggleClass("no-scrolling",!this.scrollBarEnabled),this.$iframe.attr("scrolling",this.scrollBarEnabled?"yes":"no"),this.rendered&&this._renderLocation()}setSandboxEnabled(e){this.setProperty("sandboxEnabled",e)}_renderSandboxEnabled(){this.sandboxEnabled?this._renderSandboxPermissions():(this.$iframe.removeAttr("sandbox"),this.$iframe.removeAttr("security")),this.rendered&&this._renderLocation()}setSandboxPermissions(e){this.setProperty("sandboxPermissions",e)}_renderSandboxPermissions(){!this.sandboxEnabled||(this.$iframe.attr("sandbox",u.nvl(this.sandboxPermissions,"")),this.rendered&&this._renderLocation())}postMessage(e,t,r){!this.rendered||this.$iframe[0].contentWindow.postMessage(e,t,r)}}function tt(i,e,t){return e=UT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UT(i){var e=qT(i,"string");return typeof e=="symbol"?e:String(e)}function qT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Jn extends I{constructor(){super(),tt(this,"axis",void 0),tt(this,"borderless",void 0),tt(this,"mouseWheelNeedsShift",void 0),tt(this,"$thumb",void 0),tt(this,"$thumbHandle",void 0),tt(this,"_scrollSize",void 0),tt(this,"_offsetSize",void 0),tt(this,"_dim",void 0),tt(this,"_dir",void 0),tt(this,"_dirReverse",void 0),tt(this,"_scrollDir",void 0),tt(this,"_thumbClipping",void 0),tt(this,"_onScrollHandler",void 0),tt(this,"_onScrollWheelHandler",void 0),tt(this,"_onScrollbarMouseDownHandler",void 0),tt(this,"_onTouchStartHandler",void 0),tt(this,"_onThumbMouseDownHandler",void 0),tt(this,"_onDocumentMousemoveHandler",void 0),tt(this,"_onDocumentMouseUpHandler",void 0),tt(this,"_onAncestorScrollOrResizeHandler",void 0),tt(this,"_fixScrollbarHandler",void 0),tt(this,"_unfixScrollbarHandler",void 0),tt(this,"_$thumb",void 0),tt(this,"_$thumbHandle",void 0),tt(this,"_$ancestors",void 0),this.$container=null,this.$thumb=null,this.$thumbHandle=null,this.axis="y",this.borderless=!1,this.mouseWheelNeedsShift=!1,this._scrollSize=null,this._offsetSize=null,this._dim="Height",this._dir="top",this._dirReverse="bottom",this._scrollDir="scrollTop",this._thumbClipping=new qe(0,0,0,0),this._onScrollHandler=this._onScroll.bind(this),this._onScrollWheelHandler=this._onScrollWheel.bind(this),this._onScrollbarMouseDownHandler=this._onScrollbarMouseDown.bind(this),this._onTouchStartHandler=this._onTouchStart.bind(this),this._onThumbMouseDownHandler=this._onThumbMouseDown.bind(this),this._onDocumentMousemoveHandler=this._onDocumentMousemove.bind(this),this._onDocumentMouseUpHandler=this._onDocumentMouseUp.bind(this),this._onAncestorScrollOrResizeHandler=this.update.bind(this),this._fixScrollbarHandler=this._fixScrollbar.bind(this),this._unfixScrollbarHandler=this._unfixScrollbar.bind(this)}_render(){this._ensureParentPosition(),this.$container=this.$parent.appendDiv("scrollbar").addClass(this.axis+"-axis"),this._$thumb=this.$container.appendDiv("scrollbar-thumb").addClass(this.axis+"-axis"),this._$thumbHandle=this._$thumb.appendDiv("scrollbar-thumb-handle").addClass(this.axis+"-axis"),this.borderless&&this.$container.addClass("borderless"),this._dim=this.axis==="x"?"Width":"Height",this._dir=this.axis==="x"?"left":"top",this._dirReverse=this.axis==="x"?"right":"bottom",this._scrollDir=this.axis==="x"?"scrollLeft":"scrollTop";let e=this.$parent.data("scrollbars");if(!e)throw new Error('Data "scrollbars" missing in '+w.debugOutput(this.$parent)+`
Ancestors: `+this.ancestorsToString(1));this.$parent.on("DOMMouseScroll mousewheel",this._onScrollWheelHandler).on("scroll",this._onScrollHandler).onPassive("touchstart",this._onTouchStartHandler),e.forEach(t=>{t.on("scrollStart",this._fixScrollbarHandler),t.on("scrollEnd",this._unfixScrollbarHandler)}),this.$container.on("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.on("mousedown",this._onThumbMouseDownHandler),this._$ancestors=this.$container.parents("div").on("scroll resize",this._onAncestorScrollOrResizeHandler)}_remove(){this.$parent.off("DOMMouseScroll mousewheel",this._onScrollWheelHandler).off("scroll",this._onScrollHandler).offPassive("touchstart",this._onTouchStartHandler);let e=this.$parent.data("scrollbars");e&&e.forEach(t=>{t.off("scrollStart",this._fixScrollbarHandler),t.off("scrollEnd",this._unfixScrollbarHandler)}),this.$container.off("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.off("mousedown","",this._onThumbMouseDownHandler),this._$ancestors.off("scroll resize",this._onAncestorScrollOrResizeHandler),this._$ancestors=null,super._remove()}_renderOnAttach(){super._renderOnAttach(),this._ensureParentPosition()}_ensureParentPosition(){if(this.$parent&&this.$parent.isAttached()){let e=this.$parent.css("position");u.isOneOf(e,"relative","absolute")||this.$parent.css("position","relative")}}scroll(e){let t=Math.max(0,this.$parent[this._scrollDir]());this._scrollToAbsolutePoint(t+e)}_scrollToAbsolutePoint(e){let t=Math.min(this._scrollSize-this._offsetSize+1,Math.max(0,Math.round(e)));this.$parent[this._scrollDir](t)}update(){if(!this.rendered)return;let e=this.$container["cssMargin"+this.axis.toUpperCase()](),t=this.$parent[this._scrollDir](),r=this.$parent.scrollLeft(),s=this.$parent.scrollTop();this.reset(),this._offsetSize=this.$parent[0]["offset"+this._dim],this._scrollSize=this.$parent[0]["scroll"+this._dim];let o=Math.max(this._offsetSize*this._offsetSize/this._scrollSize-e,25),n=this._offsetSize-o-e;this._$thumb.css(this._dim.toLowerCase(),o);let l=t/(this._scrollSize-this._offsetSize)*n;this._$thumb.css(this._dir,l);let d=1;this._offsetSize+d>=this._scrollSize?this.$container.css("display","none"):(this.$container.css("display",""),this._isContainerTooSmallForThumb()?this._$thumb.addClass("container-too-small-for-thumb"):this._$thumb.removeClass("container-too-small-for-thumb")),this._clipWhenOverlappingAncestor(),this.$container.cssRight(-1*r),this.$container.cssBottom(-1*s)}_resetClipping(){this.axis==="y"?this._$thumb.css("width","").css("left",""):this._$thumb.css("height","").css("top",""),this._$thumb.removeClass("clipped-left clipped-right clipped-top clipped-bottom"),this._thumbClipping=new qe(0,0,0,0)}_clipWhenOverlappingAncestor(){if(this._resetClipping(),this.$container.css("position")==="fixed"){let e=w.offsetBounds(this._$thumb),t=e.width,r=e.height,s=e.x+e.width,o=e.y+e.height,n=0,l=0,d=s,h=o;this.$container.parents("div").each(function(){let C=a()(this),P=w.offsetBounds(C);if(C.css("overflow-x")!=="visible"){P.x>n&&(n=P.x);let R=P.x+P.width;R<d&&(d=R)}if(C.css("overflow-y")!=="visible"){P.y>l&&(l=P.y);let R=P.y+P.height;R<h&&(h=R)}});let p=0,m=0,g=0,b=0;n>e.x&&(p=n-e.x,t-=p,this._$thumb.css("width",t).css("left",w.bounds(this._$thumb).x+p).addClass("clipped-left")),l>e.y&&(g=l-e.y,r-=g,this._$thumb.css("height",r).css("top",w.bounds(this._$thumb).y+g).addClass("clipped-top")),s>d&&(m=s-d,this._$thumb.css("width",t-m).addClass("clipped-right")),o>h&&(b=o-h,this._$thumb.css("height",r-b).addClass("clipped-bottom")),this._thumbClipping=new qe(g,m,b,p)}}reset(){this._$thumb.css(this._dim.toLowerCase(),0),this.$container.cssRight(0),this.$container.cssBottom(0)}_onScroll(e){this.update()}_onTouchStart(e){lt.onScrollStartEndDuringTouch(this.$parent,()=>{!this.rendered||this.$container.css("opacity",0)},()=>{!this.rendered||this.$container.css("opacity","")})}_onScrollWheel(e){if(!this.$container.isVisible()||e.ctrlKey||this.mouseWheelNeedsShift!==e.shiftKey)return!0;let t=e.originalEvent||this.$container.window(!0).event.originalEvent,r=t.wheelDelta?-t.wheelDelta/2:t.detail*20;return this.notifyBeforeScroll(),this.scroll(r),this.notifyAfterScroll(),!1}_onScrollbarMouseDown(e){this.notifyBeforeScroll();let t=this.$container[this._dim.toLowerCase()](),r=this.$container.offset()[this._dir],s=(this.axis==="x"?e.pageX:e.pageY)-r,o;if(this._isContainerTooSmallForThumb())o=Math.min(1,Math.max(0,s/t)),this._scrollToAbsolutePoint(o*this._scrollSize-Math.round(this._offsetSize/2));else{let n=this._$thumb["outer"+this._dim](!0),l=Math.round(n/2),d=t-Math.round(n/2),h=(s-l)*(1/(d-l));o=Math.min(1,Math.max(0,h)),this._scrollToAbsolutePoint(o*(this._scrollSize-this._offsetSize))}this.notifyAfterScroll()}_onThumbMouseDown(e){if(this._isContainerTooSmallForThumb())return!0;this.notifyBeforeScroll();let r=(this.axis==="x"?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),s=this.axis==="x"?this._thumbClipping.left:this._thumbClipping.top,o=this._$thumb.offset()[this._dir]+Math.floor(r/2)-s,n=Math.round((this.axis==="x"?e.pageX:e.pageY)-o);return this._$thumb.addClass("scrollbar-thumb-move"),this._$thumb.document().on("mousemove",{thumbCenterOffset:n},this._onDocumentMousemoveHandler).one("mouseup",this._onDocumentMouseUpHandler),!1}_onDocumentMousemove(e){if(!this.rendered)return;let t=e.data.thumbCenterOffset,s=(this.axis==="x"?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),o=this.$container[this._dim.toLowerCase()]()-s,n=this.$container.offset()[this._dir]+s/2,l=Math.min(o,Math.max(0,(this.axis==="x"?e.pageX:e.pageY)-n-t)),h=Math.min(1,Math.max(0,l/o))*(this._scrollSize-this._offsetSize);this._scrollToAbsolutePoint(h)}_onDocumentMouseUp(e){return a()(e.currentTarget).off("mousemove",this._onDocumentMousemoveHandler),this.rendered&&this._$thumb.removeClass("scrollbar-thumb-move"),this.notifyAfterScroll(),!1}notifyBeforeScroll(){this.trigger("scrollStart")}notifyAfterScroll(){this.trigger("scrollEnd")}_fixScrollbar(){x.fix(this.$container),this.update()}_unfixScrollbar(){x.unfix(this.$container,null,!0),this.update()}_isContainerTooSmallForThumb(){let e=this._$thumb["outer"+this._dim](!0),t=this.$container[this._dim.toLowerCase()]();return e>=t}}const x={_$scrollables:{},intersectionObserver:null,getScrollables(i){if(i)return x._$scrollables[i+""]||[];let e=[];return v.values(x._$scrollables).forEach(t=>{f.pushAll(e,t)}),e},pushScrollable(i,e){let t=i+"";if(x._$scrollables[t]){if(x._$scrollables[t].indexOf(e)>-1)return;x._$scrollables[t].push(e)}else x._$scrollables[t]=[e];a().log.isTraceEnabled()&&a().log.trace("Scrollable added: "+e.attr("class")+". New length: "+x._$scrollables[t].length)},removeScrollable(i,e){let t=0,r=i+"";if(x._$scrollables[r]){if(t=x._$scrollables[r].length,f.$remove(x._$scrollables[r],e),a().log.isTraceEnabled()&&a().log.trace("Scrollable removed: "+e.attr("class")+". New length: "+x._$scrollables[r].length),t===x._$scrollables[r].length)throw new Error("scrollable could not be removed. Potential memory leak. "+e.attr("class"))}else throw new Error("scrollable could not be removed. Potential memory leak. "+e.attr("class"))},install(i,e){e=e||{},e.axis=e.axis||"both",e.scrollShadow=e.scrollShadow||"auto";let t=u.nvl(e.nativeScrollbars,F.get().hasPrettyScrollbars()),r=u.nvl(e.hybridScrollbars,F.get().canHideScrollbars());t?x._installNative(i,e):r?(i.addClass("hybrid-scrollable"),x._installNative(i,e),x._installJs(i,e)):(i.css("overflow","hidden"),x._installJs(i,e));let s=S.optGet(i);s&&(s.scrollable=!0),i.data("scrollable",!0);let o=e.session||e.parent.session;return x.pushScrollable(o,i),e.scrollShadow&&x.installScrollShadow(i,e),i},_installNative(i,e){F.get().isIos()?setTimeout(x._installNativeInternal.bind(this,i,e)):x._installNativeInternal(i,e)},_installNativeInternal(i,e){a().log.isTraceEnabled()&&a().log.trace("use native scrollbars for container "+w.debugOutput(i)),e.axis==="x"?i.css("overflow-x","auto").css("overflow-y","hidden"):e.axis==="y"?i.css("overflow-x","hidden").css("overflow-y","auto"):i.css("overflow","auto"),i.css("-webkit-overflow-scrolling","touch")},installScrollShadow(i,e){if(!F.get().supportsIntersectionObserver())return;let t=x._computeScrollShadowStyle(e);if(t.length===0)return;let r=i.afterDiv("scroll-shadow");r.toggleClass("large",t.indexOf("large")>-1),r.toggleClass("gradient",t.indexOf("gradient")>-1),r.data("scroll-shadow-parent",i),i.data("scroll-shadow",r),i.data("scroll-shadow-style",t),i.data("scroll-shadow-customizer",e.scrollShadowCustomizer);let s=()=>x.updateScrollShadowWhileScrolling(i);i.data("scroll-shadow-handler",s),i.on("scroll",s),x.updateScrollShadow(i),x._installMutationObserver(i.entryPoint()),x._installIntersectionObserver(),x.intersectionObserver.observe(i[0]);let o=i[0],n=l=>{l.target===o&&x._onScrollableVisibleChange(o,l.type==="show")};i.data("scroll-shadow-visible-listener",n),i.on("hide show",n)},uninstallScrollShadow(i,e){let t=i.data("scroll-shadow");t&&(t.remove(),i.removeData("scroll-shadow")),i.removeData("scroll-shadow-style"),i.removeData("scroll-shadow-customizer");let r=i.data("scroll-shadow-handler");r&&(i.off("scroll",r),i.removeData("scroll-shadow-handler")),x.intersectionObserver&&x.intersectionObserver.unobserve(i[0]);let s=i.data("scroll-shadow-visible-listener");s&&i.off("hide show",s),x._hasScrollShadow(e,i.entryPoint(!0))||x._uninstallMutationObserver(i.entryPoint()),x._hasScrollShadow(e)||x._uninstallIntersectionObserver()},_hasScrollShadow(i,e){const t=x._$scrollables[i+""];return t&&t.some(r=>r.data("scroll-shadow")&&(!e||r.entryPoint(!0)===e))},_computeScrollShadowStyle(i){let e=i.scrollShadow;return e?(typeof e=="string"&&(e=e.split(" ")),e=e.slice(),e.indexOf("none")>-1?[]:(f.containsAny(e,["y","x","top","right","bottom","left"])||((i.axis==="both"||i.axis==="y")&&e.push("y"),(i.axis==="both"||i.axis==="x")&&e.push("x")),e.indexOf("y")>-1&&(e.push("top"),e.push("bottom")),e.indexOf("x")>-1&&(e.push("left"),e.push("right")),f.removeAll(e,["all","y","x","auto","none"]),e)):[]},updateScrollShadowWhileScrolling(i){let e=i.findUp(t=>t.hasAnimationClass());if(e.length>0){e.oneAnimationEnd(()=>x.updateScrollShadow(i));return}x.updateScrollShadow(i)},updateScrollShadow(i){let e=i.data("scroll-shadow");if(!e)return;let t=i[0].scrollTop,r=i[0].scrollLeft,s=p(t),o=m(t,i[0].scrollHeight,i[0].offsetHeight),n=p(r),l=m(r,i[0].scrollWidth,i[0].offsetWidth),d=i.data("scroll-shadow-style");e.toggleClass("top",!s&&d.indexOf("top")>-1),e.toggleClass("bottom",!o&&d.indexOf("bottom")>-1),e.toggleClass("left",!n&&d.indexOf("left")>-1),e.toggleClass("right",!l&&d.indexOf("right")>-1),w.setBounds(e,w.bounds(i,{exact:!0}).subtract(g(e))),w.setMargins(e,w.margins(i)),e.css("border-radius",i.css("border-radius"));let h=i.data("scroll-shadow-customizer");h&&h(i,e);function p(b){return b===0}function m(b,C,P){return b+1>=C-P}function g(b){return new qe(b.cssPxValue("--scroll-shadow-inset-top"),b.cssPxValue("--scroll-shadow-inset-right"),b.cssPxValue("--scroll-shadow-inset-bottom"),b.cssPxValue("--scroll-shadow-inset-left"))}},_installMutationObserver(i){if(!i||!i[0]||i.data("mutation-observer"))return;const e=new MutationObserver(x._onDomMutation);i.data("mutation-observer",e),e.observe(i[0],{subtree:!0,childList:!0})},_onDomMutation(i,e){i.forEach(x._processDomMutation)},_processDomMutation(i){for(let e=0;e<i.addedNodes.length;e++){let t=i.addedNodes[e],r=a()(t);if(r.data("scrollable")){let s=r.data("scroll-shadow");s&&s.insertAfter(r)}}},_uninstallMutationObserver(i){!i||!i.data("mutation-observer")||(i.data("mutation-observer").disconnect(),i.removeData("mutation-observer"))},_installIntersectionObserver(){x.intersectionObserver||(x.intersectionObserver=new IntersectionObserver((i,e)=>{i.forEach(t=>x._onScrollableVisibleChange(t.target,t.intersectionRatio>0))}))},_uninstallIntersectionObserver(){!x.intersectionObserver||(x.intersectionObserver.disconnect(),x.intersectionObserver=null)},_onScrollableVisibleChange(i,e){let t=a()(i),r=t.data("scroll-shadow");!r||r.setVisible(t.isVisible())},hasScrollShadow(i,e){if(!i)return!1;let t=i.data("scroll-shadow");return t?e?t.hasClass(e):!0:!1},isHybridScrolling(i){return i.hasClass("hybrid-scrollable")},isNativeScrolling(i){return u.isOneOf("auto",i.css("overflow"),i.css("overflow-x"),i.css("overflow-y"))},isJsScrolling(i){return!!i.data("scrollbars")},_installJs(i,e){a().log.isTraceEnabled()&&a().log.trace("installing JS-scrollbars for container "+w.debugOutput(i));let t=f.ensure(i.data("scrollbars"));t.forEach(s=>{s.destroy()}),t=[];let r;if(e.axis==="both"){let s=a().extend({},e,{axis:"y"});r=u.create(Jn,s),t.push(r),s=a().extend({},s,{axis:"x",mouseWheelNeedsShift:!0}),r=u.create(Jn,s),t.push(r)}else{let s=a().extend({},e,{axis:e.axis});r=u.create(Jn,s),t.push(r)}i.data("scrollbars",t),t.forEach(s=>{s.render(i),s.update()})},uninstall(i,e){if(!i.data("scrollable"))return;let t=i.data("scrollbars");t&&t.forEach(s=>{s.destroy()}),x.removeScrollable(e,i),i.removeData("scrollable"),i.css("overflow",""),i.removeClass("hybrid-scrollable"),i.removeData("scrollbars");let r=S.optGet(i);r&&(r.scrollable=!1),x.uninstallScrollShadow(i,e)},update(i,e){if(!i||!i.data("scrollable"))return;x.updateScrollShadow(i);let t=i.data("scrollbars");if(!t){F.get().isIos()&&x._handleIosPaintBug(i);return}if(e){x._update(t);return}i.data("scrollbarUpdatePending")||(setTimeout(()=>{x._update(t),i.removeData("scrollbarUpdatePending")},0),i.data("scrollbarUpdatePending",!0))},_update(i){i.forEach(e=>{e.rendered&&e.reset()}),i.forEach(e=>{e.rendered&&e.update()})},_handleIosPaintBug(i){if(i.data("scrollbarUpdatePending"))return;setTimeout(()=>{e(),i.removeData("scrollbarUpdatePending")}),i.data("scrollbarUpdatePending",!0);function e(){let t=w.size(i).subtract(w.insets(i,{includePadding:!1,includeBorder:!0}));i[0].scrollHeight===t.height&&i[0].scrollWidth===t.width?i.css("-webkit-overflow-scrolling",""):i.css("-webkit-overflow-scrolling","touch")}},reset(i){let e=i.data("scrollbars");!e||e.forEach(t=>t.reset())},scrollTo(i,e,t){let r;typeof t=="string"?r={align:t}:r=x._createDefaultScrollToOptions(t);let s=r.align?r.align.toLowerCase():void 0,o,n=u.nvl(r.scrollOffsetUp,s==="center"?0:4),l=u.nvl(r.scrollOffsetDown,s==="center"?0:8),d=i.height(),h=w.offsetBounds(e),p=w.offsetBounds(i),m=h.y-p.y,g=h.height,b=m-n,C=m+g+l;if(s||(s=b<0?"top":C>d?"bottom":void 0),s==="center")o=i.scrollTop()+b-Math.max(0,(d-g)/2);else if(s==="top")o=i.scrollTop()+b;else if(s==="bottom"){o=Math.ceil(i.scrollTop()+C-d);let P=b-(o-i.scrollTop());P<0&&(o=o+P)}o!==void 0&&x.scrollTop(i,o,r)},_createDefaultScrollToOptions(i){let e={animate:!1,stop:!0};return a().extend({},e,i)},scrollHorizontalTo(i,e,t){let r,s=i.width(),o=w.bounds(e,!0),n=o.x,l=o.width;n<0?x.scrollLeft(i,i.scrollLeft()+n,t):n+l>s&&(r=Math.ceil(i.scrollLeft()+n+l-s),x.scrollLeft(i,r,t))},scrollTop(i,e,t){t=x._createDefaultScrollToOptions(t);let r=x.scrollbar(i,"y");if(r&&r.notifyBeforeScroll(),t.stop&&i.stop("scroll"),!t.animate){i.scrollTop(e),r&&r.notifyAfterScroll();return}x.animateScrollTop(i,e),i.promise("scroll").always(()=>{r&&r.notifyAfterScroll()})},scrollLeft(i,e,t){t=x._createDefaultScrollToOptions(t);let r=x.scrollbar(i,"x");if(r&&r.notifyBeforeScroll(),t.stop&&i.stop("scroll"),!t.animate){i.scrollLeft(e),r&&r.notifyAfterScroll();return}x.animateScrollLeft(i,e),i.promise("scroll").always(()=>{r&&r.notifyAfterScroll()})},animateScrollTop(i,e){i.animate({scrollTop:e},{queue:"scroll"}).dequeue("scroll")},animateScrollLeft(i,e){i.animate({scrollLeft:e},{queue:"scroll"}).dequeue("scroll")},scrollbar(i,e){let t=i.data("scrollbars")||[];return f.find(t,r=>r.axis===e)},scrollToBottom(i,e){x.scrollTop(i,i[0].scrollHeight-i[0].offsetHeight,e)},isLocationInView(i,e){return!e||e.length===0?!0:e.toArray().every(t=>w.offsetBounds(a()(t)).contains(i.x,i.y))},onScroll(i,e){e.$scrollParents=[],i.scrollParents().each(function(){let t=a()(this);t.on("scroll",e),e.$scrollParents.push(t)})},offScroll(i){let e=i.$scrollParents;if(!e)throw new Error("$scrollParents are not defined");for(let t=0;t<e.length;t++)e[t].off("scroll",i)},fix(i){if(!i.isVisible()||i.css("position")==="fixed")return;let e=i[0].getBoundingClientRect();i.css("position","fixed").cssLeft(e.left-i.cssMarginLeft()).cssTop(e.top-i.cssMarginTop()).cssWidth(e.width).cssHeight(e.height)},unfix(i,e,t){if(clearTimeout(e),t){x._unfix(i);return}return setTimeout(()=>{x._unfix(i)},50)},_unfix(i){i.css({position:"absolute",left:"",top:"",width:"",height:""})},storeScrollPositions(i,e){let t=x.getScrollables(e);if(!t)return;let r,s;t.forEach(o=>{i.isOrHas(o[0])&&(r=o.scrollTop(),o.data("scrollTop",r),s=o.scrollLeft(),o.data("scrollLeft",o.scrollLeft()),a().log.isTraceEnabled()&&a().log.trace("Stored scroll position for "+o.attr("class")+". Top: "+r+". Left: "+s))})},restoreScrollPositions(i,e){let t=x.getScrollables(e);if(!t)return;let r,s;t.forEach(o=>{i.isOrHas(o[0])&&(r=o.data("scrollTop"),r&&(o.scrollTop(r),o.removeData("scrollTop")),s=o.data("scrollLeft"),s&&(o.scrollLeft(s),o.removeData("scrollLeft")),x.update(o),a().log.isTraceEnabled()&&a().log.trace("Restored scroll position for "+o.attr("class")+". Top: "+r+". Left: "+s))})},setVisible(i,e){if(!i||!i.data("scrollable"))return;let t=i.data("scrollbars");!t||t.forEach(r=>{r.rendered&&r.$container.setVisible(e)})},opacity(i,e){if(!i||!i.data("scrollable"))return;let t=i.data("scrollbars");!t||t.forEach(r=>{r.rendered&&r.$container.css("opacity",e)})},_getCompleteChildRowsHeightRecursive(i,e,t,r){let s=0;return i.forEach(o=>{o.height?s+=o.height:s+=r,t(o)&&e(o).length>0&&(s+=x._getCompleteChildRowsHeightRecursive(e(o),e,t,r))}),s},ensureExpansionVisible(i){let e=i.isExpanded(i.element),t=i.getChildren(i.element),r=i.$element.position().top,s=i.element.height,o=i.$scrollable.scrollTop();if(e){if(e&&t.length>0){let n=i.$scrollable.height(),d=x._getCompleteChildRowsHeightRecursive(t,i.getChildren,i.isExpanded,i.defaultChildHeight)+1.5*s,h=r+d,p=o+Math.min(h-n,r-s);p>o&&x.scrollTop(i.$scrollable,p,{animate:!0,stop:!1})}}else if(r<s){let n=Math.max(o-(s-r),0);x.scrollTop(i.$scrollable,n,{animate:!0})}if(t.length>0){let n=Math.max(i.element.level-3,0)*i.nodePaddingLevel;x.scrollLeft(i.$scrollable,n,{animate:!0,stop:!1})}}};function Qn(i,e,t){return e=YT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function YT(i){var e=jT(i,"string");return typeof e=="symbol"?e:String(e)}function jT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Th{constructor(e){Qn(this,"enabled",void 0),Qn(this,"minRowHeight",void 0),Qn(this,"viewRangeSize",void 0),Qn(this,"widget",void 0),Qn(this,"$scrollable",void 0),this.enabled=!0,this.minRowHeight=0,this.viewRangeSize=0,this.widget=null,this.$scrollable=null,a().extend(this,e)}setEnabled(e){this.enabled=e}set$Scrollable(e){this.$scrollable!==e&&(this.$scrollable=e)}setMinRowHeight(e){if(this.minRowHeight!==e){if(!Ge.isNumber(e))throw new Error("minRowHeight is not a number: "+e);this.minRowHeight=e,this.widget.rendered&&this.setViewRangeSize(this.calculateViewRangeSize())}}setViewRangeSize(e,t){this.viewRangeSize!==e&&(this.viewRangeSize=e,this.widget.rendered&&u.nvl(t,!0)&&this.renderViewPort())}calculateViewRangeSize(){if(!this.enabled||this.$scrollable.length===0)return this.rowCount();if(this.minRowHeight===0)throw new Error("Cannot calculate view range with rowHeight = 0");return Math.ceil(this.$scrollable.height()/this.minRowHeight)*2}calculateCurrentViewRange(){if(!this.enabled)return this.maxViewRange();if(this.viewRangeSize===0)return new O(0,0);let e;if(this.$scrollable.length===0)return this.maxViewRange();let t=this.$scrollable[0].scrollTop,r=this.$scrollable[0].scrollHeight-this.$scrollable[0].clientHeight,s=this.widget.$container[0].getBoundingClientRect(),o=this.$scrollable[0].getBoundingClientRect();return s.height>0&&(s.bottom<o.top||s.top>o.bottom)?new O(0,0):(r===0?e=0:e=this._rowIndexAtScrollTop(t),this.calculateViewRangeForRowIndex(e))}maxViewRange(){return new O(0,this.rowCount())}calculateViewRangeForRowIndex(e){if(!this.enabled)return this.maxViewRange();let t=new O,r=Math.floor(this.viewRangeSize/4),s;return t.from=Math.max(e-r,0),t.to=Math.min(t.from+this.viewRangeSize,this.rowCount()),s=this.viewRangeSize-t.size(),s>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}_rowIndexAtScrollTop(e){let t=0,r=this.rowCount(),s=r-1;this.widget.$container[0]!==this.$scrollable[0]&&(t=e+(this.widget.$container.offset().top-this.$scrollable.offset().top));for(let o=0;o<r;o++)if(t+=this.rowHeight(o),e<t){s=o;break}return s}rowHeight(e){throw new Error("Function has to be provided by widget")}rowCount(){throw new Error("Function has to be provided by widget")}renderViewPort(){let e=this.calculateCurrentViewRange();this._renderViewRange(e)}renderViewRangeForRowIndex(e){let t=this.calculateViewRangeForRowIndex(e);this._renderViewRange(t)}_renderViewRange(e){throw new Error("Function has to be provided by widget")}}function Dr(i,e,t){return e=XT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XT(i){var e=JT(i,"string");return typeof e=="symbol"?e:String(e)}function JT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Xr extends I{constructor(){super(),Dr(this,"splitHorizontal",void 0),Dr(this,"position",void 0),Dr(this,"orientation",void 0),Dr(this,"layoutData",void 0),Dr(this,"$anchor",void 0),Dr(this,"$root",void 0),Dr(this,"_cursorOffset",void 0),Dr(this,"_mouseDownHandler",void 0),Dr(this,"_$window",void 0),Dr(this,"_$body",void 0),this.splitHorizontal=!0,this.$anchor=null,this.$root=null,this.position=null,this.orientation="top",this.layoutData=null,this._cursorOffset=null,this._mouseDownHandler=this._onMouseDown.bind(this),this._$window=null,this._$body=null}_init(e){super._init(e),this.setPosition(this.position)}_render(){this.$container=this.$parent.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.htmlComp=S.install(this.$container,this.session),this._$window=this.$parent.window(),this._$body=this.$parent.body()}_renderProperties(){super._renderProperties(),this._renderPosition()}_renderEnabled(){super._renderEnabled(),this.enabledComputed?this.$container.on("mousedown",this._mouseDownHandler):this.$container.off("mousedown",this._mouseDownHandler)}_renderVisible(){super._renderVisible(),this.initialized&&this._renderPosition()}setLayoutData(e){super.setLayoutData(e),this.layoutData=e}getLayoutData(){return this.layoutData}setPosition(e){return Ge.isNumber(e)||(e=this._derivePositionFromAnchor()),e!==this.position&&this._setPosition(e),e}_derivePositionFromAnchor(){if(!this.$anchor)return null;let e=w.offsetBounds(this.$anchor,{exact:!0});return this.splitHorizontal?e.x+e.width:e.y+e.height}_setPosition(e){!Ge.isNumber(e)||e!==this.position&&(this.position=e,this.trigger("positionChange",{position:e}),this.rendered&&this._renderPosition())}_renderPosition(){if(this.position===null||!this.visible)return;let e=w.size(this.$container,!0);if(this.splitHorizontal){let t=this.position-e.width/2;this.orientation==="right"?this.$container.cssRight(t):this.$container.cssLeft(t)}else{let t=this.position-e.height/2;this.orientation==="bottom"?this.$container.cssBottom(t):this.$container.cssTop(t)}}_onMouseDown(e){let t=w.margins(this.$container),r=w.offsetBounds(this.$container);r.x-=t.left,r.y-=t.top,r.width+=t.horizontal(),r.height+=t.vertical();let s=r.center();this._$window.on("mousemove.splitter",this._onMouseMove.bind(this)).one("mouseup",this._onMouseUp.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),a()("iframe").addClass("dragging-in-progress"),this._cursorOffset={left:s.x-e.pageX,top:s.y-e.pageY},this.trigger("moveStart",{position:this._getSplitterPosition(e)}),e.preventDefault()}_getSplitterPosition(e){let t=w.offsetBounds(this.$root||this.$parent);if(this.splitHorizontal){let s=e.pageX+this._cursorOffset.left-t.x;return this.orientation==="right"?t.width-s:s}let r=e.pageY+this._cursorOffset.top-t.y;return this.orientation==="bottom"?t.height-r:r}_onMouseMove(e){let t=this._getSplitterPosition(e),r=this.trigger("move",{position:t});r.defaultPrevented||this._setPosition(r.position)}_onMouseUp(e){this._$window.off("mousemove.splitter"),this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),a()("iframe").removeClass("dragging-in-progress"),this.trigger("moveEnd",{position:this.position})}}const Xe={YEAR:"year",MONTH:"month",WEEK_IN_YEAR:"week_in_year",DAY_IN_MONTH:"day_in_month",WEEKDAY:"weekday",HOUR_24:"hour_24",HOUR_12:"hour_12",AM_PM:"am_pm",MINUTE:"minute",SECOND:"second",MILLISECOND:"millisecond",TIMEZONE:"timezone"};function Js(i,e,t){return e=QT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QT(i){var e=ZT(i,"string");return typeof e=="symbol"?e:String(e)}function ZT(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Je{constructor(e){Js(this,"type",void 0),Js(this,"terms",void 0),Js(this,"dateFormat",void 0),Js(this,"formatFunction",void 0),Js(this,"parseRegExp",void 0),Js(this,"applyMatchFunction",void 0),Js(this,"parseFunction",void 0),e=e||{},this.type=e.type,this.terms=e.terms,this.dateFormat=e.dateFormat,this.formatFunction=e.formatFunction&&e.formatFunction.bind(this),this.parseRegExp=e.parseRegExp,this.applyMatchFunction=e.applyMatchFunction&&e.applyMatchFunction.bind(this),this.parseFunction=e.parseFunction&&e.parseFunction.bind(this)}createFormatFunction(e){return function(t){if(this.formatFunction){let r=this.formatFunction(t,e);r!==void 0&&(t.formattedString+=r)}}.bind(this)}createParseFunction(e){return function(t){let r,s,o,n=!1;return this.parseRegExp&&(r=this.parseRegExp.exec(t.inputString),r&&(this.applyMatchFunction&&this.applyMatchFunction(t,r[1],e),o=r[1],t.inputString=r[2],n=!0)),!n&&this.parseFunction&&(o=this.parseFunction(t,e),o!==null&&(n=!0)),n&&(s=this.terms[0],this.terms.length>1&&this.terms.some(l=>l.length===o.length?(s=l,!0):!1),t.parsedPattern+=s),n}.bind(this)}accept(e){if(e){for(let t=0;t<this.terms.length;t++)if(e===this.terms[t])return this.terms[t]}return null}}function Mr(i,e,t){return e=eS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function eS(i){var e=tS(i,"string");return typeof e=="symbol"?e:String(e)}function tS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ft{constructor(e,t,r){Mr(this,"locale",void 0),Mr(this,"pattern",void 0),Mr(this,"symbols",void 0),Mr(this,"lenient",void 0),Mr(this,"_terms",void 0),Mr(this,"_formatFunctions",void 0),Mr(this,"_parseFunctions",void 0),Mr(this,"_analyzeFunctions",void 0),Mr(this,"_patternDefinitions",void 0),Mr(this,"_patternLibrary",void 0),r=r||{},this.locale=e,u.assertParameter("locale",this.locale),this.pattern=t||e.dateFormatPatternDefault,u.assertParameter("pattern",this.pattern),this.symbols=e.dateFormatSymbols,this.symbols.firstDayOfWeek=1,this.symbols.weekdaysOrdered=T.orderWeekdays(this.symbols.weekdays,this.symbols.firstDayOfWeek),this.symbols.weekdaysShortOrdered=T.orderWeekdays(this.symbols.weekdaysShort,this.symbols.firstDayOfWeek),this.lenient=u.nvl(r.lenient,!0),this._terms=[],this._formatFunctions=[],this._parseFunctions=[],this._analyzeFunctions=[],this._patternDefinitions=[new Je({type:Xe.YEAR,terms:["yyyy"],dateFormat:this,formatFunction:(s,o)=>{let n=s.inputDate.getFullYear(),l=Math.max(4,n.toString().length);return y.padZeroLeft(s.inputDate.getFullYear(),l).slice(-l)},parseRegExp:/^(\d{4})(.*)$/,applyMatchFunction:(s,o,n)=>{s.matchInfo.year=o,s.dateInfo.year=Number(o)}}),new Je({type:Xe.YEAR,terms:["yyy","yy","y"],dateFormat:this,formatFunction:(s,o)=>{let n=String(s.inputDate.getFullYear()),l=s.exactLength?o.length:2;return l===1?n.slice(-l):y.padZeroLeft(n,l).slice(-l)},parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:(s,o,n)=>{if(o.length===3){s.dateInfo.year=Number(o),s.matchInfo.year=o;return}let l=(s.startDate||new Date).getFullYear(),d=Number(y.padZeroLeft(l,4).substr(0,2)+y.padZeroLeft(o,2)),h=d-l;h<=-50?d+=100:h>50&&(d-=100),s.dateInfo.year=d,s.matchInfo.year=o}}),new Je({type:Xe.MONTH,terms:["MMMM"],dateFormat:this,formatFunction:function(s,o){return this.dateFormat.symbols.months[s.inputDate.getMonth()]},parseFunction:function(s,o){let n,l,d,h;for(n=0;n<this.dateFormat.symbols.months.length;n++)if(l=this.dateFormat.symbols.months[n],!!l&&(d=new RegExp("^("+y.quote(l)+")(.*)$","i"),h=d.exec(s.inputString),h))return s.dateInfo.month=n,s.matchInfo.month=h[1],s.inputString=h[2],h[1];if(s.analyze){for(n=0;n<this.dateFormat.symbols.months.length;n++)if(l=this.dateFormat.symbols.months[n],d=new RegExp("^("+y.quote(s.inputString)+")(.*)$","i"),h=d.exec(l),h)return s.dateInfo.month=n,s.matchInfo.month=l,s.inputString="",h[1]}return null}}),new Je({type:Xe.MONTH,terms:["MMM"],dateFormat:this,formatFunction:function(s,o){return this.dateFormat.symbols.monthsShort[s.inputDate.getMonth()]},parseFunction:function(s,o){let n,l,d,h;for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if(l=this.dateFormat.symbols.monthsShort[n],!!l&&(d=new RegExp("^("+y.quote(l)+")(.*)$","i"),h=d.exec(s.inputString),h))return s.dateInfo.month=n,s.matchInfo.month=h[1],s.inputString=h[2],h[1];if(s.analyze){for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if(l=this.dateFormat.symbols.monthsShort[n],d=new RegExp("^("+y.quote(s.inputString)+")(.*)$","i"),h=d.exec(l),h)return s.dateInfo.month=n,s.matchInfo.month=l,s.inputString="",h[1]}return null}}),new Je({type:Xe.MONTH,terms:["MM"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getMonth()+1,2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{let l=Number(o);s.dateInfo.month=l-1,s.matchInfo.month=o},parseFunction:function(s,o){if(s.analyze&&s.inputString==="0"){let n=this.dateFormat._dateInfoToDate(s.dateInfo);if(!n)return null;let l=n.getMonth();return l>=9&&(l=0,s.dateInfo.year===void 0?s.dateInfo.year=Number(n.getFullYear())+1:s.dateInfo.year=s.dateInfo.year+1),s.dateInfo.month=l,s.matchInfo.month=y.padZeroLeft(String(l+1),2),s.inputString="","0"}return null}}),new Je({type:Xe.MONTH,terms:["M"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getMonth()+1),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{let l=Number(o);s.dateInfo.month=l-1,s.matchInfo.month=o}}),new Je({type:Xe.WEEK_IN_YEAR,terms:["ww"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(T.weekInYear(s.inputDate),2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.matchInfo.week=o,s.hints.weekInYear=Number(o)}}),new Je({type:Xe.WEEK_IN_YEAR,terms:["w"],dateFormat:this,formatFunction:(s,o)=>String(T.weekInYear(s.inputDate)),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.matchInfo.week=o,s.hints.weekInYear=Number(o)}}),new Je({type:Xe.DAY_IN_MONTH,terms:["dd"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getDate(),2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.day=Number(o),s.matchInfo.day=o},parseFunction:(s,o)=>s.analyze&&s.inputString==="0"?(s.dateInfo.day=1,s.matchInfo.day="01",s.inputString="","0"):null}),new Je({type:Xe.DAY_IN_MONTH,terms:["d"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getDate()),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.day=Number(o),s.matchInfo.day=o}}),new Je({type:Xe.WEEKDAY,terms:["EEEE"],dateFormat:this,formatFunction:function(s,o){return this.dateFormat.symbols.weekdays[s.inputDate.getDay()]},parseFunction:function(s,o){let n,l,d,h;for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if(l=this.dateFormat.symbols.weekdays[n],!!l&&(d=new RegExp("^("+y.quote(l)+")(.*)$","i"),h=d.exec(s.inputString),h))return s.matchInfo.weekday=h[1],s.hints.weekday=n,s.inputString=h[2],h[1];if(s.analyze){for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if(l=this.dateFormat.symbols.weekdays[n],d=new RegExp("^("+y.quote(s.inputString)+")(.*)$","i"),h=d.exec(l),h)return s.matchInfo.weekday=l,s.hints.weekday=n,s.inputString="",h[1]}return null}}),new Je({type:Xe.WEEKDAY,terms:["EEE","EE","E"],dateFormat:this,formatFunction:function(s,o){return this.dateFormat.symbols.weekdaysShort[s.inputDate.getDay()]},parseFunction:function(s,o){let n,l,d,h;for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if(l=this.dateFormat.symbols.weekdaysShort[n],!!l&&(d=new RegExp("^("+y.quote(l)+")(.*)$","i"),h=d.exec(s.inputString),h))return s.matchInfo.weekday=h[1],s.hints.weekday=n,s.inputString=h[2],h[1];if(s.analyze){for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if(l=this.dateFormat.symbols.weekdaysShort[n],d=new RegExp("^("+y.quote(s.inputString)+")(.*)$","i"),h=d.exec(l),h)return s.matchInfo.weekday=l,s.hints.weekday=n,s.inputString="",h[1]}return null}}),new Je({type:Xe.HOUR_24,terms:["HH"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getHours(),2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.hours=Number(o),s.matchInfo.hours=o}}),new Je({type:Xe.HOUR_24,terms:["H"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getHours()),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.hours=Number(o),s.matchInfo.hours=o}}),new Je({type:Xe.HOUR_12,terms:["hh"],dateFormat:this,formatFunction:(s,o)=>s.inputDate.getHours()%12===0?"12":y.padZeroLeft(s.inputDate.getHours()%12,2),parseRegExp:/^(10|11|12|0[1-9])(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.hours=Number(o)+(s.hints.pm?12:0),s.matchInfo.hours=o},parseFunction:(s,o)=>s.analyze&&s.inputString==="0"?(s.dateInfo.hours=1,s.matchInfo.hours="01",s.inputString="",s.inputString):null}),new Je({type:Xe.HOUR_12,terms:["h"],dateFormat:this,formatFunction:(s,o)=>s.inputDate.getHours()%12===0?"12":String(s.inputDate.getHours()%12),parseRegExp:/^(10|11|12|0?[1-9])(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.hours=Number(o)+(s.hints.pm?12:0),s.matchInfo.hours=o}}),new Je({type:Xe.AM_PM,terms:["a"],dateFormat:this,formatFunction:function(s,o){return s.inputDate.getHours()<12?this.dateFormat.symbols.am:this.dateFormat.symbols.pm},parseFunction:function(s,o){let n=new RegExp("^("+y.quote(this.dateFormat.symbols.am)+")(.*)$","i"),l=n.exec(s.inputString);if(s.matchInfo.ampm=null,l)return s.matchInfo.ampm=l[1],s.inputString=l[2],s.hints.am=!0,s.dateInfo.hours=s.dateInfo.hours%12,l[1];if(n=new RegExp("^("+y.quote(this.dateFormat.symbols.pm)+")(.*)$","i"),l=n.exec(s.inputString),l)return s.matchInfo.ampm=l[1],s.inputString=l[2],s.hints.pm=!0,s.dateInfo.hours=s.dateInfo.hours%12+12,l[1];if(s.analyze){if(n=new RegExp("^("+y.quote(s.inputString)+")(.*)$","i"),l=n.exec(this.dateFormat.symbols.am),l)return s.matchInfo.ampm=this.dateFormat.symbols.am,s.inputString="",s.hints.am=!0,s.dateInfo.hours=s.dateInfo.hours%12,l[1];if(l=n.exec(this.dateFormat.symbols.pm),l)return s.matchInfo.ampm=this.dateFormat.symbols.pm,s.inputString="",s.hints.pm=!0,s.dateInfo.hours=s.dateInfo.hours%12+12,l[1]}return null}}),new Je({type:Xe.MINUTE,terms:["mm"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getMinutes(),2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.minutes=Number(o),s.matchInfo.minutes=o},parseFunction:(s,o)=>{if(s.analyze&&u.isOneOf(s.inputString,"0","1","2","3","4","5")){let n=s.inputString+"0";return s.dateInfo.minutes=Number(n),s.matchInfo.minutes=n,s.inputString="",s.inputString}return null}}),new Je({type:Xe.MINUTE,terms:["m"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getMinutes()),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.minutes=Number(o),s.matchInfo.minutes=o}}),new Je({type:Xe.SECOND,terms:["ss"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getSeconds(),2),parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.seconds=Number(o),s.matchInfo.seconds=o}}),new Je({type:Xe.SECOND,terms:["s"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getSeconds()),parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.seconds=Number(o),s.matchInfo.seconds=o}}),new Je({type:Xe.MILLISECOND,terms:["SSS"],dateFormat:this,formatFunction:(s,o)=>y.padZeroLeft(s.inputDate.getMilliseconds(),3),parseRegExp:/^(\d{3})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.milliseconds=Number(o),s.matchInfo.milliseconds=o}}),new Je({type:Xe.MILLISECOND,terms:["S"],dateFormat:this,formatFunction:(s,o)=>String(s.inputDate.getMilliseconds()),parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:(s,o,n)=>{s.dateInfo.milliseconds=Number(o),s.matchInfo.milliseconds=o}}),new Je({type:Xe.TIMEZONE,terms:["Z"],dateFormat:this,formatFunction:(s,o)=>{let n=Math.abs(s.inputDate.getTimezoneOffset());return(n!==s.inputDate.getTimezoneOffset()?"-":"+")+y.padZeroLeft(Math.floor(n/60),2)+y.padZeroLeft(n%60,2)},parseRegExp:/^([+|-]\d{4})(.*)$/,applyMatchFunction:(s,o,n)=>{let l=Number(o.substr(1,2))*60+Number(o.substr(3,2));o.charAt(0)==="-"&&(l*=-1),s.dateInfo.timezone=l,s.matchInfo.timezone=o}})],this._patternLibrary={};for(let s=0;s<this._patternDefinitions.length;s++){let o=this._patternDefinitions[s],n=o.type;n&&(this._patternLibrary[n]||(this._patternLibrary[n]=[]),this._patternLibrary[n].push(o))}this._compile()}_compile(){let e,t,r,s,o,n,l,d,h;for(o=/(.)\1*/g;n=o.exec(this.pattern);){for(l=n[0],this._terms.push(l),d=!1,e=0;e<this._patternDefinitions.length;e++){s=this._patternDefinitions[e];let p=s.accept(l);if(p){if(this._formatFunctions.push(s.createFormatFunction(p)),this._parseFunctions.push(s.createParseFunction(p)),h=[s.createParseFunction(p)],this.lenient)for(r=this._patternLibrary[s.type],t=0;t<r.length;t++)r[t]!==s&&h.push(r[t].createParseFunction(p));this._analyzeFunctions.push(h),d=!0;break}}if(!d){this._formatFunctions.push(this._createConstantStringFormatFunction(l));let p=this._createConstantStringParseFunction(l);this._parseFunctions.push(p),this._analyzeFunctions.push([p])}}}_createConstantStringFormatFunction(e){return t=>{t.formattedString+=e}}_createConstantStringParseFunction(e){return t=>y.startsWith(t.inputString,e)?(t.inputString=t.inputString.substr(e.length),t.parsedPattern+=e,!0):t.analyze}format(e,t){if(!e)return"";let r=this._createFormatContext(e);r.exactLength=u.nvl(t,!1);for(let s=0;s<this._formatFunctions.length;s++){let o=this._formatFunctions[s];o(r)}return r.formattedString}analyze(e,t){let r=this._createAnalyzeInfo(e);if(!e)return r;let s=this._createParseContext(e);s.analyze=!0,s.startDate=t;let o="";for(let h=0;h<this._terms.length;h++)if(s.inputString.length>0){let p=this._analyzeFunctions[h],m=!1;for(let g=0;g<p.length;g++){let b=p[g];if(b(s)){m=!0;break}}if(!m)return r.error=!0,r;o=s.parsedPattern}else s.parsedPattern+=this._terms[h];if(s.inputString.length>0)return r.error=!0,r;t=this._prepareStartDate(t);let n=s.hints.weekday,l=s.dateInfo.day;n!==void 0&&(l!==void 0&&l<=31?t=T.shiftToNextDayAndDate(t,n,l):t=T.shiftToNextDayOfType(t,n));let d=this._dateInfoToDate(s.dateInfo,t,s.hints);return r.dateInfo=s.dateInfo,r.matchInfo=s.matchInfo,r.hints=s.hints,r.parsedPattern=s.parsedPattern,r.matchedPattern=o,r.predictedDate=d,r.error=!d,r}parse(e,t){if(!e)return null;let r=this._createParseContext(e);r.startDate=t;for(let o=0;o<this._parseFunctions.length;o++){let n=this._parseFunctions[o];if(!n(r))return null;if(r.inputString.length===0)break}if(r.inputString.length>0)return null;let s=this._dateInfoToDate(r.dateInfo,t);return!s||r.hints.weekday!==void 0&&s.getDay()!==r.hints.weekday?null:s}_dateInfoToDate(e,t,r){if(!e)return null;t=this._prepareStartDate(t);let s=new Date(1970,0,1),o=u.nvl(e.day,t.getDate()),n=u.nvl(e.month,t.getMonth()),l=u.nvl(e.year,t.getFullYear());if(e.day&&!e.month)if(e.day===31){let h=[0,2,4,6,7,9,11];u.isOneOf(n,h)||(n=n+1)}else e.day>=29&&n===1&&(e.day>29||!T.isLeapYear(l))&&(n=n+1);if(!e.day&&e.month){let h=T.shift(new Date(l,e.month+1,1),0,0,-1);o=Math.min(h.getDate(),t.getDate())}if(s.setFullYear(l,n,o),s.setHours(u.nvl(e.hours,t.getHours()),u.nvl(e.minutes,t.getMinutes()),u.nvl(e.seconds,t.getSeconds()),u.nvl(e.milliseconds,t.getMilliseconds())),!d(s.getFullYear(),e.year)||!d(s.getMonth(),e.month)||!d(s.getDate(),e.day)||!d(s.getHours(),e.hours)||!d(s.getMinutes(),e.minutes)||!d(s.getSeconds(),e.seconds)||!d(s.getMilliseconds(),e.milliseconds)||!d(s.getDay(),r==null?void 0:r.weekday))return null;return Ge.isNumber(e.timezone)&&s.setMinutes(s.getMinutes()-s.getTimezoneOffset()+e.timezone),s;function d(h,p){return v.isNullOrUndefined(p)||p===h}}_prepareStartDate(e){return e?new Date(e.getTime()):T.trunc(new Date)}_createFormatContext(e){return{inputDate:e,formattedString:"",exactLength:!1}}_createParseContext(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",analyze:!1,startDate:null}}_createAnalyzeInfo(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",matchedPattern:"",predictedDate:null,error:!1}}static ensure(e,t){return!t||t instanceof Ft?t:new Ft(e,t)}}function oi(i,e,t){return e=iS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iS(i){var e=rS(i,"string");return typeof e=="symbol"?e:String(e)}function rS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ur{constructor(e,t){oi(this,"positivePrefix",void 0),oi(this,"positiveSuffix",void 0),oi(this,"negativePrefix",void 0),oi(this,"negativeSuffix",void 0),oi(this,"groupingChar",void 0),oi(this,"lenientGroupingChars",void 0),oi(this,"groupLength",void 0),oi(this,"decimalSeparatorChar",void 0),oi(this,"zeroBefore",void 0),oi(this,"zeroAfter",void 0),oi(this,"allAfter",void 0),oi(this,"pattern",void 0),oi(this,"multiplier",void 0),oi(this,"roundingMode",void 0),this.positivePrefix="",this.positiveSuffix="",this.negativePrefix=e.decimalFormatSymbols.minusSign,this.negativeSuffix="",this.groupingChar=e.decimalFormatSymbols.groupingSeparator,this.lenientGroupingChars="'´`’·    ",this.groupLength=0,this.decimalSeparatorChar=e.decimalFormatSymbols.decimalSeparator,this.zeroBefore=1,this.zeroAfter=0,this.allAfter=0,typeof t=="string"?(this.pattern=t,this.multiplier=1,this.roundingMode=or.HALF_UP):(t=t||{pattern:null},this.pattern=this.pattern||t.pattern||e.decimalFormatPatternDefault,this.multiplier=t.multiplier||1,this.roundingMode=t.roundingMode||or.HALF_UP);let r=Ur.PATTERN_SYMBOLS,s=this.pattern.split(r.patternSeparator),o=d(s[0]);if(this.positivePrefix=o.prefix,this.positiveSuffix=o.suffix,s.length>1){let h=d(s[1]);this.negativePrefix=h.prefix,this.negativeSuffix=h.suffix,this.pattern=s[0]}else this.positivePrefix.indexOf(r.minusSign)!==-1||this.positiveSuffix.indexOf(r.minusSign)!==-1?(this.negativePrefix=this.positivePrefix.replace(r.minusSign,e.decimalFormatSymbols.minusSign),this.negativeSuffix=this.positiveSuffix.replace(r.minusSign,e.decimalFormatSymbols.minusSign),this.positivePrefix=this.positivePrefix.replace(r.minusSign,""),this.positiveSuffix=this.positiveSuffix.replace(r.minusSign,"")):(this.negativePrefix=this.positivePrefix+this.negativePrefix,this.negativeSuffix=this.negativeSuffix+this.positiveSuffix);let n=this.pattern.indexOf(r.decimalSeparator);n===-1&&(n=this.pattern.length);let l=this.pattern.lastIndexOf(r.groupingSeparator,n);l>0&&(this.groupLength=n-l-1),this.pattern=this.pattern.replace(new RegExp("["+r.groupingSeparator+"]","g"),""),s=this.pattern.split(r.decimalSeparator),this.zeroBefore=y.count(s[0],r.zeroDigit),s.length>1&&(this.zeroAfter=y.count(s[1],r.zeroDigit),this.allAfter=this.zeroAfter+y.count(s[1],r.digit));function d(h){let p={prefix:"",suffix:""},m=r.digit+r.zeroDigit+r.decimalSeparator+r.groupingSeparator,g=new RegExp("^(.*?)["+m+"].*$"),b=g.exec(h);return b!==null&&(p.prefix=b[1].replace(new RegExp("'([^']+)'","g"),"$1")),g=new RegExp("^.*["+m+"](.*?)$"),b=g.exec(h),b!==null&&(p.suffix=b[1].replace(new RegExp("'([^']+)'","g"),"$1")),p}}parse(e,t){if(y.empty(e))return null;let r=this.normalize(e);t=t||Number;let s=t(r);if(isNaN(s))throw new Error(e+" is not a number (NaN)");return this.multiplier!==1&&(s/=this.multiplier),s}format(e,t){if(e==null)return null;let r=this.positivePrefix,s=this.positiveSuffix;t=u.nvl(t,!0),t&&this.multiplier!==1&&(e*=this.multiplier),e=this.round(e);let o="";if(this.allAfter){o=e.toFixed(this.allAfter).split(".")[1];for(let d=o.length-1;d>this.zeroAfter-1&&o[d]==="0";d--)o=o.slice(0,-1);o&&(o=this.decimalSeparatorChar+o)}e<0&&(r=this.negativePrefix,s=this.negativeSuffix,e=-e);let n=Math.floor(e),l=n===0?"":String(n);if(l=y.padZeroLeft(l,this.zeroBefore),this.groupLength)for(let d=l.length-this.groupLength;d>0;d-=this.groupLength)l=l.substr(0,d)+this.groupingChar+l.substr(d);return r+l+o+s}round(e,t){return t=u.nvl(t,!0),e==null?null:(t&&this.multiplier!==1&&(e*=this.multiplier),e=Ge.round(e,this.roundingMode,this.allAfter),t&&this.multiplier!==1&&(e/=this.multiplier),e)}normalize(e){return e&&e.replace(new RegExp("["+this.groupingChar+this.lenientGroupingChars+"]","g"),"").replace(new RegExp("["+this.decimalSeparatorChar+"]","g"),".").replace(/\s/g,"")}static ensure(e,t){return!t||t instanceof Ur?t:new Ur(e,t)}}oi(Ur,"PATTERN_SYMBOLS",{digit:"#",zeroDigit:"0",decimalSeparator:".",groupingSeparator:",",minusSign:"-",patternSeparator:";"});function Sh(i,e,t){return e=sS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sS(i){var e=oS(i,"string");return typeof e=="symbol"?e:String(e)}function oS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vr{constructor(e){Sh(this,"map",void 0),Sh(this,"parent",void 0),this.map=e||{}}get(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];if(!this._exists(e))return this.parent?this.parent.get(e,...r):"[undefined text: "+e+"]";let o=r.length,n=this.map[e];if(o===0)return n;for(let l=0;l<o;l++)n=n.replace(new RegExp("\\{"+l+"\\}","g"),r[l]);return n}optGet(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];return this._exists(e)?this.get(e,...s):this.parent?this.parent.optGet(e,t,...s):t}exists(e){return this._exists(e)?!0:this.parent?this.parent.exists(e):!1}_exists(e){return this.map.hasOwnProperty(e)}add(e,t){this.map[e]=t}addAll(e){!e||(e instanceof Vr&&(e=e.map),v.copyOwnProperties(e,this.map))}setParent(e){this.parent=e}remove(e){delete this.map[e]}}Sh(Vr,"TEXT_KEY_REGEX",/\${textKey:([a-zA-Z0-9.]*)}/);const Ce={TEXT_KEY_REGEX:/\${textKey:([^}]*)}/,textsByLocale:{},bootstrap(i){if(!i)return a().resolvedPromise({});let e=[];return f.ensure(i).forEach(r=>e.push(a().ajaxJson(r).then(Ce._preInit.bind(this,r)))),a().promiseAll(e)},_setTextsByLocale(i){Ce.textsByLocale=i},_preInit(i,e){if(e&&e.error)throw{error:e.error,url:i};Ce.init(e)},init(i){Object.keys(i).forEach(e=>Ce.get(e).addAll(i[e]),this)},link(i){let e=Ce.createOrderedLanguageTags(i),t;e.forEach(r=>{let s=Ce._get(r);s||(s=new Vr,Ce.put(r,s)),t&&t.setParent(s),t=s},this)},createOrderedLanguageTags(i){let e=[],t=i.lastIndexOf("-");for(e.push(i);t>=0;)i=i.substring(0,t),e.push(i),t=i.lastIndexOf("-");return i!=="default"&&e.push("default"),e},get(i){let e=Ce._get(i);if(e)return e;if(Ce.link(i),e=Ce._get(i),!e)throw new Error("Texts missing for the language tag "+i);return e},_get(i){return Ce.textsByLocale[i]},put(i,e){Ce.textsByLocale[i]=e},readFromDOM(){let i={};return a()("scout-text").each(function(){let e=a()(this).data("key"),t=a()(this).data("value");i[e]=t}),i},buildKey(i){return"${textKey:"+i+"}"},resolveKey(i){let e=Ce.TEXT_KEY_REGEX.exec(i);return e&&e.length===2?e[1]:i},resolveText(i,e){let t=Ce.resolveKey(i);return t!==i?Ce.get(e).get(t):i},resolveTextProperty(i,e,t){e=e||"text",t=i.session||t;let r=i[e],s=Ce.resolveText(r,t.locale.languageTag);s!==r&&(i[e]=s)}};function ot(i,e,t){return e=nS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nS(i){var e=lS(i,"string");return typeof e=="symbol"?e:String(e)}function lS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class lr extends I{constructor(){super(),ot(this,"text",void 0),ot(this,"severity",void 0),ot(this,"arrowPosition",void 0),ot(this,"arrowPositionUnit",void 0),ot(this,"windowPaddingX",void 0),ot(this,"windowPaddingY",void 0),ot(this,"origin",void 0),ot(this,"originRelativeToParent",void 0),ot(this,"autoRemove",void 0),ot(this,"tooltipPosition",void 0),ot(this,"tooltipDirection",void 0),ot(this,"scrollType",void 0),ot(this,"htmlEnabled",void 0),ot(this,"dialog",void 0),ot(this,"menus",void 0),ot(this,"$anchor",void 0),ot(this,"$arrow",void 0),ot(this,"$content",void 0),ot(this,"$menus",void 0),ot(this,"_openLater",void 0),ot(this,"_mouseDownHandler",void 0),ot(this,"_keydownHandler",void 0),ot(this,"_anchorScrollHandler",void 0),ot(this,"_moveHandler",void 0),this.text=null,this.severity=E.Severity.INFO,this.arrowPosition=16,this.arrowPositionUnit="px",this.windowPaddingX=10,this.windowPaddingY=5,this.origin=null,this.originRelativeToParent=!1,this.autoRemove=!0,this.tooltipPosition="top",this.tooltipDirection="right",this.scrollType="position",this.htmlEnabled=!1,this.menus=[],this.$anchor=null,this.$arrow=null,this.$content=null,this._addWidgetProperties(["menus"]),this._openLater=!1}render(e){let t=e||this.entryPoint();if(!t||!t.length||!t.isAttached()){this._openLater=!0,this.$parent=t;return}super.render(t)}_render(){this.$container=this.$parent.appendDiv("tooltip").data("tooltip",this),this.findDesktop().adjustOverlayOrder(this),this.cssClass&&this.$container.addClass(this.cssClass),this.$arrow=this.$container.appendDiv("tooltip-arrow"),this.$content=this.$container.appendDiv("tooltip-content"),this._renderText(),this._renderSeverity(),this._renderMenus(),this.autoRemove&&(this._mouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._mouseDownHandler,!0),this._keydownHandler=this._onDocumentKeyDown.bind(this),this.$container.document().on("keydown",this._keydownHandler)),this.$anchor&&this.scrollType&&(this._anchorScrollHandler=this._onAnchorScroll.bind(this),x.onScroll(this.$anchor,this._anchorScrollHandler)),this.dialog=this.findParent(e=>e instanceof Y&&e.isDialog()),this.dialog&&(this._moveHandler=this.position.bind(this),this.dialog.on("move",this._moveHandler))}_postRender(){super._postRender(),this.position()}_remove(){this._mouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._mouseDownHandler,!0),this._mouseDownHandler=null),this._keydownHandler&&(this.$container.document().off("keydown",this._keydownHandler),this._keydownHandler=null),this._anchorScrollHandler&&(x.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._moveHandler&&(this.dialog&&this.dialog.off("move",this._moveHandler),this._moveHandler=null),this.dialog=null,this.$menus=null,super._remove()}_destroy(){super._destroy(),this.menus.forEach(e=>{e.popup&&e.popup.close()})}_onAttach(){super._onAttach(),this._openLater&&!this.rendered&&(this._openLater=!1,this.render())}_renderOnDetach(){this._openLater=!0,this.remove(),super._onDetach()}_isRemovalPrevented(){return this.removalPending}setText(e){this.setProperty("text",e)}setSeverity(e){this.setProperty("severity",e)}_renderText(){let e=this.text||"";this.htmlEnabled?this.$content.html(e):this.$content.html(y.nl2br(e)),this.$content.setVisible(!!e),this.$container.toggleClass("no-text",!e),this.rendering||this.position()}_renderSeverity(){this.$container.removeClass(E.SEVERITY_CSS_CLASSES),this.$container.addClass(E.cssClassForSeverity(this.severity))}setMenus(e){e=f.ensure(e),this.setProperty("menus",e)}_renderMenus(){let e=0,t=this.menus;t.length>0&&!this.$menus?this.$menus=this.$container.appendDiv("tooltip-menus"):t.length===0&&this.$menus&&(this.$menus.remove(),this.$menus=null),t.forEach(r=>{let s=0;r.render(this.$menus),r.iconId&&(s=r.get$Icon().outerWidth(!0),e=Math.max(s,e))}),e>0&&t.forEach(r=>{r.iconId?r.$text.cssPaddingLeft(e-r.get$Icon().outerWidth(!0)):r.$text.cssPaddingLeft(e)}),this.$container.toggleClass("has-menus",t.length>0),this.rendering||(this.$container.cssLeft("").cssTop(""),this.position())}position(){let e,t,r,s,o,n,l,d,h,p,m,g,b;if(this.origin?(h=this.origin,l=h.x):(h=w.offsetBounds(this.$anchor),l=h.x+h.width/2),d=h.y,this.$anchor&&(b=x.isLocationInView(h,this.$anchor.scrollParent()),this.$container.setVisible(b)),!this.originRelativeToParent){let C=this.$parent.offset();l-=C.left,d-=C.top}r=7,s=4,m=this.$container.outerHeight(),p=this.$container.outerWidth(),g=this.arrowPosition,this.arrowPositionUnit==="%"&&(g=p*this.arrowPosition/100),this.tooltipDirection==="left"&&(g=p-g),e=d-m-s,t=l-g,o=t+p+this.windowPaddingX-this.$parent.width(),n=e-this.windowPaddingY,o>0&&(t-=o,g=l-t),t<this.windowPaddingX&&(t=this.windowPaddingX,g=l-this.windowPaddingX),this.$arrow.removeClass("arrow-top arrow-bottom"),this.tooltipPosition==="bottom"||n<0?(this.$arrow.addClass("arrow-top"),e=d+h.height+s):this.$arrow.addClass("arrow-bottom"),g=Math.min(g,this.$container.outerWidth()-r),g=Math.max(g,r),this.$arrow.cssLeft(g-this.$arrow.cssBorderLeftWidth()),this.$container.cssLeft(t).cssTop(e),this.menus.forEach(C=>{C.popup&&C.popup.position()},this)}_onAnchorScroll(e){!this.rendered||(this.scrollType==="position"?this.position():this.scrollType==="remove"&&this.destroy())}_onDocumentMouseDown(e){if(!this.rendered)return!1;this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}_isMouseDownOutside(e){let t=e.target,r=a()(t),s=u.widget(r);return!this.isOrHas(s)&&this.$anchor&&!this.$anchor.isOrHas(r[0])&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])}_onMouseDownOutside(e){this.destroy()}_onDocumentKeyDown(e){u.isOneOf(e.which,_.CTRL,_.SHIFT,_.ALT,_.NUM_LOCK,_.CAPS_LOCK,_.SCROLL_LOCK,_.WIN_LEFT,_.WIN_RIGHT,_.SELECT,_.PAUSE,_.PRINT_SCREEN)||this.destroy()}}function Zn(i,e,t){return e=aS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aS(i){var e=dS(i,"string");return typeof e=="symbol"?e:String(e)}function dS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class da{constructor(e){Zn(this,"_options",void 0),Zn(this,"_mouseEnterHandler",void 0),Zn(this,"_mouseLeaveHandler",void 0),Zn(this,"_tooltip",void 0),Zn(this,"_tooltipTimeoutId",void 0);let t={selector:null,delay:G.DEFAULT_TOOLTIP_DELAY,text:void 0,nativeTooltip:!1};e=a().extend({},t,e),this._options=e,this._mouseEnterHandler=this._onMouseEnter.bind(this),this._mouseLeaveHandler=this._onMouseLeave.bind(this),this._tooltip=null,this._tooltipTimeoutId=null}install(e){e.data("tooltipSupport")||e.on("mouseenter",this._options.selector,this._mouseEnterHandler).on("mouseleave",this._options.selector,this._mouseLeaveHandler).data("tooltipSupport",this)}uninstall(e){e.removeData("tooltipSupport").off("mouseleave",this._options.selector,this._mouseLeaveHandler).off("mouseenter",this._options.selector,this._mouseEnterHandler),this._destroyTooltip()}update(e,t){a().extend(this._options,t),this._tooltip&&this._showTooltip(e)}cancel(e){clearTimeout(this._tooltipTimeoutId)}close(){this._destroyTooltip()}_onMouseEnter(e){let t=a()(e.currentTarget);if(this._options.nativeTooltip){let r=this._text(t);t.attr("title",r)}else clearTimeout(this._tooltipTimeoutId),this._tooltipTimeoutId=setTimeout(this._showTooltip.bind(this,t),this._options.delay)}_onMouseLeave(e){this._destroyTooltip()}_destroyTooltip(){clearTimeout(this._tooltipTimeoutId),this._tooltip&&(this._tooltip.destroy(),this._tooltip=null)}_text(e){let t=this._options.text||e.data("tooltipText");return a().isFunction(t)&&(t=t(e)),t}_htmlEnabled(e){let t=this._options.htmlEnabled||e.data("htmlEnabled");return a().isFunction(t)&&(t=t(e)),u.nvl(t,!1)}_showTooltip(e){if(!e||!e.isAttached())return;let t=this._text(e);if(!t)return;let r=this._htmlEnabled(e);if(this._tooltip&&this._tooltip.rendered)this._tooltip.setText(t),this._tooltip.setSeverity(this._options.severity),this._tooltip.setMenus(this._options.menus);else{let s=a().extend({},this._options,{$anchor:this._options.$anchor||e,text:t,htmlEnabled:r});this._tooltip=u.create(lr,s),this._tooltip.render()}}}const G={DEFAULT_TOOLTIP_DELAY:600,LONG_TOOLTIP_DELAY:1e3,install(i,e){let t=i.data("tooltipSupport");t?t.update(i,e):(t=new da(e),t.install(i))},uninstall(i){let e=i.data("tooltipSupport");e&&e.uninstall(i)},update(i,e){let t=i.data("tooltipSupport");t&&t.update(i,e)},close(i){let e=i.data("tooltipSupport");e&&e.close()},cancel(i){let e=i.data("tooltipSupport");e&&e.cancel(i)},installForEllipsis(i,e){let t={text:r=>{if(r.isContentTruncated())return r.text()},nativeTooltip:!F.get().isCustomEllipsisTooltipPossible()};e=a().extend({},t,e),G.install(i,e)},find(i){let e,t,r,s=[];for(e=a()(".tooltip",i.document(!0)),t=0;t<e.length;t++)r=e.eq(t).data("tooltip"),i.has(r.$anchor).length>0&&s.push(r);return s}};function en(i,e,t){return e=hS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hS(i){var e=uS(i,"string");return typeof e=="symbol"?e:String(e)}function uS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Dm extends lr{constructor(){super(),en(this,"keyStrokeStopPropagationInterceptor",void 0),en(this,"withFocusContext",void 0),en(this,"initialFocus",void 0),en(this,"focusableContainer",void 0),en(this,"content",void 0),en(this,"$widgetContainer",void 0),this.$widgetContainer=null,this.content=null,this._addWidgetProperties(["content"]),this.keyStrokeStopPropagationInterceptor=e=>{u.isOneOf(e.which,_.ESC,_.ENTER)||e.stopPropagation()},this.withFocusContext=!0,this.initialFocus=()=>It.AUTO,this.focusableContainer=!1}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeStopPropagationInterceptor&&this.keyStrokeContext.registerStopPropagationInterceptor(this.keyStrokeStopPropagationInterceptor)}_render(){super._render(),this.$container.addClass("widget-tooltip"),this.$widgetContainer=this.$container.appendDiv("tooltip-widget-container")}_renderProperties(){super._renderProperties(),this._renderContent()}_remove(){this._removeContent(),super._remove()}setContent(e){this.setProperty("content",e)}_renderContent(){this.content&&(this.content.render(this.$widgetContainer),this.content.$container.addClass("widget"),this.content.pack()),this.$widgetContainer.setVisible(!!this.content),this.rendering||this.position(),this.withFocusContext&&this.content&&this.session.focusManager.installFocusContext(this.$widgetContainer,this.initialFocus())}_removeContent(){this.content&&(this.session.focusManager.uninstallFocusContext(this.$widgetContainer),this.content.remove())}}function Qe(i,e,t){return e=cS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cS(i){var e=pS(i,"string");return typeof e=="symbol"?e:String(e)}function pS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class oe extends I{constructor(){super(),Qe(this,"actionStyle",void 0),Qe(this,"compact",void 0),Qe(this,"compactOrig",void 0),Qe(this,"iconId",void 0),Qe(this,"horizontalAlignment",void 0),Qe(this,"keyStroke",void 0),Qe(this,"keyStrokeFirePolicy",void 0),Qe(this,"selected",void 0),Qe(this,"preventDoubleClick",void 0),Qe(this,"tabbable",void 0),Qe(this,"actionKeyStroke",void 0),Qe(this,"text",void 0),Qe(this,"textPosition",void 0),Qe(this,"htmlEnabled",void 0),Qe(this,"textVisible",void 0),Qe(this,"textVisibleOrig",void 0),Qe(this,"toggleAction",void 0),Qe(this,"tooltipText",void 0),Qe(this,"showTooltipWhenSelected",void 0),Qe(this,"tooltipPosition",void 0),Qe(this,"icon",void 0),Qe(this,"$text",void 0),Qe(this,"_doubleClickSupport",void 0),this.actionStyle=oe.ActionStyle.DEFAULT,this.compact=!1,this.iconId=null,this.horizontalAlignment=-1,this.keyStroke=null,this.keyStrokeFirePolicy=oe.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,this.selected=!1,this.preventDoubleClick=!1,this.tabbable=!1,this.text=null,this.textPosition=oe.TextPosition.DEFAULT,this.htmlEnabled=!1,this.textVisible=!0,this.toggleAction=!1,this.tooltipText=null,this.showTooltipWhenSelected=!0,this._doubleClickSupport=new Vs,this._addCloneProperties(["actionStyle","horizontalAlignment","iconId","selected","preventDoubleClick","tabbable","text","textPosition","htmlEnabled","tooltipText","toggleAction"])}_createKeyStrokeContext(){return new Oe}_init(e){super._init(e),this.actionKeyStroke=this._createActionKeyStroke(),this.resolveConsts([{property:"actionStyle",constType:oe.ActionStyle},{property:"textPosition",constType:oe.TextPosition},{property:"keyStrokeFirePolicy",constType:oe.KeyStrokeFirePolicy}]),this.resolveTextKeys(["text","tooltipText"]),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke)}_render(){this.$container=this.$parent.appendDiv("action").on("mousedown",e=>this._doubleClickSupport.mousedown(e)).on("click",this._onClick.bind(this)),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}_createLayout(){return new jo}_renderProperties(){super._renderProperties(),this._renderText(),this._renderTextPosition(),this._renderIconId(),this._renderTooltipText(),this._renderKeyStroke(),this._renderSelected(),this._renderTabbable(),this._renderCompact()}_remove(){this._removeText(),this._removeIconId(),super._remove()}setActionStyle(e){this.setProperty("actionStyle",e)}setText(e){this.setProperty("text",e)}_renderText(){let e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),S.install(this.$text,this.session)),this.htmlEnabled?this.$text.html(e):this.$text.text(e)):this._removeText()}_removeText(){this.$text&&(this.$text.remove(),this.$text=null)}setTextPosition(e){this.setProperty("textPosition",e)}_renderTextPosition(){this.$container.toggleClass("bottom-text",this.textPosition===oe.TextPosition.BOTTOM),this.invalidateLayoutTree()}setHtmlEnabled(e){this.setProperty("htmlEnabled",e)}_renderHtmlEnabled(){this._renderText()}setIconId(e){this.setProperty("iconId",e)}_renderIconId(){let e=this.iconId||"";if(!e){this._removeIconId();return}if(this.icon){this.icon.setIconDesc(e);return}this.icon=u.create(Qr,{parent:this,iconDesc:e,prepend:!0}),this.icon.one("destroy",()=>{this.icon=null}),this.icon.render()}get$Icon(){return this.icon?this.icon.$container:a()()}_removeIconId(){this.icon&&this.icon.destroy()}_renderEnabled(){super._renderEnabled(),this.rendered&&(this._updateTooltip(),this._renderTabbable())}setTooltipText(e){this.setProperty("tooltipText",e)}_renderTooltipText(){this._updateTooltip()}_updateTooltip(){this._shouldInstallTooltip()?G.install(this.$container,this._configureTooltip()):G.uninstall(this.$container)}_shouldInstallTooltip(){let e=this.tooltipText&&this.enabledComputed;return!this.showTooltipWhenSelected&&this.selected&&(e=!1),e}setTabbable(e){this.setProperty("tabbable",e)}_renderTabbable(){this.$container.setTabbable(this.tabbable&&this.enabledComputed&&!F.get().supportsOnlyTouch())}setCompact(e){this.compact!==e&&(this.compact=e,this.rendered&&this._renderCompact())}_renderCompact(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}setTooltipPosition(e){this.setProperty("tooltipPosition",e)}_configureTooltip(){return{parent:this,text:this.tooltipText,$anchor:this.$container,arrowPosition:50,arrowPositionUnit:"%",tooltipPosition:this.tooltipPosition}}doAction(){return this.prepareDoAction()?(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction(),!0):!1}toggle(){this.isToggleAction()&&this.setSelected(!this.selected)}setToggleAction(e){this.setProperty("toggleAction",e)}isToggleAction(){return this.toggleAction}prepareDoAction(){return!(!this.enabledComputed||!this.visible)}_doAction(){this.trigger("action")}setSelected(e){this.setProperty("selected",e)}_renderSelected(){this.$container.toggleClass("selected",this.selected),this.rendered&&this._updateTooltip()}setKeyStroke(e){this.setProperty("keyStroke",e)}_setKeyStroke(e){this.actionKeyStroke.parseAndSetKeyStroke(e),this._setProperty("keyStroke",e)}_renderKeyStroke(){let e=this.keyStroke;e===void 0?this.$container.removeAttr("data-shortcut"):this.$container.attr("data-shortcut",e)}setTextVisible(e){this.textVisible!==e&&(this._setProperty("textVisible",e),this.rendered&&this._renderText())}setHorizontalAlignment(e){this.setProperty("horizontalAlignment",e)}_createActionKeyStroke(){return new Qs(this)}setPreventDoubleClick(e){this.setProperty("preventDoubleClick",e)}_allowMouseEvent(e){return!(e.which!==1||e.type==="click"&&this.preventDoubleClick&&this._doubleClickSupport.doubleClicked())}_onClick(e){!this._allowMouseEvent(e)||(G.cancel(this.$container),this.doAction())}}Qe(oe,"ActionStyle",{DEFAULT:0,BUTTON:1}),Qe(oe,"TextPosition",{DEFAULT:"default",BOTTOM:"bottom"}),Qe(oe,"KeyStrokeFirePolicy",{ACCESSIBLE_ONLY:0,ALWAYS:1});class bs extends He{constructor(){super(),this._addRemoteProperties(["selected"])}_goOffline(){this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1)}_goOnline(){this.widget.setEnabled(this._enabledBeforeOffline)}_onWidgetAction(e){this.widget.isToggleAction()||this._send("action")}_onWidgetEvent(e){e.type==="action"?this._onWidgetAction(e):super._onWidgetEvent(e)}}class ha extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE,_.ENTER],this.stopPropagation=!0}handle(e){this.field.doAction()}}class Qs extends B{constructor(e){super(),this.field=e,this.parseAndSetKeyStroke(e.keyStroke),this.keyStrokeFirePolicy=e.keyStrokeFirePolicy,this.stopPropagation=!0,this.stopImmediatePropagation=!0}_isEnabled(){return this.which.length?super._isEnabled():!1}handle(e){this.field.doAction()}}function Jr(i,e,t){return e=fS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fS(i){var e=mS(i,"string");return typeof e=="symbol"?e:String(e)}function mS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ua{constructor(){Jr(this,"rendered",void 0),Jr(this,"logoUrl",void 0),Jr(this,"$parent",void 0),Jr(this,"$container",void 0),Jr(this,"$backgroundElements",void 0),Jr(this,"$wrapper",void 0),Jr(this,"$content",void 0),Jr(this,"$header",void 0),Jr(this,"$logo",void 0),this.rendered=!1,this.logoUrl=null,this.$parent=null,this.$container=null,this.$backgroundElements=null,this.$wrapper=null,this.$content=null,this.$header=null,this.$logo=null}render(e){this.$parent=e,this._render(),this.rendered=!0}remove(){this.$container.remove(),this.$container=null,this.rendered=!1}_render(){this.$backgroundElements=a()("<div>").addClass("box-background-elements").appendTo(this.$parent),a()("<div>").addClass("box-background-element-1").appendTo(this.$backgroundElements),a()("<div>").addClass("box-background-element-2").appendTo(this.$backgroundElements),a()("<div>").addClass("box-background-element-3").appendTo(this.$backgroundElements),this.$container=a()("<div>").addClass("box").appendTo(this.$parent),this.$wrapper=a()("<div>").addClass("wrapper").appendTo(this.$container),this.$content=a()("<div>").addClass("box-content").appendTo(this.$wrapper),this.logoUrl&&(this.$header=this.$content.appendDiv("header"),this.$logo=a()("<img>").addClass("logo").attr("src",this.logoUrl).appendTo(this.$header))}}function Ch(i,e,t){return e=gS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gS(i){var e=_S(i,"string");return typeof e=="symbol"?e:String(e)}function _S(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ca extends I{constructor(){super(),Ch(this,"value",void 0),Ch(this,"htmlEnabled",void 0),Ch(this,"scrollable",void 0),this.value=null,this.htmlEnabled=!1,this.scrollable=!1}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new hn(this,this._onAppLinkAction))}_init(e){super._init(e),this.resolveTextKeys(["value"])}_render(){this.$container=this.$parent.appendDiv(),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderValue(),this._renderScrollable()}setValue(e){this.setProperty("value",e)}_renderValue(){let e=this.value||"";this.htmlEnabled?(this.$container.html(e),this.$container.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this))):this.$container.html(y.nl2br(e)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollable()),this.invalidateLayoutTree()}setHtmlEnabled(e){this.setProperty("htmlEnabled",e)}_renderHtmlEnabled(){this._renderValue()}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this.scrollable?this._installScrollbars():this._uninstallScrollbars()}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}_onImageLoad(e){this.invalidateLayoutTree()}_onImageError(e){this.invalidateLayoutTree()}}class Mm extends He{_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function se(i,e,t){return e=bS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bS(i){var e=yS(i,"string");return typeof e=="symbol"?e:String(e)}function yS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class pe extends I{constructor(){super(),se(this,"anchorBounds",void 0),se(this,"animateOpening",void 0),se(this,"animateResize",void 0),se(this,"anchor",void 0),se(this,"windowPaddingX",void 0),se(this,"windowPaddingY",void 0),se(this,"withGlassPane",void 0),se(this,"withFocusContext",void 0),se(this,"initialFocus",void 0),se(this,"focusableContainer",void 0),se(this,"horizontalAlignment",void 0),se(this,"verticalAlignment",void 0),se(this,"calculatedHorizontalAlignment",void 0),se(this,"calculatedVerticalAlignment",void 0),se(this,"horizontalSwitch",void 0),se(this,"verticalSwitch",void 0),se(this,"trimWidth",void 0),se(this,"trimHeight",void 0),se(this,"scrollType",void 0),se(this,"windowResizeType",void 0),se(this,"boundToAnchor",void 0),se(this,"withArrow",void 0),se(this,"closeOnAnchorMouseDown",void 0),se(this,"closeOnMouseDownOutside",void 0),se(this,"closeOnOtherPopupOpen",void 0),se(this,"modal",void 0),se(this,"$anchor",void 0),se(this,"$arrow",void 0),se(this,"$arrowOverlay",void 0),se(this,"_documentMouseDownHandler",void 0),se(this,"_anchorScrollHandler",void 0),se(this,"_anchorLocationChangeHandler",void 0),se(this,"_popupOpenHandler",void 0),se(this,"_glassPaneRenderer",void 0),se(this,"_openLater",void 0),se(this,"_windowResizeHandler",void 0),se(this,"_anchorRenderHandler",void 0),se(this,"_withGlassPane",void 0),se(this,"_closeOnAnchorMouseDown",void 0),se(this,"_closeOnMouseDownOutside",void 0),se(this,"_closeOnOtherPopupOpen",void 0),this._documentMouseDownHandler=null,this._anchorScrollHandler=null,this._anchorLocationChangeHandler=null,this._popupOpenHandler=null,this._glassPaneRenderer=null,this.anchorBounds=null,this.animateOpening=!1,this.animateResize=!1,this.anchor=null,this.$anchor=null,this.windowPaddingX=10,this.windowPaddingY=5,this.withGlassPane=!1,this._withGlassPane=null,this.withFocusContext=!0,this.initialFocus=()=>It.AUTO,this.focusableContainer=!1,this.horizontalAlignment=pe.Alignment.LEFTEDGE,this.verticalAlignment=pe.Alignment.BOTTOM,this.calculatedHorizontalAlignment=this.horizontalAlignment,this.calculatedVerticalAlignment=this.verticalAlignment,this.horizontalSwitch=!1,this.verticalSwitch=!0,this.trimWidth=!1,this.trimHeight=!0,this.scrollType="remove",this.windowResizeType=null,this.boundToAnchor=!0,this.withArrow=!1,this.closeOnAnchorMouseDown=!0,this._closeOnAnchorMouseDown=null,this.closeOnMouseDownOutside=!0,this._closeOnMouseDownOutside=null,this.closeOnOtherPopupOpen=!0,this._closeOnOtherPopupOpen=null,this.modal=!1,this._openLater=!1,this.$arrow=null,this.$arrowOverlay=null,this._windowResizeHandler=this._onWindowResize.bind(this),this._anchorRenderHandler=this._onAnchorRender.bind(this),this._addWidgetProperties(["anchor"]),this._addPreserveOnPropertyChangeProperties(["anchor"])}_init(e){super._init(e),e.location&&(this.anchorBounds=new re(e.location.x,e.location.y,0,0)),this._setAnchor(this.anchor),this._setModal(this.modal)}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(this._createCloseKeyStroke())}_createCloseKeyStroke(){return new Jo(this)}_createLayout(){return new Ii(this)}_openWithoutParent(){if(!this.parent.destroyed){if(this.parent.rendered||this.parent.rendering){this.open(this._getDefaultOpen$Parent());return}this.parent.one("render",()=>{this.session.layoutValidator.schedulePostValidateFunction(()=>{this.destroyed||this.rendered||this.open()})})}}_getDefaultOpen$Parent(){return this.parent.entryPoint()}open(e){if(!e){this._openWithoutParent();return}if(this._triggerPopupOpenEvent(),this._open(e),!this._openLater){if(!this.animateOpening){this.validateFocus();return}this.$container.addClass("before-animate-open"),setTimeout(()=>{!this.rendered||this.removing||(this.$container.removeClass("before-animate-open"),this.validateFocus(),this.rendered&&this.$container.addClassForAnimation("animate-open"))})}}validateFocus(){if(!this.withFocusContext)return;let e=this.session.focusManager.getFocusContext(this.$container);e.ready(),e.lastValidFocusedElement||this._requestInitialFocus()}_requestInitialFocus(){let e=this.session.focusManager.evaluateFocusRule(this.$container,this.initialFocus());!e||this.session.focusManager.requestFocus(e)}_open(e){this.render(e),!this._openLater&&(this.revalidateLayout(),this.position())}render(e){let t=e||this.entryPoint();if(!t||!t.length||!t.isAttached()){this._openLater=!0;return}super.render(t)}_render(){this.$container=this.$parent.appendDiv("popup"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._windowResizeHandler)}_renderProperties(){super._renderProperties(),this._renderAnchor(),this._renderWithArrow(),this._renderWithFocusContext(),this._renderWithGlassPane(),this._renderModal()}_postRender(){super._postRender(),this._attachCloseHandlers(),this._attachAnchorHandlers(),this._handleGlassPanes()}_onAttach(){if(super._onAttach(),this._openLater&&!this.rendered){this._openLater=!1;let e=this.animateOpening;this.animateOpening=!1,this.open(),this.animateOpening=e}}_renderOnDetach(){this._openLater=!0,super.removeImmediately(),super._renderOnDetach()}remove(){let e=this.animateRemoval;this.boundToAnchor&&this.$anchor&&!this._isAnchorInView()&&(this.animateRemoval=!1),super.remove(),this.animateRemoval=e}_remove(){this.$container.window().off("resize",this._windowResizeHandler),this._glassPaneRenderer&&this._glassPaneRenderer.removeGlassPanes(),this.withFocusContext&&this.session.focusManager.uninstallFocusContext(this.$container),this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.anchor&&this.anchor.one("render",this._anchorRenderHandler),this._detachAnchorHandlers(),this._detachCloseHandlers(),super._remove()}_destroy(){this.anchor&&this.anchor.off("render",this._anchorRenderHandler),super._destroy()}_renderWithFocusContext(){!this.withFocusContext||(this.focusableContainer&&this.$container.attr("tabindex",-1),this.session.focusManager.installFocusContext(this.$container,It.PREPARE))}setModal(e){this.setProperty("modal",e)}_setModal(e){this._setProperty("modal",e),e?(ke.preserveAndSetProperty(()=>this.setProperty("withGlassPane",!0),()=>this.withGlassPane,this,"_withGlassPane"),ke.preserveAndSetProperty(()=>this.setProperty("closeOnAnchorMouseDown",!1),()=>this.closeOnAnchorMouseDown,this,"_closeOnAnchorMouseDown"),ke.preserveAndSetProperty(()=>this.setProperty("closeOnMouseDownOutside",!1),()=>this.closeOnMouseDownOutside,this,"_closeOnMouseDownOutside"),ke.preserveAndSetProperty(()=>this.setProperty("closeOnOtherPopupOpen",!1),()=>this.closeOnOtherPopupOpen,this,"_closeOnOtherPopupOpen")):(ke.resetProperty(t=>this.setWithGlassPane(t),this,"_withGlassPane"),ke.resetProperty(t=>this.setCloseOnAnchorMouseDown(t),this,"_closeOnAnchorMouseDown"),ke.resetProperty(t=>this.setCloseOnMouseDownOutside(t),this,"_closeOnMouseDownOutside"),ke.resetProperty(t=>this.setCloseOnOtherPopupOpen(t),this,"_closeOnOtherPopupOpen"))}_renderModal(){this.$container.toggleClass("modal",this.modal)}setWithGlassPane(e){this.modal?this._withGlassPane=e:this.setProperty("withGlassPane",e)}_renderWithGlassPane(){this.withGlassPane&&!this._glassPaneRenderer?(this._glassPaneRenderer=new js(this),this._glassPaneRenderer.renderGlassPanes()):!this.withGlassPane&&this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null)}setCloseOnMouseDownOutside(e){this.modal?this._closeOnMouseDownOutside=e:this.setProperty("closeOnMouseDownOutside",e)}_renderCloseOnMouseDownOutside(){this.closeOnMouseDownOutside&&!this._documentMouseDownHandler?(this._documentMouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._documentMouseDownHandler,!0)):!this.closeOnMouseDownOutside&&this._documentMouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),this._documentMouseDownHandler=null)}setCloseOnAnchorMouseDown(e){this.modal?this._closeOnAnchorMouseDown=e:this.setProperty("closeOnAnchorMouseDown",e)}setCloseOnOtherPopupOpen(e){this.modal?this._closeOnOtherPopupOpen=e:this.setProperty("closeOnOtherPopupOpen",e)}_renderCloseOnOtherPopupOpen(){this.closeOnOtherPopupOpen&&!this._popupOpenHandler?(this._popupOpenHandler=this._onPopupOpen.bind(this),this.session.desktop.on("popupOpen",this._popupOpenHandler)):!this.closeOnOtherPopupOpen&&this._popupOpenHandler&&(this.session.desktop.off("popupOpen",this._popupOpenHandler),this._popupOpenHandler=null)}setWithArrow(e){this.setProperty("withArrow",e)}_renderWithArrow(){this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.$arrowOverlay&&(this.$arrowOverlay.remove(),this.$arrowOverlay=null),this.withArrow&&(this.$arrowOverlay=this.$container.prependDiv("popup-arrow-overlay"),this.$arrow=this.$container.prependDiv("popup-arrow"),this._updateArrowClass()),this.$container.toggleClass("with-arrow",this.withArrow),this.invalidateLayoutTree()}_updateArrowClass(e,t){this.$arrow&&(this.$arrow.removeClass(this._alignClasses()),this.$arrow.addClass(this._computeArrowPositionClass(e,t)))}_computeArrowPositionClass(e,t){let r=pe.Alignment,s="";switch(t=t||this.horizontalAlignment,e=e||this.verticalAlignment,t){case r.LEFT:s=r.RIGHT;break;case r.RIGHT:s=r.LEFT;break;default:s=t;break}switch(e){case r.BOTTOM:s+=" "+r.TOP;break;case r.TOP:s+=" "+r.BOTTOM;break;default:s+=" "+e;break}return s}_animateRemovalWhileRemovingParent(){return this.$anchor?ke.get(this.$anchor)!==this.parent:!0}_isRemovalPrevented(){return this.removalPending}close(){if(this.destroyed||this.destroying)return;this.trigger("close").defaultPrevented||this.destroy()}_attachCloseHandlers(){this._renderCloseOnMouseDownOutside(),this._renderCloseOnOtherPopupOpen()}_attachAnchorHandlers(){if(!this.$anchor||!this.boundToAnchor||!this.scrollType)return;this._anchorScrollHandler=this._onAnchorScroll.bind(this),x.onScroll(this.$anchor,this._anchorScrollHandler);let e=u.widget(this.$anchor);e&&(this._anchorLocationChangeHandler=this._onAnchorLocationChange.bind(this),e.on("locationChange",this._anchorLocationChangeHandler))}_detachAnchorHandlers(){if(this._anchorScrollHandler&&(x.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._anchorLocationChangeHandler){let e=u.widget(this.$anchor);e&&(e.off("locationChange",this._anchorLocationChangeHandler),this._anchorLocationChangeHandler=null)}}_detachCloseHandlers(){this._popupOpenHandler&&(this.session.desktop.off("popupOpen",this._popupOpenHandler),this._popupOpenHandler=null),this._documentMouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),this._documentMouseDownHandler=null)}_onDocumentMouseDown(e){!this._rendered||this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}_isMouseDownOutside(e){let t=e.target,r=a()(t),s;return!this.closeOnAnchorMouseDown&&this._isMouseDownOnAnchor(e)?!1:(s=u.widget(r),!this.isOrHas(s)&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0]))}_isMouseDownOnAnchor(e){let t=e.target;return!!this.$anchor&&this.$anchor.isOrHas(t)}_onMouseDownOutside(e){this.close()}_onAnchorScroll(e){!this.rendered||this._handleAnchorPositionChange(e)}_handleAnchorPositionChange(e){u.isOneOf(this.scrollType,"position","layoutAndPosition")&&this.isOpeningAnimationRunning()||(this.scrollType==="position"?this.position():this.scrollType==="layoutAndPosition"?(this.revalidateLayout(),this.position()):this.scrollType==="remove"&&this.close())}isOpeningAnimationRunning(){return this.rendered&&this.animateOpening&&this.$container.hasClass("animate-open")}_onAnchorLocationChange(e){this._handleAnchorPositionChange(e)}_onPopupOpen(e){let t=!this.isOrHas(e.popup)&&!e.popup.isOrHas(this);this.rendered&&(t=t&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])),t&&this.close()}setHorizontalAlignment(e){this.setProperty("horizontalAlignment",e)}_renderHorizontalAlignment(){this._updateArrowClass(),this.invalidateLayoutTree()}setVerticalAlignment(e){this.setProperty("verticalAlignment",e)}_renderVerticalAlignment(){this._updateArrowClass(),this.invalidateLayoutTree()}setHorizontalSwitch(e){this.setProperty("horizontalSwitch",e)}_renderHorizontalSwitch(){this.invalidateLayoutTree()}setVerticalSwitch(e){this.setProperty("verticalSwitch",e)}_renderVerticalSwitch(){this.invalidateLayoutTree()}setTrimWidth(e){this.setProperty("trimWidth",e)}_renderTrimWidth(){this.invalidateLayoutTree()}setTrimHeight(e){this.setProperty("trimHeight",e)}_renderTrimHeight(){this.invalidateLayoutTree()}prefLocation(e,t){return!this.boundToAnchor||!this.anchorBounds&&!this.$anchor?this._prefLocationWithoutAnchor():this._prefLocationWithAnchor(e,t)}_prefLocationWithoutAnchor(){return br.positionContainerInWindow(this.$container)}_prefLocationWithAnchor(e,t){let r=this.$container;t=t||this.horizontalAlignment,e=e||this.verticalAlignment;let s=this.getAnchorBounds(),o=w.size(r,{exact:!0}),n=w.margins(r),l=pe.Alignment,d=null;this.$arrow&&(this._updateArrowClass(e,t),w.setMargins(this.$arrow,new qe),d=w.bounds(this.$arrow)),r.removeClass(this._alignClasses()),r.addClass(e+" "+t);let h=o.width+n.horizontal(),p=o.width,m=s.x;t===l.LEFT?m-=h:t===l.LEFTEDGE?this.withArrow?m+=s.width/2-d.center().x-n.left:m=s.x-n.left:t===l.CENTER?m+=s.width/2-p/2-n.left:t===l.RIGHT?m+=s.width:t===l.RIGHTEDGE&&(this.withArrow?m+=s.width/2-d.center().x-n.left:m=s.x+s.width-p-n.left);let g=o.height+n.vertical(),b=o.height,C=s.y;e===l.TOP?C-=g:e===l.TOPEDGE?this.withArrow?C+=s.height/2-d.center().y-n.top:C=s.y-n.top:e===l.CENTER?C+=s.height/2-b/2-n.top:e===l.BOTTOM?C+=s.height:e===l.BOTTOMEDGE&&(this.withArrow?C+=s.height/2-d.center().y-n.top:C=s.y+s.height-b-n.top);let P=this.$parent.offset();return m-=P.left,C-=P.top,new Z(m,C)}_alignClasses(){let e=pe.Alignment;return y.join(" ",e.LEFT,e.LEFTEDGE,e.CENTER,e.RIGHT,e.RIGHTEDGE,e.TOP,e.TOPEDGE,e.CENTER,e.BOTTOM,e.BOTTOMEDGE)}getAnchorBounds(){let e=this.anchorBounds;if(!this.$anchor)return e;let t=w.offsetBounds(this.$anchor,{exact:!0});return e?(e.x||(e.x=t.x,e.width=t.width),e.y||(e.y=t.y,e.height=t.height)):e=t,e}getWindowSize(){let e=this.$parent.window();return new A(e.width(),e.height())}overlap(e,t){let r=this.$container;if(!r||!e)return null;t=u.nvl(t,!0);let s=w.size(r,{exact:!0,includeMargin:t}),o=s.width,n=s.height,l=new re(e.x,e.y,o,n),d=w.offsetBounds(r.entryPoint(),!0),h=l.right()+this.windowPaddingX-d.width;h<0&&(h=Math.min(l.x-this.windowPaddingX-d.x,0));let p=l.bottom()+this.windowPaddingY-d.height;return p<0&&(p=Math.min(l.y-this.windowPaddingY-d.y,0)),new Z(h,p)}adjustLocation(e,t){this.calculatedVerticalAlignment=this.verticalAlignment,this.calculatedHorizontalAlignment=this.horizontalAlignment;let r=this.overlap(e);return this.$arrow&&(this._updateArrowClass(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment),w.setMargins(this.$arrow,new qe)),e=e.clone(),Math.abs(r.y)>=1&&(u.nvl(t,this.verticalSwitch)?(this.calculatedVerticalAlignment=pe.SwitchRule[this.calculatedVerticalAlignment],e.y=this.prefLocation(this.calculatedVerticalAlignment).y):e.y-=r.y),Math.abs(r.x)>=1&&(u.nvl(t,this.horizontalSwitch)?(this.calculatedHorizontalAlignment=pe.SwitchRule[this.calculatedHorizontalAlignment],e.x=this.prefLocation(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment).x):e.x-=r.x),this.$arrow&&(r.y!==0&&(this.$arrow.hasClass(pe.Alignment.LEFT)||this.$arrow.hasClass(pe.Alignment.RIGHT))&&(r.y>0?this.$arrow.cssMarginTop(r.y):this.$arrow.cssMarginBottom(-r.y)),r.x!==0&&(this.$arrow.hasClass(pe.Alignment.TOP)||this.$arrow.hasClass(pe.Alignment.BOTTOM))&&(r.x>0?this.$arrow.cssMarginLeft(r.x):this.$arrow.cssMarginRight(-r.x))),e}position(e){!this.rendered||(this._validateVisibility(),this._position(e))}_position(e){let t=this.prefLocation();!t||(t=this.adjustLocation(t,e),this.setLocation(t))}setLocation(e){!this.rendered||(this.$container.css("left",e.x).css("top",e.y),this._triggerLocationChange())}_validateVisibility(){if(!this.boundToAnchor||!this.$anchor)return;let e=this._isAnchorInView(),t=this.$container.hasClass("invisible")===e&&e;if(this.$container.toggleClass("invisible",!e),t){let r=this.animateResize;this.animateResize=!1,this.revalidateLayout(),this.animateResize=r,this.withFocusContext&&this.session.focusManager.validateFocus()}}_isAnchorInView(){if(!this.boundToAnchor||!this.$anchor)return;let e=this.getAnchorBounds();return x.isLocationInView(e.center(),this.$anchor.scrollParents())}_triggerLocationChange(){this.trigger("locationChange")}_triggerPopupOpenEvent(){this.session.desktop.trigger("popupOpen",{popup:this})}belongsTo(e){return this.$anchor[0]===e[0]}set$Anchor(e){this.$anchor&&this._detachAnchorHandlers(),this.setProperty("$anchor",e),this.rendered&&(this._attachAnchorHandlers(),this.revalidateLayout(),this.animateResize||this.position())}isOpen(){return this.rendered}ensureOpen(){this.isOpen()||this.open()}setAnchor(e){this.setProperty("anchor",e)}_setAnchor(e){e&&this.setParent(e),this._setProperty("anchor",e)}_onAnchorRender(e){this.session.layoutValidator.schedulePostValidateFunction(()=>{if(this.rendered||this.destroyed)return;if(this.anchor&&!this.anchor.rendered){this.anchor.one("render",this._anchorRenderHandler);return}let t=this.animateOpening;this.animateOpening=!1,this.open(),this.animateOpening=t})}_renderAnchor(){this.anchor&&this.set$Anchor(this.anchor.$container)}_onWindowResize(e){!this.rendered||(this.windowResizeType==="position"?this.position():this.windowResizeType==="layoutAndPosition"?(this.revalidateLayoutTree(!1),this.position()):this.windowResizeType==="remove"&&this.close())}_handleGlassPanes(){this.session.focusManager.isElementCovertByGlassPane(this.parent.$container)&&this.session.focusManager.rerenderGlassPanes()}}se(pe,"Alignment",{LEFT:"left",LEFTEDGE:"leftedge",TOP:"top",TOPEDGE:"topedge",CENTER:"center",RIGHT:"right",RIGHTEDGE:"rightedge",BOTTOM:"bottom",BOTTOMEDGE:"bottomedge"}),se(pe,"SwitchRule",{}),(()=>{let i=pe.SwitchRule,e=pe.Alignment;i[e.LEFT]=e.RIGHT,i[e.LEFTEDGE]=e.RIGHTEDGE,i[e.TOP]=e.BOTTOM,i[e.TOPEDGE]=e.BOTTOMEDGE,i[e.CENTER]=e.CENTER,i[e.RIGHT]=e.LEFT,i[e.RIGHTEDGE]=e.LEFTEDGE,i[e.BOTTOM]=e.TOP,i[e.BOTTOMEDGE]=e.TOPEDGE})();class Ph extends He{_onWidgetClose(e){e.preventDefault(),this._send("close")}_onWidgetEvent(e){e.type==="close"?this._onWidgetClose(e):super._onWidgetEvent(e)}}function Zs(i,e,t){return e=vS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vS(i){var e=wS(i,"string");return typeof e=="symbol"?e:String(e)}function wS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ii extends te{constructor(e){super(),Zs(this,"popup",void 0),Zs(this,"doubleCalcPrefSize",void 0),Zs(this,"autoPosition",void 0),Zs(this,"autoSize",void 0),Zs(this,"resizeAnimationRunning",void 0),Zs(this,"resizeAnimationDuration",void 0),Zs(this,"_autoPositionOrig",void 0),this.popup=e,this.doubleCalcPrefSize=!0,this.autoPosition=!0,this.autoSize=!0,this.resizeAnimationRunning=!1,this.resizeAnimationDuration=null,this._autoPositionOrig=null}layout(e){if(this.popup.isOpeningAnimationRunning()){this.popup.$container.oneAnimationEnd(this.layout.bind(this,e));return}if(this.popup.removalPending||this.popup.removing||!this.popup.rendered)return;if(!this.autoSize){this._setSize(this.popup.htmlComp.size({exact:!0}));return}let t=this.popup.htmlComp,r=w.bounds(t.$comp),s=this.preferredLayoutSize(e,{exact:!0,widthOnly:this.doubleCalcPrefSize});s=this.adjustSize(s),this.doubleCalcPrefSize&&(s=this.preferredLayoutSize(e,{exact:!0,widthHint:s.width-t.insets().horizontal()}),s=this.adjustSize(s)),this._setSize(s),t.layouted&&this.popup.animateResize&&this._resizeAnimated(r,s)}_resizeAnimated(e,t){this._position();let r=this.popup.htmlComp,s=r.$comp.position(),o=new re(s.left,s.top,Math.ceil(t.width),Math.ceil(t.height));e.equals(o)||(this.resizeAnimationRunning=!0,r.$comp.stop(!0).cssHeight(e.height).cssWidth(e.width).cssLeft(e.x).cssTop(e.y).animate({height:t.height,width:t.width,left:s.left,top:s.top},{duration:this.resizeAnimationDuration,complete:()=>{this.resizeAnimationRunning=!1,this.popup.rendered&&this._position()}}))}_position(e){this.autoPosition&&this.popup.position(e)}_setSize(e){w.setSize(this.popup.htmlComp.$comp,e)}adjustSize(e){return this.popup.htmlComp._adjustPrefSizeWithMinMaxSize(e),this.popup.boundToAnchor&&(this.popup.anchorBounds||this.popup.$anchor)?this._adjustSizeWithAnchor(e):this._adjustSize(e)}_adjustSize(e){let t=new A,r=this._calcMaxSize();return t.width=Math.min(r.width,e.width),t.height=Math.min(r.height,e.height),t}_calcMaxSize(){let e,t,r=this.popup.htmlComp,s=this.popup.windowPaddingX,o=this.popup.windowPaddingY,n=r.margins(),l=this.popup.getWindowSize();return e=l.width-n.horizontal()-s,t=l.height-n.vertical()-o,new A(e,t)}_adjustSizeWithAnchor(e){let t=new A,r=this._calcMaxSizeAroundAnchor(),s=this._calcMaxSize(),o=pe.Alignment,n=this.popup.horizontalAlignment,l=this.popup.verticalAlignment;return t.width=e.width,this.popup.trimWidth&&(this.popup.horizontalSwitch?e.width>r.right&&e.width>r.left&&(t.width=Math.max(r.right,r.left)):n===o.RIGHT?t.width=Math.min(t.width,r.right):n===o.LEFT?t.width=Math.min(t.width,r.left):t.width=Math.min(t.width,s.width)),t.height=e.height,this.popup.trimHeight&&(this.popup.verticalSwitch?e.height>r.bottom&&e.height>r.top&&(t.height=Math.max(r.bottom,r.top)):l===o.BOTTOM?t.height=Math.min(t.height,r.bottom):l===o.TOP?t.height=Math.min(t.height,r.top):t.height=Math.min(t.height,s.height)),(l===o.CENTER||n===o.CENTER)&&(n===o.CENTER&&(t.width=Math.min(s.width,e.width)),l===o.CENTER&&(t.height=Math.min(s.height,e.height))),t}_calcMaxSizeAroundAnchor(){let e,t,r,s,o=this.popup.htmlComp,n=this.popup.windowPaddingX,l=this.popup.windowPaddingY,d=o.margins(),h=this.popup.getAnchorBounds(),p=this.popup.getWindowSize(),m=this.popup.horizontalAlignment,g=this.popup.verticalAlignment,b=pe.Alignment;return u.isOneOf(m,b.LEFTEDGE,b.RIGHTEDGE)?(t=p.width-h.x-d.horizontal()-n,e=h.right()-d.horizontal()-n):(t=p.width-h.right()-d.horizontal()-n,e=h.x-d.horizontal()-n),u.isOneOf(g,b.BOTTOMEDGE,b.TOPEDGE)?(r=p.height-h.y-d.vertical()-l,s=h.bottom()-d.vertical()-l):(r=p.height-h.bottom()-d.vertical()-l,s=h.y-d.vertical()-l),new qe(s,t,r,e)}disableAutoPosition(){this._autoPositionOrig===null&&(this._autoPositionOrig=this.autoPosition,this.autoPosition=!1)}resetAutoPosition(){this.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null}}function TS(i,e,t){return e=SS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function SS(i){var e=CS(i,"string");return typeof e=="symbol"?e:String(e)}function CS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class kd extends I{constructor(){super(),TS(this,"popups",void 0),this.popups=[],this._addWidgetProperties(["popups"]),this._addPreserveOnPropertyChangeProperties(["popups"])}_init(e){super._init(e),this.session.layoutValidator.schedulePostValidateFunction(()=>{this._openPopups(this.popups)})}setPopups(e){this.setProperty("popups",e)}_setPopups(e){this._openPopups(f.diff(e,this.popups)),this._destroyPopups(f.diff(this.popups,e)),this._setProperty("popups",e),this.popups.forEach(t=>{t.parent instanceof kd&&t.setParent(this.session.desktop)})}_openPopups(e){e.forEach(t=>{t.open()})}_destroyPopups(e){e.forEach(t=>t.destroy())}}class $m extends He{}function ar(i,e,t){return e=PS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function PS(i){var e=xS(i,"string");return typeof e=="symbol"?e:String(e)}function xS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class el extends pe{constructor(){super(),ar(this,"doneAction",void 0),ar(this,"htmlBody",void 0),ar(this,"$body",void 0),ar(this,"_field",void 0),ar(this,"_touchField",void 0),ar(this,"_touchFieldTooltip",void 0),ar(this,"_widget",void 0),ar(this,"_$widgetContainer",void 0),ar(this,"_$header",void 0),ar(this,"_widgetContainerHtmlComp",void 0),ar(this,"_touchFieldPropertyChangeListener",void 0),this._touchField=null,this._touchFieldTooltip=null,this._field=null,this._widget=null,this._$widgetContainer=null,this._widgetContainerHtmlComp=null,this.windowPaddingX=0,this.windowPaddingY=0,this.withGlassPane=!0,this._touchFieldPropertyChangeListener=this._onTouchFieldPropertyChange.bind(this)}_init(e){super._init(e),this._touchField=e.field;let t=this._touchField.tooltip();t&&t.rendered&&(this._touchFieldTooltip=t,this._touchFieldTooltip.remove()),this._field=this._touchField.clone(this._fieldOverrides()),this._touchField.on("propertyChange",this._touchFieldPropertyChangeListener),this._initWidget(e),this.doneAction=u.create(le,{parent:this,text:this.session.text("ui.Done")}),this.doneAction.on("action",this._onCloseIconClick.bind(this))}_destroy(){this._touchField.off("propertyChange",this._touchFieldPropertyChangeListener),this._touchFieldTooltip&&!this._touchFieldTooltip.destroyed&&this._touchFieldTooltip.render(this._touchField._$tooltipParent()),super._destroy()}_fieldOverrides(){return{parent:this,labelVisible:!1,fieldStyle:M.FieldStyle.CLASSIC,popup:this,statusVisible:!1,menusVisible:!1,embedded:!0,touchMode:!1,clearable:ge.Clearable.ALWAYS}}_initWidget(e){}_createLayout(){return new pa(this)}prefLocation(e,t){let r=this.htmlComp.prefSize(),s=this.$container.window().width(),o=Math.max(this.windowPaddingX,(s-r.width)/2);return new Z(o,0)}_render(){this.$container=this.$parent.appendDiv("popup touch-popup"),this.$body=this.$container.appendDiv("body"),this.htmlBody=S.install(this.$body,this.session),this.htmlBody.setLayout(new Ri),this._$header=this.$body.appendDiv("touch-popup-header"),S.install(this._$header,this.session),this._$header.appendDiv("touch-popup-title").textOrNbsp(this._touchField.label,"empty"),this.doneAction.render(this._$header),this._$widgetContainer=this.$body.appendDiv("touch-popup-widget-container"),this._widgetContainerHtmlComp=S.install(this._$widgetContainer,this.session),this._widgetContainerHtmlComp.setLayout(new Cr),this._field.render(),this._field.$container.insertBefore(this._$widgetContainer),this._field.$container.addClass("touch-popup-field"),this._widget&&this._widget.render(this._$widgetContainer),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout())}_handleGlassPanes(){super._handleGlassPanes(),this._glassPaneRenderer&&this._glassPaneRenderer.eachGlassPane(e=>e.addClass("dark"))}_onTouchFieldPropertyChange(e){e.propertyName==="errorStatus"?this._field.setErrorStatus(e.newValue):e.propertyName==="lookupRow"&&this._field instanceof ae&&this._field.setLookupRow(e.newValue)}_acceptInput(){let e=this._field.acceptInput();e?e.always(this.close.bind(this)):this.close()}_onCloseIconClick(e){this._acceptInput()}}class pa extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}_setSize(e){super._setSize(e);let t=this.popup.htmlComp,r=this.popup.htmlBody,s=e.subtract(t.insets());r.setSize(s.subtract(r.margins()))}preferredLayoutSize(e,t){let r=this.popup.htmlComp,s=this.popup.htmlBody,o=s.prefSize(t).add(r.insets());return o.width=ue.get().formColumnWidth,o.add(s.margins())}}function dr(i,e,t){return e=FS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FS(i){var e=ES(i,"string");return typeof e=="symbol"?e:String(e)}function ES(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tn extends pe{constructor(){super(),dr(this,"closable",void 0),dr(this,"closeAction",void 0),dr(this,"movable",void 0),dr(this,"resizable",void 0),dr(this,"resizeModes",void 0),dr(this,"$dragHandle",void 0),dr(this,"content",void 0),dr(this,"$actions",void 0),dr(this,"_moveHandler",void 0),dr(this,"_resizeHandler",void 0),dr(this,"_autoPositionOrig",void 0),this.animateOpening=!0,this.animateResize=!0,this.animateRemoval=!0,this.closable=!1,this.closeAction=null,this.movable=!1,this.resizable=!1,this.resizeModes=null,this.content=null,this.windowPaddingX=0,this.windowPaddingY=0,this.windowResizeType="layoutAndPosition",this.$dragHandle=null,this.$actions=null,this._moveHandler=this._onMove.bind(this),this._resizeHandler=this._onResize.bind(this),this._autoPositionOrig=null,this._addWidgetProperties(["content"])}_createLayout(){return new Fh(this)}_init(e){super._init(e),this._setClosable(this.closable)}_render(){super._render(),this.$container.addClass("widget-popup")}_renderProperties(){super._renderProperties(),this._renderContent(),this._renderClosable(),this._renderMovable(),this._renderResizable()}_remove(){this.$dragHandle=null,this.$actions=null,super._remove()}setContent(e){this.setProperty("content",e)}_renderContent(){!this.content||(this.content.render(),this.content.$container.addClass("popup-widget"),this.invalidateLayoutTree())}setClosable(e){this.setProperty("closable",e)}_setClosable(e){if(this._setProperty("closable",e),this.closable){if(this.closeAction)return;this.closeAction=this._createCloseAction(),this.closeAction.on("action",this._onCloseAction.bind(this))}else{if(!this.closeAction)return;this.closeAction.destroy(),this.closeAction=null}}_createCloseAction(){return u.create(oe,{parent:this,cssClass:"close-action menu-item",iconId:ve.REMOVE})}_renderClosable(){this.closeAction?(this.$actions||(this.$actions=this.$container.appendDiv("actions")),this.closeAction.render(this.$actions)):this.$actions&&this.$actions.children().length===0&&(this.$actions.remove(),this.$actions=null)}_onCloseAction(e){this.close()}setResizable(e){this.setProperty("resizable",e)}_renderResizable(){this.resizable?this.$container.resizable({modes:this._determineResizeModes(),$container:this.$container,boundaries:this._calculateResizeBoundaries()}).on("resize",this._resizeHandler):(this.$container.unresizable().off("resize",this._resizeHandler),this.invalidateLayoutTree())}_calculateResizeBoundaries(){let e=new qe;if(!this.$arrow)return e;let t=this._getAnchorMiddlePoint();if(!t)return e;let r=w.size(this.$arrow);return this._isVerticallyAligned()?(e.top=t.y-r.height,e.bottom=t.y+r.height):(e.left=t.x-r.width,e.right=t.x+r.width),e}_determineResizeModes(){return!this.$arrow||this.resizeModes?this.resizeModes:this.calculatedVerticalAlignment===pe.Alignment.TOP?[Ee.MODES.WEST,Ee.MODES.EAST,Ee.MODES.NORTH]:this.calculatedVerticalAlignment===pe.Alignment.BOTTOM?[Ee.MODES.WEST,Ee.MODES.EAST,Ee.MODES.SOUTH]:this.calculatedHorizontalAlignment===pe.Alignment.LEFT?[Ee.MODES.NORTH,Ee.MODES.SOUTH,Ee.MODES.WEST]:this.calculatedHorizontalAlignment===pe.Alignment.RIGHT?[Ee.MODES.NORTH,Ee.MODES.SOUTH,Ee.MODES.EAST]:this.resizeModes}_onResize(e){let t=this.htmlComp.layout,r=t.autoSize;return t.autoSize=!1,this.htmlComp.revalidateLayout(),t.autoSize=r,this._updateArrowPosition(),!1}position(e){if(!!this.rendered&&(super.position(e),this.resizable)){let t=this.$container.data("resizable");t.setBoundaries(this._calculateResizeBoundaries()),t.setModes(this._determineResizeModes()),this._updateArrowPosition()}}_updateArrowClass(e,t){super._updateArrowClass(e,t),this.$arrow&&(this.$arrow.cssLeft(null),this.$arrow.cssTop(null))}_updateArrowPosition(){if(!this.$arrow)return;let e=this._getAnchorMiddlePoint();if(!e)return;this.$arrow.removeClass("leftedge rightedge topedge bottomedge");let t=w.size(this.$arrow),r=w.margins(this.$arrow);if(this._isVerticallyAligned()){let s=r.top+r.bottom;this.$arrow.cssTop(e.y-(s+this.$container.position().top+t.height/2))}else{let s=r.left+r.right;this.$arrow.cssLeft(e.x-(s+this.$container.position().left+t.width/2))}}_getAnchorMiddlePoint(){let e=this.getAnchorBounds();return e?e.center():null}_isVerticallyAligned(){return u.isOneOf(this.calculatedHorizontalAlignment,pe.Alignment.LEFT,pe.Alignment.RIGHT)}setMovable(e){this.setProperty("movable",e)}_renderMovable(){if(this.movable){if(this.$dragHandle)return;this.$dragHandle=this.$container.prependDiv("drag-handle"),this.$container.draggable(this.$dragHandle,a().throttle(this._moveHandler,1e3/60))}else{if(!this.$dragHandle)return;this.$container.undraggable(this.$dragHandle),this.$dragHandle.remove(),this.$dragHandle=null;let e=this.htmlComp.layout;e.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null,this.invalidateLayoutTree()}}_onMove(e){if(this._autoPositionOrig===null){let t=this.htmlComp.layout;this._autoPositionOrig=t.autoPosition,t.autoPosition=!1}this.trigger("move",e)}set$Anchor(e){if(this._autoPositionOrig&&e&&this.$anchor!==e){let t=this.htmlComp.layout;t.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null}super.set$Anchor(e)}}class xh extends Ph{}class Fh extends Ii{constructor(e){super(e)}_setSize(e){super._setSize(e);let t=this.popup.htmlComp,r=this.popup.content.htmlComp,s=e.subtract(t.insets());r.setSize(s.subtract(r.margins()))}preferredLayoutSize(e,t){let r=this.popup.htmlComp,s=this.popup.content.htmlComp;return s.prefSize(t).add(r.insets()).add(s.margins())}}function Eh(i,e,t){return e=AS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function AS(i){var e=DS(i,"string");return typeof e=="symbol"?e:String(e)}function DS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ah extends tn{constructor(){super(),Eh(this,"title",void 0),Eh(this,"$header",void 0),Eh(this,"$title",void 0),this.boundToAnchor=!1,this.closable=!0,this.title=null,this.withGlassPane=!0}_createLayout(){return new Dh(this)}_createCloseAction(){return u.create(oe,{parent:this,cssClass:"closer",iconId:ve.REMOVE_BOLD})}prefLocation(e,t){let r=this.htmlComp.prefSize(),s=this.$container.window().height(),o=Math.max(s-r.height,0);return new Z(0,o)}_render(){this.$container=this.$parent.appendDiv("popup mobile-popup"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$header=this.$container.appendDiv("mobile-popup-header"),this.$title=this.$header.appendDiv("title")}_renderProperties(){super._renderProperties(),this._renderTitle()}_renderContent(){super._renderContent(),this.content&&this.content.$container.addClass("mobile-popup-widget")}_renderClosable(){this.closeAction&&this.closeAction.render(this.$header),this.$header.setVisible(!!this.title||this.closable)}_renderTitle(){this.$title.textOrNbsp(this.title),this.$header.setVisible(!!this.title||this.closable)}}class Rm extends xh{}class Dh extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}layout(e){super.layout(e);let t=this.popup.htmlComp,r=t.size(),s=this.popup.content.htmlComp,o,n=this.popup.$header,l;r=r.subtract(t.insets()),l=w.prefSize(n,!0),w.setLocation(n,new Z(0,0)),o=r.clone(),o.height-=l.height,s.setLocation(new Z(0,l.height)),s.setSize(o.subtract(s.margins()))}preferredLayoutSize(e,t){let r=this.popup.$container.window();return new A(r.width(),r.height())}}function ki(i,e,t){return e=MS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function MS(i){var e=$S(i,"string");return typeof e=="symbol"?e:String(e)}function $S(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fa extends I{constructor(){super(),ki(this,"preselectedDate",void 0),ki(this,"selectedDate",void 0),ki(this,"dateFormat",void 0),ki(this,"viewDate",void 0),ki(this,"allowedDates",void 0),ki(this,"touch",void 0),ki(this,"currentMonth",void 0),ki(this,"months",void 0),ki(this,"$scrollable",void 0),ki(this,"swiped",void 0),ki(this,"_showWeekendSeparator",void 0),ki(this,"_boxWidth",void 0),ki(this,"_$header",void 0),this.preselectedDate=null,this.selectedDate=null,this.dateFormat=null,this.viewDate=null,this.allowedDates=[],this.currentMonth=null,this.$scrollable=null,this.months=[],this._showWeekendSeparator=!0}_init(e){super._init(e),this._setDateFormat(this.dateFormat),this._showWeekendSeparator=this.dateFormat.symbols.firstDayOfWeek===1}_render(){this.$container=this.$parent.appendDiv("date-picker").toggleClass("touch-only",F.get().supportsOnlyTouch()),this.htmlComp=S.install(this.$container,this.session),this._$header=this._append$Header(),this._$header.find(".date-picker-left-y, .date-picker-left-m, .date-picker-right-m, .date-picker-right-y").on("mousedown",this._onNavigationMouseDown.bind(this)),this.$container.appendDiv("date-picker-separator"),this.$scrollable=this.$container.appendDiv("date-picker-scrollable"),this._registerSwipeHandlers()}_setDateFormat(e){e||(e=this.session.locale.dateFormatPatternDefault),e=Ft.ensure(this.session.locale,e),this._setProperty("dateFormat",e)}prependMonth(e){let t=this.months.slice();f.insert(t,e,0),this.setMonths(t)}appendMonth(e){let t=this.months.slice();t.push(e),this.setMonths(t)}resetMonths(e){e=e||this.viewDate;let t=T.shift(e,0,-1,0),r=T.shift(e,0,1,0);this.setMonths([t,e,r])}setMonths(e){e=f.ensure(e);let t=e.map(r=>{let s;r instanceof Date?s=r:s=r.viewDate;let o=this._findMonthByViewDate(s);return o||{rendered:!1,viewDate:s,$container:void 0}});this.rendered&&this.months.forEach(r=>{t.indexOf(r)<0&&r.rendered&&r.$container.remove()}),this.setProperty("months",t)}_renderMonths(){this.months.forEach(t=>{t.rendered?this._layoutWeekendSeparator(t):(this._renderMonth(t),this.currentMonth&&T.compare(t.viewDate,this.currentMonth.viewDate)<0&&t.$container.insertBefore(this.currentMonth.$container))});let e=this.months.length*this._boxWidth;this.$scrollable.width(e),this.currentMonth&&this.$scrollable.cssLeft(this._scrollableLeftForMonth(this.currentMonth))}_findMonthByViewDate(e){return f.find(this.months,t=>T.compareMonths(t.viewDate,e)===0)}_scrollableLeftForMonth(e){let t=w.insets(this.$scrollable),r=w.margins(e.$container);return-1*(e.$container.position().left-r.left-t.left)}_renderMonth(e){if(e.rendered)return;let t=this.$parent.makeDiv("date-picker-month-box");this._showWeekendSeparator&&(e.$weekendSeparator=t.appendDiv("date-picker-weekend-separator")),this._build$DateBox(e.viewDate).appendTo(t),t.on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).appendTo(this.$scrollable),this._boxWidth||(this._boxWidth=t.width()),t.width(this._boxWidth),e.$container=t,e.rendered=!0}setViewDate(e,t){v.equals(this.viewDate,e)||(this._setProperty("viewDate",e),this.rendered&&this._renderViewDate(t))}_renderViewDate(e){let t=this._findMonthByViewDate(this.viewDate),r=this._scrollableLeftForMonth(t);this.currentMonth||this.revalidateLayoutTree(),this.currentMonth=t,this._updateHeader(this.viewDate),e=u.nvl(e,!0),e?this.$scrollable.stop(!0).animate({left:r},300,()=>{this.resetMonths()}):(this.$scrollable.cssLeft(r),this.resetMonths())}_layoutWeekendSeparators(){this.months.forEach(e=>this._layoutWeekendSeparator(e))}_layoutWeekendSeparator(e){if(!e.$weekendSeparator)return;let t=this.$container.find(".date-picker-weekdays").first().children();if(t.length<6)return;let r=t.eq(4),s=t.eq(5),o=w.position(r).x+w.size(r,{includeMargin:!0}).width,l=w.position(s).x-o,d=e.$weekendSeparator.cssBorderWidthX(),h=Math.floor(o+l/2-d);e.$weekendSeparator.cssLeft(h)}preselectDate(e,t){this.showDate(e,t),e&&this.setSelectedDate(null),this.setPreselectedDate(e)}setPreselectedDate(e){this.setProperty("preselectedDate",e)}_renderPreselectedDate(){if(!this.currentMonth)return;this.currentMonth.$container.find(".date-picker-day").each((t,r)=>{let s=a()(r);s.removeClass("preselected"),T.isSameDay(this.preselectedDate,s.data("date"))&&s.addClass("preselected")})}selectDate(e,t){this.showDate(e,t),e&&this.setPreselectedDate(null),this.setSelectedDate(e)}setSelectedDate(e){this.setProperty("selectedDate",e)}_renderSelectedDate(){if(!this.currentMonth)return;this.currentMonth.$container.find(".date-picker-day").each((t,r)=>{let s=a()(r);s.removeClass("selected"),T.isSameDay(this.selectedDate,s.data("date"))&&s.addClass("selected")})}showDate(e,t){let r=0;this.viewDate&&(r=T.compareMonths(e,this.viewDate)),this.currentMonth&&r?r<0?this.prependMonth(e):this.appendMonth(e):this.currentMonth?this.resetMonths(e):this.setMonths([e]),this.setViewDate(e,t)}shiftViewDate(e,t,r){let s=this.viewDate;s=T.shift(s,e,t,r),this.showDate(s)}shiftSelectedDate(e,t,r){let s=this.preselectedDate;this.selectedDate&&(this.allowedDates.length>0?s=this._findNextAllowedDate(e,t,r):s=T.shift(this.selectedDate,e,t,r)),s&&this.selectDate(s,!0)}_findNextAllowedDate(e,t,r){let s,o,n=e+t+r,l=n>0?1:-1,d=this.selectedDate||T.trunc(new Date);if(e!==0?d=T.shift(d,e,0,0):t!==0&&(d=T.shift(d,0,t,0)),l===1){for(s=0;s<this.allowedDates.length;s++)if(o=this.allowedDates[s],T.compare(d,o)<0)return o}else if(l===-1){for(s=this.allowedDates.length-1;s>=0;s--)if(o=this.allowedDates[s],T.compare(d,o)>0)return o}return null}_isDateAllowed(e){if(this.allowedDates.length===0)return!0;let t=T.trunc(e).getTime();return this.allowedDates.some(r=>r.getTime()===t)}_build$DateBox(e){let t,r,s,o,n,l,d=new Date,h=new Date(e),p=this.$container.makeDiv("date-picker-month").data("viewDate",e),m=p.appendDiv("date-picker-weekdays");this.dateFormat.symbols.weekdaysShortOrdered.map(b=>b.length>2?b.substr(0,2):b).forEach(b=>m.appendDiv("date-picker-weekday",b.toUpperCase()));let g;for(let b=0;b<42;b++){h.setDate(h.getDate()-1);let C=new Date(h.getFullYear(),e.getMonth(),0).getDate()-h.getDate();if(h.getDay()===0&&h.getMonth()!==e.getMonth()&&C>1)break}for(r=0;r<42;r++)r%7===0&&(g=p.appendDiv("date-picker-week")),h.setDate(h.getDate()+1),n=h.getDate(),h.getDay()===6||h.getDay()===0?(t=h.getMonth()!==e.getMonth()?" date-picker-out-weekend":" date-picker-weekend",this._showWeekendSeparator&&h.getDay()===6&&(t+=" date-picker-day-weekend-separator")):t=h.getMonth()!==e.getMonth()?" date-picker-out":"",T.isSameDay(h,d)&&(t+=" date-picker-now"),T.isSameDay(this.selectedDate,h)&&(t+=" selected"),T.isSameDay(this.preselectedDate,h)&&(t+=" preselected"),n>9&&n<20&&(t+=" ten"),o=this._isDateAllowed(h),o||(t+=" disabled"),s=n<=9?"0"+n:n,l=g.appendDiv("date-picker-day"+t).data("dayInMonth",n).data("date",new Date(h)),l.appendSpan("text",s),o&&l.on("click",this._onDayClick.bind(this));return p}_append$Header(){let e='<div class="date-picker-header">  <div class="date-picker-left-y" data-shift="-12"></div>  <div class="date-picker-left-m" data-shift="-1"></div>  <div class="date-picker-right-y" data-shift="12"></div>  <div class="date-picker-right-m" data-shift="1"></div>  <div class="date-picker-header-month">&nbsp;</div></div>';return this.$container.appendElement(e).toggleClass("touch",this.touch)}_updateHeader(e){this._$header.find(".date-picker-header-month").text(this._createHeaderText(e))}_createHeaderText(e){return this.dateFormat.symbols.months[e.getMonth()]+" "+e.getFullYear()}_registerSwipeHandlers(){let e,t,r=n=>(this.$scrollable.stop(!0),e=T.shift(this.viewDate,0,-1,0),t=T.shift(this.viewDate,0,1,0),this.setMonths([e,this.viewDate,t]),this.swiped=!1,!0),s=n=>{let l=this.$container.width()-this.$scrollable.outerWidth(),d=Math.max(Math.min(n.newLeft,0),l);return d!==n.originalLeft&&this.$scrollable.cssLeft(d),d},o=n=>{let l=5,d=this.viewDate;n.deltaX<-l?d=t:n.deltaX>l&&(d=e),this.viewDate!==d&&(this.swiped=!0,this.setViewDate(d))};lt.onSwipe(this.$scrollable,"datepickerDrag",r,s,o)}_onNavigationMouseDown(e){let r=a()(e.currentTarget).data("shift");this.shiftViewDate(0,r,0)}_onDayClick(e){if(this.swiped)return;let r=a()(e.currentTarget).data("date");this.selectDate(r),this.trigger("dateSelect",{date:r})}_onMouseWheel(e){let t=e.originalEvent||this.$container.window(!0).event.originalEvent,s=(t.wheelDelta?t.wheelDelta/10:-t.detail*3)>=0?-1:1;this.shiftViewDate(0,s,0),t.preventDefault()}}function Lm(i,e,t){return e=RS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function RS(i){var e=LS(i,"string");return typeof e=="symbol"?e:String(e)}function LS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ma extends pe{constructor(){super(),Lm(this,"field",void 0),Lm(this,"picker",void 0),this.windowPaddingX=0,this.windowPaddingY=0}_init(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,super._init(e),this.picker=u.create(fa,{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}_createLayout(){return new Mh(this)}_render(){this.$container=this.$parent.appendDiv("popup date-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===M.FieldStyle.ALTERNATIVE),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.findDesktop().adjustOverlayOrder(this),this.picker.render()}getDatePicker(){return this.picker}_isMouseDownOnAnchor(e){let t=e.target;return this.field.$dateField.isOrHas(t)||this.field.$dateFieldIcon.isOrHas(t)||this.field.$dateClearIcon&&this.field.$dateClearIcon.isOrHas(t)}}class Mh extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}layout(e){let t,r=this.popup.htmlComp,s=this.popup.picker.htmlComp;super.layout(e),t=r.size().subtract(r.insets()).subtract(s.margins()),s.setSize(t),this.popup.htmlComp.layouted&&this.popup.position(),this.popup.getDatePicker()._layoutWeekendSeparators()}preferredLayoutSize(e,t){let r,s=this.popup.htmlComp,o=this.popup.picker.htmlComp;return r=o.prefSize().add(s.insets()).add(o.margins()),r}}class $h extends el{_init(e){super._init(e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this)),this.addCssClass("date-picker-touch-popup")}_initWidget(e){this._widget=u.create(fa,{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}_render(){super._render(),this._field.$container.addClass("date")}_onMouseDownOutside(e){this._acceptInput()}getDatePicker(){return this._widget}_createLayout(){return new Rh(this)}_onFieldAcceptInput(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),(e.errorStatus?e.errorStatus.containsStatus(vi):!1)||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput(e.whileTyping)}_acceptInput(){this._field.acceptDate(),this.close()}}class Rh extends pa{constructor(e){super(e)}layout(e){super.layout(e),this.popup.getDatePicker()._layoutWeekendSeparators()}}function nt(i,e,t){return e=IS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function IS(i){var e=kS(i,"string");return typeof e=="symbol"?e:String(e)}function kS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Si extends I{constructor(){super(),nt(this,"bodyAnimating",void 0),nt(this,"collapsed",void 0),nt(this,"collapsible",void 0),nt(this,"title",void 0),nt(this,"titleHtmlEnabled",void 0),nt(this,"titleSuffix",void 0),nt(this,"header",void 0),nt(this,"headerFocusable",void 0),nt(this,"headerVisible",void 0),nt(this,"body",void 0),nt(this,"collapseStyle",void 0),nt(this,"htmlHeader",void 0),nt(this,"htmlFooter",void 0),nt(this,"iconId",void 0),nt(this,"icon",void 0),nt(this,"$header",void 0),nt(this,"$footer",void 0),nt(this,"$collapseIcon",void 0),nt(this,"$collapseBorderLeft",void 0),nt(this,"$collapseBorderRight",void 0),nt(this,"$title",void 0),nt(this,"$titleSuffix",void 0),this.bodyAnimating=!1,this.collapsed=!1,this.collapsible=!0,this.title=null,this.titleHtmlEnabled=!1,this.titleSuffix=null,this.header=null,this.headerFocusable=!1,this.headerVisible=!0,this.body=null,this.$container=null,this.$header=null,this.$footer=null,this.$collapseIcon=null,this.$collapseBorderLeft=null,this.$collapseBorderRight=null,this.collapseStyle=Si.CollapseStyle.LEFT,this.htmlComp=null,this.htmlHeader=null,this.htmlFooter=null,this.iconId=null,this.icon=null,this._addWidgetProperties(["header","body"])}_init(e){super._init(e),this.resolveTextKeys(["title","titleSuffix"]),this.resolveIconIds(["iconId"]),this._setBody(this.body),this._setHeader(this.header)}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.$bindTarget=()=>this.$header,this.keyStrokeContext.registerKeyStrokes([new Ih(this)])}_render(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Lh(this)),this._renderHeader(),this.$collapseIcon=this.$header.appendDiv("group-collapse-icon"),this.$footer=this.$container.appendDiv("group-footer"),this.$collapseBorderLeft=this.$footer.appendDiv("group-collapse-border"),this.$collapseBorderRight=this.$footer.appendDiv("group-collapse-border"),this.htmlFooter=S.install(this.$footer,this.session),this.$footer.on("mousedown",this._onFooterMouseDown.bind(this))}_renderProperties(){super._renderProperties(),this._renderIconId(),this._renderTitle(),this._renderTitleSuffix(),this._renderHeaderVisible(),this._renderHeaderFocusable(),this._renderCollapsed(),this._renderCollapseStyle(),this._renderCollapsible()}_remove(){this.$header=null,this.$title=null,this.$titleSuffix=null,this.$footer=null,this.$collapseIcon=null,this.$collapseBorderLeft=null,this.$collapseBorderRight=null,this._removeIconId(),super._remove()}_renderEnabled(){super._renderEnabled(),this.$header.setTabbable(this.enabledComputed)}setIconId(e){this.setProperty("iconId",e)}_renderIconId(){let e=this.iconId||"";if(!e){this._removeIconId(),this._updateIconStyle();return}if(this.icon){this.icon.setIconDesc(e),this._updateIconStyle();return}this.icon=u.create(Qr,{parent:this,iconDesc:e,prepend:!0}),this.icon.one("destroy",()=>{this.icon=null}),this.icon.render(this.$header),this._updateIconStyle()}_updateIconStyle(){let e=!!this.title;this.get$Icon().toggleClass("with-title",e),this.get$Icon().addClass("group-icon"),this._renderCollapseStyle()}get$Icon(){return this.icon?this.icon.$container:a()()}_removeIconId(){this.icon&&this.icon.destroy()}setHeader(e){this.setProperty("header",e)}_setHeader(e){this._setProperty("header",e)}setHeaderFocusable(e){this.setProperty("headerFocusable",e)}_renderHeaderFocusable(){this.$header.toggleClass("unfocusable",!this.headerFocusable)}setTitle(e){this.setProperty("title",e)}_renderTitle(){this.$title&&(this.titleHtmlEnabled?this.$title.htmlOrNbsp(this.title):this.$title.textOrNbsp(this.title),this._updateIconStyle())}setTitleSuffix(e){this.setProperty("titleSuffix",e)}_renderTitleSuffix(){this.$titleSuffix&&this.$titleSuffix.text(this.titleSuffix||"")}setHeaderVisible(e){this.setProperty("headerVisible",e)}_renderHeaderVisible(){this.$header.setVisible(this.headerVisible),this._renderCollapsible(),this.invalidateLayoutTree()}setBody(e){this.setProperty("body",e)}_setBody(e){e||(e=u.create(BS,{parent:this})),this._setProperty("body",e)}_createLoadingSupport(){return new rr({widget:this,$container:()=>this.$header})}_renderHeader(){this.$header&&(this.$header.remove(),this._removeIconId()),this.header?(this.header.render(),this.$header=this.header.$container.addClass("group-header").addClass("custom-header-widget").prependTo(this.$container),this.htmlHeader=this.header.htmlComp):(this.$header=this.$container.prependDiv("group-header").unfocusable().addClass("prevent-initial-focus"),this.$title=this.$header.appendDiv("group-title"),this.$titleSuffix=this.$header.appendDiv("group-title-suffix"),G.installForEllipsis(this.$title,{parent:this}),this.htmlHeader=S.install(this.$header,this.session),this.rendering||(this._renderIconId(),this._renderTitle(),this._renderTitleSuffix())),this.$header.on("mousedown",this._onHeaderMouseDown.bind(this)),this.invalidateLayoutTree()}_renderBody(){this.body.render(),this.body.$container.insertAfter(this.$header),this.body.$container.addClass("group-body"),this.body.invalidateLayoutTree()}getFocusableElement(){return this.rendered?this.$header:null}toggleCollapse(){this.setCollapsed(!this.collapsed&&this.collapsible)}setCollapsed(e){this.setProperty("collapsed",e)}_renderCollapsed(){this.$container.toggleClass("collapsed",this.collapsed),this.$collapseIcon.toggleClass("collapsed",this.collapsed),!this.collapsed&&!this.bodyAnimating&&this._renderBody(),this.rendered?this.resizeBody():this.collapsed&&this.body.remove(),this.invalidateLayoutTree()}setCollapsible(e){this.setProperty("collapsible",e)}_renderCollapsible(){this.$container.toggleClass("collapsible",this.collapsible),this.$header.toggleClass("disabled",!this.collapsible),this.$footer.setVisible(this.collapseStyle===Si.CollapseStyle.BOTTOM&&(this.headerVisible||this.collapsible)),this.$collapseIcon.setVisible(this.collapsible),this.invalidateLayoutTree()}setCollapseStyle(e){this.setProperty("collapseStyle",e)}_renderCollapseStyle(){if(this.$header.toggleClass("collapse-right",this.collapseStyle===Si.CollapseStyle.RIGHT),this.$container.toggleClass("collapse-bottom",this.collapseStyle===Si.CollapseStyle.BOTTOM),this.collapseStyle===Si.CollapseStyle.RIGHT&&!this.header)this.$collapseIcon.appendTo(this.$header);else if(this.collapseStyle===Si.CollapseStyle.LEFT&&!this.header)this.$collapseIcon.prependTo(this.$header);else if(this.collapseStyle===Si.CollapseStyle.BOTTOM){let e=this.body.$container?this.body.$container:this.$header;this.$footer.insertAfter(e),this.$collapseIcon.insertAfter(this.$collapseBorderLeft)}this._renderCollapsible(),this.invalidateLayoutTree()}_onHeaderMouseDown(e){this.collapsible&&(!this.header||this.collapseStyle!==Si.CollapseStyle.BOTTOM)&&this.setCollapsed(!this.collapsed&&this.collapsible)}_onFooterMouseDown(e){this.collapsible&&this.setCollapsed(!this.collapsed&&this.collapsible)}resizeBody(){this.animateToggleCollapse().done(()=>{this.bodyAnimating||(this.collapsed&&this.body.remove(),this.invalidateLayoutTree())})}animateToggleCollapse(){let e=w.cssSize(this.body.$container),t=w.margins(this.body.$container),r=w.paddings(this.body.$container),s,o,n;return this.collapsed?(s=0,o=new qe,n=new qe):(s=this.body.htmlComp.prefSize({widthHint:e.width}).height,this.body.htmlComp.setSize(new A(this.body.$container.outerWidth(),s)),this.bodyAnimating?(this.body.$container.cssMarginY("").cssPaddingY(""),o=w.margins(this.body.$container),n=w.paddings(this.body.$container)):(e.height=0,t=new qe,r=new qe,o=w.margins(this.body.$container),n=w.paddings(this.body.$container))),this.bodyAnimating=!0,this.collapsed&&this.$container.addClass("collapsing"),this.body.$container.stop(!0).cssHeight(e.height).cssMarginTop(t.top).cssMarginBottom(t.bottom).cssPaddingTop(r.top).cssPaddingBottom(r.bottom).animate({height:s,marginTop:o.top,marginBottom:o.bottom,paddingTop:n.top,paddingBottom:n.bottom},{duration:350,progress:()=>{this.trigger("bodyHeightChange"),this.revalidateLayoutTree()},complete:()=>{this.bodyAnimating=!1,this.body.rendered&&(this.body.$container.cssMarginY(""),this.body.$container.cssPaddingY("")),this.rendered&&this.$container.removeClass("collapsing"),this.trigger("bodyHeightChangeDone")}}).promise()}}nt(Si,"CollapseStyle",{LEFT:"left",RIGHT:"right",BOTTOM:"bottom"});class BS extends I{_render(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=S.install(this.$container,this.session)}}class Im extends He{constructor(){super(),this._addRemoteProperties(["collapsed"])}}function OS(i,e,t){return e=HS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HS(i){var e=NS(i,"string");return typeof e=="symbol"?e:String(e)}function NS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Lh extends te{constructor(e){super(),OS(this,"group",void 0),this.group=e}layout(e){let t=this.group.htmlComp,r=t.availableSize().subtract(t.insets()),s=this.group.htmlHeader,o=s.prefSize({widthHint:r.width});o.width=r.width,o=o.subtract(s.margins()),s.setSize(o);let n=this.group.htmlFooter;if(n.isVisible()){let h=n.prefSize({includeMargin:!1,useCssSize:!0});h.width=r.width,n.setSize(h.subtract(n.margins()))}if(this.group.collapsed||this.group.bodyAnimating||!this.group.body.rendered||!this.group.body.isVisible())return;let l=this.group.body.htmlComp,d=r.subtract(l.margins());d.height-=o.height,n.isVisible()&&(d.height-=n.prefSize(!0).height),l.setSize(d)}invalidate(e){this.group.body.htmlComp&&this.group.bodyAnimating&&e&&e.isDescendantOf(this.group.htmlComp)&&(this.group.body.$container.stop(),this.group.resizeBody())}preferredLayoutSize(e,t){t=t||{};let r,s=this.group.htmlComp,o=this.group.htmlHeader,n=this.group.body.htmlComp,l=this.group.htmlFooter;return t.heightHint=null,this.group.bodyAnimating?r=n.size(!0):this.group.collapsed||!this.group.body.rendered||!this.group.body.isVisible()?r=new A(0,0):r=n.prefSize(t).add(n.margins()),r=r.add(s.insets({includeMargin:!0})),r.height+=o.prefSize(t).add(o.margins()).height,l.isVisible()&&(r.height+=l.prefSize({includeMargin:!0,useCssSize:!0}).height),r}}class Ih extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE]}handle(e){this.field.toggleCollapse()}}function ga(i,e,t){return e=VS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function VS(i){var e=WS(i,"string");return typeof e=="symbol"?e:String(e)}function WS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qr extends I{constructor(){super(),ga(this,"autoFit",void 0),ga(this,"iconDesc",void 0),ga(this,"image",void 0),ga(this,"prepend",void 0),this.autoFit=!1,this.iconDesc=null,this.image=null,this.prepend=!1}_init(e){super._init(e),this._setIconDesc(this.iconDesc)}_render(){this._renderIconDesc()}setIconDesc(e){this.setProperty("iconDesc",e)}_setIconDesc(e){e=hi.ensure(e),this._setProperty("iconDesc",e)}_renderIconDesc(){this._removeFontIcon(),this._removeImageIcon(),!this.iconDesc||this.iconDesc.isFontIcon()?this._renderFontIcon():this._renderImageIcon(),this.rendering||this._renderProperties(),this.invalidateLayoutTree()}_renderFontIcon(){this.$container=this.$parent.appendIcon(this.iconDesc),this.prepend&&this.$container.prependTo(this.$parent),this.htmlComp=S.install(this.$container,this.session)}_removeFontIcon(){this.$container&&(this.$container.remove(),this.$container=null)}_renderImageIcon(){this.image||(this.image=u.create(_a,{parent:this,imageUrl:this.iconDesc.iconUrl,cssClass:"icon image-icon",autoFit:this.autoFit,prepend:this.prepend}),this.image.render(this.$parent),this.image.one("destroy",()=>{this.image=null}),this.image.on("load error",e=>{this.trigger(e.type,e)}),this.$container=this.image.$container,this.htmlComp=this.image.htmlComp)}_removeImageIcon(){this.image&&(this.image.destroy(),this.image=null)}setAutoFit(e){this.setProperty("autoFit",e),this.image&&this.image.setAutoFit(e)}}function rn(i,e,t){return e=KS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function KS(i){var e=zS(i,"string");return typeof e=="symbol"?e:String(e)}function zS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hi{constructor(){rn(this,"iconType",void 0),rn(this,"font",void 0),rn(this,"iconCharacter",void 0),rn(this,"iconUrl",void 0),this.iconType=null,this.font=null,this.iconCharacter=null,this.iconUrl=null}cssClass(){return this.isFontIcon()&&this.font!==hi.DEFAULT_FONT?"font-"+this.font:""}appendCssClass(e){let t=this.cssClass();return t.length>0?e+" "+t:e}isFontIcon(){return this.iconType===hi.IconType.FONT_ICON}isBitmap(){return this.iconType===hi.IconType.BITMAP}static ensure(e){return!e||e instanceof hi?e:ve.parseIconId(e)}}rn(hi,"IconType",{FONT_ICON:0,BITMAP:1}),rn(hi,"DEFAULT_FONT","scoutIcons");function kh(i,e,t){return e=GS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function GS(i){var e=US(i,"string");return typeof e=="symbol"?e:String(e)}function US(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _a extends I{constructor(){super(),kh(this,"autoFit",void 0),kh(this,"imageUrl",void 0),kh(this,"prepend",void 0),this.autoFit=!1,this.imageUrl=null,this.prepend=!1}_render(){this.$container=this.$parent.makeElement("<img>","image").addDeviceClass().on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.prepend?this.$container.prependTo(this.$parent):this.$container.appendTo(this.$parent),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Bh(this)),this.htmlComp.pixelBasedSizing=!1}_renderProperties(){super._renderProperties(),this._renderImageUrl(),this._renderAutoFit()}_remove(){super._remove(),this.htmlComp=null}setImageUrl(e){this.setProperty("imageUrl",e)}_renderImageUrl(){this.$container.attr("src",this.imageUrl),this.imageUrl||this.$container.addClass("empty").removeClass("broken")}setAutoFit(e){this.setProperty("autoFit",e)}_renderAutoFit(){this.$container.toggleClass("autofit",this.autoFit)}_onImageLoad(e){!this.rendered||(this._ensureImageLayout(),this.$container.removeClass("empty broken"),this.invalidateLayoutTree(),this.trigger("load"))}_ensureImageLayout(){!F.get().isChrome()||(this.$container.addClass("chrome-fix"),setTimeout(()=>{this.rendered&&this.$container.removeClass("chrome-fix")}))}_onImageError(e){!this.rendered||(this.$container.addClass("empty broken"),this.invalidateLayoutTree(),this.trigger("error"))}}function qS(i,e,t){return e=YS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function YS(i){var e=jS(i,"string");return typeof e=="symbol"?e:String(e)}function jS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bh extends te{constructor(e){super(),qS(this,"image",void 0),this.image=e}preferredLayoutSize(e,t){let r=e[0];if(r&&r.complete&&r.naturalWidth>0&&r.naturalHeight>0){let s=r.naturalHeight,o=r.naturalWidth;return t.widthHint>0&&t.widthHint<r.naturalWidth?(s=t.widthHint/r.naturalWidth*r.naturalHeight,o=t.widthHint):t.heightHint>0&&t.heightHint<r.naturalHeight&&(s=t.heightHint,o=t.heightHint/r.naturalHeight*r.naturalWidth),new A(o,s)}return super.preferredLayoutSize(e,t)}}function eo(i,e,t){return e=XS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XS(i){var e=JS(i,"string");return typeof e=="symbol"?e:String(e)}function JS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Oh extends I{constructor(){super(),eo(this,"status",void 0),eo(this,"closable",void 0),eo(this,"htmlEnabled",void 0),eo(this,"$content",void 0),eo(this,"$messageText",void 0),eo(this,"$closer",void 0),eo(this,"_icon",void 0),this.status=E.info(),this.closable=!1,this.htmlEnabled=!1,this._icon=null}_init(e){super._init(e),(e.severity||e.message||e.iconId)&&(this.status=new E({severity:u.nvl(e.severity,this.status.severity),message:u.nvl(e.message,this.status.message),iconId:u.nvl(e.iconId,this.status.iconId)})),Ce.resolveTextProperty(this.status,"message",this.session),this._setStatus(this.status)}_render(){this.$container=this.$parent.appendDiv("notification"),this.$content=this.$container.appendDiv("notification-content"),this.$messageText=this.$content.appendDiv("notification-message"),this.htmlComp=S.install(this.$container,this.session)}_remove(){super._remove(),this._removeCloser(),this._removeIcon()}_renderProperties(){super._renderProperties(),this._renderStatus(),this._renderClosable()}setStatus(e){this.setProperty("status",e)}_setStatus(e){this.rendered&&this._removeStatus(),e=E.ensure(e)||E.info(),this._setProperty("status",e)}_removeStatus(){this.status&&this.$container.removeClass(this.status.cssClass())}_renderStatus(){this.status&&(this.$container.addClass(this.status.cssClass()),this._renderIconId()),this._renderMessage()}_renderMessage(){let e=this.status.message||"";this.htmlEnabled?(this.$messageText.html(e),this.$messageText.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$messageText.html(y.nl2br(e)),this.invalidateLayoutTree()}setIconId(e){this.status||(this.status=E.info()),this.status.iconId=e,this.rendered&&this._renderStatus()}_renderIconId(){let e=this.status&&!!this.status.iconId;this.$container.toggleClass("has-icon",e),this.$container.toggleClass("no-icon",!e),e?this._renderIcon():this._removeIcon()}_renderIcon(){if(this._icon){this._icon.setIconDesc(this.status.iconId);return}this._icon=u.create(Qr,{parent:this,iconDesc:this.status.iconId,prepend:!0}),this._icon.one("destroy",()=>{this._icon=null}),this._icon.render(),this._icon.$container.addClass("notification-icon")}_removeIcon(){this._icon&&this._icon.destroy()}setClosable(e){this.setProperty("closable",e)}_renderClosable(){this.$container.toggleClass("closable",this.closable),this.$content.toggleClass("closable",this.closable),this.closable?this._renderCloser():this._removeCloser()}_removeCloser(){!this.$closer||(this.$closer.remove(),this.$closer=null)}_renderCloser(){this.$closer||(this.$closer=this.$content.appendDiv("closer").on("click",this._onCloseIconClick.bind(this)))}_onCloseIconClick(e){this.removing||this.trigger("close")}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}}class Hh extends He{_onWidgetClose(e){this._send("close")}_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="close"?this._onWidgetClose(e):e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}const Ke={filterAccordingToSelection(i,e,t,r,s){let o=[],{notAllowedTypes:n}=s||{};r===kt.MENU_BAR?o=[i+".EmptySpace",i+".SingleSelection",i+".MultiSelection"]:r===kt.CONTEXT_MENU?o=[i+".SingleSelection",i+".MultiSelection"]:r===kt.HEADER&&(o=[i+".Header"]),o.indexOf(i+".SingleSelection")>-1&&e!==1&&f.remove(o,i+".SingleSelection"),o.indexOf(i+".MultiSelection")>-1&&e<=1&&f.remove(o,i+".MultiSelection"),n=f.ensure(n);let l=[];return i=i+".",n.forEach(d=>{d.slice(0,i.length)!==i&&(d=i+d),l.push(d)},this),Ke.filter(t,o,a().extend({},s,{notAllowedTypes:l}))},filter(i,e,t){if(!i)return;e=f.ensure(e);let{onlyVisible:r,enableDisableKeyStrokes:s,notAllowedTypes:o,defaultMenuTypes:n}=t||{};o=f.ensure(o),n=f.ensure(n);let l=[],d=0;return i.forEach(h=>{let p=h.childActions;if(p.length>0){if(p=Ke.filter(p,e,t),p.length===0){Ke._enableDisableMenuKeyStroke(h,s,!0);return}}else if(!Ke._checkType(h,e,n)||o.length!==0&&Ke._checkType(h,o,n)){Ke._enableDisableMenuKeyStroke(h,s,!0);return}if(r&&!h.visible){Ke._enableDisableMenuKeyStroke(h,s,!0);return}h.separator&&d++,Ke._enableDisableMenuKeyStroke(h,s,!1),l.push(h)}),d===l.length?[]:l},updateSeparatorVisibility(i){if(i=f.ensure(i),i=i.filter(r=>r.visible||r.separator),i.length===0)return;let e=!1,t=!1;i.forEach((r,s)=>{if(!r.ellipsis){if(!r.separator){e=!0;return}t=i[s+1]&&!i[s+1].separator&&!i[s+1].ellipsis,!e||!t?r.visibleOrig===void 0&&(r.visibleOrig=r.visible,r.setVisible(!1)):r.visibleOrig!==void 0&&(r.setVisible(r.visibleOrig),r.visibleOrig=void 0)}})},checkType(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return e=f.ensure(e),i.childActions.length>0?Ke.filter(i.childActions,e).length>0:Ke._checkType(i,e,t)},_enableDisableMenuKeyStroke(i,e,t){e&&(i.excludedByFilter=t)},_checkType(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(!e||e.length===0)return!1;let r=f.ensure(i.menuTypes);t=f.ensure(t),r.length===0&&(r=t);for(let s=0;s<e.length;s++)if(r.indexOf(e[s])>-1)return!0;return!1},createEllipsisMenu(i){return u.create(tl,i)},moveMenuIntoEllipsis(i,e){i.remove(),i._setOverflown(!0),i.overflowMenu=e;let t=e.childActions.slice();t.unshift(i),e.setChildActions(t)},removeMenuFromEllipsis(i,e){i._setOverflown(!1),i.overflowMenu=null,i.rendered||i.render(e)}};var kt;(function(i){i[i.MENU_BAR=1]="MENU_BAR",i[i.CONTEXT_MENU=2]="CONTEXT_MENU",i[i.HEADER=3]="HEADER"})(kt||(kt={}));function Ze(i,e,t){return e=QS(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QS(i){var e=ZS(i,"string");return typeof e=="symbol"?e:String(e)}function ZS(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class le extends oe{constructor(){super(),Ze(this,"childActions",void 0),Ze(this,"defaultMenu",void 0),Ze(this,"excludedByFilter",void 0),Ze(this,"menuTypes",void 0),Ze(this,"menuStyle",void 0),Ze(this,"uiCssClass",void 0),Ze(this,"overflown",void 0),Ze(this,"overflowMenu",void 0),Ze(this,"parentMenu",void 0),Ze(this,"ellipsis",void 0),Ze(this,"rightAligned",void 0),Ze(this,"popup",void 0),Ze(this,"popupHorizontalAlignment",void 0),Ze(this,"popupVerticalAlignment",void 0),Ze(this,"stackable",void 0),Ze(this,"separator",void 0),Ze(this,"shrinkable",void 0),Ze(this,"subMenuVisibility",void 0),Ze(this,"menuFilter",void 0),Ze(this,"createdBy",void 0),Ze(this,"$submenuIcon",void 0),Ze(this,"$subMenuBody",void 0),Ze(this,"$placeHolder",void 0),this.childActions=[],this.defaultMenu=null,this.excludedByFilter=!1,this.menuTypes=[],this.menuStyle=le.MenuStyle.NONE,this.overflown=!1,this.parentMenu=null,this.popup=null,this.popupHorizontalAlignment=void 0,this.popupVerticalAlignment=void 0,this.stackable=!0,this.separator=!1,this.shrinkable=!1,this.rightAligned=!1,this.subMenuVisibility=le.SubMenuVisibility.DEFAULT,this.menuFilter=null,this.$submenuIcon=null,this.$subMenuBody=null,this._addCloneProperties(["defaultMenu","menuTypes","overflow","stackable","separator","shrinkable","parentMenu","menuFilter","subMenuVisibility"]),this._addWidgetProperties("childActions")}_init(e){super._init(e),this._setChildActions(this.childActions)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new Vh(this))}_render(){this.separator?this._renderSeparator():this._renderItem(),this.$container.unfocusable(),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderOverflown(),this._renderMenuStyle(),this._renderActionStyle(),this._updateIconAndTextStyle()}_remove(){super._remove(),this.$submenuIcon=null,this.$subMenuBody=null}_renderSeparator(){this.$container=this.$parent.appendDiv("menu-separator")}_renderItem(){this.$container=this.$parent.appendDiv("menu-item"),this.uiCssClass&&this.$container.addClass(this.uiCssClass);let e=this._onMouseEvent.bind(this);this.$container.on("mousedown",e).on("contextmenu",e).on("click",e),this._renderSubMenuIcon()}_renderActionStyle(){this.$container.toggleClass("menu-button",this.isButton()&&!this.overflown)}_renderSelected(){this._doActionTogglesSubMenu()||(super._renderSelected(),this.parent instanceof mt&&this.parent.updateNextToSelected()),this.selected?this._doActionTogglesSubMenu()?this._renderSubMenuItems(this,this.childActions):this._doActionTogglesPopup()&&this._openPopup():this._doActionTogglesSubMenu()&&this.rendered?this._removeSubMenuItems(this):(this._closePopup(),this._closeSubMenus()),this.$container.toggleClass("has-popup",this._doActionTogglesSubMenu()||this._doActionTogglesPopup())}_closeSubMenus(){this.childActions.forEach(e=>{e._doActionTogglesPopup()&&(e._closeSubMenus(),e.setSelected(!1))})}_removeSubMenuItems(e){this.parent instanceof mt?this.parent.removeSubMenuItems(e,!0):this.parent instanceof le&&this.parent._removeSubMenuItems(e)}_renderSubMenuItems(e,t){let r=this.parent;if(r instanceof mt){r.renderSubMenuItems(e,t,!0);let s=n=>e.setSelected(!1),o=n=>{n.newValue===!1&&(r.off("destroy",s),e.off("propertyChange:selected",o))};r.one("destroy",s),e.on("propertyChange:selected",o)}else r instanceof le&&r._renderSubMenuItems(e,t)}_togglesSubMenu(){return!0}_doActionTogglesSubMenu(){return this.childActions.length?this.parent instanceof mt?!0:this.parent instanceof le?this.parent._togglesSubMenu():!1:!1}_onMouseEvent(e){e.type==="mousedown"&&this._doubleClickSupport.mousedown(e),this._allowMouseEvent(e)&&(G.cancel(this.$container),e.type==="mousedown"&&this._doActionTogglesPopup()?this.doAction():(e.type==="click"||e.type==="contextmenu")&&!this._doActionTogglesPopup()&&this.doAction())}_doActionTogglesPopup(){return this.childActions.length>0}_renderChildActions(){this.rendering||this._renderSubMenuIcon()}setSubMenuVisibility(e){this.setProperty("subMenuVisibility",e)}_renderSubMenuVisibility(){this._renderSubMenuIcon()}_renderSubMenuIcon(){let e=!1;if(this.childActions.length>0)switch(this.subMenuVisibility){case le.SubMenuVisibility.DEFAULT:e=this._hasText();break;case le.SubMenuVisibility.TEXT_OR_ICON:e=this._hasText()||!!this.iconId;break;case le.SubMenuVisibility.ALWAYS:e=!0;break;case le.SubMenuVisibility.NEVER:e=!1;break}if(e){if(!this.$submenuIcon){let t=ve.parseIconId(le.SUBMENU_ICON);this.$submenuIcon=this.$container.appendSpan("submenu-icon").text(t.iconCharacter),this.invalidateLayoutTree()}}else this.$submenuIcon&&(this.$submenuIcon.remove(),this.$submenuIcon=null,this.invalidateLayoutTree());this.rendering||(this._renderTextPosition(),this._updateIconAndTextStyle())}_renderText(){super._renderText(),this.$container.toggleClass("has-text",y.hasText(this.text)&&this.textVisible),this.rendering||this._renderSubMenuIcon(),this.invalidateLayoutTree()}_renderTextPosition(){super._renderTextPosition();let e=this.$container;this.textPosition===oe.TextPosition.BOTTOM&&this.$text&&this.iconId&&(e=this.$text),this.$submenuIcon&&this.$submenuIcon.appendTo(e)}_renderIconId(){super._renderIconId(),this.$container.toggleClass("has-icon",!!this.iconId),this.rendering||this._renderSubMenuIcon(),this.invalidateLayoutTree()}isTabTarget(){return this.enabledComputed&&this.visible&&!this.overflown&&(this.isButton()||!this.separator)&&(!this.parentMenu||this.parentMenu.visible&&!this.parentMenu.overflown)}recomputeEnabled(e){e===void 0&&(e=this._getInheritedAccessibility());let t,r;this.enabled&&this.inheritAccessibility&&!e&&this.childActions.length>0?(t=this._hasAccessibleChildMenu(),t?r=e:r=!1):(t=this._computeEnabled(this.inheritAccessibility,e),r=t),this._updateEnabledComputed(t,r)}_getInheritedAccessibility(){let e=this,t=e;for(;e;){if(!e.inheritAccessibility)return e.enabled;t=e,e=e.parentMenu}let r=t.parent;return r&&r.initialized&&r.enabledComputed!==void 0?r.enabledComputed:!0}_findRootMenu(){let e=this,t;for(;e;)t=e,e=e.parentMenu;return t}_hasAccessibleChildMenu(){let e=!1;return this.visitChildMenus(t=>!t.inheritAccessibility&&t.enabled&&t.visible?(e=!0,ye.TERMINATE):ye.CONTINUE),e}visitChildMenus(e){for(let t=0;t<this.childActions.length;t++){let r=this.childActions[t];if(r instanceof le){let s=e(r);if(s===!0||s===ye.TERMINATE)return ye.TERMINATE;if(s!==ye.SKIP_SUBTREE&&(s=r.visitChildMenus(e),s===ye.TERMINATE))return ye.TERMINATE}}}_hasText(){return y.hasText(this.text)&&this.textVisible}_updateIconAndTextStyle(){let e=this._hasText(),t=!!(e&&this.iconId),r=!!this.iconId,s=!!this.$submenuIcon,o=r&&!s||!r&&s;this.$container.toggleClass("menu-textandicon",t),this.$container.toggleClass("menu-icononly",!e&&o)}_closePopup(){this.popup&&!this.popup.isRemovalPending()&&this.popup.close()}_canOpenPopup(){return this.popup&&this.popup.isRemovalPending()&&this.popup.removeImmediately(),!(this.popup||!this._doActionTogglesPopup())}_openPopup(){!this._canOpenPopup()||(this.popup=this._createPopup(),this.popup.open(),this.popup.one("destroy",e=>{this.popup=null}),this.popup.on("close",e=>this.setSelected(!1)),this.uiCssClass&&this.popup.$container.addClass(this.uiCssClass))}_createPopup(){return u.create(Zh,{parent:this,menu:this,menuFilter:this.menuFilter,horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment})}_createActionKeyStroke(){return new Nh(this)}isToggleAction(){return this.childActions.length>0||this.toggleAction}isButton(){return oe.ActionStyle.BUTTON===this.actionStyle}addChildActions(e){this.insertChildActions(e)}insertChildAction(e){this.insertChildActions([e])}insertChildActions(e){if(e=f.ensure(e),e.length===0)return;let t=this.childActions;this.setChildActions(t.concat(e))}deleteChildAction(e){this.deleteChildActions([e])}deleteChildActions(e){if(e=f.ensure(e),e.length===0)return;let t=this.childActions.slice();f.removeAll(t,e),this.setChildActions(t)}setChildActions(e){this.setProperty("childActions",e)}_setChildActions(e){this.childActions.forEach(t=>{t.parentMenu=null}),this._setProperty("childActions",e),this.childActions.forEach(t=>{t.parentMenu=this}),this.initialized&&this.recomputeEnabled()}_setInheritAccessibility(e){this._setProperty("inheritAccessibility",e)&&this._recomputeEnabledInMenuHierarchy()}_setEnabled(e){this._setProperty("enabled",e)&&this._recomputeEnabledInMenuHierarchy()}_setVisible(e){this._setProperty("visible",e)&&this._recomputeEnabledInMenuHierarchy()}_recomputeEnabledInMenuHierarchy(){if(!this.initialized)return;let e=this._findRootMenu();e.recomputeEnabled(),e!==this&&this.recomputeEnabled()}setSelected(e){e!==this.selected&&(super.setSelected(e),!(!this._doActionTogglesSubMenu()&&!this._doActionTogglesPopup())&&this.overflowMenu&&!this.overflowMenu.selected&&this._handleSelectedInEllipsis())}_handleSelectedInEllipsis(){this.selected&&this.overflowMenu.setSelected(!0)}setStackable(e){this.setProperty("stackable",e)}_renderStackable(){this.invalidateLayoutTree()}setShrinkable(e){this.setProperty("shrinkable",e)}_renderShrinkable(){this.invalidateLayoutTree()}_setOverflown(e){this.overflown!==e&&(this._setProperty("overflown",e),this.rendered&&this._renderOverflown())}_renderOverflown(){this.$container.toggleClass("overflown",this.overflown),this._renderActionStyle()}setMenuTypes(e){this.setProperty("menuTypes",e)}setMenuStyle(e){this.setProperty("menuStyle",e)}_renderMenuStyle(){this.$container.toggleClass("default",this.menuStyle===le.MenuStyle.DEFAULT)}setDefaultMenu(e){this.setProperty("defaultMenu",e)}setMenuFilter(e){this.setProperty("menuFilter",e),this.childActions.forEach(t=>t.setMenuFilter(e))}clone(e,t){let r=super.clone(e,t);return this._deepCloneProperties(r,"childActions",t),r._setChildActions(r.childActions),r}focus(){return this.trigger("focus").defaultPrevented?!1:super.focus()}}Ze(le,"SUBMENU_ICON",ve.ANGLE_DOWN_BOLD),Ze(le,"MenuStyle",{NONE:0,DEFAULT:1}),Ze(le,"SubMenuVisibility",{DEFAULT:"default",TEXT_OR_ICON:"textOrIcon",ALWAYS:"always",NEVER:"never"});function eC(i,e,t){return e=tC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tC(i){var e=iC(i,"string");return typeof e=="symbol"?e:String(e)}function iC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tl extends le{constructor(){super(),eC(this,"hidden",void 0),this.hidden=!0,this.ellipsis=!0,this.stackable=!1,this.horizontalAlignment=1,this.iconId=ve.ELLIPSIS_V,this.tabbable=!1,this._addPreserveOnPropertyChangeProperties(["childActions"])}_render(){super._render(),this.$container.addClass("ellipsis")}setChildActions(e){super.setChildActions(e),e&&e.forEach(t=>t.setSelected(!1))}_renderProperties(){super._renderProperties(),this._renderHidden()}setHidden(e){this.setProperty("hidden",e)}_renderHidden(){this.$container.setVisible(!this.hidden)}isTabTarget(){return super.isTabTarget()&&!this.hidden}_childrenForEnabledComputed(){return this.childActions}}class il extends bs{}class Nh extends Qs{constructor(e){super(e)}_isEnabled(){return this.field.excludedByFilter?!1:super._isEnabled()}}class Vh extends ha{constructor(e){super(e),this.renderingHints.offset=16}}function rl(i,e,t){return e=rC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function rC(i){var e=sC(i,"string");return typeof e=="symbol"?e:String(e)}function sC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sn{constructor(e,t){rl(this,"session",void 0),rl(this,"objectType",void 0),rl(this,"emptySpaceTypes",void 0),rl(this,"selectionTypes",void 0),rl(this,"menuBar",void 0),this.session=e,this.objectType=t,this.emptySpaceTypes=["EmptySpace"],this.selectionTypes=["SingleSelection","MultiSelection"]}order(e){let t=[],r=[],s=[],o=[],n=!1,l=!1;return e.forEach(d=>{d.createdBy!==this&&(d.isButton()?t.push(d):d.horizontalAlignment===1?o.push(d):Ke.checkType(d,this._menuTypes(this.emptySpaceTypes))?(d.visible&&(n=!0),r.push(d)):Ke.checkType(d,this._menuTypes(this.selectionTypes))&&(d.visible&&(l=!0),s.push(d)))}),n&&l&&r.push(this._createSeparator()),{left:t.concat(r,s),right:o,all:t.concat(r,s).concat(o)}}_menuTypes(e){let t=[];e=e||[];for(let r=0;r<e.length;r++)t.push(this.objectType+"."+e[r]);return t}_createSeparator(){let e=u.create(le,{parent:this.menuBar,separator:!0});return e.createdBy=this,e}}function oC(i,e,t){return e=nC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nC(i){var e=lC(i,"string");return typeof e=="symbol"?e:String(e)}function lC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wh extends le{constructor(){super(),oC(this,"_childVisibleChangeHandler",void 0),this._childVisibleChangeHandler=this._onChildVisibleChange.bind(this)}_render(){this.$container=this.$parent.appendDiv("menu-item combo-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.$container.unfocusable(),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderChildActions()}_setChildActions(e){this.childActions.forEach(t=>t.off("propertyChange:visible",this._childVisibleChangeHandler)),super._setChildActions(e),this.childActions.forEach(t=>t.on("propertyChange:visible",this._childVisibleChangeHandler))}_renderChildActions(){super._renderChildActions(),this.childActions.forEach(e=>{e.addCssClass("combo-menu-child"),e.render()}),ke.updateFirstLastMarker(this.childActions)}_togglesSubMenu(){return!1}_onChildVisibleChange(e){this.rendered&&ke.updateFirstLastMarker(this.childActions)}_doActionTogglesPopup(){return!1}isToggleAction(){return!1}isTabTarget(){return!1}}class km extends il{}function ys(i,e,t){return e=aC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aC(i){var e=dC(i,"string");return typeof e=="symbol"?e:String(e)}function dC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mt extends pe{constructor(){super(),ys(this,"menuItems",void 0),ys(this,"cloneMenuItems",void 0),ys(this,"bodyAnimating",void 0),ys(this,"animationDuration",void 0),ys(this,"$body",void 0),ys(this,"initialSubMenusToRender",void 0),ys(this,"menuFilter",void 0),ys(this,"_toggleSubMenuQueue",void 0),this.animateOpening=!0,this.animateRemoval=!0,this.menuItems=[],this.cloneMenuItems=!0,this.bodyAnimating=!1,this._toggleSubMenuQueue=[],this.animationDuration=300}_init(e){e.focusableContainer=!0,e.cloneMenuItems===!1&&this._addWidgetProperties("menuItems"),super._init(e)}_initKeyStrokeContext(){super._initKeyStrokeContext(),vs.registerKeyStrokes(this.keyStrokeContext,this,"menu-item")}_createLayout(){return new Kh(this)}_createBodyLayout(){return new Ri({pixelBasedSizing:!1})}_render(){super._render(),this.$container.addClass("context-menu-popup"),this._renderBody(),this._installScrollbars(),this._renderMenuItems()}_remove(){this._toggleSubMenuQueue=[],super._remove()}_renderBody(){this.$body=this.$container.appendDiv("context-menu"),S.install(this.$body,this.session).setLayout(this._createBodyLayout())}_installScrollbars(e){super._installScrollbars({axis:"y",scrollShadow:"none"})}_checkRemoveSubMenuItemsPossible(e,t){if(!this.rendered&&!this.rendering)return!1;let r=this.isOpeningAnimationRunning(),o=this.htmlComp.layout.resizeAnimationRunning;return this.bodyAnimating||r||o?(this._toggleSubMenuQueue.push(this.removeSubMenuItems.bind(this,e,t)),r&&this.$container.oneAnimationEnd(()=>this._processSubMenuQueue()),!1):!0}removeSubMenuItems(e,t){let r=e;if(!this._checkRemoveSubMenuItemsPossible(r,t))return;this.$body=r.__originalParent.$subMenuBody,this.$body.insertBefore(r.$subMenuBody),r.__originalParent._doActionTogglesSubMenu&&r.__originalParent._doActionTogglesSubMenu();let s=this.htmlComp.bounds();this._adjustTextAlignment(),S.get(this.$body).invalidateLayoutTree(),this.validateLayoutTree(),this.position(),t&&this._animateRemoveSubmenuItems(r,s)}_animateRemoveSubmenuItems(e,t){let r=e.$placeHolder.position(),s=this.htmlComp.insets(),o=this.htmlComp.bounds(),n=S.get(e.$subMenuBody).bounds(),l=S.get(this.$body).bounds(),d=new re(0,s.top,n.width,n.height),h=new re(0,s.top+r.top,l.width,e.$container.cssHeight());this.bodyAnimating=!0,this.$container.addClass("animating"),this.htmlComp.layout.disableAutoPosition(),this._animateResizePopup(this.htmlComp.$comp,t,o),this._animateTextOffset(e.$subMenuBody,e.$subMenuBody.data("text-offset")),e.$subMenuBody.cssWidthAnimated(d.width,h.width,{duration:this.animationDuration,progress:this.revalidateLayout.bind(this),complete:()=>this._completeAnimateRemoveSubMenuItems(e),queue:!1}).cssHeightAnimated(d.height,h.height,{duration:this.animationDuration,queue:!1}).cssTopAnimated(d.y,h.y,{duration:this.animationDuration,queue:!1}),this.$body.cssWidthAnimated(n.width,l.width,{duration:this.animationDuration,queue:!1}).cssHeightAnimated(n.height,l.height,{duration:this.animationDuration,queue:!1})}_completeAnimateRemoveSubMenuItems(e){this.bodyAnimating=!1,!(!this.rendered||!e.$container)&&(this.$container.removeClass("animating"),e.$placeHolder.replaceWith(e.$container),e.$container.toggleClass("expanded",!1),this._updateFirstLastClass(),this.updateNextToSelected("menu-item",e.$container),e.$subMenuBody.detach(),this._processSubMenuQueue())}_processSubMenuQueue(){let e=this._toggleSubMenuQueue.shift();e&&e()}_checkRenderSubMenuItemsPossible(e,t,r,s){if(!this.session.desktop.rendered&&!s)return this.initialSubMenusToRender={parentMenu:e,menus:t},!1;if(!this.rendered&&!this.rendering)return!1;let o=this.isOpeningAnimationRunning(),l=this.htmlComp.layout.resizeAnimationRunning;return this.bodyAnimating||o||l?(this._toggleSubMenuQueue.push(this.renderSubMenuItems.bind(this,e,t,r,s)),o&&this.$container.oneAnimationEnd(()=>this._processSubMenuQueue()),!1):!0}renderSubMenuItems(e,t,r,s){let o=e;if(!this._checkRenderSubMenuItemsPossible(o,t,r,s))return!1;let n=this.htmlComp.bounds(),l=this.$body;o.__originalParent.$subMenuBody=l,this.$body.find(".menu-item").removeClass("next-to-selected"),o.$subMenuBody?this.$body=o.$subMenuBody:(this._renderBody(),o.$subMenuBody=this.$body,this._renderMenuItems(t,s));let h=o.$container.prev(),p=o.$container.position();o.$placeHolder=o.$container.clone(),S.install(o.$placeHolder,this.session),h.length?o.$placeHolder.insertAfter(h):l.prepend(o.$placeHolder),this.$body.insertAfter(l),this.$body.prepend(o.$container),o.$container.toggleClass("expanded"),this._adjustTextAlignment(),S.get(this.$body).invalidateLayoutTree(),this.validateLayoutTree(),this.position(),this.updateNextToSelected(),r?this._animateRenderSubMenuItems(o,n,p):(l.detach(),this._updateFirstLastClass())}_animateRenderSubMenuItems(e,t,r){let s=e,o=s.__originalParent.$subMenuBody,n=this.htmlComp.bounds(),l=this.htmlComp.insets(),d=w.bounds(o),h=S.get(this.$body).bounds(),p=new re(0,l.top+r.top,d.width,s.$container.cssHeight()),m=new re(0,l.top,h.width,h.height);this.bodyAnimating=!0,this.$container.addClass("animating"),this.htmlComp.layout.disableAutoPosition(),this._animateResizePopup(this.htmlComp.$comp,t,n),this._animateTextOffset(this.$body,o.data("text-offset")),this.$body.cssWidthAnimated(p.width,m.width,{duration:this.animationDuration,progress:this.revalidateLayout.bind(this),complete:()=>this._completeAnimateRenderSubMenuItems(o),queue:!1}).cssHeightAnimated(p.height,m.height,{duration:this.animationDuration,queue:!1}).cssTopAnimated(p.y,m.y,{duration:this.animationDuration,queue:!1}),o.cssWidthAnimated(d.width,m.width,{duration:this.animationDuration,queue:!1}).cssHeightAnimated(d.height,m.height,{duration:this.animationDuration,queue:!1})}_completeAnimateRenderSubMenuItems(e){if(this.bodyAnimating=!1,!this.rendered)return;this.$container.removeClass("animating"),e&&(e.detach(),this.$body.cssTop(""),this._updateFirstLastClass()),this.htmlComp.layout.resetAutoPosition(),this._processSubMenuQueue()}_animateResizePopup(e,t,r){let s={duration:this.animationDuration,queue:!1};e.cssTopAnimated(t.y,r.y,s).cssLeftAnimated(t.x,r.x,s).cssWidthAnimated(t.width,r.width,s).cssHeightAnimated(t.height,r.height,s)}_animateTextOffset(e,t,r){r=u.nvl(r,this.$body.data("text-offset")),this.$visibleMenuItems(e).each((o,n)=>{let l=a()(n),d=l.children(".text"),h=this._calcTextPaddingLeft(l,t),p=this._calcTextPaddingLeft(l,r);d.cssAnimated({paddingLeft:h},{paddingLeft:p},{duration:this.animationDuration})})}_renderMenuItems(e,t){e=e||this._getMenuItems(),this.menuFilter&&(e=this.menuFilter(e,kt.CONTEXT_MENU)),!(!e||e.length===0)&&(e.forEach(r=>{if(r.separator)return;let s=r.parent;(this.cloneMenuItems&&!r.cloneOf||!this.has(r))&&(r=r.clone({parent:this,textPosition:oe.TextPosition.DEFAULT},{delegateEventsToOriginal:["acceptInput","action","click"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected","logicalGrid","tabbable"]}),r.setTabbable(!1),this._attachCloneMenuListeners(r)),r.__originalParent||(r.__originalParent=s),r.render(this.$body),r.$container.removeClass("menu-button"),this._attachMenuListeners(r)}),this._handleInitialSubMenus(t),this._updateFirstLastClass(),this._adjustTextAlignment())}_attachCloneMenuListeners(e){e.on("propertyChange",this._onCloneMenuPropertyChange.bind(this)),e.childActions.forEach(this._attachCloneMenuListeners.bind(this))}_onCloneMenuPropertyChange(e){e.propertyName==="selected"&&e.source.cloneOf.triggerPropertyChange("selected",e.oldValue,e.newValue)}_handleInitialSubMenus(e){if(e)return;let t;for(;this.initialSubMenusToRender;)t=this.initialSubMenusToRender,this.initialSubMenusToRender=void 0,this.renderSubMenuItems(t.parentMenu,t.menus,!1,!0)}_attachMenuListeners(e){let t=this._onMenuItemAction.bind(this),r=this._onMenuItemPropertyChange.bind(this);e.on("action",t),e.on("propertyChange",r),this.one("remove",()=>{e.off("action",t),e.off("propertyChange",r)})}updateMenuItems(e){e=f.ensure(e),f.equals(this.menuItems,e)||this.close()}_getMenuItems(){return this.menuItems}$menuItems(){return this.$body.children(".menu-item")}$visibleMenuItems(e){return e=e||this.$body,e.children(".menu-item:visible")}_updateFirstLastClass(){let e,t;this.$body.children(".menu-item").each(function(){let r=a()(this);r.removeClass("first last"),r.isVisible()&&(e||(e=r),t=r)}),e&&e.addClass("first"),t&&t.addClass("last")}updateNextToSelected(e,t){e=e||"menu-item";let r=this.$body.find("."+e);t=t||this.$body.find("."+e+".selected"),r.removeClass("next-to-selected"),t.hasClass("selected")&&t.nextAll(":visible").first().addClass("next-to-selected")}_onMenuItemAction(e){e.source.isToggleAction()||e.defaultPrevented||this.close()}_onMenuItemPropertyChange(e){!this.rendered||(e.propertyName==="visible"?this._updateFirstLastClass():e.propertyName==="selected"&&this._deselectSiblings(e.source),this.position())}_deselectSiblings(e){e.$container.siblings(".menu-item").each((t,r)=>{a()(r).select(!1)})}_adjustTextAlignment(e){e=e||this.$body;let t=this.$visibleMenuItems(e),r=this._calcTextOffset(t);e.data("text-offset",r),this._updateTextOffset(r,t)}_calcTextOffset(e){let t=0;return e=e||this.$visibleMenuItems(),e.each((r,s)=>{let n=a()(s).children(".icon"),l=0;n.length>0&&(l=n.outerWidth(!0)),t=Math.max(t,l)}),t}_updateTextOffset(e,t){t=t||this.$visibleMenuItems(),t.each((r,s)=>{let o=a()(s);o.children(".text").css("padding-left",this._calcTextPaddingLeft(o,e));let l=S.optGet(o);l&&l.invalidateLayout()})}_calcTextPaddingLeft(e,t){let r=e.children(".icon"),s=0;return r.length>0&&(s=r.outerWidth(!0)),t-s}}class Kh extends Ii{constructor(e){super(e)}_setSize(e){if(this.popup.bodyAnimating){x.update(this.popup.get$Scrollable());return}super._setSize(e),x.update(this.popup.get$Scrollable()),S.get(this.popup.$body).pack()}invalidate(e){this.popup.bodyAnimating&&e&&e.isDescendantOf(this.popup.htmlComp)&&this.popup._toggleSubMenuQueue.unshift(()=>{if(!this.popup.rendered)return;let t=this.popup.$body.data("text-offset");this.popup._adjustTextAlignment(),this.popup.animateResize=!0,this.resizeAnimationDuration=this.popup.animationDuration,this.popup.revalidateLayoutTree(),this.popup.animateResize=!1,this.popup._animateTextOffset(this.popup.$body,t),this.popup.$container.promise().done(()=>this.popup._processSubMenuQueue())})}preferredLayoutSize(e,t){let r=this.popup.htmlComp,s=S.get(this.popup.$body),o;if(this.popup.bodyAnimating)o=w.size(this.popup.$body,t);else{let n=this.popup.$container.attr("style"),l=this.popup.$body.siblings(".context-menu");l.addClass("hidden"),this.popup.$body.css({width:"auto",height:"auto"}),s=S.get(this.popup.$body),o=s.prefSize(t),l.removeClass("hidden"),this.popup.$container.attr("style",n)}return o.add(r.insets()).add(s.margins())}}function hC(i,e,t){return e=uC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function uC(i){var e=cC(i,"string");return typeof e=="symbol"?e:String(e)}function cC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sl extends B{constructor(e){super(),hC(this,"_menuItemClass",void 0),this.field=e,this.inheritAccessibility=!1}_accept(e){let t=super._accept(e);return!t||this.field.bodyAnimating?!1:t}_changeSelection(e,t){t.length!==0&&(t.select(!0).focus(),this.field.updateNextToSelected&&this.field.updateNextToSelected(this._menuItemClass,t),e.length>0&&e.select(!1))}}class ol extends sl{constructor(e,t){super(e),this._menuItemClass=t,this.stopImmediatePropagation=!0,this.which=[_.ENTER,_.SPACE],this.renderingHints.render=!1}handle(e){let t=vs._findMenuItems(this.field,this._menuItemClass).$selected;t.length>0&&t.data("widget").doAction()}}class zh extends ol{constructor(e,t){super(e,t),this._menuItemClass=t,this.which=[_[1],_[2],_[3],_[4],_[5],_[6],_[7],_[8],_[9]],this.renderingHints.render=!0,this.renderingHints.hAlign=ht.RIGHT,this.renderingHints.$drawingArea=(r,s)=>s.$menuItem}_accept(e){if(!super._accept(e))return!1;let r=vs._findMenuItems(this.field,this._menuItemClass),s=_.codesToKeys[e.which];return e.$menuItem=r.$allVisible.eq(s-1),e.$menuItem.length>0}handle(e){e.$menuItem.data("widget").doAction()}}class Gh extends sl{constructor(e,t){super(e),this._menuItemClass=t,this.which=[_.DOWN],this.renderingHints.render=!1}handle(e){let t=vs._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.nextAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.first())}}class Uh extends sl{constructor(e,t){super(e),this._menuItemClass=t,this.which=[_.UP],this.renderingHints.render=!1}handle(e){let t=vs._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.prevAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.last())}}class qh extends ol{constructor(e,t){super(e,t),this._menuItemClass=t,this.which=[_.BACKSPACE],this.renderingHints.render=!0,this.renderingHints.$drawingArea=(r,s)=>s.$menuItem}_accept(e){if(!super._accept(e))return!1;let r=vs._findMenuItems(this.field,this._menuItemClass+".expanded");return r.$all.length>0?(e.$menuItem=r.$all,!0):!1}handle(e){e.$menuItem.data("widget").doAction()}}const vs={registerKeyStrokes(i,e,t){i.registerKeyStrokes([new Uh(e,t),new Gh(e,t),new ol(e,t),new zh(e,t),new qh(e,t)])},_findMenuItems(i,e){return{$all:i.$body.find("."+e),$allVisible:i.$body.find("."+e+":visible"),$selected:i.$body.find("."+e+".selected")}}};function ba(i,e,t){return e=pC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pC(i){var e=fC(i,"string");return typeof e=="symbol"?e:String(e)}function fC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Dn extends le{constructor(){super(),ba(this,"button",void 0),ba(this,"menubar",void 0),ba(this,"_buttonPropertyChangeHandler",void 0),ba(this,"_buttonDestroyHandler",void 0),this._removeWidgetProperties("childActions"),this._buttonPropertyChangeHandler=this._onButtonPropertyChange.bind(this),this._buttonDestroyHandler=this._onButtonDestroy.bind(this),this._addCloneProperties(["button"]),this.button=null,this.menubar=null}_init(e){if(super._init(e),!this.button)throw new Error("Cannot adapt to undefined button");this.button.adaptedBy=this,this._installListeners()}_destroy(){super._destroy(),delete this.button.adaptedBy}_installListeners(){this.button.on("propertyChange",this._buttonPropertyChangeHandler),this.button.on("destroy",this._buttonDestroyHandler)}_uninstallListeners(){this.button.off("propertyChange",this._buttonPropertyChangeHandler),this.button.off("destroy",this._buttonDestroyHandler)}_render(){super._render(),this.$container.attr("data-buttonadapter",this.button.id)}_onButtonPropertyChange(e){let t={};t[e.propertyName]=e.newValue,t=Dn.adaptButtonProperties(t);for(let r in t)this.setProperty(r,t[r])}_onButtonDestroy(e){this.destroy(),this._uninstallListeners()}doAction(){if(this.childActions.length>0)return super.doAction();let e=this.button.doAction();return e&&(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction()),e}focus(){return this.rendered?(this.menubar.setTabbableMenu(this),this.session.focusManager.requestFocus(this.getFocusableElement())):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}static adaptButtonProperties(e,t){t=t||{},["visible","selected","tooltipText","keyStroke","keyStrokes","cssClass","modelClass","classId","iconId","preventDoubleClick","enabled","inheritAccessibility","stackable","shrinkable"].forEach(o=>{t[o]=e[o]}),t.text=e.label,t.textPosition=s(e.labelPosition),t.horizontalAlignment=e.gridData?e.gridData.horizontalAlignment:void 0,t.actionStyle=r(e.displayStyle),t.toggleAction=e.displayStyle===Le.DisplayStyle.TOGGLE,t.childActions=e.menus,t.defaultMenu===void 0&&(t.defaultMenu=e.defaultButton);for(let o in t)t[o]===void 0&&delete t[o];return t;function r(o){if(o!==void 0)return o===Le.DisplayStyle.LINK?oe.ActionStyle.DEFAULT:oe.ActionStyle.BUTTON}function s(o){if(o!==void 0)return o===Le.LabelPosition.BOTTOM?oe.TextPosition.BOTTOM:oe.TextPosition.DEFAULT}}}function mC(i,e,t){return e=gC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gC(i){var e=_C(i,"string");return typeof e=="symbol"?e:String(e)}function _C(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bm extends le{constructor(){super(),mC(this,"field",void 0),this._addWidgetProperties("field")}_render(){this.$container=this.$parent.appendDiv("menu-item"),this.$container.addClass("form-field-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new ch({stretch:!1}))}_renderProperties(){super._renderProperties(),this._renderField()}_renderText(){super._renderText(),this.field&&this.field.rendered&&this.$text&&this.field.$container.insertAfter(this.$text)}setField(e){this.setProperty("field",e)}_renderField(){if(this.field){this.field.gridData=ze.createFromHints(this.field,1),this.field.render(this.$container);let e=new Nr(this.field);e.validate(),this.field.setLayoutData(e),this.field.$container.addClass("content")}}_removeField(){this.field&&this.field.remove()}clone(e,t){let r=super.clone(e,t);return this._deepCloneProperties(r,["field"],t),r}isTabTarget(){return!1}_renderOverflown(){super._renderOverflown(),this.field._hideStatusMessage()}}class Om extends il{_postCreateWidget(){super._postCreateWidget(),this.widget.field&&(this.widget.field.gridDataHints=new ze(this.widget.field.gridData))}}function ya(i,e,t){return e=bC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bC(i){var e=yC(i,"string");return typeof e=="symbol"?e:String(e)}function yC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Yh extends I{constructor(){super(),ya(this,"compact",void 0),ya(this,"compactOrig",void 0),ya(this,"menus",void 0),ya(this,"uiMenuCssClass",void 0),this.compact=!1,this.menus=[],this.uiMenuCssClass="menu-box-item",this._addWidgetProperties("menus")}_init(e){super._init(e),this._initMenus(this.menus)}_initMenus(e){e.forEach(this._initMenu.bind(this))}_initMenu(e){e.uiCssClass=this.uiMenuCssClass}_render(){this.$container=this.$parent.appendDiv("menu-box"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new jh(this))}_renderProperties(){super._renderProperties(),this._renderMenus(),this._renderCompact()}setMenus(e){this.setProperty("menus",e)}_renderMenus(){this.menus.forEach(e=>e.render()),this.invalidateLayoutTree()}_removeMenus(){this.menus.forEach(e=>e.remove()),this.invalidateLayoutTree()}setCompact(e){this.setProperty("compact",e)}_renderCompact(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}}function va(i,e,t){return e=vC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vC(i){var e=wC(i,"string");return typeof e=="symbol"?e:String(e)}function wC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class jh extends te{constructor(e){super(),va(this,"menuBox",void 0),va(this,"firstMenu",void 0),va(this,"lastMenu",void 0),va(this,"_ellipsis",void 0),this.menuBox=e,this.firstMenu=null,this.lastMenu=null}layout(e){let t=this.menuBox.htmlComp,r=t.size(),s=this.visibleMenus(),o=0;this.menuBox.session.layoutValidator.schedulePostValidateFunction(()=>{s.forEach(n=>{n.popup&&n.popup.position()})}),this.updateFirstAndLastMenuMarker(s),this.undoCollapse(s),this.undoCompact(s),this.undoShrink(s),o=this.actualPrefSize(s).width,!(o<=r.width)&&(this.compact(s),o=this.actualPrefSize(s).width,!(o<=r.width)&&(this.shrink(s),o=this.actualPrefSize(s).width,!(o<=r.width)&&this.collapse(r,o)))}preferredLayoutSize(e,t){let r=this.visibleMenus();return this.updateFirstAndLastMenuMarker(r),this.undoCollapse(r),this.undoCompact(r),this.undoShrink(r),this.actualPrefSize()}compact(e){this.menuBox.compactOrig===void 0&&(this.menuBox.compactOrig=this.menuBox.compact,this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(!0),this.menuBox.htmlComp.suppressInvalidate=!1),this.compactMenus(e)}undoCompact(e){this.menuBox.compactOrig!==void 0&&(this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(this.menuBox.compactOrig),this.menuBox.htmlComp.suppressInvalidate=!1,this.menuBox.compactOrig=void 0),this.undoCompactMenus(e)}compactMenus(e){e=e||this.visibleMenus(),e.forEach(t=>{t.compactOrig===void 0&&(t.compactOrig=t.compact,t.htmlComp.suppressInvalidate=!0,t.setCompact(!0),t.htmlComp.suppressInvalidate=!1)}),this._ellipsis&&this._ellipsis.setCompact(!0)}undoCompactMenus(e){e=e||this.visibleMenus(),e.forEach(t=>{t.compactOrig!==void 0&&(t.htmlComp.suppressInvalidate=!0,t.setCompact(t.compactOrig),t.htmlComp.suppressInvalidate=!1,t.compactOrig=void 0)}),this._ellipsis&&this._ellipsis.setCompact(!1)}shrink(e){this.shrinkMenus(e)}shrinkMenus(e){e=e||this.visibleMenus(),e.forEach(t=>{t.textVisibleOrig===void 0&&t.iconId&&(t.textVisibleOrig=t.textVisible,t.htmlComp.suppressInvalidate=!0,t.setTextVisible(!1),t.htmlComp.suppressInvalidate=!1)})}undoShrink(e){this.undoShrinkMenus(e)}undoShrinkMenus(e){e=e||this.visibleMenus(),e.forEach(t=>{t.textVisibleOrig!==void 0&&(t.htmlComp.suppressInvalidate=!0,t.setTextVisible(t.textVisibleOrig),t.htmlComp.suppressInvalidate=!1,t.textVisibleOrig=void 0)})}collapse(e,t){this._createAndRenderEllipsis(this.menuBox.$container);let r=this._moveOverflowMenusIntoEllipsis(e,t);this.updateFirstAndLastMenuMarker(r)}undoCollapse(e){e=e||this.visibleMenus(),this._destroyEllipsis(),this._removeMenusFromEllipsis(e)}_createAndRenderEllipsis(e){let t=Ke.createEllipsisMenu({parent:this.menuBox,hidden:!1,compact:this.menuBox.compact});t.uiCssClass=this.menuBox.uiMenuCssClass,t.render(e),this._ellipsis=t}_destroyEllipsis(){this._ellipsis&&(this._ellipsis.destroy(),this._ellipsis=null)}_moveOverflowMenusIntoEllipsis(e,t){let r=[this._ellipsis],s=w.size(this._ellipsis.$container,!0);return t+=s.width,this.visibleMenus().slice().reverse().forEach(o=>{if(t>e.width){let n=w.size(o.$container,!0);t-=n.width,Ke.moveMenuIntoEllipsis(o,this._ellipsis)}else r.unshift(o)}),r}_removeMenusFromEllipsis(e){e=e||this.visibleMenus(),e.forEach(t=>Ke.removeMenuFromEllipsis(t,this.menuBox.$container))}actualPrefSize(e){e=e||this.visibleMenus();let t=this._menusWidth(e),r=w.prefSize(this.menuBox.$container);return r.width=t+this.menuBox.htmlComp.insets().horizontal(),r}_menusWidth(e){let t=0,r=s=>w.size(s.htmlComp.$comp,{includeMargin:!0,exact:!0});return e=e||this.visibleMenus(),e.forEach(s=>{s.rendered&&(t+=r(s).width)}),this._ellipsis&&(t+=r(this._ellipsis).width),t}compactPrefSize(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.undoShrink(e),this.compact(e),this.actualPrefSize()}shrinkPrefSize(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.compact(e),this.shrink(e),this.actualPrefSize()}visibleMenus(){return this.menuBox.menus.filter(e=>e.visible)}updateFirstAndLastMenuMarker(e){let t=null,r=null;(e||[]).forEach(s=>{s.rendered&&(t||(t=s),r=s)}),(t!==this.firstMenu||r!==this.lastMenu)&&(this.firstMenu&&this.firstMenu.rendered&&this.firstMenu.$container.removeClass("first"),this.lastMenu&&this.lastMenu.rendered&&this.lastMenu.$container.removeClass("last"),this.firstMenu=t,this.lastMenu=r,this.firstMenu&&this.firstMenu.$container.addClass("first"),this.lastMenu&&this.lastMenu.$container.addClass("last"))}}function Bt(i,e,t){return e=TC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function TC(i){var e=SC(i,"string");return typeof e=="symbol"?e:String(e)}function SC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ce extends I{constructor(){super(),Bt(this,"menuSorter",void 0),Bt(this,"menuFilter",void 0),Bt(this,"position",void 0),Bt(this,"tabbable",void 0),Bt(this,"menuboxLeft",void 0),Bt(this,"menuboxRight",void 0),Bt(this,"menuItems",void 0),Bt(this,"orderedMenuItems",void 0),Bt(this,"defaultMenu",void 0),Bt(this,"ellipsisPosition",void 0),Bt(this,"hiddenByUi",void 0),Bt(this,"tabbableMenu",void 0),Bt(this,"_menuItemPropertyChangeHandler",void 0),Bt(this,"_focusHandler",void 0),Bt(this,"_ellipsis",void 0),this.menuSorter=null,this.menuFilter=null,this.position=ce.Position.TOP,this.tabbable=!0,this.menuboxLeft=null,this.menuboxRight=null,this.menuItems=[],this.orderedMenuItems={left:[],right:[],all:[]},this.defaultMenu=null,this.visible=!1,this.ellipsisPosition=ce.EllipsisPosition.RIGHT,this._menuItemPropertyChangeHandler=this._onMenuItemPropertyChange.bind(this),this._focusHandler=this._onMenuItemFocus.bind(this),this.hiddenByUi=!1,this._addWidgetProperties("menuItems")}_init(e){super._init(e),this.menuSorter=e.menuOrder||new rs,this.menuSorter.menuBar=this,e.menuFilter&&(this.menuFilter=(t,r)=>e.menuFilter(t,kt.MENU_BAR)),this.menuboxLeft=u.create(wa,{parent:this,cssClass:"left",tooltipPosition:this._oppositePosition()}),this.menuboxRight=u.create(wa,{parent:this,cssClass:"right",tooltipPosition:this._oppositePosition()}),this._setMenuItems(f.ensure(this.menuItems)),this.updateVisibility()}_destroy(){super._destroy(),this._detachMenuHandlers()}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new Jh(this),new Qh(this)])}_render(){this.$container=this.$parent.appendDiv("menubar"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Zr(this)),this.menuboxRight.render(this.$container),this.menuboxLeft.render(this.$container)}_renderProperties(){super._renderProperties(),this._renderMenuItems(),this._renderPosition()}setPosition(e){this.setProperty("position",e)}_setPosition(e){this._setProperty("position",e),this.menuboxLeft.setTooltipPosition(this._oppositePosition()),this.menuboxRight.setTooltipPosition(this._oppositePosition())}_renderPosition(){this.$container.toggleClass("bottom",this.position===ce.Position.BOTTOM)}_oppositePosition(){return this.position===ce.Position.TOP?ce.Position.BOTTOM:ce.Position.TOP}setEllipsisPosition(e){this.setProperty("ellipsisPosition",e)}_setChildMenuFilters(){this.orderedMenuItems.all.forEach(e=>e.setMenuFilter(this.menuFilter))}_attachMenuHandlers(){this.orderedMenuItems.all.forEach(e=>{e.events.count("propertyChange",this._menuItemPropertyChangeHandler)===0&&e.on("propertyChange",this._menuItemPropertyChangeHandler),e.events.count("focus",this._focusHandler)===0&&e.on("focus",this._focusHandler)})}_detachMenuHandlers(){this.orderedMenuItems.all.forEach(e=>{e.off("propertyChange",this._menuItemPropertyChangeHandler),e.off("focus",this._focusHandler)})}setMenuItems(e){let t=f.ensure(e);if(f.equals(this.menuItems,t)){this.menuboxRight.link(this.menuboxRight.menuItems),this.menuboxLeft.link(this.menuboxLeft.menuItems);return}this.setProperty("menuItems",t)}_setMenuItems(e,t){this._detachMenuHandlers(),this.orderedMenuItems=this._createOrderedMenus(e),t?(this.menuboxRight.setMenuItems(this.orderedMenuItems.right),this.menuboxLeft.setMenuItems(this.orderedMenuItems.left)):(this.menuboxLeft.setMenuItems(this.orderedMenuItems.left),this.menuboxRight.setMenuItems(this.orderedMenuItems.right)),this._setChildMenuFilters(),this._attachMenuHandlers(),this.updateVisibility(),this.updateDefaultMenu(),this._setProperty("menuItems",e)}_renderMenuItems(){ke.updateFirstLastMarker(this.menuItems),this.updateLeftOfButtonMarker(),this.invalidateLayoutTree()}_removeMenuItems(){}_createOrderedMenus(e){let t=this.menuSorter.order(e),r=-1,s;if(t.right.forEach(o=>{o.rightAligned=!0}),t.all.length>0){if(this._ellipsis&&(this._ellipsis.setChildActions([]),this._ellipsis.destroy()),s=u.create(tl,{parent:this,cssClass:"overflow-menu-item"}),this._ellipsis=s,this.ellipsisPosition===ce.EllipsisPosition.RIGHT){let o=this._getFirstStackableIndexPosition(t.right.slice().reverse());o>-1?(r=t.right.length-o,s.rightAligned=!0,t.right.splice(r,0,s)):(o=this._getFirstStackableIndexPosition(t.left.slice().reverse()),o>-1&&(r=t.left.length-o,t.left.splice(r,0,s)))}else r=this._getFirstStackableIndexPosition(t.left),r>-1?t.left.splice(r,0,s):(r=this._getFirstStackableIndexPosition(t.right),r>-1&&(s.rightAligned=!0,t.right.splice(r,0,s)));t.all=t.left.concat(t.right)}return t}_getFirstStackableIndexPosition(e){let t=-1;return e.some((r,s)=>r.stackable&&r.visible?(t=s,!0):!1),t}_updateTabbableMenu(){this.tabbable&&(this.defaultMenu&&this.defaultMenu.isTabTarget()?this.setTabbableMenu(this.defaultMenu):this.setTabbableMenu(f.find(this.orderedMenuItems.all,e=>e.isTabTarget())))}setTabbableMenu(e){!this.tabbable||e===this.tabbableMenu||(this.tabbableMenu&&this.tabbableMenu.setTabbable(!1),this.tabbableMenu=e,e&&e.setTabbable(!0))}setHiddenByUi(e){this.setProperty("hiddenByUi",e)}updateVisibility(){Ke.updateSeparatorVisibility(this.orderedMenuItems.left),Ke.updateSeparatorVisibility(this.orderedMenuItems.right),this.setVisible(!this.hiddenByUi&&this.orderedMenuItems.all.some(e=>e.visible&&!e.ellipsis))}updateDefaultMenu(e){let t=null;for(let r=0;r<this.orderedMenuItems.all.length;r++){let s=this.orderedMenuItems.all[r];if(!(!s.visible||!s.enabled||s.defaultMenu===!1)){if(s.defaultMenu){t=s;break}!t&&this._isDefaultKeyStroke(s.actionKeyStroke)&&(t=s)}}this.setDefaultMenu(t),u.nvl(e,!0)&&this._updateTabbableMenu()}_isDefaultKeyStroke(e){return u.isOneOf(_.ENTER,e.which)&&!e.ctrl&&!e.alt&&!e.shift}setDefaultMenu(e){this.setProperty("defaultMenu",e)}_setDefaultMenu(e){this.defaultMenu&&this.defaultMenu.setMenuStyle(le.MenuStyle.NONE),e&&e.setMenuStyle(le.MenuStyle.DEFAULT),this._setProperty("defaultMenu",e)}updateLeftOfButtonMarker(){this._updateLeftOfButtonMarker(this.orderedMenuItems.left),this._updateLeftOfButtonMarker(this.orderedMenuItems.right)}_updateLeftOfButtonMarker(e){let t,r;e=e.filter(s=>s.visible&&s.rendered);for(let s=0;s<e.length;s++)t=e[s],t.$container.removeClass("left-of-button"),s>0&&t.isButton()&&(r=e[s-1],r.$container.addClass("left-of-button"))}_onMenuItemPropertyChange(e){let t=e.source;if((e.propertyName==="overflown"||e.propertyName==="enabledComputed"||e.propertyName==="visible"||e.propertyName==="hidden")&&(!this.tabbableMenu||t===this.tabbableMenu)&&this._updateTabbableMenu(),(e.propertyName==="overflown"||e.propertyName==="hidden")&&(!this.defaultMenu||t===this.defaultMenu)&&this.updateDefaultMenu(),e.propertyName==="horizontalAlignment"&&this.reorderMenus(e.newValue<=0),e.propertyName==="visible"){let r=this.visible;this.updateVisibility(),!r&&this.visible&&this.revalidateLayout(),t.separator||this.reorderMenus()}(e.propertyName==="keyStroke"||e.propertyName==="enabledComputed"||e.propertyName==="defaultMenu"||e.propertyName==="visible")&&this.updateDefaultMenu()}_onMenuItemFocus(e){this.setTabbableMenu(e.source)}reorderMenus(e){let t=this.menuItems;this._setMenuItems(t,e),this.rendered&&this.updateLeftOfButtonMarker()}allMenusAsFlatList(){return f.flatMap(this.orderedMenuItems.all,e=>e instanceof Wh?e.childActions:[e])}}Bt(ce,"EllipsisPosition",{LEFT:"left",RIGHT:"right"}),Bt(ce,"Position",{TOP:"top",BOTTOM:"bottom"});function Xh(i,e,t){return e=CC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CC(i){var e=PC(i,"string");return typeof e=="symbol"?e:String(e)}function PC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zr extends te{constructor(e){super(),Xh(this,"collapsed",void 0),Xh(this,"_menuBar",void 0),Xh(this,"_overflowMenuItems",void 0),this._menuBar=e,this._overflowMenuItems=[],this.collapsed=!1}layout(e){let t=this._menuBar.orderedMenuItems.left.concat(this._menuBar.orderedMenuItems.right),r=this.visibleMenuItems(),s=S.get(e),o=f.find(t,n=>n.ellipsis);this._setFirstLastMenuMarker(r),this.preferredLayoutSize(e,{widthHint:s.availableSize().width,undo:!1}),o&&this._overflowMenuItems.length>0&&o.setHidden(!1),r.forEach(n=>n._setOverflown(!1)),this._overflowMenuItems.forEach(n=>n._setOverflown(!0)),o&&this._overflowMenuItems.length===0&&o.setHidden(!0),this._overflowMenuItems=this._overflowMenuItems.filter(n=>!n.separator),o&&(o._closePopup(),o.setChildActions(this._overflowMenuItems)),r.forEach(n=>n.validateLayout()),r.forEach(n=>{n.popup&&n.popup.position()})}preferredLayoutSize(e,t){if(this._overflowMenuItems=[],!this._menuBar.isVisible())return new A(0,0);let r=this.visibleMenuItems(),s=r.filter(p=>{let m=p.overflown;return p._setOverflown(!1),m}),o=r.filter(p=>{let m=!p.textVisible;return this.undoShrink([p]),m}),n=[...r],l=S.get(e),d=new A(0,0),h=Number.MAX_VALUE;return(t.widthHint===0||t.widthHint)&&(h=t.widthHint-l.insets().horizontal()),h<=0?d=this._minSize(r):(d=this._prefSize(r),d.width>h&&this.shrink(r),d=this._prefSizeWithOverflow(r,h)),u.nvl(t.undo,!0)&&(this.undoOverflow(s),this.undoShrink(n),this.shrink(o)),d.add(l.insets())}_prefSizeWithOverflow(e,t){let r=[];e.forEach((n,l)=>{n.stackable&&r.push(l)});let s=-1;this._setFirstLastMenuMarker(e);let o=this._prefSize(e);for(;o.width>t&&r.length>0;)this._menuBar.ellipsisPosition===ce.EllipsisPosition.RIGHT?s=r.splice(-1)[0]:s=r.splice(0,1)[0]-this._overflowMenuItems.length,this._overflowMenuItems.splice(0,0,e[s]),e.splice(s,1),this._setFirstLastMenuMarker(e),o=this._prefSize(e);return o}_minSize(e){let t=e.filter(r=>!r.stackable);return this.shrink(e),this._setFirstLastMenuMarker(t,!0),this._prefSize(t,!0)}_prefSize(e,t){let r=new A(0,0);return t=u.nvl(t,this._overflowMenuItems.length>0),this._setFirstLastMenuMarker(e,t),e.forEach(s=>{let o=new A(0,0);s.ellipsis?t&&(o=this._menuItemSize(s)):o=this._menuItemSize(s),r.height=Math.max(r.height,o.height),r.width+=o.width}),r}_menuItemSize(e){let t=e.$container.attr("class");e.$container.removeClass("overflown"),e.$container.removeClass("hidden"),e.htmlComp.invalidateLayout();let r=e.htmlComp.prefSize({useCssSize:!0,exact:!0}).add(w.margins(e.$container));return e.$container.attrOrRemove("class",t),r}_setFirstLastMenuMarker(e,t){let r=e;t=u.nvl(t,this._overflowMenuItems.length>0),this._menuBar.orderedMenuItems.all.forEach(s=>s.$container.removeClass("first last")),t||(r=r.filter(s=>!s.ellipsis)),r.length>0&&(r[0].$container.addClass("first"),r[r.length-1].$container.addClass("last"))}undoOverflow(e){e.forEach(t=>t._setOverflown(!0))}shrink(e){e.forEach(t=>{t.textVisibleOrig===void 0&&t.shrinkable&&t.icon&&(t.textVisibleOrig=t.textVisible,t.htmlComp.suppressInvalidate=!0,t.setTextVisible(!1),t.htmlComp.suppressInvalidate=!1)})}undoShrink(e){e.forEach(t=>{t.textVisibleOrig!==void 0&&(t.htmlComp.suppressInvalidate=!0,t.setTextVisible(t.textVisibleOrig),t.htmlComp.suppressInvalidate=!1,t.textVisibleOrig=void 0)})}visibleMenuItems(){return this._menuBar.orderedMenuItems.all.filter(e=>e.visible)}static size(e,t){let r=e.prefSize({widthHint:t.width});return r.width=t.width,r=r.subtract(e.margins()),r}}class Jh extends B{constructor(e){super(),this.field=e,this.which=[_.LEFT],this.renderingHints.render=!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}handle(e){let t=this.field.allMenusAsFlatList(),r=this.field.$container.find(":focus"),s,o,n;for(s=0;s<t.length;s++){if(o=t[s],r[0]===o.$container[0]){n&&(this.field.setTabbableMenu(n),n.focus());break}o.isTabTarget()&&(n=o)}}}class Qh extends B{constructor(e){super(),this.field=e,this.which=[_.RIGHT],this.renderingHints.render=!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}handle(e){let t=this.field.allMenusAsFlatList(),r=this.field.$container.find(":focus"),s,o,n=!1;for(s=0;s<t.length;s++){if(o=t[s],n&&o.isTabTarget()){this.field.setTabbableMenu(o),o.focus();break}r[0]===o.$container[0]&&(n=!0)}}}function xC(i,e,t){return e=FC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FC(i){var e=EC(i,"string");return typeof e=="symbol"?e:String(e)}function EC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zh extends mt{constructor(){super(),xC(this,"menu",void 0),this.menu=null,this.windowPaddingX=0,this.windowPaddingY=0}_init(e){e.anchor=e.menu,e.closeOnAnchorMouseDown=!1,super._init(e)}_render(){super._render(),this.$container.addClass("menu-bar-popup")}_getMenuItems(){return this.menu.childActions}}function Hm(i,e,t){return e=AC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function AC(i){var e=DC(i,"string");return typeof e=="symbol"?e:String(e)}function DC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wa extends I{constructor(){super(),Hm(this,"menuItems",void 0),Hm(this,"tooltipPosition",void 0),this.menuItems=[],this.tooltipPosition="top",this._addWidgetProperties("menuItems")}_render(){this.$container=this.$parent.appendDiv("menubar-box"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new eu(this))}_renderProperties(){super._renderProperties(),this._renderMenuItems()}_remove(){this._removeMenuItems(),super._remove()}setMenuItems(e){let t=f.ensure(e);f.equals(this.menuItems,t)||this.setProperty("menuItems",t)}_setMenuItems(e){this._setProperty("menuItems",e),this._updateTooltipPosition()}_removeMenuItems(){this.menuItems.forEach(e=>e.remove())}_renderMenuItems(){this.menuItems.forEach(e=>{e.render(this.$container),e.$container.addClass("menubar-item")}),this.rendering||this.invalidateLayoutTree()}_renderVisible(){super._renderVisible(),this.revalidateLayout()}setTooltipPosition(e){this.setProperty("tooltipPosition",e)}_setTooltipPosition(e){this._setProperty("tooltipPosition",e),this._updateTooltipPosition()}_updateTooltipPosition(){this.menuItems.forEach(e=>e.setTooltipPosition(this.tooltipPosition))}}function MC(i,e,t){return e=$C(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $C(i){var e=RC(i,"string");return typeof e=="symbol"?e:String(e)}function RC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class eu extends te{constructor(e){super(),MC(this,"menubox",void 0),this.menubox=e}layout(e){}preferredLayoutSize(e,t){let r=null;return this.menubox.menuItems.filter(s=>!s.overflown&&s.isVisible()).reduce((s,o)=>(r=o.htmlComp.prefSize({useCssSize:!0,includeMargin:!0}),s.height=Math.max(s.height,r.height),s.width=Math.max(s.width,r.width),s),new A)}}function K(i,e,t){return e=LC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LC(i){var e=IC(i,"string");return typeof e=="symbol"?e:String(e)}function IC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ne extends I{constructor(){super(),K(this,"monthViewNumberOfWeeks",void 0),K(this,"numberOfHourDivisions",void 0),K(this,"widthPerDivision",void 0),K(this,"heightPerDivision",void 0),K(this,"startHour",void 0),K(this,"heightPerHour",void 0),K(this,"heightPerDay",void 0),K(this,"spaceBeforeScrollTop",void 0),K(this,"workDayIndices",void 0),K(this,"displayCondensed",void 0),K(this,"displayMode",void 0),K(this,"components",void 0),K(this,"selectedComponent",void 0),K(this,"loadInProgress",void 0),K(this,"selectedDate",void 0),K(this,"selectorStart",void 0),K(this,"selectorEnd",void 0),K(this,"showDisplayModeSelection",void 0),K(this,"rangeSelectionAllowed",void 0),K(this,"title",void 0),K(this,"useOverflowCells",void 0),K(this,"viewRange",void 0),K(this,"calendarToggleListWidth",void 0),K(this,"calendarToggleYearWidth",void 0),K(this,"menuInjectionTarget",void 0),K(this,"modesMenu",void 0),K(this,"menus",void 0),K(this,"yearPanel",void 0),K(this,"selectedRange",void 0),K(this,"needsScrollToStartHour",void 0),K(this,"$header",void 0),K(this,"$range",void 0),K(this,"$commands",void 0),K(this,"$grids",void 0),K(this,"$grid",void 0),K(this,"$topGrid",void 0),K(this,"$list",void 0),K(this,"$listContainer",void 0),K(this,"$listTitle",void 0),K(this,"$progress",void 0),K(this,"$headerRow1",void 0),K(this,"$headerRow2",void 0),K(this,"$title",void 0),K(this,"$select",void 0),K(this,"$window",void 0),K(this,"_showYearPanel",void 0),K(this,"_showListPanel",void 0),K(this,"_exactRange",void 0),K(this,"_listComponents",void 0),K(this,"_menuInjectionTargetMenusChangedHandler",void 0),K(this,"_moveData",void 0),K(this,"_rangeSelectionStarted",void 0),K(this,"_mouseMoveHandler",void 0),K(this,"_mouseUpHandler",void 0),K(this,"_mouseMoveRangeSelectionHandler",void 0),K(this,"_mouseUpRangeSelectionHandler",void 0),this.monthViewNumberOfWeeks=6,this.numberOfHourDivisions=2,this.heightPerDivision=30,this.startHour=6,this.heightPerHour=this.numberOfHourDivisions*this.heightPerDivision,this.heightPerDay=24*this.heightPerHour,this.spaceBeforeScrollTop=15,this.workDayIndices=[1,2,3,4,5],this.components=[],this.displayCondensed=!1,this.displayMode=Ne.DisplayMode.MONTH,this.loadInProgress=!1,this.selectedDate=new Date,this.showDisplayModeSelection=!0,this.rangeSelectionAllowed=!1,this.title=null,this.useOverflowCells=!0,this.viewRange=null,this.calendarToggleListWidth=270,this.calendarToggleYearWidth=215,this.$container=null,this.$header=null,this.$range=null,this.$commands=null,this.$grids=null,this.$grid=null,this.$topGrid=null,this.$list=null,this.$progress=null,this._showYearPanel=!1,this._showListPanel=!1,this._exactRange=null,this._listComponents=[],this.menuInjectionTarget=null,this._menuInjectionTargetMenusChangedHandler=null,this._moveData=null,this._mouseMoveHandler=this._onMouseMove.bind(this),this._mouseUpHandler=this._onMouseUp.bind(this),this._mouseMoveRangeSelectionHandler=this._onMouseMoveRangeSelection.bind(this),this._mouseUpRangeSelectionHandler=this._onMouseUpRangeSelection.bind(this),this.selectedRange=null,this._addWidgetProperties(["components","menus","selectedComponent"]),this._addPreserveOnPropertyChangeProperties(["selectedComponent"])}init(e){super.init(e)}isDay(){return this.displayMode===Ne.DisplayMode.DAY}isWeek(){return this.displayMode===Ne.DisplayMode.WEEK}isMonth(){return this.displayMode===Ne.DisplayMode.MONTH}isWorkWeek(){return this.displayMode===Ne.DisplayMode.WORK_WEEK}_createKeyStrokeContext(){return new Oe}_init(e){super._init(e),this.yearPanel=u.create(Sa,{parent:this}),this.yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this.modesMenu=u.create(ru,{parent:this,visible:!1,displayMode:this.displayMode}),this._setSelectedDate(this.selectedDate),this._setDisplayMode(this.displayMode),this._setMenuInjectionTarget(this.menuInjectionTarget),this._exactRange=this._calcExactRange(),this.yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange()}setSelectedDate(e){this.setProperty("selectedDate",e)}_setSelectedDate(e){e=T.ensure(e),this._setProperty("selectedDate",e),this.yearPanel.selectDate(this.selectedDate)}_renderSelectedDate(){this._updateModel(!0,!1)}setDisplayMode(e){if(v.equals(this.displayMode,e))return;let t=this.displayMode;this._setDisplayMode(e),this.rendered&&this._renderDisplayMode(t)}_setDisplayMode(e){if(this._setProperty("displayMode",e),this.yearPanel.setDisplayMode(this.displayMode),this.modesMenu.setDisplayMode(e),this.isWorkWeek()){let t=this._dateParts(this.selectedDate,!0);t.day>4&&this.setSelectedDate(new Date(t.year,t.month,t.date-t.day+4))}this.selectedRange=null,this.trigger("selectedRangeChange")}_renderDisplayMode(e){this.rendering||(this._updateModel(!1,!0),(e===Ne.DisplayMode.MONTH||this.displayMode===Ne.DisplayMode.MONTH)&&(this._renderComponents(),this.needsScrollToStartHour=!0))}_setViewRange(e){e=We.ensure(e),this._setProperty("viewRange",e)}_setRangeSelectionAllowed(e){this.rangeSelectionAllowed=e,this.rangeSelectionAllowed||this._setSelectedRange(null)}_setSelectedRange(e){let t=We.ensure(e);t&&t.from&&t.to?(this.selectorStart=new Date(t.from),this.selectorStart.setHours(0,this._getHours(this.selectorStart)*60),this.selectorEnd=new Date(t.to),this.selectorEnd.setHours(0,this._getHours(this.selectorEnd)*60-30),this._setRangeSelection()):(this.selectorStart=null,this.selectorEnd=null,this._removeRangeSelection()),this._updateSelectedRange()}_setMenus(e){if(this._checkMenuInjectionTarget(this.menuInjectionTarget)){let t=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(e.concat(t))}this._setProperty("menus",e)}_setMenuInjectionTarget(e){if(v.isString(e)&&(e=u.widget(e)),this._checkMenuInjectionTarget(this.menuInjectionTarget)){e.off("propertyChange:menus",this._menuInjectionTargetMenusChangedHandler);let t=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(t)}this._checkMenuInjectionTarget(e)&&(e.setMenus(this.menus.concat(e.menus)),this._menuInjectionTargetMenusChangedHandler=t=>{this.menuInjectionTarget.menus.some(r=>this.menus.includes(r))||this.menuInjectionTarget.setMenus(this.menus.concat(this.menuInjectionTarget.menus))},e.on("propertyChange:menus",this._menuInjectionTargetMenusChangedHandler)),this._setProperty("menuInjectionTarget",e)}_checkMenuInjectionTarget(e){return e instanceof Fe}_removeInjectedMenus(e,t){return e.menus.filter(r=>!t.includes(r))}_render(){this.$container=this.$parent.appendDiv("calendar");let e=new iu(this);this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(e);let t=F.get().type===F.Type.MOBILE;this.$header=this.$container.appendDiv("calendar-header"),this.$header.toggleClass("mobile",t),this.$headerRow1=this.$header.appendDiv("calendar-header-row first"),this.$headerRow2=this.$header.appendDiv("calendar-header-row last"),this.yearPanel.render(),this.$grids=this.$container.appendDiv("calendar-grids"),this.$topGrid=this.$grids.appendDiv("calendar-top-grid"),this.$topGrid.toggleClass("mobile",t),this.$grid=this.$grids.appendDiv("calendar-grid"),this.$grid.toggleClass("mobile",t),this.$listContainer=this.$container.appendDiv("calendar-list-container"),this.$list=this.$listContainer.appendDiv("calendar-list calendar-scrollable-components"),this.$listTitle=this.$list.appendDiv("calendar-list-title"),this.$range=this.$headerRow1.appendDiv("calendar-range"),this.$range.appendDiv("calendar-previous").on("click",this._onPreviousClick.bind(this)),this.$range.appendDiv("calendar-today",this.session.text("ui.CalendarToday")).on("click",this._onTodayClick.bind(this)),this.$range.appendDiv("calendar-next").on("click",this._onNextClick.bind(this)),this.$title=this.$headerRow1.appendDiv("calendar-title"),this.$select=this.$title.appendDiv("calendar-select"),this.$progress=this.$title.appendDiv("busyindicator-label"),this.$commands=this.$headerRow1.appendDiv("calendar-commands"),this.$commands.appendDiv("calendar-mode first",this.session.text("ui.CalendarDay")).attr("data-mode",Ne.DisplayMode.DAY).on("click",this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",Ne.DisplayMode.WORK_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",Ne.DisplayMode.WEEK).on("click",this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode last",this.session.text("ui.CalendarMonth")).attr("data-mode",Ne.DisplayMode.MONTH).on("click",this._onDisplayModeClick.bind(this)),this.modesMenu.render(this.$commands),this.$commands.appendDiv("calendar-toggle-year").on("click",this._onYearClick.bind(this)),this.$commands.appendDiv("calendar-toggle-list").on("click",this._onListClick.bind(this));let r=this.$topGrid.appendDiv("calendar-week-header");r.appendDiv("calendar-week-name");for(let d=0;d<7;d++)r.appendDiv("calendar-day-name").data("day",d);this.$topGrid.appendDiv("calendar-week-task").attr("data-axis-name",this.session.text("ui.CalendarDay"));let s=this.$topGrid.appendDiv("calendar-week-allday-container");s.appendDiv("calendar-week-name");let o=this._onDayContextMenu.bind(this);for(let d=0;d<7;d++)s.appendDiv("calendar-day").addClass("calendar-scrollable-components").data("day",d).on("contextmenu",o);for(let d=1;d<7;d++){let h=this.$grid.appendDiv("calendar-week");for(let p=0;p<8;p++){let m=h.appendDiv();d>0&&p===0?m.addClass("calendar-week-name"):d>0&&p>0&&m.addClass("calendar-day").data("day",p).data("week",d).on("contextmenu",o)}}let n=this._onDayMouseDown.bind(this,!0);this.$grid.find(".calendar-day").on("mousedown",n);let l=this._onDayMouseDown.bind(this,!1);this.$topGrid.find(".calendar-day").on("mousedown",l),this.$window=this.$container.window(),this.$container.on("mousedown touchstart",this._onMouseDown.bind(this)),this._updateScreen(!1,!1)}_renderProperties(){super._renderProperties(),this._renderComponents(),this._renderSelectedComponent(),this._renderLoadInProgress(),this._renderDisplayMode()}_renderComponents(){this.components.sort(this._sortFromTo),this.components.forEach(e=>e.remove()),this.components.forEach(e=>e.render()),this._arrangeComponents(),this._updateListPanel()}_renderSelectedComponent(){this.selectedComponent&&this.selectedComponent.setSelected(!0)}_renderLoadInProgress(){this.$progress.setVisible(this.loadInProgress)}updateScrollPosition(e){this.rendered?this._updateScrollPosition(!0,e):this.session.layoutValidator.schedulePostValidateFunction(this._updateScrollPosition.bind(this,!0,e))}_updateScrollPosition(e,t){if(this.isMonth())this._scrollToSelectedComponent(t);else if(this.selectedComponent)if(this.selectedComponent.fullDay)this._scrollToSelectedComponent(t),e&&this._scrollToInitialTime(t);else{let r=T.parseJsonDate(this.selectedComponent.fromDate),s=this._dayPosition(r.getHours(),r.getMinutes())/100,o=this.heightPerDay*s;x.scrollTop(this.$grid,o-this.spaceBeforeScrollTop,{animate:t})}else e&&this._scrollToInitialTime(t)}_scrollToSelectedComponent(e){this.selectedComponent&&this.selectedComponent._$parts[0]&&this.selectedComponent._$parts[0].parent()&&this.selectedComponent._$parts[0].isVisible()&&x.scrollTo(this.selectedComponent._$parts[0].parent(),this.selectedComponent._$parts[0],{animate:e})}_scrollToInitialTime(e){if(this.needsScrollToStartHour=!1,!this.isMonth())if(this.selectedComponent&&!this.selectedComponent.fullDay){let t=T.parseJsonDate(this.selectedComponent.fromDate),r=this._dayPosition(t.getHours(),t.getMinutes())/100,s=this.heightPerDay*r;x.scrollTop(this.$grid,s-this.spaceBeforeScrollTop,{animate:e})}else{let t=this.heightPerHour*this.startHour;x.scrollTop(this.$grid,t-this.spaceBeforeScrollTop,{animate:e})}}_onPreviousClick(){this._navigateDate(Ne.Direction.BACKWARD)}_onNextClick(){this._navigateDate(Ne.Direction.FORWARD)}_dateParts(e,t){let r={year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()};return t&&(r.day=(e.getDay()+6)%7),r}_navigateDate(e){this.selectedDate=this._calcSelectedDate(e),this._updateModel(!0,!1)}_calcSelectedDate(e){let t=this._dateParts(this.selectedDate),r=e,s=e*7,o=e;if(this.isDay())return new Date(t.year,t.month,t.date+r);if(this.isWeek()||this.isWorkWeek())return new Date(t.year,t.month,t.date+s);if(this.isMonth())return T.shift(this.selectedDate,0,o,0)}_updateModel(e,t){this._exactRange=this._calcExactRange(),this.yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange(),this.trigger("modelChange"),this._updateScreen(e,t)}_calcExactRange(){let e,t,r=this._dateParts(this.selectedDate,!0);if(this.isDay())e=new Date(r.year,r.month,r.date),t=new Date(r.year,r.month,r.date+1);else if(this.isWeek())e=new Date(r.year,r.month,r.date-r.day),t=new Date(r.year,r.month,r.date-r.day+6);else if(this.isMonth())e=new Date(r.year,r.month,1),t=new Date(r.year,r.month+1,0);else if(this.isWorkWeek())e=new Date(r.year,r.month,r.date-r.day),t=new Date(r.year,r.month,r.date-r.day+4);else throw new Error("invalid value for displayMode");return new We(e,t)}_calcViewRange(){let e=r(this._exactRange.from),t=s(e);return new We(e,t);function r(o){let n,l=new Date(o.valueOf());for(n=0;n<42;n++)if(l.setDate(l.getDate()-1),l.getDay()===1&&l.getMonth()!==o.getMonth())return l;throw new Error("failed to calc viewFrom date")}function s(o){let n,l=new Date(o.valueOf());for(n=0;n<42;n++)l.setDate(l.getDate()+1);return l}}_onTodayClick(e){this.selectedDate=new Date,this._updateModel(!0,!1)}_onDisplayModeClick(e){let t=a()(e.target).data("mode");this.setDisplayMode(t)}_onYearClick(e){this._showYearPanel=!this._showYearPanel,this._updateScreen(!0,!0)}_onListClick(e){this._showListPanel=!this._showListPanel,this._updateScreen(!1,!0)}_onDayMouseDown(e,t){let r=new Date(a()(t.delegateTarget).data("date")),s=!1;if(e&&(this.isDay()||this.isWeek()||this.isWorkWeek())){let o=this._getSelectedSeconds(t);o<60*60*24&&(r.setSeconds(o),s=!0),this._startRangeSelection(t)}this._setSelection(r,null,!1,s)}_getSelectedDate(e){let t=null;return a()(e.target).hasClass("calendar-day")?t=a()(e.target).data("date"):(a()(e.target).hasClass("calendar-component")||a()(e.target).parents(".calendar-component").length>0||a()(e.target).hasClass("calendar-range-selector"))&&(t=a()(e.target).closest(".calendar-day").data("date")),t?new Date(t):null}_getSelectedSeconds(e){let t=e.originalEvent.layerY;return a()(e.target).hasClass("calendar-component")||a()(e.target).parents(".calendar-component").length>0?t+=a()(e.target).closest(".calendar-component").position().top:a()(e.target).hasClass("calendar-range-selector")&&(t+=a()(e.target).position().top),Math.floor(t/this.heightPerDivision)/this.numberOfHourDivisions*60*60}_getSelectedDateTime(e){let t=this._getSelectedDate(e);if(t&&(this.isDay()||this.isWeek()||this.isWorkWeek())){let r=this._getSelectedSeconds(e);r<60*60*24&&t.setSeconds(r)}return t}_setSelection(e,t,r,s){let o=!1,n=T.compareDays(this.selectedDate,e)!==0;(n||s)&&(o=!0,n&&a()(".calendar-day",this.$container).each((l,d)=>{let h=a()(d),p=h.data("date");!p||T.compareDays(p,this.selectedDate)===0?h.select(!1):T.compareDays(p,e)===0&&h.select(!0)}),this.selectedDate=e),this.selectedComponent!==t&&(o=!0,this.selectedComponent&&this.selectedComponent.setSelected(!1),t&&t.setSelected(!0),this.selectedComponent=t),o&&(this.trigger("selectionChange"),n&&this._updateListPanel(),r&&this._updateScrollPosition(!1,!0)),this._showYearPanel&&this.yearPanel.selectDate(this.selectedDate)}_updateScreen(e,t){a().log.isInfoEnabled()&&a().log.info("(Calendar#_updateScreen)"),a()(".calendar-mode",this.$commands).select(!1),a()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0),a()(".selected",this.$grid).select(!1),this.layoutLabel(),this.layoutSize(t),this.layoutAxis(),this._showYearPanel&&this.yearPanel.selectDate(this.selectedDate),this._updateListPanel(),this._updateScrollbars(this.$grid,t),e&&!this.isMonth()&&this._updateTopGrid(),this._setSelectedRange(this.selectedRange)}layoutSize(e){a()("div",this.$container).removeData(["new-width","new-height"]),this.isMonth()?(this.$topGrid.addClass("calendar-top-grid-short"),this.$grid.removeClass("calendar-grid-short")):(this.$topGrid.removeClass("calendar-top-grid-short"),this.$grid.addClass("calendar-grid-short"));let t=a()(".selected",this.$grid),r=a()(".selected",this.$topGrid),s=this.$container.width(),o=this.$grid.height(),n=this.$grid.innerWidth()-this.$grid.width(),l=s-n;a()(".calendar-toggle-year",this.$commands).select(this._showYearPanel),this._showYearPanel?(this.yearPanel.$container.data("new-width",this.calendarToggleYearWidth),l-=this.calendarToggleYearWidth,s-=this.calendarToggleYearWidth):this.yearPanel.$container.data("new-width",0),a()(".calendar-toggle-list",this.$commands).select(this._showListPanel),this._showListPanel?(this.$list.parent().data("new-width",this.calendarToggleListWidth),l-=this.calendarToggleListWidth,s-=this.calendarToggleListWidth):this.$list.parent().data("new-width",0),this.$grids.data("new-width",s);let d=a()(),h=a()(".calendar-week",this.$grid);if(this.isDay()||this.isWeek()||this.isWorkWeek()){h.removeClass("calendar-week-noborder");let m=t.parent();d=h.not(m),d.data("new-height",0),d.removeClass("invisible"),m.data("new-height",this.heightPerDay),m.addClass("calendar-week-noborder"),m.removeClass("hidden invisible"),a()(".calendar-day",m).data("new-height",this.heightPerDay),a()(".calendar-week-name",this.$grid).addClass("invisible"),a()(".calendar-week-allday-container",this.$topGrid).removeClass("hidden"),a()(".calendar-week-task",this.$topGrid).removeClass("hidden")}else{let m=o/this.monthViewNumberOfWeeks;h.removeClass("calendar-week-noborder invisible hidden"),h.eq(0).addClass("calendar-week-noborder"),h.data("new-height",m),a()(".calendar-day",this.$grid).data("new-height",m);let g=a()(".calendar-week-name",this.$grid);g.removeClass("hidden invisible"),g.data("new-height",m),a()(".calendar-week-allday-container",this.$topGrid).addClass("hidden"),a()(".calendar-week-task",this.$topGrid).addClass("hidden")}let p=l-45;if(this.isDay())a()(".calendar-day-name, .calendar-day",this.$topGrid).data("new-width",0),a()(".calendar-day",this.$grid).data("new-width",0),a()(".calendar-day-name:nth-child("+(r.index()+1)+")",this.$topGrid).data("new-width",p),a()(".calendar-day:nth-child("+(r.index()+1)+")",this.$topGrid).data("new-width",p),a()(".calendar-day:nth-child("+(t.index()+1)+")",this.$grid).data("new-width",p),this.widthPerDivision=p;else if(this.isWorkWeek()){this.$topGrid.find(".calendar-day-name").data("new-width",0),this.$grids.find(".calendar-day").data("new-width",0);let m=Math.round(p/this.workDayIndices.length);this.$topGrid.find(".calendar-day-name").slice(0,5).data("new-width",m),this.$topGrid.find(".calendar-day").slice(0,5).data("new-width",m),a()(".calendar-day:nth-child(-n+6)",this.$grid).data("new-width",m),this.widthPerDivision=m}else if(this.isMonth()||this.isWeek()){let m=Math.round(p/7);this.$grids.find(".calendar-day").data("new-width",m),this.$topGrid.find(".calendar-day-name").data("new-width",m),this.widthPerDivision=m}this.isMonth()&&a()(".component-month",this.$grid).each(function(){let m=a()(this),g=m.closest(".calendar-day");m.toggleClass("compact",g.data("new-width")<Mn.MONTH_COMPACT_THRESHOLD)}),a()("div",this.$container).each((m,g)=>{let b=a()(g),C=b.data("new-width"),P=b.data("new-height");if(b.stop(!1,!0),C!==void 0&&C!==b.outerWidth())if(e){let R={complete:()=>this._afterLayout(b,e)};b[0]===this.$grids[0]&&(R.progress=()=>this._afterLayout(b,e)),b.animate({width:C},R)}else b.css("width",C),this._afterLayout(b,e);P!==void 0&&P!==b.outerHeight()&&(P>0&&b.removeClass("hidden"),e?b.animateAVCSD("height",P,()=>{P===0&&b.addClass("hidden"),this._afterLayout(b,e)}):(b.css("height",P),P===0&&b.addClass("hidden"),this._afterLayout(b,e)))})}_afterLayout(e,t){this._updateScrollbars(e,t),this._updateWeekdayNames()}_updateWeekdayNames(){let e=this.$topGrid.width(),t;this.isDay()?e/=1:this.isWorkWeek()?e/=this.workDayIndices.length:(this.isWeek()||this.isMonth())&&(e/=7),e>90?t=this.session.locale.dateFormat.symbols.weekdaysOrdered:t=this.session.locale.dateFormat.symbols.weekdaysShortOrdered,a()(".calendar-day-name",this.$topGrid).each(function(r){a()(this).attr("data-day-name",t[r])})}_updateScrollbars(e,t){a()(".calendar-scrollable-components",e).each((s,o)=>{x.update(a()(o),!0)}),this.updateScrollPosition(t)}_uninstallComponentScrollbars(e){e.find(".calendar-scrollable-components").each((t,r)=>{x.uninstall(a()(r),this.session)})}_updateTopGrid(){a()(".calendar-component",this.$topGrid).each((t,r)=>{let s=a()(r).data("component");s&&s.remove()});let e=this.components.filter(t=>t.fullDay);e.forEach(t=>t.remove()),e.forEach(t=>t.render()),this._updateScrollbars(this.$topGrid,!1)}layoutYearPanel(){this._showYearPanel&&(x.update(this.yearPanel.$yearList),this.yearPanel._scrollYear())}layoutLabel(){let e,t,r,s=this._exactRange.from,o=this._exactRange.to;if(this.isDay())e=this._format(s,"d. MMMM yyyy");else if(this.isWorkWeek()||this.isWeek()){let m=this.session.text("ui.to");s.getMonth()===o.getMonth()?e=y.join(" ",this._format(s,"d."),m,this._format(o,"d. MMMM yyyy")):s.getFullYear()===o.getFullYear()?e=y.join(" ",this._format(s,"d. MMMM"),m,this._format(o,"d. MMMM yyyy")):e=y.join(" ",this._format(s,"d. MMMM yyyy"),m,this._format(o,"d. MMMM yyyy"))}else this.isMonth()&&(e=this._format(s,"MMMM yyyy"));this.$select.text(e),t=a()(".calendar-day",this.$grid);let n,l,d,h=this._exactRange.from.getMonth(),p=new Date(this.viewRange.from.valueOf());for(n=0;n<this.monthViewNumberOfWeeks;n++)for(l=0;l<7;l++)d="",this.workDayIndices.indexOf(p.getDay())===-1?d=p.getMonth()!==h?" weekend-out":" weekend":d=p.getMonth()!==h?" out":"",T.isSameDay(p,new Date)&&(d+=" now"),T.isSameDay(p,this.selectedDate)&&(d+=" selected"),this.isMonth()||(d+=" calendar-no-label"),p.getDate()>9&&p.getDate()<20&&(d+=" center-nice"),e=this._format(p,"dd"),t.eq(n*7+l).removeClass("weekend-out weekend out selected now calendar-no-label").addClass(d).attr("data-day-name",e).data("date",new Date(p.valueOf())),p.setDate(p.getDate()+1);if(!this.isMonth()){r=a()(".calendar-day",this.$topGrid);let m=new Date(this._exactRange.from.valueOf());for(p=T.firstDayOfWeek(m,1),l=0;l<7;l++)d="",this.workDayIndices.indexOf(p.getDay())===-1?d=p.getMonth()!==h?" weekend-out":" weekend":d=p.getMonth()!==h?" out":"",T.isSameDay(p,new Date)&&(d+=" now"),T.isSameDay(p,this.selectedDate)&&(d+=" selected"),e=this._format(p,"dd"),r.eq(l).removeClass("weekend-out weekend out selected now").addClass(d).attr("data-day-name",e).data("date",new Date(p.valueOf())),p.setDate(p.getDate()+1)}}layoutAxis(){let e;a()(".calendar-week-axis, .calendar-week-task",this.$grid).remove();let t=this.session;if(a()(".calendar-week-name",this.$container).each(function(r){r>0&&(e=a()(this),e.text(t.text("ui.CW",T.weekInYear(e.next().data("date"))+"")))}),!this.isMonth()){let r=a()(".calendar-week",this.$grid);for(let s=0;s<24;s++){let o=("00"+s).slice(-2),n=s*this.heightPerHour;r.appendDiv("calendar-week-axis hour"+(s===0?" first":"")).attr("data-axis-name",o+":00").css("top",n+"px");for(let l=1;l<this.numberOfHourDivisions;l++)n+=this.heightPerDivision,r.appendDiv("calendar-week-axis").attr("data-axis-name","").css("top",n+"px")}}}_onYearPanelDateSelect(e){this.selectedDate=e.date,this._updateModel(!0,!1)}_updateListPanel(){this._showListPanel&&(x.uninstall(this.$list,this.session),this._listComponents.forEach(e=>e.remove()),this._listComponents=[],this._renderListPanel(),x.install(this.$list,{parent:this,session:this.session,axis:"y"}))}_remove(){this._uninstallComponentScrollbars(this.$grid),this._uninstallComponentScrollbars(this.$topGrid),this.$window.off("mousemove touchmove",this._mouseMoveHandler).off("mouseup touchend touchcancel",this._mouseUpHandler),this._moveData=null,super._remove()}_renderListPanel(){let e,t=[];this.$listTitle.text(this._format(this.selectedDate,"d. MMMM yyyy")),this.components.forEach(s=>{r.call(this,s)&&t.push(s)});function r(s){let o=T.trunc(this.selectedDate);return T.compare(o,s.coveredDaysRange.from)>=0&&T.compare(o,s.coveredDaysRange.to)<=0}t.forEach(s=>{e=new tu(this.selectedDate,s),e.render(this.$list),this._listComponents.push(e)})}_selectedComponentChanged(e,t,r){this._setSelection(t,e,r,!1)}_onDayContextMenu(e){this._showContextMenu(e,Ne.MenuTypes.EmptySpace)}_showContextMenu(e,t){e.preventDefault(),e.stopPropagation();let r=function(o,n){if(!this.rendered||!this.attached)return;let l=Ke.filter(this.menus,[n],{onlyVisible:!0}),d=a()(o.currentTarget);if(l.length===0)return;u.create(mt,{parent:this,menuItems:l,location:{x:o.pageX,y:o.pageY},$anchor:d}).open()}.bind(this);this.session.onRequestsDone(r,e,t)}_arrangeComponents(){let e,t,r,s,o,n,l,d,h=a()(".calendar-day",this.$grid);for(e=0;e<h.length;e++){if(r=h.eq(e),o=r.children(".calendar-component:not(.component-task)"),s=r.children(".calendar-component"),d=r.data("date"),n=r.children(".calendar-scrollable-components"),n.length>0&&(x.uninstall(n,this.session),n.remove()),this.isMonth()&&s.length>0){for(n=r.appendDiv("calendar-scrollable-components"),t=0;t<s.length;t++){let p=s.eq(t);!this.isMonth()&&!p.hasClass("component-task")||n.append(p)}x.install(n,{parent:this,session:this.session,axis:"y"})}this.isMonth()&&o.length>2?r.addClass("many-items"):!this.isMonth()&&o.length>1&&(l=this._getComponents(o),this._arrange(l,d),this._arrangeComponentSetPlacement(o,d))}this.isMonth()?(this._uninstallScrollbars(),this._uninstallComponentScrollbars(this.$topGrid),this.$grid.removeClass("calendar-scrollable-components")):(this.$grid.addClass("calendar-scrollable-components"),this._installScrollbars({parent:this,session:this.session,axis:"y"}),this.$topGrid.find(".calendar-scrollable-components").each((p,m)=>{let g=a()(m);if(g.data("scrollable")){x.update(g);return}x.install(g,{parent:this,session:this.session,axis:"y",scrollShadow:"none"})}))}_getComponents(e){let t,r,s=[];for(t=0;t<e.length;t++)r=e.eq(t),s.push(r.data("component"));return s}_sort(e){e.sort(this._sortFromTo)}_arrange(e,t){let r=[],s=t+"";this._sort(e);for(let o=0;o<e.length;o++){let n=e[o];n.stack||(n.stack={}),n.stack[s]={}}for(let o=0;o<e.length;o++){let n=e[o],l=n.getPartDayPosition(t);r.length>0&&this._allEndBefore(r,l.from,t)&&(r=[]);let d=this._findReplacableColumn(r,l.from,t);d>=0?(r[d]=n,n.stack[s].x=d):(r.push(n),n.stack[s].x=r.length-1);for(let h=0;h<r.length;h++)r[h].stack[s].w=r.length}}_allEndBefore(e,t,r){let s;for(s=0;s<e.length;s++)if(!this._endsBefore(e[s],t,r))return!1;return!0}_findReplacableColumn(e,t,r){let s;for(s=0;s<e.length;s++)if(this._endsBefore(e[s],t,r))return s;return-1}_endsBefore(e,t,r){return e.getPartDayPosition(r).to<=t}_arrangeComponentSetPlacement(e,t){let r,s,o;for(r=0;r<e.length;r++)s=e.eq(r),o=s.data("component").stack[t+""],s.css("width",100/o.w+"%").css("left",o.x*100/o.w+"%")}get$Scrollable(){return this.$grid}_onMouseDown(e){if(this._moveData)return;let t=this._getCalendarComponentForMouseEvent(e);!t||!t.draggable||!this.isMonth()&&t.fullDay||t._$parts.length>1||e.which!==3&&(this.$window.off("mousemove touchmove",this._mouseMoveHandler).off("mouseup touchend touchcancel",this._mouseUpHandler).on("mousemove touchmove",this._mouseMoveHandler).on("mouseup touchend touchcancel",this._mouseUpHandler),this._moveData=this._newMoveData(e),this._onComponentMouseDown(e,t),this._moveData.onMove=this._onComponentMouseMove.bind(this),this._moveData.onUp=this._onComponentMouseUp.bind(this))}_onMouseMove(e){lt.fixTouchEvent(e),this._moveData.event=e,this._moveData.currentCursorPosition=new Z(e.pageX-this._moveData.containerOffset.left+this._moveData.containerScrollPosition.x,e.pageY-this._moveData.containerOffset.top+this._moveData.containerScrollPosition.y),this._scrollViewportWhileDragging(e),this._moveData.onMove&&!this._moveData.cancelled&&this._moveData.onMove(e)}_scrollViewportWhileDragging(e){if(!this._moveData||this._moveData.mode==="pan"||this._moveData.cancelled)return;this._moveData.viewportScroller||(this._moveData.viewportScroller=u.create(Gr,a().extend({viewportWidth:this.$grid.width(),viewportHeight:this.$grid.height(),active:()=>!!this._moveData,scroll:(r,s)=>{let o=this.get$Scrollable().scrollTop()+s;x.scrollTop(this.get$Scrollable(),o),this._moveData.containerScrollPosition=new Z(this.get$Scrollable().scrollLeft(),this.get$Scrollable().scrollTop())}})));let t=this._moveData.currentCursorPosition.subtract(this._moveData.containerScrollPosition);this._moveData.viewportScroller.update(t)}_onMouseUp(e){this.$window.off("mousemove touchmove",this._mouseMoveHandler).off("mouseup touchend touchcancel",this._mouseUpHandler),lt.fixTouchEvent(e),this._moveData.event=e,this._moveData.onUp&&!this._moveData.cancelled&&this._moveData.onUp(e),this._moveData=null}_onComponentMouseDown(e,t){this._moveData.component=t;let r=t._$parts[0];this._moveData.logicalX=r.closest(".calendar-day").data().day,this._moveData.logicalY=Math.round(r.position().top)/this.heightPerDivision,this.isMonth()&&(this._moveData.logicalY=r.closest(".calendar-day").data().week),e.preventDefault()}_onComponentMouseMove(e){this._moveData.rafId||(this._moveData.rafId=requestAnimationFrame(this._whileComponentMove.bind(this)))}_onComponentMouseUp(e){this._endComponentMove()}_whileComponentMove(){this._moveData.rafId=null;let e=new Z(this._moveData.currentCursorPosition.x-this._moveData.startCursorPosition.x,this._moveData.currentCursorPosition.y-this._moveData.startCursorPosition.y);if(!this._moveData.moving){if(Math.abs(e.x)<7&&Math.abs(e.y)<7)return;this._moveData.moving=!0}let t=this.toLogicalPosition(e),r=1,s=this.isMonth()?1:0,o=this.isWorkWeek()?this.workDayIndices.length:7,n=this.isMonth()?this.monthViewNumberOfWeeks:24*this.numberOfHourDivisions-Math.ceil(this._moveData.component.getLengthInHoursDecimal()*this.numberOfHourDivisions);function l(h){let p=h.x,m=h.y;p<r?t.x-=p-r:p>o&&(t.x-=p-o),m<s?t.y-=m-s:m>n&&(t.y-=m-n)}l(new Z(this._moveData.logicalX,this._moveData.logicalY).add(t)),this._moveData.distance=t;let d=new Z(this._moveData.logicalX,this._moveData.logicalY).add(this._moveData.distance);this._setComponentLogicalPosition(this._moveData.component,d)}_endComponentMove(){this._moveData.rafId&&(cancelAnimationFrame(this._moveData.rafId),this._moveData.rafId=null);let e=this._moveData.component;if(this._moveData.distance){let t=!1,r=new Z(this._moveData.logicalX,this._moveData.logicalY).add(this._moveData.distance),s=r.x-this._moveData.logicalX,o=r.y-this._moveData.logicalY;if(t=t||!!s||!!o,t){let n=T.parseJsonDate(e.toDate),l=T.parseJsonDate(e.fromDate),d=s;if(this.isMonth())d+=o*7;else{let h=this._hourMinuteByDivision(o);l=T.shiftTime(l,h.hour,h.minute),n=T.shiftTime(n,h.hour,h.minute)}l=T.shift(l,0,0,d),n=T.shift(n,0,0,d),e.fromDate=this._format(l,"yyyy-MM-dd HH:mm:ss.SSS"),e.toDate=this._format(n,"yyyy-MM-dd HH:mm:ss.SSS"),e.coveredDaysRange=new We(T.trunc(l),T.trunc(n)),this._renderComponents(),this.trigger("componentMove",{component:e})}}}_setComponentLogicalPosition(e,t){let r=e._$parts[0],s=r.closest(".calendar-day").data("day"),o=r.closest(".calendar-day").data("week");if(e.rendered)if(this.isMonth()){if(s!==t.x||o!==t.y){let n=a()(".calendar-week:not(.hidden) > .calendar-day").filter(function(){return a()(this).data("day")===t.x&&a()(this).data("week")===t.y}),l=n.find(".calendar-scrollable-components");n=l.length>0?l:n,r.detach().appendTo(n)}}else{s!==t.x&&r.detach().appendTo(a()(".calendar-week:not(.hidden) > .calendar-day").filter(function(){return a()(this).data("day")===t.x}));let n=this._dayPositionByDivision(t.y)+"%";r.css("top",n)}}_getCalendarComponentForMouseEvent(e){let t=a()(e.target);for(t=a().ensure(t);t&&t.length>0;){let r=t.data("component");if(r)return r;t=t.parent()}return null}_newMoveData(e){let t={};return t.event=e,t.cancel=()=>{t.cancelled=!0},t.unitX=this.widthPerDivision,t.unitY=this.heightPerDivision,this.isMonth()&&(t.unitY=a()(e.target).closest(".calendar-day").height()),t.containerOffset=this.$grid.offset(),t.containerScrollPosition=new Z(this.get$Scrollable().scrollLeft(),this.get$Scrollable().scrollTop()),t.startCursorPosition=new Z(e.pageX-t.containerOffset.left+t.containerScrollPosition.x,e.pageY-t.containerOffset.top+t.containerScrollPosition.y),t.currentCursorPosition=t.startCursorPosition,t}toLogicalPosition(e,t,r){let s;return e instanceof Z?(s=e,r=t):s=new Z(e,t),this.isDay()&&(s.x=0),new Z(Ge.round(s.x/this._moveData.unitX,r),Ge.round(s.y/this._moveData.unitY,r))}_hourMinuteByDivision(e){e/=this.numberOfHourDivisions;let t=Math.floor(e),r=e-t,s=1/60;r=s*Math.round(r/s);let o=Math.floor(r*60);return{hour:t,minute:o}}_dayPositionByDivision(e){let t=this._hourMinuteByDivision(e);return this._dayPosition(t.hour,t.minute)}_dayPosition(e,t){let r;return e<0?r=0:r=100/(24*60)*(e*60+t),Math.round(r*100)/100}_format(e,t){return T.format(e,this.session.locale,t)}_sortFromTo(e,t){let r=T.parseJsonDate(e.fromDate),s=T.parseJsonDate(t.fromDate),o=T.compare(r,s);if(o!==0)return o;let n=T.parseJsonDate(e.toDate),l=T.parseJsonDate(t.toDate),d=T.compare(n,l);if(d!==0)return d;let h=e.item&&e.item.subject?e.item.subject:"",p=t.item&&t.item.subject?t.item.subject:"";return h.localeCompare(p)}_startRangeSelection(e){if(!this.rangeSelectionAllowed||this._rangeSelectionStarted||F.get().type===F.Type.MOBILE)return;let t=this._getSelectedDateTime(e);e.which===3&&this.selectedRange&&t&&T.compare(t,this.selectedRange.from)>=0&&T.compare(t,this.selectedRange.to)<0||!a()(e.target).hasClass("calendar-range-selector")&&!a()(e.target).hasClass("calendar-day")||(this.selectorStart=this._getSelectedDateTime(e),this.selectorStart&&(this.selectorEnd=new Date(this.selectorStart),!(!this.selectorStart||!this.selectorEnd)&&(this.$window.off("mousemove",this._mouseMoveRangeSelectionHandler).off("mouseup",this._mouseUpRangeSelectionHandler).on("mousemove",this._mouseMoveRangeSelectionHandler).on("mouseup",this._mouseUpRangeSelectionHandler),this._setRangeSelection(),this._rangeSelectionStarted=!0)))}_findDayInCalendar(e){let t=null;return a()(".calendar-day",this.$container).each((r,s)=>{let o=a()(s),n=o.data("date");T.compareDays(n,e)===0&&(t=o)}),t}_setRangeSelection(){let e,t;if(!this.selectorStart||!this.selectorEnd)return;this._removeRangeSelection(),T.compare(this.selectorStart,this.selectorEnd)>0?(e=this.selectorEnd,t=this.selectorStart):(e=this.selectorStart,t=this.selectorEnd);let r=T.compareDays(t,e)+1;if(r===1)this._appendCalendarRangeSelection(e,e,t);else if(r>1){this._appendCalendarRangeSelection(e,e,null);for(let s=1;s<r-1;s++){let o=new Date(e);o.setDate(o.getDate()+s),this._appendCalendarRangeSelection(o,null,null)}this._appendCalendarRangeSelection(t,null,t)}}_removeRangeSelection(){a()(".calendar-range-selector").remove()}_appendCalendarRangeSelection(e,t,r){let s=this._findDayInCalendar(e);if(!s)return;let o=t?this._dayPosition(this._getHours(t),0):0,n=r?this._dayPosition(this._getHours(r)+.5,0):100;s.appendDiv("calendar-range-selector").css("top",o+"%").css("height",n-o+"%")}_getHours(e){return Math.round((e.getHours()+e.getMinutes()/60)*2)/2}_onMouseMoveRangeSelection(e){let t=this._getSelectedDateTime(e);t&&(this.selectorEnd=t),this._setRangeSelection()}_onMouseUpRangeSelection(e){this._mouseMoveRangeSelectionHandler&&this.$window.off("mousemove",this._mouseMoveRangeSelectionHandler),this._mouseUpRangeSelectionHandler&&this.$window.off("mouseup",this._mouseUpRangeSelectionHandler),this._rangeSelectionStarted&&(this._rangeSelectionStarted=!1,this.rendered&&(this._setRangeSelection(),this._updateSelectedRange()))}_updateSelectedRange(){let e,t;this.selectorStart&&this.selectorEnd?(T.compare(this.selectorStart,this.selectorEnd)>0?(e=new Date(this.selectorEnd),t=new Date(this.selectorStart)):(e=new Date(this.selectorStart),t=new Date(this.selectorEnd)),e.setHours(0,this._getHours(e)*60),t.setHours(0,this._getHours(t)*60+30),this.selectedRange=new We(e,t)):this.selectedRange=null,this.trigger("selectedRangeChange")}}K(Ne,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4}),K(Ne,"Direction",{BACKWARD:-1,FORWARD:1}),K(Ne,"MenuTypes",{EmptySpace:"Calendar.EmptySpace",CalendarComponent:"Calendar.CalendarComponent"});class Nm extends He{_postCreateWidget(){this._sendViewRangeChange()}_onWidgetEvent(e){e.type==="viewRangeChange"?this._sendViewRangeChange():e.type==="modelChange"?this._sendModelChange():e.type==="selectionChange"?this._sendSelectionChange():e.type==="componentMove"?this._sendComponentMove(e):e.type==="selectedRangeChange"?this._sendSelectedRangeChange():super._onWidgetEvent(e)}_jsonViewRange(){return T.toJsonDateRange(this.widget.viewRange)}_jsonSelectedRange(){return this.widget.selectedRange?T.toJsonDateRange(this.widget.selectedRange):null}_jsonSelectedDate(){return T.toJsonDate(this.widget.selectedDate)}_sendViewRangeChange(){this._send("viewRangeChange",{viewRange:this._jsonViewRange()})}_sendSelectedRangeChange(){this._send("selectedRangeChange",{selectedRange:this._jsonSelectedRange()})}_sendModelChange(){let e={viewRange:this._jsonViewRange(),selectedDate:this._jsonSelectedDate(),displayMode:this.widget.displayMode};this._send("modelChange",e)}_sendSelectionChange(){let e=this.widget.selectedComponent?this.widget.selectedComponent.id:null;this._send("selectionChange",{date:this._jsonSelectedDate(),componentId:e})}_sendComponentMove(e){this._send("componentMove",{componentId:e.component.id,fromDate:e.component.fromDate,toDate:e.component.toDate})}}function $r(i,e,t){return e=kC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kC(i){var e=BC(i,"string");return typeof e=="symbol"?e:String(e)}function BC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Mn extends I{constructor(){super(),$r(this,"fromDate",void 0),$r(this,"toDate",void 0),$r(this,"selected",void 0),$r(this,"fullDay",void 0),$r(this,"draggable",void 0),$r(this,"item",void 0),$r(this,"stack",void 0),$r(this,"coveredDaysRange",void 0),$r(this,"_$parts",void 0),this.selected=!1,this.fullDay=!1,this.item=null,this._$parts=[]}_init(e){super._init(e),this._syncCoveredDaysRange(e.coveredDaysRange)}_syncCoveredDaysRange(e){e&&(this.coveredDaysRange=new We(T.parseJsonDate(e.from),T.parseJsonDate(e.to)))}_remove(){this._$parts.forEach(e=>e.remove()),this._$parts=[],super._remove()}_startLoopDay(){return T.compare(this.coveredDaysRange.from,this.parent.viewRange.from)>0?this.coveredDaysRange.from:this.parent.viewRange.from}_render(){let e,t,r;if(!this.coveredDaysRange)return;let s=this._startLoopDay(),o=T.parseJsonDate(this.toDate),n=T.parseJsonDate(this.fromDate),l=this.coveredDaysRange.to;if(!this.fullDay){let h=T.trunc(o);!T.isSameDay(n,o)&&T.compare(o,h)===0&&(o=T.shiftTime(o,0,0,0,-1),l=T.shift(l,0,0,-1))}o=T.toJsonDate(o);let d=T.shift(l,0,0,1);if(!(T.compare(s,d)>0))for(;!T.isSameDay(s,d)&&(e=s,s=T.shift(s,0,0,1),!(T.compare(e,this.parent.viewRange.to)>0));){if(this.fullDay&&!this.parent.isMonth()?t=this._findDayInGrid(e,this.parent.$topGrid):t=this._findDayInGrid(e,this.parent.$grid),!t)continue;r=t.appendDiv("calendar-component"),r.addClass(this.item.cssClass).data("component",this).data("partDay",e).on("mouseup",this._onMouseUp.bind(this)).on("contextmenu",this._onContextMenu.bind(this)),r.appendDiv("calendar-component-leftcolorborder");let h=r.appendDiv("content");if(this.item.subjectIconId&&h.appendIcon(this.item.subjectIconId),h.appendSpan("subject",this.item.subject),this._$parts.push(r),this.parent.isMonth()){let p=t.data("new-width")||t.width();r.addClass("component-month").toggleClass("compact",p<Mn.MONTH_COMPACT_THRESHOLD)}else if(this.fullDay){let p=a()(".component-task",t).length;this._arrangeTask(30+26*p),r.addClass("component-task")}else{let p=T.parseJsonDate(this.fromDate),m=T.parseJsonDate(o),g=this._getHours(this.fromDate),b=this._getHours(o);r.addClass("component-day"),T.isSameDay(T.trunc(this.coveredDaysRange.from),T.trunc(l))?this._partPosition(r,g,b):T.isSameDay(e,p)?this._partPosition(r,g,25).addClass("component-open-bottom"):T.isSameDay(e,m)?this._partPosition(r,0,b).addClass("component-open-top"):this._partPosition(r,0,25).addClass("component-open-top").addClass("component-open-bottom")}}}_getHours(e){let t=T.parseJsonDate(e);return t.getHours()+t.getMinutes()/60}getLengthInHoursDecimal(){let e=T.parseJsonDate(this.toDate),t=T.parseJsonDate(this.fromDate);return(e.getTime()-t.getTime())/(1e3*60*60)}_findDayInGrid(e,t){return t.find(".calendar-day").filter(function(r,s){return T.isSameDay(a()(this).data("date"),e)}).eq(0)}_isTask(){return!this.parent.isMonth()&&this.fullDay}_arrangeTask(e){this._$parts.forEach(t=>t.css("top",e+"px"))}_isDayPart(){return!this.parent.isMonth()&&!this.fullDay}_getHourRange(e){let t=new O(this._getHours(this.fromDate),this._getHours(this.toDate)),r=new We(T.parseJsonDate(this.fromDate),T.parseJsonDate(this.toDate));return T.isSameDay(e,r.from)&&T.isSameDay(e,r.to)?new O(t.from,t.to):T.isSameDay(e,r.from)?new O(t.from,24):T.isSameDay(e,r.to)?new O(0,t.to):new O(0,24)}getPartDayPosition(e){return this._getDisplayDayPosition(this._getHourRange(e))}_getDisplayDayPosition(e){let t=new O(this.parent._dayPosition(e.from,0),this.parent._dayPosition(e.to,0)),r=Math.round(100*100/24/this.parent.numberOfHourDivisions)/100;return t.size()<r?new O(t.from,t.from+r):t}_partPosition(e,t,r){let s=r===25?23:0;r=Math.min(24,r);let o=new O(t,r),n=this._getDisplayDayPosition(o);return s=Math.round(100*(100/1920*s))/100,e.css("top",n.from+"%").css("height",n.to-n.from-s+"%")}_renderProperties(){super._renderProperties(),this._renderSelected()}_renderSelected(){this._$parts.forEach(e=>e.toggleClass("comp-selected",this.selected))}setSelected(e){this.setProperty("selected",e)}updateSelectedComponent(e,t){this.parent._selectedComponentChanged(this,e.data("partDay"),t)}_onMouseUp(e){if(this.parent._moveData&&this.parent._moveData.moving||this.parent._rangeSelectionStarted)return;let t=a()(e.delegateTarget);if(this.updateSelectedComponent(t,!1),e.button===0){let r=u.create(tn,{parent:this.parent,$anchor:t,closeOnAnchorMouseDown:!0,closeOnMouseDownOutside:!0,closeOnOtherPopupOpen:!0,horizontalAlignment:pe.Alignment.LEFT,verticalAlignment:pe.Alignment.CENTER,trimWidth:!1,trimHeight:!0,horizontalSwitch:!0,verticalSwitch:!1,withArrow:!0,cssClass:"popup",scrollType:"remove",location:{y:e.originalEvent.clientY},content:{objectType:ca,htmlEnabled:!0,scrollable:!0,cssClass:"calendar-component-tooltip-content tooltip-content",value:this.description(!0)}});r.open(),r.$container.find(".app-link").on("click",this._onAppLinkAction.bind(this))}}_onContextMenu(e){this.parent._showContextMenu(e,Ne.MenuTypes.CalendarComponent)}_format(e,t){return T.format(e,this.session.locale,t)}description(e){let t=null,r=a()("<div>"),s=T.parseJsonDate(this.fromDate),o=T.parseJsonDate(this.toDate),n=y.hasText(this.item.description)||this.item.descriptionElements,l=r.appendDiv("calendar-component-header");if(n&&l.addClass("with-description"),y.hasText(this.item.subject)){y.hasText(this.item.subjectLabel)&&l.appendDiv("calendar-component-title-label",this.item.subjectLabel);let d=l.appendDiv("calendar-component-title",this.item.subject);e&&y.hasText(this.item.subjectAppLink)&&d.addClass("app-link").attr("data-ref",this.item.subjectAppLink)}if(this.fullDay||(T.isSameDay(s,o)?t=this.session.text("ui.FromXToY",this._format(s,"HH:mm"),this._format(o,"HH:mm")):t=this.session.text("ui.FromXToY",this._format(s,"EEEE HH:mm "),this._format(o,"EEEE HH:mm"))),y.hasText(t)){let d=l.appendDiv("calendar-component-intro");d.appendIcon(ve.CLOCK),d.appendSpan("",t)}if(n){let d=r.appendDiv("calendar-component-description-container");if(y.hasText(this.item.description)&&d.appendSpan("calendar-component-description").html(y.nl2br(this.item.description)),this.item.descriptionElements){let h=!1;for(let p=0;p<this.item.descriptionElements.length;p++)if(this.item.descriptionElements[p].iconId){h=!0;break}for(let p=0;p<this.item.descriptionElements.length;p++){let m=this.item.descriptionElements[p],g=d.appendDiv("calendar-component-description-element");p===0&&g.addClass("first"),p===this.item.descriptionElements.length-1&&g.addClass("last"),(y.hasText(m.iconId)||h)&&g.appendIcon(m.iconId);let b=g.appendDiv("text").html(y.nl2br(m.text));e&&y.hasText(m.appLink)&&b.addClass(" app-link").attr("data-ref",m.appLink)}}}return r[0].innerHTML}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}}$r(Mn,"MONTH_COMPACT_THRESHOLD",100);class Vm extends He{_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function nl(i,e,t){return e=OC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function OC(i){var e=HC(i,"string");return typeof e=="symbol"?e:String(e)}function HC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tu{constructor(e,t){nl(this,"partDay",void 0),nl(this,"source",void 0),nl(this,"$container",void 0),nl(this,"_selectedListener",void 0),nl(this,"_removeListener",void 0),this.partDay=e,this.source=t,this.$container=null,this._selectedListener=t.on("propertyChange:selected",r=>{this.$container.toggleClass("comp-selected",r.newValue)}),this._removeListener=t.on("remove",this.remove.bind(this))}render(e){let t=this.source;this.$container=e.appendDiv("calendar-component").data("partDay",this.partDay).addClass(t.item.cssClass).toggleClass("comp-selected",t.selected).on("mousedown",this._onMouseDown.bind(this,t)).on("contextmenu",t._onContextMenu.bind(t)),this.$container.appendDiv("calendar-component-leftcolorborder"),this.$container.appendDiv("content").html(t.description(!1))}_onMouseDown(e,t){t.preventDefault();let r=$(t.delegateTarget);e.updateSelectedComponent(r,!0)}remove(){this.source.removeListener(this._selectedListener),this.source.removeListener(this._removeListener),this.$container.remove()}}function Ta(i,e,t){return e=NC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NC(i){var e=VC(i,"string");return typeof e=="symbol"?e:String(e)}function VC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class iu extends te{constructor(e){super(),Ta(this,"calendar",void 0),Ta(this,"stacked",void 0),Ta(this,"compacted",void 0),Ta(this,"compactWidth",void 0),this.calendar=e,this.stacked=!1,this.compacted=!1,this.compactWidth=550}layout(e){let t=0,r=0,s=this.calendar.yearPanel.$container,o=this.calendar.$grids,n=this.calendar.$listContainer,l=this.calendar.$header;t+=e.cssMarginTop()+e.cssMarginBottom(),e.css("height","calc(100% - "+t+"px)"),this.undoCompact(),this.undoStack(),l[0].scrollWidth>e.width()&&this.stack(),(e.width()<this.compactWidth||l[0].scrollWidth>e.width())&&this.compact(),r=l.outerHeight(!0),s.css("height","calc(100% - "+(r+s.cssMarginY())+"px)"),o.css("height","calc(100% - "+(r+o.cssMarginY())+"px)"),n.css("height","calc(100% - "+(r+n.cssMarginY())+"px)"),this.calendar.layoutSize(),this.calendar.layoutYearPanel()}compact(){if(this.compacted)return;let e=this.calendar.$headerRow2;this.calendar.$title.appendTo(this.calendar.$headerRow2),e.show(),this.compacted=!0}undoCompact(){if(!this.compacted)return;let e=this.calendar.$headerRow2;this.calendar.$title.insertBefore(this.calendar.$commands),e.hide(),this.compacted=!1}stack(){this.stacked||(this.calendar.$commands.children(".calendar-mode").hide(),this.calendar.modesMenu.setVisible(!0),this.stacked=!0)}undoStack(){!this.stacked||(this.calendar.$commands.children(".calendar-mode").show(),this.calendar.modesMenu.setVisible(!1),this.stacked=!1)}}function WC(i,e,t){return e=KC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function KC(i){var e=zC(i,"string");return typeof e=="symbol"?e:String(e)}function zC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class on extends le{constructor(){super(...arguments),WC(this,"displayMode",void 0)}doAction(){return this.prepareDoAction()?(this.setSelected(!0),this.parentMenu.setSelected(!1),!0):!1}}function Wm(i,e,t){return e=GC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function GC(i){var e=UC(i,"string");return typeof e=="symbol"?e:String(e)}function UC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ru extends le{constructor(){super(),Wm(this,"calendar",void 0),Wm(this,"displayMode",void 0),this.cssClass="calendar-mode-menu"}_init(e){super._init(e),this.calendar=this.parent;let t=[];t.push(u.create(on,{parent:this,displayMode:Ne.DisplayMode.DAY,text:this.session.text("ui.CalendarDay")})),t.push(u.create(on,{parent:this,displayMode:Ne.DisplayMode.WORK_WEEK,text:this.session.text("ui.CalendarWorkWeek")})),t.push(u.create(on,{parent:this,displayMode:Ne.DisplayMode.WEEK,text:this.session.text("ui.CalendarWeek")})),t.push(u.create(on,{parent:this,displayMode:Ne.DisplayMode.MONTH,text:this.session.text("ui.CalendarMonth")})),this.insertChildActions(t),this.childActions.forEach(r=>r.on("propertyChange",this._onMenuPropertyChange.bind(this))),this._setDisplayMode(this.displayMode)}setDisplayMode(e){this.setProperty("displayMode",e)}_setDisplayMode(e){this._setProperty("displayMode",e);let t=this.getMenuForMode(this.displayMode);t.setSelected(!0),this.setText(t.text)}getMenuForMode(e){return f.find(this.childActions,t=>t.displayMode===e)}_onMenuPropertyChange(e){if(e.propertyName==="selected"){let t=e;if(t.newValue){let s=t.source,o=s.displayMode;this.setDisplayMode(o),this.calendar.setDisplayMode(o),this.childActions.forEach(n=>{n!==s&&n.setSelected(!1)})}}}}function Km(i,e,t){return e=qC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qC(i){var e=YC(i,"string");return typeof e=="symbol"?e:String(e)}function YC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class We{constructor(e,t){Km(this,"from",void 0),Km(this,"to",void 0),this.from=e,this.to=t}equals(e){return e?T.equals(this.from,e.from)&&T.equals(this.to,e.to):!1}toString(){return"scout.DateRange[from="+(this.from===null?"null":this.from.toUTCString())+" to="+(this.to===null?"null":this.to.toUTCString())+"]"}static ensure(e){return!e||e instanceof We?e:new We(T.ensure(e.from),T.ensure(e.to))}}function to(i,e,t){return e=jC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jC(i){var e=XC(i,"string");return typeof e=="symbol"?e:String(e)}function XC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Sa extends I{constructor(){super(...arguments),to(this,"$yearTitle",void 0),to(this,"$yearList",void 0),to(this,"selectedDate",void 0),to(this,"displayMode",void 0),to(this,"alwaysSelectFirstDay",void 0),to(this,"yearRendered",void 0),to(this,"viewRange",void 0)}_init(e){super._init(e),this.alwaysSelectFirstDay=e.alwaysSelectFirstDay}_render(){this.$container=this.$parent.appendDiv("year-panel-container"),this.$yearTitle=this.$container.appendDiv("year-panel-title"),this.$yearList=this.$container.appendDiv("year-panel-list")}renderContent(){this.removeContent(),this._drawYear(),this._installScrollbars({axis:"y"}),this.yearRendered=!0,this._colorYear()}get$Scrollable(){return this.$yearList}removeContent(){this._uninstallScrollbars(),this.$yearList.empty(),this.yearRendered=!1}_remove(){this.removeContent(),super._remove()}_drawYear(){let e,t,r,s,o,n=this.selectedDate.getFullYear();for(this.$yearTitle.data("year",n).empty(),this.$yearTitle.appendDiv("year-title-item",n-1+"").data("year-diff",-1).on("click",this._onYearClick.bind(this)),this.$yearTitle.appendDiv("year-title-item selected",n+""),this.$yearTitle.appendDiv("year-title-item",n+1+"").data("year-diff",1).on("click",this._onYearClick.bind(this)),t=0;t<12;t++){e=new Date(n,t,1),r=this.$yearList.appendDiv("year-month").attr("data-title",this._format(e,"MMMM"));for(let l=1;l<=31&&(s=new Date(n,t,l),s.getMonth()===t);l++)o=r.appendDiv("year-day",l+"").data("date",s),(s.getDay()===0||s.getDay()===6)&&o.addClass("weekend"),l===1&&o.css("margin-left",(s.getDay()+6)%7*o.outerWidth())}a()(".year-day",this.$yearList).on("click",this._onYearDayClick.bind(this)).on("mouseenter",this._onYearHoverIn.bind(this)).on("mouseleave",this._onYearHoverOut.bind(this)),x.update(this.$yearList)}_colorYear(){if(!this.yearRendered)return;a()(".year-day.year-range, .year-day.year-range-day",this.$yearList).removeClass("year-range year-range-day");let e=this,t,r;a()(".year-day",this.$yearList).each(function(){t=a()(this),r=t.data("date"),e.displayMode!==Ne.DisplayMode.DAY&&r>=e.viewRange.from&&r<e.viewRange.to&&t.addClass("year-range"),T.isSameDay(r,e.selectedDate)&&t.addClass("year-range-day")}),this._scrollYear()}_scrollYear(){let e,t,r,s=a()(".year-range-day",this.$yearList),o=s.parent(),n=s.parent().parent();!o[0]||(e=o[0].offsetTop,t=o.outerHeight()/2,r=n.outerHeight()/2,this.$yearList.animateAVCSD("scrollTop",e+t-r))}_format(e,t){return T.format(e,this.session.locale,t)}selectDate(e){this.selectedDate=e,this.rendered&&((!e||e.getFullYear()!==this.$yearTitle.data("year"))&&this.renderContent(),this._colorYear())}setDisplayMode(e){e!==this.displayMode&&(this._setProperty("displayMode",e),this.rendered&&this._colorYear())}setViewRange(e){e!==this.viewRange&&(this._setProperty("viewRange",e),this.rendered&&this._colorYear())}_onYearClick(e){let t=he.DisplayMode,r=a()(e.target).data("year-diff"),s=this.selectedDate.getFullYear(),o=this.selectedDate.getMonth(),n=this.selectedDate.getDate(),l=new Date(s+r,o,n),d,h,p;this.alwaysSelectFirstDay&&(u.isOneOf(this.displayMode,t.WEEK,t.WORK_WEEK,t.CALENDAR_WEEK)?(d=T.weekInYear(this.selectedDate),h=T.weekInYear(l),p=d-h,l=T.shift(l,0,0,p*7),l=T.shiftToNextOrPrevMonday(l,0)):u.isOneOf(this.displayMode,t.MONTH,t.YEAR)&&(l=new Date(s+r,o,1))),this.selectedDate=l,this.trigger("dateSelect",{date:this.selectedDate})}_onYearDayClick(e){this.selectedDate=a()(".year-hover-day",this.$yearList).data("date"),this.selectedDate&&this.trigger("dateSelect",{date:this.selectedDate})}_onYearHoverIn(e){let t=a()(e.target),r=t.data("date"),s=r.getFullYear(),o=r.getMonth(),n=r.getDate(),l=(r.getDay()+6)%7,d,h,p,m;this.displayMode===Ne.DisplayMode.DAY?(d=new Date(s,o,n),h=new Date(s,o,n)):this.displayMode===Ne.DisplayMode.WEEK?(d=new Date(s,o,n-l),h=new Date(s,o,n-l+6)):this.displayMode===Ne.DisplayMode.WORK_WEEK?(d=new Date(s,o,n-l),h=new Date(s,o,n-l+4),r>h&&(r=h)):this.displayMode===Ne.DisplayMode.MONTH?(d=new Date(s,o,1),h=new Date(s,o+1,0)):this.displayMode===he.DisplayMode.YEAR?(d=new Date(s,o,1),h=d):(d=new Date(s,o,n-l),h=d),this.alwaysSelectFirstDay&&(r=d),a()(".year-day",this.$yearList).each(function(){p=a()(this),m=p.data("date"),m>=d&&m<=h?p.addClass("year-hover"):p.removeClass("year-hover"),T.isSameDay(r,m)&&p.addClass("year-hover-day")})}_onYearHoverOut(e){a()(".year-day.year-hover, .year-day.year-hover-day",this.$yearList).removeClass("year-hover year-hover-day")}}function ji(i,e,t){return e=JC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function JC(i){var e=QC(i,"string");return typeof e=="symbol"?e:String(e)}function QC(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class su extends ir{constructor(){super(),ji(this,"objectType",void 0),ji(this,"widget",void 0),ji(this,"validationFailedTextKey",void 0),ji(this,"validationFailedText",void 0),ji(this,"emptyMandatoryElementsTextKey",void 0),ji(this,"emptyMandatoryElementsText",void 0),ji(this,"invalidElementsTextKey",void 0),ji(this,"invalidElementsText",void 0),ji(this,"saveChangesQuestionTextKey",void 0),ji(this,"askIfNeedSave",void 0),ji(this,"askIfNeedSaveText",void 0),ji(this,"handlers",void 0),this.widget=null,this.validationFailedTextKey=null,this.validationFailedText=null,this.emptyMandatoryElementsTextKey=null,this.emptyMandatoryElementsText=null,this.invalidElementsTextKey=null,this.invalidElementsText=null,this.saveChangesQuestionTextKey=null,this.askIfNeedSave=!0,this.askIfNeedSaveText=null,this.handlers={load:this._defaultLoad.bind(this),save:this._defaultSave.bind(this)}}init(e){u.assertParameter("widget",e.widget),a().extend(this,e),v.isNullOrUndefined(this.validationFailedText)&&(this.validationFailedText=this.session().text(this.validationFailedTextKey)),v.isNullOrUndefined(this.emptyMandatoryElementsText)&&(this.emptyMandatoryElementsText=this.session().text(this.emptyMandatoryElementsTextKey)),v.isNullOrUndefined(this.invalidElementsText)&&(this.invalidElementsText=this.session().text(this.invalidElementsTextKey)),v.isNullOrUndefined(this.askIfNeedSaveText)&&(this.askIfNeedSaveText=this.session().text(this.saveChangesQuestionTextKey))}load(){return this._load().then(()=>{this.markAsSaved(),this.trigger("postLoad")})}_load(){return this.handlers.load().then(e=>{this.trigger("load")})}_defaultLoad(){return a().resolvedPromise()}ok(){return this._whenInvalid(this._validate).then(e=>{if(!e)return this.requiresSave()?this._whenInvalid(this._save).then(t=>{if(!t)return this.markAsSaved(),this.close()}):this.close()})}cancel(){return this.requiresSave()&&this.askIfNeedSave?this._showYesNoCancelMessageBox(this.askIfNeedSaveText,this.ok.bind(this),this.close.bind(this)):this.close()}reset(){return this.load().then(()=>{this.trigger("reset")})}close(){return this._close()}_close(){return this.trigger("close"),a().resolvedPromise()}save(){return this._whenInvalid(this._validate).then(e=>{if(!(e||!this.requiresSave()))return this._whenInvalid(this._save).then(t=>{t||this.markAsSaved()})})}_save(){return this.handlers.save().then(e=>(this.trigger("save"),e))}_defaultSave(){return a().resolvedPromise()}markAsSaved(){}requiresSave(){return!1}setAskIfNeedSave(e){this.askIfNeedSave=e}_whenInvalid(e){return e.call(this).then(r=>!r||r.severity===E.Severity.OK?a().resolvedPromise(!1):this._showStatusMessageBox(r)).catch(r=>this._showStatusMessageBox(t(r)));function t(r){return r instanceof E?r:typeof r=="string"?E.error({message:r}):E.error({message:r.message})}}_showYesNoCancelMessageBox(e,t,r){return as.createYesNoCancel(this.widget).withHeader(e).buildAndOpen().then(s=>s===Ti.Buttons.YES?t():s===Ti.Buttons.NO?r():a().resolvedPromise())}_showStatusMessageBox(e){return as.createOk(this.widget).withSeverity(e.severity).withHeader(this.validationFailedText).withBody(e.message,!0).buildAndOpen().then(()=>{let t=e.severity===E.Severity.ERROR;return a().resolvedPromise(t)})}_validate(){let e=this._validateElements();return e.isValid()&&(e=this._validateWidget()),a().resolvedPromise(e)}_validateElements(){let e=this.invalidElements(),t=new E;return e.missingElements.length===0&&e.invalidElements.length===0?t.severity=E.Severity.OK:(t.severity=E.Severity.ERROR,t.message=this._createInvalidElementsMessageHtml(e.missingElements,e.invalidElements),this._revealInvalidElement(f.first(e.missingElements)||f.first(e.invalidElements))),t}_revealInvalidElement(e){}_validateWidget(){return E.ok()}invalidElements(){return{missingElements:[],invalidElements:[]}}_createInvalidElementsMessageHtml(e,t){let r=a()("<div>"),s=e.length>0,o=t.length>0;return s&&n.call(this,r,this.emptyMandatoryElementsText,e,this._missingElementText),s&&o&&r.appendElement("<br>"),o&&n.call(this,r,this.invalidElementsText,t,this._invalidElementText),r.html();function n(l,d,h,p){l.appendDiv().text(d);let m=l.appendElement("<ul>");h.forEach(g=>{m.appendElement("<li>").text(p.call(this,g))})}}_invalidElementText(e){return""}_missingElementText(e){return""}session(){return this.widget.session}handle(e,t){if(["load","save"].indexOf(e)===-1)throw new Error("Cannot register handler for unsupported type '"+e+"'");this.handlers[e]=t}}function J(i,e,t){return e=ZC(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ZC(i){var e=eP(i,"string");return typeof e=="symbol"?e:String(e)}function eP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class he extends I{constructor(){super(),J(this,"activityMap",void 0),J(this,"activitySelectable",void 0),J(this,"availableDisplayModes",void 0),J(this,"displayMode",void 0),J(this,"displayModeOptions",void 0),J(this,"headerVisible",void 0),J(this,"label",void 0),J(this,"resources",void 0),J(this,"resourceMap",void 0),J(this,"selectionMode",void 0),J(this,"selectionRange",void 0),J(this,"selectedResources",void 0),J(this,"viewRange",void 0),J(this,"startRange",void 0),J(this,"lastRange",void 0),J(this,"beginScale",void 0),J(this,"endScale",void 0),J(this,"selectedActivity",void 0),J(this,"menus",void 0),J(this,"startRow",void 0),J(this,"lastRow",void 0),J(this,"menuBar",void 0),J(this,"header",void 0),J(this,"yearPanel",void 0),J(this,"transformLeft",void 0),J(this,"transformWidth",void 0),J(this,"yearPanelVisible",void 0),J(this,"$range",void 0),J(this,"$modes",void 0),J(this,"$selector",void 0),J(this,"$grid",void 0),J(this,"$highlight",void 0),J(this,"$timeline",void 0),J(this,"$timelineLarge",void 0),J(this,"$timelineSmall",void 0),J(this,"$scaleTitle",void 0),J(this,"$scale",void 0),J(this,"_resourceTitleWidth",void 0),J(this,"_rangeSelectionStarted",void 0),J(this,"_tooltipSupport",void 0),J(this,"_gridScrollHandler",void 0),J(this,"_cellMousemoveHandler",void 0),J(this,"_resizeMousemoveHandler",void 0),this.activityMap={},this.activitySelectable=!1,this.availableDisplayModes=[],this.displayMode=null,this.displayModeOptions={},this.headerVisible=!0,this.label=null,this.resources=[],this.resourceMap={},this.selectionMode=he.SelectionMode.MULTI_RANGE,this.selectionRange=new We,this.selectedResources=[],this.viewRange=new We,this.selectedActivity=null,this.startRow=null,this.lastRow=null,this._resourceTitleWidth=20,this._rangeSelectionStarted=!1,this.$container=null,this.$range=null,this.$modes=null,this.$grid=null,this.transformLeft=e=>e,this.transformWidth=(e,t)=>t-e,this.yearPanelVisible=!1,this._addWidgetProperties(["menus"])}_createKeyStrokeContext(){return new Oe}_init(e){super._init(e),this.yearPanel=u.create(Sa,{parent:this,alwaysSelectFirstDay:!0}),this.yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this.header=u.create(ou,{parent:this}),this.header.on("todayClick",this._onTodayClick.bind(this)),this.header.on("yearClick",this._onYearClick.bind(this)),this.header.on("previousClick",this._onPreviousClick.bind(this)),this.header.on("nextClick",this._onNextClick.bind(this)),this.header.on("displayModeClick",this._onDisplayModeClick.bind(this)),this.menuBar=u.create(ce,{parent:this,position:ce.Position.BOTTOM,menuOrder:new lu(this.session,"Planner"),cssClass:"bounded"});for(let t=0;t<this.resources.length;t++)this._initResource(this.resources[t]);this._setDisplayMode(this.displayMode),this._setAvailableDisplayModes(this.availableDisplayModes),this._setViewRange(this.viewRange),this._setSelectedResources(this.selectedResources),this._setSelectedActivity(this.selectedActivity),this._setSelectionRange(this.selectionRange),this._setMenus(this.menus),this._setDisplayModeOptions(this.displayModeOptions),this._tooltipSupport=new da({parent:this,arrowPosition:50})}_initResource(e){e.activities.forEach(t=>this._initActivity(t)),this.resourceMap[e.id]=e}_initActivity(e){e.beginTime=T.parseJsonDate(e.beginTime),e.endTime=T.parseJsonDate(e.endTime),this.activityMap[e.id]=e}_render(){this.$container=this.$parent.appendDiv("planner");let e=new nu(this);this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(e),this.header.render(),this.yearPanel.render(),this.$grid=this.$container.appendDiv("planner-grid").on("mousedown",".resource-cells",this._onCellMouseDown.bind(this)).on("mousedown",".resource-title",this._onResourceTitleMouseDown.bind(this)).on("contextmenu",".resource-title",this._onResourceTitleContextMenu.bind(this)).on("contextmenu",".planner-activity",this._onActivityContextMenu.bind(this)),this.$scale=this.$container.appendDiv("planner-scale"),this.menuBar.render(),G.install(this.$grid,{parent:this,selector:".planner-activity",text:function(t){let r=this.activityById(t.attr("data-id"));if(r)return r.tooltipText}.bind(this)}),this._installScrollbars(),this._gridScrollHandler=this._onGridScroll.bind(this),this.$grid.on("scroll",this._gridScrollHandler)}_renderProperties(){super._renderProperties(),this._renderViewRange(),this._renderHeaderVisible(),this._renderYearPanelVisible(!1),this._renderResources(),this._renderSelectedActivity(),this._renderSelectedResources(),setTimeout(this._renderSelectionRange.bind(this))}get$Scrollable(){return this.$grid}_onPreviousClick(e){this._navigateDate(he.Direction.BACKWARD)}_onNextClick(e){this._navigateDate(he.Direction.FORWARD)}_navigateDate(e){let t=new We(this.viewRange.from,this.viewRange.to),r=he.DisplayMode;this.displayMode===r.DAY?(t.from=T.shift(this.viewRange.from,0,0,e),t.to=T.shift(this.viewRange.to,0,0,e)):u.isOneOf(this.displayMode,r.WEEK,r.WORK_WEEK)?(t.from=T.shift(this.viewRange.from,0,0,e*7),t.from=T.ensureMonday(t.from,-1*e),t.to=T.shift(this.viewRange.to,0,0,e*7)):u.isOneOf(this.displayMode,r.MONTH,r.CALENDAR_WEEK)?(t.from=T.shift(this.viewRange.from,0,e,0),t.from=T.ensureMonday(t.from,-1*e),t.to=T.shift(this.viewRange.to,0,e,0)):this.displayMode===r.YEAR&&(t.from=T.shift(this.viewRange.from,0,3*e,0),t.to=T.shift(this.viewRange.to,0,3*e,0)),this.setViewRange(t)}_onTodayClick(e){let t=this._today(),r=t.getFullYear(),s=t.getMonth(),o=t.getDate(),n=(t.getDay()+6)%7,l=he.DisplayMode;this.displayMode===l.DAY?t=new Date(r,s,o):this.displayMode===l.YEAR?t=new Date(r,s,1):t=new Date(r,s,o-n),this.setViewRangeFrom(t)}_today(){return new Date}_onDisplayModeClick(e){let t=e.displayMode;this.setDisplayMode(t)}_onYearClick(e){this.setYearPanelVisible(!this.yearPanelVisible)}_onYearPanelDateSelect(e){this.setViewRangeFrom(e.date)}_onResourceTitleMouseDown(e){let t=a()(e.target).parent();t.isSelected()&&(e.which===3||e.which===1&&e.ctrlKey)||(this.startRow=t.data("resource"),this.lastRow=this.startRow,this._select())}_onResourceTitleContextMenu(e){this._showContextMenu(e,he.MenuTypes.Resource)}_onRangeSelectorContextMenu(e){this._showContextMenu(e,he.MenuTypes.Range)}_onActivityContextMenu(e){this._showContextMenu(e,he.MenuTypes.Activity)}_showContextMenu(e,t){e.preventDefault(),e.stopPropagation();let r=function(o,n){if(!this.rendered||!this.attached)return;let l=this._filterMenus([n],!0),d=a()(o.currentTarget);if(l.length===0)return;u.create(mt,{parent:this,menuItems:l,location:{x:o.pageX,y:o.pageY},$anchor:d}).open()}.bind(this);this.session.onRequestsDone(r,e,t)}_onGridScroll(e){this._reconcileScrollPos()}_reconcileScrollPos(){let e=this.$grid.scrollLeft();this.$scale.scrollLeft(e)}_renderRange(){if(!this.viewRange.from||!this.viewRange.to)return;let e,t=new Date(this.viewRange.to.valueOf()-1),r=this.session.text("ui.to"),s=he.DisplayMode;T.isSameDay(this.viewRange.from,t)?e=this._dateFormat(this.viewRange.from,"d. MMMM yyyy"):this.viewRange.from.getMonth()===t.getMonth()&&this.viewRange.from.getFullYear()===t.getFullYear()?e=y.join(" ",this._dateFormat(this.viewRange.from,"d."),r,this._dateFormat(t,"d. MMMM yyyy")):this.viewRange.from.getFullYear()===t.getFullYear()?this.displayMode===s.YEAR?e=y.join(" ",this._dateFormat(this.viewRange.from,"MMMM"),r,this._dateFormat(t,"MMMM yyyy")):e=y.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM"),r,this._dateFormat(t,"d. MMMM yyyy")):this.displayMode===s.YEAR?e=y.join(" ",this._dateFormat(this.viewRange.from,"MMMM yyyy"),r,this._dateFormat(t,"MMMM yyyy")):e=y.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM yyyy"),r,this._dateFormat(t,"d. MMMM yyyy")),a()(".planner-select",this.header.$range).text(e)}_renderScale(){if(!this.viewRange.from||!this.viewRange.to)return;let e=this,t=he.DisplayMode;this.$scale.empty(),this.$grid.children(".planner-small-scale-item-line").remove(),this.$grid.children(".planner-large-scale-item-line").remove(),this.$scaleTitle=this.$scale.appendDiv("planner-scale-title"),this._renderLabel(),this.$timeline=this.$scale.appendDiv("timeline"),this.$timelineLarge=this.$timeline.appendDiv("timeline-large"),this.$timelineSmall=this.$timeline.appendDiv("timeline-small"),this.displayMode===t.DAY?this._renderDayScale():u.isOneOf(this.displayMode,t.WORK_WEEK,t.WEEK)?this._renderWeekScale():this.displayMode===t.MONTH?this._renderMonthScale():this.displayMode===t.CALENDAR_WEEK?this._renderCalendarWeekScale():this.displayMode===t.YEAR&&this._renderYearScale();let r=this.$timelineSmall.children(".scale-item"),s=this.$timelineLarge.children(".scale-item"),o=100/r.length;s.each(function(){let d=a()(this),h=e.$grid.prependDiv("planner-large-scale-item-line");d.css("width",d.data("count")*o+"%").data("scale-item-line",h),d.prependDiv("planner-large-scale-item-line").css("left",0)}),r.each(function(d){let h=a()(this);if(h.css("width",o+"%"),!h.data("first")){let p=e.$grid.prependDiv("planner-small-scale-item-line");h.data("scale-item-line",p),h.prependDiv("planner-small-scale-item-line").css("left",0)}});let n=this.$timelineSmall.children().first().data("date-from");this.beginScale=n.valueOf();let l=this.$timelineSmall.children().last().data("date-to");if(this.endScale=l.valueOf(),u.isOneOf(this.displayMode,t.WORK_WEEK,t.WEEK)){let d=this.displayModeOptions[this.displayMode],h=d.interval,p=d.firstHourOfDay,m=d.lastHourOfDay;this.transformLeft=((g,b,C,P,R)=>k=>{let N=new Date(k);g=new Date(g),b=new Date(b);let be=b.valueOf()-g.valueOf(),st=T.compareDays(N,g),Ye=T.compareDays(b,g),ri=st*36e5*24,Dt=24/(P-C+1),si=st/Ye;return N.getHours()<C?(Dt/be+si)*100:N.getHours()>P?(si=(st+1)/Ye,(Dt/be+si)*100):((N.valueOf()-(g.valueOf()+C*36e5)-ri)*Dt/be+si)*100})(this.viewRange.from,this.viewRange.to,p,m,h),this.transformWidth=((g,b,C,P,R)=>function(k,N){let be=b.valueOf()-g.valueOf(),st=new O(k,N),Ye=this._findHiddenRangesInWeekMode(),ri=st.subtractAll(Ye).reduce((si,ko)=>si+ko.size(),0),Dt=24/(P-C+1);return ri*Dt/be*100})(this.viewRange.from,this.viewRange.to,p,m,h)}else this.transformLeft=((d,h)=>p=>(p-d)/(h-d)*100)(this.beginScale,this.endScale),this.transformWidth=((d,h)=>(p,m)=>(m-p)/(h-d)*100)(this.beginScale,this.endScale)}_findHiddenRangesInWeekMode(){if(!u.isOneOf(this.displayMode,he.DisplayMode.WORK_WEEK,he.DisplayMode.WEEK))return[];let e=[],t=this.displayModeOptions[this.displayMode],r=t.firstHourOfDay,s=t.lastHourOfDay,o=new Date(this.viewRange.from.valueOf());for(;o<this.viewRange.to;){let n=new O(new Date(o.valueOf()).valueOf(),T.shiftTime(o,r).valueOf());n.size()>0&&e.push(n),n=new O(T.shiftTime(o,s+1).valueOf(),T.shiftTime(o,24).valueOf()),n.size()>0&&e.push(n),o.setHours(0),o.setMinutes(0),o.setDate(o.getDate()+1)}return e}_renderDayScale(){let e,t,r,s=!0,o=new Date(this.viewRange.from.valueOf()),n=this.displayModeOptions[this.displayMode],l=n.interval,d=n.labelPeriod,h=n.firstHourOfDay,p=n.lastHourOfDay;for(l=Math.min(l,60*(p-h+1));o<this.viewRange.to;)o.getHours()>=h&&o.getHours()<=p?(e=!1,(o.getMinutes()===0||s)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"HH")).data("count",0),e=!0),r=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,":mm")).data("date-from",new Date(o.valueOf())),o.getMinutes()%(l*d)!==0&&r.addClass("label-invisible"),o=T.shiftTime(o,0,l,0),this._incrementTimelineScaleItems(t,r,o,e),s=!1):o=T.shiftTime(o,0,l,0)}_renderWeekScale(){let e,t,r,s=!0,o=new Date(this.viewRange.from.valueOf()),n=this.displayModeOptions[this.displayMode],l=n.interval,d=n.labelPeriod,h=n.firstHourOfDay,p=n.lastHourOfDay;for(l=Math.min(l,60*(p-h+1));o<this.viewRange.to;)e=!1,o.getHours()<h&&o.setHours(h),(o.getHours()===h&&o.getMinutes()===0||s)&&(o.getMonth()===0||s?t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d. MMMM yyyy")).data("count",0):o.getDate()===1?t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d. MMMM")).data("count",0):t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d.")).data("count",0),e=!0),r=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"HH:mm")).data("date-from",new Date(o.valueOf())),((o.getHours()-h)*60+o.getMinutes())%(l*d)!==0&&r.addClass("label-invisible"),o=T.shiftTime(o,0,l,0,0),this._incrementTimelineScaleItems(t,r,o,e),s=!1,o.getHours()>p&&(o.setHours(0),o.setMinutes(0),o.setDate(o.getDate()+1))}_renderMonthScale(){let e,t,r,s=!0,o=new Date(this.viewRange.from.valueOf()),l=this.displayModeOptions[this.displayMode].labelPeriod;for(;o<this.viewRange.to;)e=!1,(o.getDate()===1||s)&&(o.getMonth()===0||s?t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0):t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("count",0),e=!0),r=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"dd")).data("date-from",new Date(o.valueOf())),o.getDate()%l!==0&&r.addClass("label-invisible"),o=T.shift(o,0,0,1),this._incrementTimelineScaleItems(t,r,o,e),s=!1}_renderCalendarWeekScale(){let e,t,r,s=!0,o=new Date(this.viewRange.from.valueOf()),l=this.displayModeOptions[this.displayMode].labelPeriod;for(;o<this.viewRange.to;)e=!1,(o.getDate()<8||s===!0)&&(o.getMonth()===0||s===!0?o.getDate()>11?(t=this.$timelineLarge.appendDiv("scale-item").html("&nbsp;").data("count",0),s=2):(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0),s=!1):s===2?(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0),s=!1):t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("count",0),e=!0),r=this.$timelineSmall.appendDiv("scale-item",T.weekInYear(o)+"").data("date-from",new Date(o.valueOf())).data("tooltipText",this._scaleTooltipText.bind(this)),this._tooltipSupport.install(r),T.weekInYear(o)%l!==0&&r.addClass("label-invisible"),o.setDate(o.getDate()+7),this._incrementTimelineScaleItems(t,r,o,e)}_renderYearScale(){let e,t,r,s=!0,o=new Date(this.viewRange.from.valueOf()),l=this.displayModeOptions[this.displayMode].labelPeriod;for(;o<this.viewRange.to;)e=!1,(o.getMonth()===0||s)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"yyyy")).data("count",0),e=!0),r=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("date-from",new Date(o.valueOf())),o.getMonth()%l!==0&&r.addClass("label-invisible"),o=T.shift(o,0,1,0),this._incrementTimelineScaleItems(t,r,o,e),s=!1}_incrementTimelineScaleItems(e,t,r,s){e.data("count",e.data("count")+1),t.data("date-to",new Date(r.valueOf())).data("first",s)}_scaleTooltipText(e){let t=" "+this.session.text("ui.to")+" ",r=new Date(e.data("date-from").valueOf()),s=new Date(e.data("date-to").valueOf()-1);return r.getMonth()===s.getMonth()?this._dateFormat(r,"d.")+t+this._dateFormat(s,"d. MMMM yyyy"):r.getFullYear()===s.getFullYear()?this._dateFormat(r,"d. MMMM")+t+this._dateFormat(s,"d. MMMM yyyy"):this._dateFormat(r,"d. MMMM yyyy")+t+this._dateFormat(s,"d. MMMM yyyy")}_removeAllResources(){this.resources.forEach(e=>e.$resource.remove())}_renderResources(e){let t,r="";e=e||this.resources;for(let s=0;s<e.length;s++)t=e[s],r+=this._buildResourceHtml(t);a()(r).appendTo(this.$grid),this.$grid.children(".planner-resource").each((s,o)=>{let n=a()(o);t=this.resourceById(n.attr("data-id")),this._linkResource(n,t),this._linkActivitiesForResource(t)})}_linkResource(e,t){e.data("resource",t),t.$resource=e,t.$cells=e.children(".resource-cells")}_linkActivity(e,t){e.data("activity",t),t.$activity=e}_rerenderActivities(e){e=e||this.resources,e.forEach(t=>{this._removeActivitiesForResource(t),this._renderActivitiesForResource(t)})}_buildResourceHtml(e){let t='<div class="planner-resource" data-id="'+e.id+'">';return t+='<div class="resource-title">'+y.encode(e.resourceCell.text||"")+"</div>",t+='<div class="resource-cells">'+this._buildActivitiesHtml(e)+"</div>",t+="</div>",t}_renderActivitiesForResource(e){e.$cells.html(this._buildActivitiesHtml(e)),this._linkActivitiesForResource(e)}_linkActivitiesForResource(e){e.$cells.children(".planner-activity").each((t,r)=>{let s=a()(r),o=this.activityById(s.attr("data-id"));this._linkActivity(s,o)})}_buildActivitiesHtml(e){let t="";return e.activities.forEach(r=>{r.beginTime.valueOf()>=this.endScale||r.endTime.valueOf()<=this.beginScale||(t+=this._buildActivityHtml(r))}),t}_removeActivitiesForResource(e){e.activities.forEach(t=>{t.$activity&&(t.$activity.remove(),t.$activity=null)})}_buildActivityHtml(e){let t=100-Math.min(e.level*100,100),r=L.modelToCssColor(e.backgroundColor),s=L.modelToCssColor(e.foregroundColor),o=L.modelToCssColor(e.levelColor),n=e.beginTime,l=e.endTime,d=n.valueOf(),h=l.valueOf();d=Math.max(d,this.beginScale),h=Math.min(h,this.endScale);let p="planner-activity"+(e.cssClass?" "+e.cssClass:""),m="left: calc("+this.transformLeft(d)+"% + 2px);";m+=" width: calc("+this.transformWidth(d,h)+"% - 4px);",o&&(m+=" background-color: "+o+";",m+=" border-color: "+o+";"),!o&&r&&(m+=" background-color: "+r+";",m+=" border-color: "+r+";"),s&&(m+=" color: "+s+";");let g="planner-activity-level"+(e.cssClass?" "+e.cssClass:""),b=L.get(g,"background-color").backgroundColor;m+=" background-image: linear-gradient(to bottom, "+b+" 0%, "+b+" "+t+"%, transparent "+t+"%, transparent 100% );";let C="<div";return C+=' class="'+p+'"',C+=' style="'+m+'"',C+=' data-id="'+e.id+'"',C+=">"+y.encode(e.text||"")+"</div>",C}_onCellMouseDown(e){let t,r,s=a()(e.target),o=he.SelectionMode,n=e.which===3||e.which===1&&e.ctrlKey;this.activitySelectable?(!n&&this.$selector&&this.$selector.hide(),t=this.$grid.elementFromPoint(e.pageX,e.pageY),!n&&this.$selector&&this.$selector.show(),t.hasClass("planner-activity")?(r=t.parent().parent(),this.selectResources([r.data("resource")]),this.selectActivity(t.data("activity")),this.selectRange(new We)):this.selectActivity(null)):this.selectActivity(null),this.selectionMode!==o.NONE&&(s.hasClass("selector")&&n||(this.selectedActivity||this._startRangeSelection(e.pageX,e.pageY),this._cellMousemoveHandler=this._onCellMousemove.bind(this,e),s.document().on("mousemove",this._cellMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this))))}_startRangeSelection(e,t){this.startRow=this._findRow(t),this.lastRow=this.startRow,this.startRange=this._findScale(e),this.lastRange=this.startRange,this._select(),this._rangeSelectionStarted=!0}_prepareRangeSelectionByMousemove(e,t){let r=e.pageX-t.pageX,s=e.pageY-t.pageY,o=he.RANGE_SELECTION_MOVE_THRESHOLD;if(Math.abs(r)>=o)return!0;let n=this._findRow(e.pageY),l=this._findRow(t.pageY);return Math.abs(s)>=o&&this.selectionMode===he.SelectionMode.MULTI_RANGE&&n!==l}_onCellMousemove(e,t){if(this.selectedActivity&&!this._rangeSelectionStarted){if(!this._prepareRangeSelectionByMousemove(e,t))return;this._startRangeSelection(e.pageX,e.pageY)}let r=this._findRow(t.pageY);r&&(this.lastRow=r);let s=this._findScale(t.pageX);s&&(this.lastRange=s),this._select()}_onResizeMouseDown(e){let t,r=a()(e.target);return this.startRow=this.selectedResources[0],this.lastRow=this.selectedResources[this.selectedResources.length-1],this.startRange=u.nvl(this._findScaleByFromDate(this.selectionRange.from),new O(this.selectionRange.from.getTime(),this.selectionRange.from.getTime())),this.lastRange=u.nvl(this._findScaleByToDate(this.selectionRange.to),new O(this.selectionRange.to.getTime(),this.selectionRange.to.getTime())),r.hasClass("selector-resize-left")&&(t=this.startRange,this.startRange=this.lastRange,this.lastRange=t),r.body().addClass("col-resize"),this._resizeMousemoveHandler=this._onResizeMousemove.bind(this),r.document().on("mousemove",this._resizeMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this)),!1}_onResizeMousemove(e){if(!this.rendered)return;let t=this._findScale(e.pageX);t&&(this.lastRange=t),this._select()}_onDocumentMouseUp(e){let t=a()(e.target);t.body().removeClass("col-resize"),this._cellMousemoveHandler&&(t.document().off("mousemove",this._cellMousemoveHandler),this._cellMousemoveHandler=null),this._resizeMousemoveHandler&&(t.document().off("mousemove",this._resizeMousemoveHandler),this._resizeMousemoveHandler=null),this._rangeSelectionStarted&&(this._rangeSelectionStarted=!1,this.rendered&&this._select())}_select(){if(!this.startRow||!this.lastRow)return;let e=!!(this.startRange&&this.lastRange),t=this.startRow.$resource,r=this.lastRow.$resource;this.selectionMode===he.SelectionMode.SINGLE_RANGE&&(this.lastRow=this.startRow,r=this.startRow.$resource);let s=t[0].offsetTop<=r[0].offsetTop?t:r,o=t[0].offsetTop>r[0].offsetTop?t:r,n=a()(".planner-resource",this.$grid).toArray(),l=s[0].offsetTop,d=o[0].offsetTop;for(let h=n.length-1;h>=0;h--){let p=n[h];(p.offsetTop<l&&p.offsetTop<d||p.offsetTop>l&&p.offsetTop>d)&&n.splice(h,1)}if(this.selectResources(n.map(h=>a()(h).data("resource"))),this.selectActivity(null),e){let h=Math.min(this.lastRange.from.valueOf(),this.startRange.from.valueOf()),p=Math.max(this.lastRange.to.valueOf(),this.startRange.to.valueOf()),m=new We(new Date(h),new Date(p));m=this._adjustSelectionRange(m),this.selectRange(m)}}_adjustSelectionRange(e){let t=e.from.getTime(),r=e.to.getTime(),s=0,o=this.displayModeOptions[this.displayMode];o.interval>0&&o.minSelectionIntervalCount>0&&(s=o.minSelectionIntervalCount*o.interval*6e4);let n=o.lastHourOfDay,l=T.shiftTime(T.trunc(e.from),n+1),d=this._visibleViewRange();return this.lastRange.from<this.startRange.from?r-s>=d.from.getTime()?t=Math.min(t,r-s):(t=d.from.getTime(),r=Math.max(r,Math.min(t+s,d.to.getTime()))):t+s<=d.to.getTime()?(r=Math.max(r,Math.max(t+s,d.from.getTime())),r>=l.getTime()&&new O(t,r).size()===s&&(r=l.getTime(),t=Math.min(t,r-s))):(r=d.to.getTime(),t=Math.min(t,r-s)),new We(new Date(t),new Date(r))}_findRow(e){let t,r=w.offsetBounds(this.$grid),s=r.x+10;return e=Math.min(Math.max(e,0),r.y+r.height-1),t=this.$container.elementFromPoint(s,e,".planner-resource"),t.length>0?t.data("resource"):null}_findScale(e){let t,r=w.offsetBounds(this.$grid),s=this.$scale.offset().top+this.$scale.height()*.75;return e=Math.min(Math.max(e,0),r.x+r.width-1),t=this.$container.elementFromPoint(e,s,".scale-item"),t.length>0?new We(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}_findScaleByFromDate(e){return this._findScaleByFunction((t,r)=>{if(a()(r).data("date-from").getTime()===e.getTime())return!0})}_findScaleByToDate(e){return this._findScaleByFunction((t,r)=>{if(a()(r).data("date-to").getTime()===e.getTime())return!0})}_findScaleByFunction(e){let t=this.$timelineSmall.children(".scale-item").filter(e);return t.length?new We(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}_visibleViewRange(){let e=this.$timelineSmall.children(".scale-item");return new We(e.first().data("date-from"),e.last().data("date-to"))}_dateFormat(e,t){let r=new Date(e.valueOf());return new Ft(this.session.locale,t).format(r)}_renderViewRange(){this._renderRange(),this._renderScale(),this.invalidateLayoutTree()}_renderHeaderVisible(){this.header.setVisible(this.headerVisible),this.invalidateLayoutTree()}_renderYearPanelVisible(e){let t;this.yearPanelVisible&&this.yearPanel.renderContent(),a()(".calendar-toggle-year",this.$modes).select(this.yearPanelVisible),this.yearPanelVisible?t=210:t=0,this.yearPanel.$container.animate({width:t},{duration:e?500:0,progress:this._onYearPanelWidthChange.bind(this),complete:this._afterYearPanelWidthChange.bind(this)})}_onYearPanelWidthChange(){if(!this.yearPanel.$container)return;let e=this.yearPanel.$container.outerWidth();this.$grid.css("width","calc(100% - "+e+"px)"),this.$scale.css("width","calc(100% - "+e+"px)"),this.revalidateLayout()}_afterYearPanelWidthChange(){this.yearPanelVisible||this.yearPanel.removeContent()}_setMenus(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}_updateMenuBar(){let e=this._filterMenus([he.MenuTypes.EmptySpace,he.MenuTypes.Resource,he.MenuTypes.Activity,he.MenuTypes.Range],!1,!0);this.menuBar.setMenuItems(e)}_filterMenus(e,t,r){return e=e||[],e.indexOf(he.MenuTypes.Resource)>-1&&this.selectedResources.length===0&&f.remove(e,he.MenuTypes.Resource),e.indexOf(he.MenuTypes.Activity)>-1&&!this.selectedActivity&&f.remove(e,he.MenuTypes.Activity),e.indexOf(he.MenuTypes.Range)>-1&&!this.selectionRange.from&&!this.selectionRange.to&&f.remove(e,he.MenuTypes.Range),Ke.filter(this.menus,e,{onlyVisible:t,enableDisableKeyStrokes:r})}setDisplayModeOptions(e){this.setProperty("displayModeOptions",e)}_setDisplayModeOptions(e){e&&this._adjustHours(e),this.displayModeOptions=e}_adjustHours(e){v.values(e).forEach(r=>{r.firstHourOfDay&&(r.firstHourOfDay=t(r.firstHourOfDay)),r.lastHourOfDay&&(r.lastHourOfDay=t(r.lastHourOfDay))});function t(r){return r<0?0:r>23?23:r}}_renderDisplayModeOptions(){this._renderRange(),this._renderScale(),this._rerenderActivities(),this._select(),this.invalidateLayoutTree()}_renderAvailableDisplayModes(){}_renderDisplayMode(){}_setViewRange(e){e=We.ensure(e),this._setProperty("viewRange",e),this.yearPanel.setViewRange(this.viewRange),this.yearPanel.selectDate(this.viewRange.from)}_setDisplayMode(e){this._setProperty("displayMode",e),this.yearPanel.setDisplayMode(this.displayMode),this.header.setDisplayMode(this.displayMode)}_setAvailableDisplayModes(e){this._setProperty("availableDisplayModes",e),this.header.setAvailableDisplayModes(this.availableDisplayModes)}_setSelectionRange(e){e=We.ensure(e),this._setProperty("selectionRange",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}_setSelectedResources(e){typeof e[0]=="string"&&(e=this.resourcesByIds(e)),this.rendered&&this._removeSelectedResources(),this._setProperty("selectedResources",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}_removeSelectedResources(){this.selectedResources.forEach(e=>e.$resource.select(!1))}_renderSelectedResources(){this.selectedResources.forEach(e=>e.$resource.select(!0))}_renderActivitySelectable(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.toggleClass("selected",this.activitySelectable)}_renderSelectionMode(){this.selectionMode===he.SelectionMode.NONE?this.$selector&&(this.$selector.remove(),this.$highlight.remove()):this._renderSelectionRange()}_renderSelectionRange(){let e=this.selectionRange.from,t=this.selectionRange.to,r=this.selectedResources[0],s=this.selectedResources[this.selectedResources.length-1];if(this.$selector&&(this.$selector.remove(),this.$highlight.remove()),!r||!s||!this.selectionRange.from||!this.selectionRange.to)return;let o=r.$resource,n=s.$resource,l=Math.max(e.valueOf(),this.beginScale),d=Math.min(t.valueOf(),this.endScale),h=o[0].offsetTop<=n[0].offsetTop?o:n;this.$selector=h.children(".resource-cells").appendDiv("selector"),this.$selector.cssHeight(o.outerHeight()+Math.abs(n[0].offsetTop-o[0].offsetTop));let p=this.$selector.appendDiv("selector-resize-left").on("mousedown",this._onResizeMouseDown.bind(this)),m=this.$selector.appendDiv("selector-resize-right").on("mousedown",this._onResizeMouseDown.bind(this));this.$selector.css("left","calc("+this.transformLeft(l)+"% - "+p.cssWidth()+"px)").css("width","calc("+this.transformWidth(l,d)+"% + "+(p.cssWidth()+m.cssWidth())+"px)").on("contextmenu",this._onRangeSelectorContextMenu.bind(this)),this.$highlight=this.$timelineSmall.prependDiv("highlight");let g=this.$selector.cssLeft()+p.cssWidth()+this.$scaleTitle.cssWidth(),b=this.$selector.cssWidth()-(p.cssWidth()+m.cssWidth());this.$highlight.cssLeft(g).cssWidth(b)}_setSelectedActivity(e){typeof e=="string"&&(e=this.activityById(e)),this.rendered&&this._removeSelectedActivity(),this._setProperty("selectedActivity",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}_removeSelectedActivity(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.removeClass("selected")}_renderSelectedActivity(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.addClass("selected")}_renderLabel(){let e=this.label||"";this.$scaleTitle&&this.$scaleTitle.text(e)}resourcesByIds(e){return e.map(this.resourceById.bind(this))}activityById(e){return this.activityMap[e]}resourceById(e){return this.resourceMap[e]}setDisplayMode(e){this.setProperty("displayMode",e),this.startRange=null,this.lastRange=null}layoutYearPanel(){this.yearPanelVisible&&(x.update(this.yearPanel.$yearList),this.yearPanel._scrollYear())}setYearPanelVisible(e){this.yearPanelVisible!==e&&(this._setProperty("yearPanelVisible",e),this.rendered&&this._renderYearPanelVisible(!0))}setViewRangeFrom(e){let t=T.compareDays(this.viewRange.to,this.viewRange.from),r=new We(this.viewRange.from,this.viewRange.to);r.from=e,r.to=T.shift(e,0,0,t),this.setViewRange(r)}setViewRange(e){this.viewRange!==e&&(this._setViewRange(e),this.rendered&&(this._renderViewRange(),this._rerenderActivities(),this._renderSelectedActivity(),this.validateLayoutTree(),this._reconcileScrollPos()))}selectRange(e){e&&e.equals(this.selectionRange)||this.setProperty("selectionRange",e)}selectActivity(e){this.setProperty("selectedActivity",e)}selectResources(e){let t=f.ensure(e);f.equals(t,this.selectedResources)||(t=t.slice(),this.setProperty("selectedResources",t),this.trigger("resourcesSelected",{resources:t}),this.rendered&&this._renderSelectionRange())}deselectResources(e){let t=!1;e=f.ensure(e);let r=this.selectedResources.slice();return f.removeAll(r,e)&&(this.selectResources(r),t=!0),t}insertResources(e){e.forEach(t=>{this._initResource(t),this.resources.push(t)}),this.rendered&&(this._renderResources(e),this.invalidateLayoutTree())}deleteResources(e){this.deselectResources(e)&&this.selectRange(new We),e.forEach(t=>{f.remove(this.resources,t),delete this.resourceMap[t.id],t.activities.forEach(r=>delete this.activityMap[r.id]),this.rendered&&(t.$resource.remove(),delete t.$resource)}),this.invalidateLayoutTree()}deleteAllResources(){this.rendered&&(this._removeAllResources(),this.invalidateLayoutTree()),this.resources=[],this.resourceMap={},this.activityMap={},this.selectResources([]),this.selectRange(new We)}updateResources(e){e.forEach(t=>{let r=this.resourceMap[t.id];if(!r)throw new Error("Update event received for non existing resource. ResourceId: "+t.id);if(this._initResource(t),f.replace(this.resources,r,t),f.replace(this.selectedResources,r,t),this.rendered&&r.$resource){let s=a()(this._buildResourceHtml(t));r.$resource.replaceWith(s),s.css("min-width",r.$resource.css("min-width")),this._linkResource(s,t),this._linkActivitiesForResource(t)}})}}J(he,"Direction",{BACKWARD:-1,FORWARD:1}),J(he,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4,CALENDAR_WEEK:5,YEAR:6}),J(he,"SelectionMode",{NONE:0,SINGLE_RANGE:1,MULTI_RANGE:2}),J(he,"RANGE_SELECTION_MOVE_THRESHOLD",10),J(he,"MenuTypes",{Activity:"Planner.Activity",EmptySpace:"Planner.EmptySpace",Range:"Planner.Range",Resource:"Planner.Resource"});function tP(i,e,t){return e=iP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iP(i){var e=rP(i,"string");return typeof e=="symbol"?e:String(e)}function rP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Os extends He{constructor(){super(),this._addRemoteProperties(["displayMode","viewRange","selectionRange","selectedActivity"])}_orderPropertyNamesOnSync(e){return Object.keys(e).sort(this._createPropertySortFunc(Os.PROPERTIES_ORDER))}_sendViewRange(e){this._send("property",{viewRange:T.toJsonDateRange(e)})}_sendSelectedActivity(){let e=null;this.widget.selectedActivity&&(e=this.widget.selectedActivity.id),this._send("property",{selectedActivity:e})}_sendSelectionRange(){let e=T.toJsonDateRange(this.widget.selectionRange);this._send("property",{selectionRange:e})}_onWidgetResourcesSelected(e){this._sendResourcesSelected()}_sendResourcesSelected(){let e=this.widget.selectedResources.map(t=>t.id);this._send("resourcesSelected",{resourceIds:e})}_onWidgetEvent(e){e.type==="resourcesSelected"?this._onWidgetResourcesSelected(e):super._onWidgetEvent(e)}_onResourcesInserted(e){this.widget.insertResources(e)}_onResourcesDeleted(e){let t=this.widget.resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new We}),this.widget.deleteResources(t)}_onAllResourcesDeleted(){this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new We}),this.widget.deleteAllResources()}_onResourcesSelected(e){let t=this.widget.resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.widget.selectResources(t)}_onResourcesUpdated(e){this.widget.updateResources(e)}onModelAction(e){e.type==="resourcesInserted"?this._onResourcesInserted(e.resources):e.type==="resourcesDeleted"?this._onResourcesDeleted(e.resourceIds):e.type==="allResourcesDeleted"?this._onAllResourcesDeleted():e.type==="resourcesSelected"?this._onResourcesSelected(e.resourceIds):e.type==="resourcesUpdated"?this._onResourcesUpdated(e.resources):super.onModelAction(e)}static _initResourceRemote(e){return this.modelAdapter&&Ve.applyTo(e,"Resource"),this._initResourceOrig(e)}static _initActivityRemote(e){return this.modelAdapter&&Ve.applyTo(e,"Activity"),this._initActivityOrig(e)}static modifyPlannerPrototype(){!ie.get().remote||(v.replacePrototypeFunction(he,"_initResource",Os._initResourceRemote,!0),v.replacePrototypeFunction(he,"_initActivity",Os._initActivityRemote,!0))}}tP(Os,"PROPERTIES_ORDER",["displayMode","viewRange"]),ie.addListener("bootstrap",Os.modifyPlannerPrototype);function Ca(i,e,t){return e=sP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sP(i){var e=oP(i,"string");return typeof e=="symbol"?e:String(e)}function oP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ou extends I{constructor(){super(),Ca(this,"$range",void 0),Ca(this,"$commands",void 0),Ca(this,"availableDisplayModes",void 0),Ca(this,"displayMode",void 0),this.availableDisplayModes=[]}_render(){this.$container=this.$parent.appendDiv("planner-header"),this.$range=this.$container.appendDiv("planner-range"),this.$range.appendDiv("planner-previous").on("click",this._onPreviousClick.bind(this)),this.$range.appendDiv("planner-today",this.session.text("ui.CalendarToday")).on("click",this._onTodayClick.bind(this)),this.$range.appendDiv("planner-next").on("click",this._onNextClick.bind(this)),this.$range.appendDiv("planner-select"),this.$commands=this.$container.appendDiv("planner-commands"),this._renderAvailableDisplayModes(),this._renderDisplayMode()}setAvailableDisplayModes(e){this.setProperty("availableDisplayModes",e)}_renderAvailableDisplayModes(){let e=he.DisplayMode;this.$commands.empty(),this.availableDisplayModes.length>1&&(this.availableDisplayModes.indexOf(e.DAY)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarDay")).attr("data-mode",e.DAY).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WORK_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",e.WORK_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",e.WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.MONTH)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarMonth")).attr("data-mode",e.MONTH).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.CALENDAR_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarCalendarWeek")).attr("data-mode",e.CALENDAR_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.YEAR)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarYear")).attr("data-mode",e.YEAR).on("click",this._onDisplayModeClick.bind(this)));let t=this.$commands.children(".planner-mode");t.first().addClass("first"),t.last().addClass("last"),t.length===1&&(t.first().addClass("disabled"),t.off("click")),this.$commands.appendDiv("planner-toggle-year").on("click",this._onYearClick.bind(this))}setDisplayMode(e){this.setProperty("displayMode",e)}_renderDisplayMode(){a()(".planner-mode",this.$commands).select(!1),a()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0)}_onTodayClick(e){this.trigger("todayClick")}_onNextClick(e){this.trigger("nextClick")}_onPreviousClick(e){this.trigger("previousClick")}_onYearClick(e){this.trigger("yearClick")}_onDisplayModeClick(e){let t=a()(e.target).data("mode");this.setDisplayMode(t),this.trigger("displayModeClick",{displayMode:this.displayMode})}}function nP(i,e,t){return e=lP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lP(i){var e=aP(i,"string");return typeof e=="symbol"?e:String(e)}function aP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class nu extends te{constructor(e){super(),nP(this,"planner",void 0),this.planner=e}layout(e){let t,r=this.planner.header.$container,s=this.planner.$scale,o=this.planner.$grid,n=this.planner.menuBar,l=this.planner.yearPanel.$container,d=0,h=0,p=0,m=0,g=0,b=S.get(n.$container),C=this.planner.htmlComp,P=C.availableSize().subtract(C.insets());n.$container.isVisible()&&(t=Zr.size(b,P),b.setSize(t),d=t.height,n.position==="top"&&(g+=d)),r.isVisible()&&(g+=w.size(r).height),s.css("top",g),m+=g+w.size(s).height,o.css("top",m),p=g+l.cssMarginY(),h=m+o.cssMarginY(),n.$container.isVisible()&&n.position==="bottom"&&(p+=d,h+=d),l.css("height","calc(100% - "+p+"px)"),o.css("height","calc(100% - "+h+"px)"),this._updateMinWidth(),this._layoutScaleLines(),x.update(this.planner.$grid,!0),this.planner.layoutYearPanel()}_updateMinWidth(){let e=this._minWidth(),t=this.planner.$scaleTitle,r=this.planner.$timeline;!r||(r.css("min-width",e),e+=t.outerWidth(!0),this.planner.resources.forEach(s=>s.$resource.css("min-width",e)))}_layoutScaleLines(){let e,t,r,s,o=this.planner.$timelineSmall,n=this.planner.$timelineLarge;!o||(t=o.children(".scale-item"),r=n.children(".scale-item"),r.each(function(){a()(this).data("scale-item-line").cssHeight(0)}),t.each(function(){let l=a()(this).data("scale-item-line");l&&l.cssHeight(0)}),x.reset(this.planner.$grid),e=this.planner.$grid[0].scrollHeight,s=this.planner.$scale[0].scrollLeft,r.each(function(){let l=a()(this);l.data("scale-item-line").cssLeft(s+l.position().left).cssHeight(e)}),t.each(function(){let l=a()(this),d=l.data("scale-item-line");d&&d.cssLeft(s+l.position().left).cssHeight(e)}))}_minWidth(){let e=this.planner.$timelineLarge.children(".scale-item"),t=this.planner.$timelineSmall.children(".scale-item"),r=e.length,s=t.length,o=he.DisplayMode,n=w.insets(t,{includeBorder:!1}),l=s*n.horizontal();if(this.planner.displayMode===o.DAY)return Math.max(l,r*52);if(u.isOneOf(this.planner.displayMode,o.WORK_WEEK,o.WEEK))return Math.max(l,r*160);if(this.planner.displayMode===o.MONTH||this.planner.displayMode===o.CALENDAR_WEEK)return Math.max(l,s*23);if(this.planner.displayMode===o.YEAR)return Math.max(l,s*90)}}class lu extends sn{constructor(e,t){super(e,t),this.selectionTypes=["Resource","Activity","Range"]}}function mi(i,e,t){return e=dP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dP(i){var e=hP(i,"string");return typeof e=="symbol"?e:String(e)}function hP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zm extends I{constructor(){super(),mi(this,"maximumUploadSize",void 0),mi(this,"acceptTypes",void 0),mi(this,"multiSelect",void 0),mi(this,"displayParent",void 0),mi(this,"files",void 0),mi(this,"boxButtons",void 0),mi(this,"uploadButton",void 0),mi(this,"cancelButton",void 0),mi(this,"fileInput",void 0),mi(this,"$content",void 0),mi(this,"$title",void 0),mi(this,"$files",void 0),mi(this,"dragAndDropHandler",void 0),mi(this,"_glassPaneRenderer",void 0),this.displayParent=null,this.files=[],this._glassPaneRenderer=null,this.maximumUploadSize=wi.DEFAULT_MAXIMUM_UPLOAD_SIZE,this.boxButtons=null,this.uploadButton=null,this.cancelButton=null,this.inheritAccessibility=!1,this._addWidgetProperties(["boxButtons","uploadButton","cancelButton"])}_init(e){super._init(e),this._setDisplayParent(this.displayParent),this._glassPaneRenderer=new js(this),this.fileInput=u.create(wi,{parent:this,acceptTypes:this.acceptTypes,maximumUploadSize:this.maximumUploadSize,multiSelect:this.multiSelect,visible:!F.get().supportsFile()}),this.fileInput.on("change",this._onFileChange.bind(this)),this.boxButtons=u.create(Xn,{parent:this}),this.boxButtons.addButton({text:this.session.text("ui.Browse")}).on("action",r=>this._onAddFileButtonClicked(r)),this.uploadButton=this.boxButtons.addButton({text:this.session.text("ui.Upload"),enabled:!1}),this.uploadButton.on("action",r=>this._onUploadButtonClicked(r)),this.cancelButton=this.boxButtons.addButton({text:this.session.text("Cancel")}),this.cancelButton.on("action",r=>this._onCancelButtonClicked(r))}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new oa(this.session,this),new jn(this,[_.SPACE,_.ENTER]),new Jo(this,()=>this.cancelButton?this.cancelButton.$container:null)])}_render(){this.$container=this.$parent.appendDiv("file-chooser").on("mousedown",this._onMouseDown.bind(this));let e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$content=this.$container.appendDiv("file-chooser-content"),this.$title=this.$content.appendDiv("file-chooser-title").text(this.session.text(this.multiSelect?"ui.ChooseFiles":"ui.ChooseFile")),this.fileInput.render(this.$content),this.$content.appendDiv("file-chooser-label").text(this.session.text("ui.FileChooserHint")),this.$files=this.$content.appendElement("<ul>","file-chooser-files"),this._installScrollbars(),this.boxButtons.render(),this.boxButtons.$container.addClass("file-chooser-buttons"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new dl(this)),this.$container.addClassForAnimation("animate-open"),this.$container.addClass("calc-helper");let t=this.$container.windowSize(),r=Math.min(this.$container.width(),t.width);this.$container.css("min-width",r),this.$container.css("max-width",r),this.$container.removeClass("calc-helper"),this._glassPaneRenderer.renderGlassPanes(),this._position()}_renderProperties(){super._renderProperties(),this._renderFiles()}_renderEnabled(){super._renderEnabled(),this._installOrUninstallDragAndDropHandler()}_postRender(){super._postRender(),this._installFocusContext()}_remove(){this._glassPaneRenderer.removeGlassPanes(),Ae.uninstallDragAndDropHandler(this),this._uninstallFocusContext(),super._remove()}_installFocusContext(){this.session.focusManager.installFocusContext(this.$container,It.AUTO)}_uninstallFocusContext(){this.session.focusManager.uninstallFocusContext(this.$container)}get$Scrollable(){return this.$files}_position(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}setDisplayParent(e){this.setProperty("displayParent",e)}_setDisplayParent(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}setMaximumUploadSize(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}open(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.fileChooserController.registerAndRender(this)}close(){if(!this.rendered){this.cancel();return}this.cancelButton&&this.cancelButton.$container&&this.session.focusManager.requestFocus(this.cancelButton.$container)&&this.cancelButton.doAction()}cancel(){this.trigger("cancel").defaultPrevented||this._close()}_close(){this.displayParent&&this.displayParent.fileChooserController.unregisterAndRemove(this),this.destroy()}_installOrUninstallDragAndDropHandler(){Ae.installOrUninstallDragAndDropHandler({target:this,onDrop:e=>this.addFiles(e.files),dropMaximumSize:()=>this.maximumUploadSize,validateFiles:(e,t)=>{}})}browse(){this.fileInput.browse()}setAcceptTypes(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}setMultiSelect(e){this.setProperty("multiSelect",e),this.fileInput.setMultiSelect(e)}addFiles(e){e instanceof FileList&&(e=Yr.fileListToArray(e)),e=f.ensure(e),e.length!==0&&(this.multiSelect?(e=e.slice(),f.insertAll(e,this.files,0),this.setFiles(e)):this.setFiles([e[0]]))}removeFile(e){let t=this.files.slice();f.remove(t,e),this.setFiles(t),this.fileInput.clear()}setFiles(e){e instanceof FileList&&(e=Yr.fileListToArray(e)),e=f.ensure(e);try{this.fileInput.validateMaximumUploadSize(e)}catch(t){as.createOk(this).withHeader(this.session.text("ui.FileSizeLimitTitle")).withBody(t).withSeverity(E.Severity.ERROR).buildAndOpen();return}this.setProperty("files",e)}_renderFiles(){let e=this.files;this.$files.empty(),e.forEach(t=>{let r=this.$files.appendElement("<li>","file",t.name);r.append(" ");let s=r.appendSpan("remove").on("click",this.removeFile.bind(this,t)),o=r.makeElement("<a>","remove-link",this.session.text("Remove"));s.append(o)}),x.update(this.$files),this.uploadButton.setEnabled(e.length>0)}_onUploadButtonClicked(e){this.trigger("upload")}_onCancelButtonClicked(e){this.cancel()}_onAddFileButtonClicked(e){this.browse()}_onFileChange(e){this.addFiles(e.files)}_onMouseDown(e){let t=this.findParent(r=>r instanceof Y&&r.isDialog());t&&t.activate()}_attach(){this.$parent.append(this.$container),super._attach()}_detach(){this.$container.detach(),super._detach()}}class Gm extends He{_onWidgetCancel(e){e.preventDefault(),this._send("cancel")}_onWidgetEvent(e){e.type==="cancel"?this._onWidgetCancel(e):e.type==="upload"?this._onUpload(e):super._onWidgetEvent(e)}_onUpload(e){this.widget.rendered&&this.widget.uploadButton.setEnabled(!1),this.widget.files.length!==0&&(this.session.uploadFiles(this,this.widget.files,void 0,this.widget.maximumUploadSize),this.session.listen().done(()=>{this.widget&&this.widget.rendered&&this.widget.uploadButton.setEnabled(!0)}))}}function Um(i,e,t){return e=uP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function uP(i){var e=cP(i,"string");return typeof e=="symbol"?e:String(e)}function cP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ll{constructor(e,t){Um(this,"displayParent",void 0),Um(this,"session",void 0),this.displayParent=e,this.session=t}registerAndRender(e){u.assertProperty(e,"displayParent"),this.displayParent.fileChoosers.push(e),this._render(e)}unregisterAndRemove(e){e&&(f.remove(this.displayParent.fileChoosers,e),this._remove(e))}remove(){this.displayParent.fileChoosers.forEach(this._remove.bind(this))}render(){this.displayParent.fileChoosers.forEach(e=>{e.setDisplayParent(this.displayParent),this._render(e)})}_render(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;if(e.rendered)return;let t;this.displayParent instanceof Y&&this.displayParent.isPopupWindow()?t=this.displayParent.popupWindow.$container:t=this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach()}_remove(e){e.remove()}attach(){this.displayParent.fileChoosers.forEach(e=>e.attach())}detach(){this.displayParent.fileChoosers.forEach(e=>e.detach())}acceptView(e){return this.displayParent.rendered}}function Rr(i,e,t){return e=pP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pP(i){var e=fP(i,"string");return typeof e=="symbol"?e:String(e)}function fP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wi extends I{constructor(){super(),Rr(this,"acceptTypes",void 0),Rr(this,"maximumUploadSize",void 0),Rr(this,"multiSelect",void 0),Rr(this,"text",void 0),Rr(this,"uploadController",void 0),Rr(this,"files",void 0),Rr(this,"$fileInput",void 0),Rr(this,"$text",void 0),Rr(this,"dragAndDropHandler",void 0),this.acceptTypes=null,this.maximumUploadSize=wi.DEFAULT_MAXIMUM_UPLOAD_SIZE,this.multiSelect=!1,this.files=[],this.text=null}_init(e){super._init(e),this.uploadController=e.uploadController||e.parent}_render(){this.$fileInput=this.$parent.makeElement("<input>").attr("type","file").on("change",this._onFileChange.bind(this)),this.$container=this.$parent.appendDiv("file-input input-field"),this.$fileInput.appendTo(this.$container),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$text=this.$container.appendDiv("file-input-text")}_renderProperties(){super._renderProperties(),this._renderText(),this._renderAcceptTypes(),this._renderMultiSelect()}_renderEnabled(){super._renderEnabled(),this._installOrUninstallDragAndDropHandler(),this.$container.setTabbable(this.enabledComputed)}setText(e){this.setProperty("text",e)}_renderText(){let e=this.text||"";this.$text.text(e)}setAcceptTypes(e){this.setProperty("acceptTypes",e)}_renderAcceptTypes(){let e=this.acceptTypes||"";this.$fileInput.attr("accept",e)}setMultiSelect(e){this.setProperty("multiSelect",e)}_renderMultiSelect(){this.$fileInput.prop("multiple",this.multiSelect)}setMaximumUploadSize(e){this.setProperty("maximumUploadSize",e)}_remove(){Ae.uninstallDragAndDropHandler(this),super._remove()}_installOrUninstallDragAndDropHandler(){Ae.installOrUninstallDragAndDropHandler({target:this,onDrop:e=>{e.files.length>=1&&this._setFiles(e.files)},dropMaximumSize:()=>this.maximumUploadSize,validateFiles:(e,t)=>{}})}clear(){this._setFiles([]),this.setText(null),this.rendered&&this.$fileInput.val(null)}_setFiles(e){let t;if(e instanceof FileList?t=Yr.fileListToArray(e):t=f.ensure(e),f.equals(this.files,t))return;let r="";t.length>0&&(r=t[0].name),this.files=t,this.setText(r),this.trigger("change",{files:t})}upload(){return this.files.length===0?!0:this.session.uploadFiles(this.uploadController,this.files,void 0,this.maximumUploadSize)}browse(){this.$fileInput.trigger("click")}_onFileChange(e){let t=this.$fileInput[0].files;t.length&&this._setFiles(t)}_onMouseDown(e){!this.enabled||this.browse()}validateMaximumUploadSize(e){if(!Yr.validateMaximumUploadSize(e,this.maximumUploadSize))throw this.session.text("ui.FileSizeLimit",this.maximumUploadSize/1024/1024+"")}}Rr(wi,"DEFAULT_MAXIMUM_UPLOAD_SIZE",50*1024*1024);function mP(i,e,t){return e=gP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gP(i){var e=_P(i,"string");return typeof e=="symbol"?e:String(e)}function _P(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qm{constructor(){mP(this,"location",void 0),this.location=null}matches(e){return!1}activate(e){this.location=e}deactivate(){}}function bP(i,e,t){return e=yP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yP(i){var e=vP(i,"string");return typeof e=="symbol"?e:String(e)}function vP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}const Yt={routes:[],events:new On,currentRoute:null,defaultLocation:null,setDefaultLocation(i){Yt.defaultLocation="#"+i},prepare(i,e){y.startsWith(e,"#")||(e="#"+e),i.attr("href",e).on("mousedown",t=>(Yt.activate(e),!1))},activate(i){i||(i=new RegExp("[^/]*$").exec(document.location.href)[0]),(y.empty(i)||i==="/")&&(i=Yt.defaultLocation);let e,t=null;for(e=0;e<Yt.routes.length;e++)if(t=Yt.routes[e],t.matches(i)){if(t===Yt.currentRoute&&t.location===i){a().log.isDebugEnabled()&&a().log.debug("Route has not changed - do not activate route");return}Yt.currentRoute&&Yt.currentRoute.deactivate(),Yt.currentRoute=t,Yt.currentRoute.activate(i),window.location.replace(i),a().log.isInfoEnabled()&&a().log.info("router: activated route for location=",i),Yt.events.trigger("routeChange",new au(t));return}a().log.warn("router: no route registered for location=",i)},register(i){Yt.routes.push(i)},on(i,e){Yt.events.on(i,e)},updateLocation(i){let e="#"+i;window.location.replace(e)}};class au extends Gt{constructor(e){super({route:e}),bP(this,"route",void 0)}}window.addEventListener("popstate",i=>(Yt.activate(null),!1));function nn(i,e,t){return e=wP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wP(i){var e=TP(i,"string");return typeof e=="symbol"?e:String(e)}function TP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class du extends I{constructor(){super(),nn(this,"value",void 0),nn(this,"minValue",void 0),nn(this,"maxValue",void 0),nn(this,"step",void 0),nn(this,"$sliderInput",void 0),nn(this,"$sliderValue",void 0),this.value=null,this.minValue=null,this.maxValue=null,this.step=null,this.$sliderInput=null,this.$sliderValue=null}_init(e){super._init(e),this.value=e.value,this.minValue=e.minValue,this.maxValue=e.maxValue,this.step=e.step}_render(){this.$container=this.$parent.appendDiv("slider"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new hu(this)),this.$sliderInput=this.$container.appendElement("<input>","slider-input").attr("type","range").on("change",this._onValueChange.bind(this)).addClass(F.get().cssClassForEdge()),this.$sliderValue=this.$container.appendSpan("slider-value",this.value+"")}_renderProperties(){super._renderProperties(),this._renderValue(),this._renderMinValue(),this._renderMaxValue(),this._renderStep()}_remove(){super._remove(),this.$sliderInput=null,this.$sliderValue=null}_renderValue(){let e=u.nvl(this.value,0);this.$sliderInput.val(e),this.$sliderValue.text(e)}_renderMinValue(){this.minValue?this.$sliderInput.attr("min",this.minValue):this.$sliderInput.removeAttr("min")}_renderMaxValue(){this.maxValue?this.$sliderInput.attr("max",this.maxValue):this.$sliderInput.removeAttr("max")}_renderStep(){this.step?this.$sliderInput.attr("step",this.step):this.$sliderInput.removeAttr("step")}_onValueChange(e){let t=Number(this.$sliderInput.val());v.isNumber(t)||(t=u.nvl(this.maxValue,this.minValue,0)),this.setValue(t)}setValue(e){this.setProperty("value",e)}}class Ym extends He{constructor(){super(),this._addRemoteProperties(["value"])}}function SP(i,e,t){return e=CP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CP(i){var e=PP(i,"string");return typeof e=="symbol"?e:String(e)}function PP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hu extends te{constructor(e){super(),SP(this,"slider",void 0),this.slider=e}layout(e){let t=w.size(e);this.slider.$sliderInput.css("height",t.height),this.slider.$sliderValue.css("height",t.height)}}function xP(i,e,t){return e=FP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FP(i){var e=EP(i,"string");return typeof e=="symbol"?e:String(e)}function EP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class jm extends oe{constructor(){super(),xP(this,"ref",void 0),this.selected=!1,this.ref=null}_init(e){e.owner=e.parent,super._init(e)}_render(){super._render(),this.$container.addClass("button mode")}_renderProperties(){super._renderProperties(),this._renderSelected()}_renderSelected(){this.$container.select(this.selected)}doAction(){return this.prepareDoAction()?(this.selected||this.setSelected(!0),!0):!1}toggle(){this.selected||this.setSelected(!0)}_renderIconId(){super._renderIconId(),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}_renderText(){super._renderText(),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}_updateLabelAndIconStyle(){let e=!!this.text;this.get$Icon().toggleClass("with-label",e)}}class Xm extends bs{}function al(i,e,t){return e=AP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function AP(i){var e=DP(i,"string");return typeof e=="symbol"?e:String(e)}function DP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class uu extends I{constructor(){super(),al(this,"modes",void 0),al(this,"selectedMode",void 0),al(this,"$slider",void 0),al(this,"_isModeChanging",void 0),al(this,"_modePropertyChangeHandler",void 0),this._addWidgetProperties(["modes","selectedMode"]),this._addPreserveOnPropertyChangeProperties(["selectedMode"]),this.modes=[],this.selectedMode=null,this.$slider=null,this._isModeChanging=!1,this._modePropertyChangeHandler=this._onModePropertyChange.bind(this)}_init(e){super._init(e),this._setModes(this.modes),this._setSelectedMode(this.selectedMode)}_render(){this.$container=this.$parent.appendDiv("mode-selector"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new cu(this))}_renderProperties(){super._renderProperties(),this._renderSlider(),this._renderModes()}setModes(e){this.setProperty("modes",e)}_setModes(e){this.modes.forEach(t=>t.off("propertyChange",this._modePropertyChangeHandler)),this._setProperty("modes",f.ensure(e)),this.modes.forEach(t=>{t.on("propertyChange",this._modePropertyChangeHandler),t.selected&&this.setSelectedMode(t)})}_renderSlider(){this.$slider=this.$container.appendDiv("mode-slider")}_renderModes(){this.modes.forEach(e=>{e.render(),this._registerDragHandlers(e.$container)}),this._updateMarkers()}setSelectedMode(e){this.setProperty("selectedMode",e)}_setSelectedMode(e){this._isModeChanging=!0,this.selectedMode&&this.selectedMode!==e&&this.selectedMode.setSelected(!1),e&&!e.selected&&e.setSelected(!0),this._setProperty("selectedMode",e),this._isModeChanging=!1,this._updateMarkers()}_onModePropertyChange(e){e.propertyName==="selected"&&!this._isModeChanging?this.setSelectedMode(e.newValue?e.source:null):e.propertyName==="visible"?this._updateMarkers():e.propertyName==="enabled"&&this._updateSlider()}_updateMarkers(){let e=[],t=-1;this.modes.forEach(r=>{r.rendered&&(r.$container.removeClass("first last after-selected"),r.isVisible()&&(e.push(r),r.selected&&(t=e.length-1)))}),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"),t>=0&&t<e.length-1&&e[t+1].$container.addClass("after-selected")),this._updateSlider()}_updateSlider(){if(!this.$slider)return;let e=0,t=0;this.selectedMode&&this.selectedMode.$container&&(e=w.position(this.selectedMode.$container).x,t=w.size(this.selectedMode.$container,{exact:!0}).width),this.$slider.cssLeft(e),this.$slider.cssWidth(t),this.$slider.setVisible(this.selectedMode&&this.selectedMode.$container&&this.selectedMode.enabled)}_registerDragHandlers(e){let t="mode-selector-dragging",r=n=>this.enabledComputed&&this.selectedMode&&this.selectedMode.$container===e&&this.modes.filter(l=>l.isVisible()&&l.enabled).length>1,s=n=>{let l=this.$container.width()-e.outerWidth(),d=0,h=Math.max(Math.min(n.newLeft,l),d);return this.$container.children().addClass(t),h!==n.originalLeft&&this.$slider.cssLeft(h),h},o=n=>{this.$container.children().removeClass(t);let l=this._computeNewSelectedMode(n);!l||l===this.selectedMode||!l.enabled?this._updateSlider():this.setSelectedMode(l)};lt.onSwipe(e,t,r,s,o)}_computeNewSelectedMode(e){return e.direction===0||Math.abs(e.deltaX)<=5?this.selectedMode:e.direction<0?this._findModeByPos(e.newLeft):this._findModeByPos(e.newLeft+this.$slider.width())}_findModeByPos(e){let t=this.modes.filter(r=>r.isVisible());for(let r=t.length-1;r>=0;r--){let s=t[r],o=Math.floor(w.position(s.$container).x);if(e>=o){let n=w.size(s.$container).width,l=o+n;if(e<=l)return s}}return null}findModeById(e){return f.find(this.modes,t=>t.id===e)}findModeByRef(e){return f.find(this.modes,t=>t.ref===e)}selectModeById(e){this.setSelectedMode(this.findModeById(e))}selectModeByRef(e){this.setSelectedMode(this.findModeByRef(e))}}function MP(i,e,t){return e=$P(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $P(i){var e=RP(i,"string");return typeof e=="symbol"?e:String(e)}function RP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class cu extends te{constructor(e){super(),MP(this,"modeSelector",void 0),this.modeSelector=e}layout(e){super.layout(e),this.modeSelector.$slider&&this.modeSelector.$slider.setVisible(!1),this.modeSelector._updateSlider()}preferredLayoutSize(e,t){let r=super.preferredLayoutSize(e,t),s=this.modeSelector.$container.attr("style");this.modeSelector.$container.css({width:"auto",height:"auto"});let o=0;return this.modeSelector.modes.filter(n=>n.rendered).forEach(n=>{let l=n.$container.attr("style");n.$container.css("flex","none");let d=n.htmlComp.prefSize().width;d>o&&(o=d),n.$container.attrOrRemove("style",l)}),this.modeSelector.$container.attrOrRemove("style",s),r.width=o*this.modeSelector.modes.length+this.modeSelector.htmlComp.insets().horizontal(),r}}function j(i,e,t){return e=LP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LP(i){var e=IP(i,"string");return typeof e=="symbol"?e:String(e)}function IP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Y extends I{constructor(){super(),j(this,"animateOpening",void 0),j(this,"askIfNeedSave",void 0),j(this,"askIfNeedSaveText",void 0),j(this,"data",void 0),j(this,"displayViewId",void 0),j(this,"displayHint",void 0),j(this,"maximized",void 0),j(this,"headerVisible",void 0),j(this,"modal",void 0),j(this,"displayParent",void 0),j(this,"dialogs",void 0),j(this,"views",void 0),j(this,"messageBoxes",void 0),j(this,"fileChoosers",void 0),j(this,"focusedElement",void 0),j(this,"closable",void 0),j(this,"cacheBounds",void 0),j(this,"cacheBoundsKey",void 0),j(this,"resizable",void 0),j(this,"movable",void 0),j(this,"rootGroupBox",void 0),j(this,"saveNeeded",void 0),j(this,"saveNeededVisible",void 0),j(this,"formController",void 0),j(this,"messageBoxController",void 0),j(this,"fileChooserController",void 0),j(this,"closeKeyStroke",void 0),j(this,"showOnOpen",void 0),j(this,"initialFocus",void 0),j(this,"renderInitialFocusEnabled",void 0),j(this,"popupWindow",void 0),j(this,"title",void 0),j(this,"subTitle",void 0),j(this,"iconId",void 0),j(this,"status",void 0),j(this,"uiCssClass",void 0),j(this,"lifecycle",void 0),j(this,"detailForm",void 0),j(this,"$statusIcons",void 0),j(this,"$header",void 0),j(this,"$statusContainer",void 0),j(this,"$close",void 0),j(this,"$saveNeeded",void 0),j(this,"$icon",void 0),j(this,"$title",void 0),j(this,"$subTitle",void 0),j(this,"$dragHandle",void 0),j(this,"_glassPaneRenderer",void 0),j(this,"_preMaximizedBounds",void 0),j(this,"_resizeHandler",void 0),j(this,"_windowResizeHandler",void 0),this._addWidgetProperties(["rootGroupBox","views","dialogs","initialFocus","messageBoxes","fileChoosers"]),this._addPreserveOnPropertyChangeProperties(["initialFocus"]),this.animateOpening=!0,this.askIfNeedSave=!0,this.askIfNeedSaveText=null,this.data={},this.displayViewId=null,this.displayHint=Y.DisplayHint.DIALOG,this.displayParent=null,this.maximized=!1,this.headerVisible=null,this.modal=!0,this.logicalGrid=u.create(pu),this.dialogs=[],this.views=[],this.messageBoxes=[],this.fileChoosers=[],this.focusedElement=null,this.closable=!0,this.cacheBounds=!1,this.cacheBoundsKey=null,this.resizable=!0,this.movable=!0,this.rootGroupBox=null,this.saveNeeded=!1,this.saveNeededVisible=!1,this.formController=null,this.messageBoxController=null,this.fileChooserController=null,this.closeKeyStroke=null,this.showOnOpen=!0,this.initialFocus=null,this.renderInitialFocusEnabled=!0,this.popupWindow=null,this.title=null,this.subTitle=null,this.iconId=null,this.$statusIcons=[],this.$header=null,this.$statusContainer=null,this.$close=null,this.$saveNeeded=null,this.$icon=null,this.$title=null,this.$subTitle=null,this.$dragHandle=null,this._glassPaneRenderer=null,this._preMaximizedBounds=null,this._resizeHandler=this._onResize.bind(this),this._windowResizeHandler=this._onWindowResize.bind(this)}_init(e){super._init(e),this.resolveTextKeys(["title","askIfNeedSaveText"]),this.resolveIconIds(["iconId"]),this._setDisplayParent(this.displayParent),this._setViews(this.views),this.formController=u.create(ml,{displayParent:this,session:this.session}),this.messageBoxController=new gl(this,this.session),this.fileChooserController=new ll(this,this.session),this._setRootGroupBox(this.rootGroupBox),this._setStatus(this.status),this.cacheBoundsKey=u.nvl(e.cacheBoundsKey,this.objectType),this._installLifecycle(),this._setClosable(this.closable)}_createKeyStrokeContext(){return new Oe}_render(){this._renderForm()}_renderProperties(){super._renderProperties(),this._renderMaximized(),this._renderMovable(),this._renderResizable(),this._renderHeaderVisible(),this._renderCssClass(),this._renderModal(),this._installFocusContext(),this.renderInitialFocusEnabled&&this.renderInitialFocus()}_postRender(){super._postRender(),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this._glassPaneRenderer&&this._glassPaneRenderer.renderGlassPanes()}_destroy(){super._destroy(),this._glassPaneRenderer&&(this._glassPaneRenderer=null)}_remove(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null),this._uninstallFocusContext(),this._removeHeader(),this.$dragHandle=null,super._remove()}_renderForm(){let e;this.$container=this.$parent.appendDiv("form").data("model",this),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=S.install(this.$container,this.session),this.isDialog()?(this.$container.addClass("dialog"),e=new br(this),this.htmlComp.validateRoot=!0,this.$container[0].addEventListener("mousedown",this._onDialogMouseDown.bind(this),!0)):(this.isPopupWindow()&&this.$container.addClass("popup-window"),e=new dl(this)),this.htmlComp.setLayout(e),this.rootGroupBox.render()}setModal(e){this.setProperty("modal",e)}_renderModal(){this.parent instanceof _n||(this.modal&&!this._glassPaneRenderer?(this._glassPaneRenderer=new js(this),this._glassPaneRenderer.renderGlassPanes()):!this.modal&&this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null))}_installLifecycle(){this.lifecycle=this._createLifecycle(),this.lifecycle.handle("load",this._onLifecycleLoad.bind(this)),this.lifecycle.handle("save",this._onLifecycleSave.bind(this)),this.lifecycle.on("postLoad",this._onLifecyclePostLoad.bind(this)),this.lifecycle.on("reset",this._onLifecycleReset.bind(this)),this.lifecycle.on("close",this._onLifecycleClose.bind(this))}_createLifecycle(){return u.create(mu,{widget:this,askIfNeedSave:this.askIfNeedSave,askIfNeedSaveText:this.askIfNeedSaveText})}open(){return this.load().then(()=>{this.destroyed||this.showOnOpen&&this.show()})}load(){return this.lifecycle.load()}whenLoad(){return this.when("load")}_onLifecycleLoad(){try{return this._load().then(e=>{this.destroyed||(this.setData(e),this.importData(),this.trigger("load"))}).catch(e=>this._handleLoadError(e))}catch(e){return this._handleLoadError(e)}}_handleLoadError(e){throw this.close(),e}_load(){return a().resolvedPromise().then(()=>this.data)}whenPostLoad(){return this.when("postLoad")}_onLifecyclePostLoad(){return this._postLoad().then(()=>{this.trigger("postLoad")})}_postLoad(){return a().resolvedPromise()}setData(e){this.setProperty("data",e)}importData(){}exportData(){return null}ok(){return this.lifecycle.ok()}save(){return this.lifecycle.save()}whenSave(){return this.when("save")}_onLifecycleSave(){let e=this.exportData();return this._save(e).then(t=>(this.setData(e),this.trigger("save"),t))}_validate(){return E.ok()}_save(e){return a().resolvedPromise()}reset(){return this.lifecycle.reset()}whenReset(){return this.when("reset")}_onLifecycleReset(){this.trigger("reset")}cancel(){return this.lifecycle.cancel()}close(){return this.lifecycle.close()}whenClose(){return this.when("close")}_onLifecycleClose(){let e=new Gt;this.trigger("close",e),e.defaultPrevented||this._close()}_close(){this.hide(),this.destroy()}abort(){let e=new Gt;this.trigger("abort",e),e.defaultPrevented||this._abort()}whenAbort(){return this.when("abort")}_abort(){let e=this.rootGroupBox.controls;e=e.concat(this.rootGroupBox.menus),e.filter(r=>{let s=r.enabled;return r.enabledComputed!==void 0&&(s=r.enabledComputed),r.visible&&s&&r.systemType}).some(r=>r.systemType===Le.SystemType.CLOSE)?this.close():this.cancel(),this._afterAbort()}_afterAbort(){!this.destroyed&&this.isShown()&&this.activate()}revealInvalidField(e){!e||this._revealInvalidField(e)}_revealInvalidField(e){let t=this._createRevealInvalidFieldEvent(e);this.trigger("revealInvalidField",t),!t.defaultPrevented&&e.reveal()}_createRevealInvalidFieldEvent(e){return new Gt({validationResult:e})}_createCloseKeyStroke(){return new na(this,()=>this.$close)}_setClosable(e){this._setProperty("closable",e),this.closable?(this.closeKeyStroke=this._createCloseKeyStroke(),this.keyStrokeContext.registerKeyStroke(this.closeKeyStroke)):this.keyStrokeContext.unregisterKeyStroke(this.closeKeyStroke)}setClosable(e){this.setProperty("closable",e)}_renderClosable(){if(!!this.$header)if(this.$container.toggleClass("closable"),this.closable){if(this.$close)return;this.$close=this.$statusContainer.appendDiv("status closer").on("click",this._onCloseIconClick.bind(this))}else{if(!this.$close)return;this.$close.remove(),this.$close=null}}_onCloseIconClick(){this.abort()}setResizable(e){this.setProperty("resizable",e)}_renderResizable(){this.resizable&&this.isDialog()&&!this.maximized?this.$container.resizable().on("resize",this._resizeHandler):this.$container.unresizable().off("resize",this._resizeHandler)}_onResize(e){let t=this.htmlComp.layout,r=t.autoSize;return t.autoSize=!1,this.htmlComp.revalidateLayout(),t.autoSize=r,this.updateCacheBounds(),!1}setMovable(e){this.setProperty("movable",e)}_renderMovable(){if(this.movable&&this.isDialog()&&!this.maximized){if(this.$dragHandle)return;this.$dragHandle=this.$container.prependDiv("drag-handle"),this.$container.draggable(this.$dragHandle,a().throttle(this._onMove.bind(this),1e3/60))}else{if(!this.$dragHandle)return;this.$container.undraggable(this.$dragHandle),this.$dragHandle.remove(),this.$dragHandle=null}}_onDialogMouseDown(){this.activate()}activate(){this.session.desktop.activateForm(this)}show(){this.session.desktop.showForm(this)}hide(){this.session.desktop.hideForm(this)}isShown(){return this.session.desktop.isFormShown(this)}_renderHeader(){this.$header=this.$container.prependDiv("header"),this.$statusContainer=this.$header.appendDiv("status-container"),this.$icon=this.$header.appendDiv("icon-container"),this.$title=this.$header.appendDiv("title"),G.installForEllipsis(this.$title,{parent:this}),this.$subTitle=this.$header.appendDiv("sub-title"),G.installForEllipsis(this.$subTitle,{parent:this}),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderStatus(),this._renderClosable(),this._renderSaveNeeded()}_removeHeader(){this.$title&&G.uninstall(this.$title),this.$subTitle&&G.uninstall(this.$subTitle),this.$header&&(this.$header.remove(),this.$header=null),this.$title=null,this.$subTitle=null,this.$statusContainer=null,this.$icon=null,this.$close=null,this.$saveNeeded=null}setRootGroupBox(e){this.setProperty("rootGroupBox",e)}_setRootGroupBox(e){this._setProperty("rootGroupBox",e),this.rootGroupBox&&this.rootGroupBox.setMainBox(!0)}_renderSaveNeeded(){if(!!this.$header){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$close?this.$saveNeeded=this.$close.beforeDiv("status save-needer"):this.$saveNeeded=this.$statusContainer.appendDiv("status save-needer")}else{if(this.$container.removeClass("save-needed"),!this.$saveNeeded)return;this.$saveNeeded.remove(),this.$saveNeeded=null}this.invalidateLayoutTree()}}setAskIfNeedSave(e){this.setProperty("askIfNeedSave",e),this.lifecycle&&this.lifecycle.setAskIfNeedSave(e)}setDisplayViewId(e){this.setProperty("displayViewId",e)}setDisplayHint(e){this.setProperty("displayHint",e)}setSaveNeededVisible(e){this.setProperty("saveNeededVisible",e)}_renderSaveNeededVisible(){this._renderSaveNeeded()}_renderCssClass(e,t){e=e||this.cssClass,this.$container.removeClass(t),this.$container.addClass(e),this.invalidateLayoutTree()}setStatus(e){this.setProperty("status",e)}_setStatus(e){e=E.ensure(e),this._setProperty("status",e)}_renderStatus(){if(!!this.$header){if(this.$statusIcons.forEach(e=>{e.remove()}),this.$statusIcons=[],this.status){let e=this.status.asFlatList(),t;e.forEach(r=>{t=this._renderSingleStatus(r,t),t&&this.$statusIcons.push(t)})}this.invalidateLayoutTree()}}_renderSingleStatus(e,t){if(e&&e.iconId){let r=this.$statusContainer.appendIcon(e.iconId,"status");return e.cssClass()&&r.addClass(e.cssClass()),r.prependTo(this.$statusContainer),r}return t}addStatus(e){if(!e)return;const t=this.status&&this.status.children,r=new E({children:t});r.addStatus(e),this.setStatus(r)}removeStatus(e){if(!(!this.status||!e)){if(this.status.equals(e)){this.setStatus(null);return}if(this.status.containsStatusByPredicate(t=>e.equals(t))){const t=this.status.clone();t.removeAllStatusByPredicate(r=>e.equals(r)),this.setStatus(t)}}}getNotificationBadgeText(){const e=this._getNotificationBadgeStatus();if(e)return e.message}setNotificationBadgeText(e){this.removeStatus(this._getNotificationBadgeStatus()),e&&this.addStatus(new Kr({message:e,code:Y._NOTIFICATION_BADGE_STATUS_CODE}))}_getNotificationBadgeStatus(){if(!!this.status)return this.status.asFlatList().find(e=>Y._NOTIFICATION_BADGE_STATUS_CODE===e.code)}setShowOnOpen(e){this.setProperty("showOnOpen",e)}_updateTitleForDom(){let e=this.title;if(!e&&this.closable&&(e=y.plainText("&nbsp;")),e||this.subTitle){let s=t(this.$container,"title-box");e?t(s,"title").text(e).icon(this.iconId):r(s,"title"),y.hasText(e)?t(s,"sub-title").text(this.subTitle):r(s,"sub-title")}else r(this.$container,"title-box");function t(s,o){let n=s.children("."+o);return n.length===0&&(n=this.$parent.appendDiv(o)),n}function r(s,o){s.children("."+o).remove()}}isDialog(){return this.displayHint===Y.DisplayHint.DIALOG}isPopupWindow(){return this.displayHint===Y.DisplayHint.POPUP_WINDOW}isView(){return this.displayHint===Y.DisplayHint.VIEW}_onMove(e){this.trigger("move",e),this.updateCacheBounds()}moveTo(e){this.$container.cssPosition(e),this.trigger("move",{left:e.x,top:e.y}),this.updateCacheBounds()}position(){let e,t=this.prefBounds();if(t){e=t.point();let r=this.$container.windowSize(),s=this.htmlComp.margins(),o=0,n=0,l=r.width-t.width-s.horizontal(),d=r.height-t.height-s.vertical();e.x=Math.max(o,Math.min(l,e.x)),e.y=Math.max(n,Math.min(d,e.y))}else e=br.positionContainerInWindow(this.$container);this.moveTo(e)}updateCacheBounds(){this.cacheBounds&&!this.maximized&&this.storeCacheBounds(this.htmlComp.bounds())}appendTo(e){this.$container.appendTo(e)}setHeaderVisible(e){this.setProperty("headerVisible",e)}_renderHeaderVisible(){let e=this.headerVisible===null?this.isDialog():this.headerVisible;e&&!this.$header?this._renderHeader():!e&&this.$header&&this._removeHeader();let t=this.$header&&this.$header.hasClass("no-title");this.$container.toggleClass("header-visible",e&&!t),this.invalidateLayoutTree()}setTitle(e){this.setProperty("title",e)}_renderTitle(){this.$header&&(this.$title.text(this.title),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)),this.invalidateLayoutTree()}setSubTitle(e){this.setProperty("subTitle",e)}_renderSubTitle(){this.$header&&(this.$subTitle.text(this.subTitle),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)),this.invalidateLayoutTree()}setIconId(e){this.setProperty("iconId",e)}_renderIconId(){this.$header&&(this.$icon.icon(this.iconId),this.invalidateLayoutTree())}_setViews(e){e&&e.forEach(t=>{t.setDisplayParent(this)}),this._setProperty("views",e)}setDisabledStyle(e){this.rootGroupBox.setDisabledStyle(e)}setDisplayParent(e){this.setProperty("displayParent",e)}_setDisplayParent(e){e instanceof Y&&e.parent instanceof _n&&e.isView()&&(e=Y.findNonWrappedForm(e)),this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}setMaximized(e){this.setProperty("maximized",e)}_renderMaximized(){!this.isDialog()||(this.maximized&&this.htmlComp.layouted&&(this._preMaximizedBounds=this.htmlComp.bounds()),this._maximize(),this.maximized||(this._preMaximizedBounds=null),this.maximized?this.$container.window().on("resize",this._windowResizeHandler):this.$container.window().off("resize",this._windowResizeHandler),this.rendered&&(this._renderMovable(),this._renderResizable()))}_onWindowResize(){this.maximized&&this._maximize()}_maximize(){if(!this.rendered)return;let e=this.htmlComp.layout,t=e.shrinkEnabled;e.shrinkEnabled=!0,this.revalidateLayoutTree(),this.position(),e.shrinkEnabled=t}prefBounds(){return this.maximized?null:this._preMaximizedBounds?this._preMaximizedBounds:this.cacheBounds?this.readCacheBounds():null}_attach(){this.$parent.append(this.$container),this.isView()&&this.invalidateLayoutTree(!1),(this.isView()||this.isDialog())&&!this.detailForm&&this.session.desktop._setFormActivated(this),super._attach()}_postAttach(){this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach(),super._attach()}_detach(){this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach(),this.$container.detach(),super._detach()}renderInitialFocus(){let e=!1;if(this.initialFocus)e=this.initialFocus.focus();else if(!this.$container.isOrHas(this.$container.activeElement())){let t=this.session.focusManager;e=t.requestFocusIfReady(t.findFirstFocusableElement(this.$container))}if(e){let t=this.$container.activeElement().scrollParent();t.scrollTop(0),t.scrollLeft(0)}}_initialFocusElement(){let e;return this.initialFocus&&(e=this.initialFocus.getFocusableElement()),e||(e=this.session.focusManager.findFirstFocusableElement(this.$container)),e}_installFocusContext(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.installFocusContext(this.$container,It.NONE)}_uninstallFocusContext(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.uninstallFocusContext(this.$container)}touch(){this.rootGroupBox.touch()}inFront(){return this.rendered&&this.attached}visitFields(e){this.rootGroupBox.visitFields(e)}visitDisplayChildren(e,t){t||(t=s=>!0);let r=s=>{e(s),s instanceof Y&&s.visitDisplayChildren(e,t)};this.dialogs.filter(t).forEach(r,this),this.messageBoxes.filter(t).forEach(r,this),this.fileChoosers.filter(t).forEach(r,this)}storeCacheBounds(e){if(this.cacheBounds){let t="scout:formBounds:"+this.cacheBoundsKey;Pe.setItemToLocalStorage(t,JSON.stringify(e))}}readCacheBounds(){if(!this.cacheBounds)return null;let e="scout:formBounds:"+this.cacheBoundsKey,t=Pe.getItemFromLocalStorage(e);return t?(t=JSON.parse(t),new re(t.x,t.y,t.width,t.height)):null}static findForm(e){let t=e.parent;for(;t&&!(t instanceof Y);)t=t.parent;return t}static findNonWrappedForm(e){if(!e)return null;let t=null;return e.findParent(r=>{if(r instanceof Y)return t=r,!(t.parent instanceof _n)}),t}}j(Y,"DisplayHint",{DIALOG:"dialog",POPUP_WINDOW:"popupWindow",VIEW:"view"}),j(Y,"_NOTIFICATION_BADGE_STATUS_CODE",197821);class Pa extends He{_initModel(e,t){let r=super._initModel(e,t);return r.logicalGrid=null,r}_onWidgetEvent(e){e.type==="abort"?this._onWidgetAbort(e):e.type==="close"?this._onWidgetClose(e):super._onWidgetEvent(e)}_onWidgetAbort(e){e.preventDefault(),this._send("formClosing"),this.session.onRequestsDone(()=>{this.widget&&this.widget._afterAbort()})}_onWidgetClose(e){this._send("close")}onModelAction(e){e.type==="requestFocus"?this._onRequestFocus(e):e.type==="requestInput"?this._onRequestInput(e):super.onModelAction(e)}_onRequestFocus(e){this.session.getOrCreateWidget(e.formField,this.widget).focus()}_onRequestInput(e){this.session.getOrCreateWidget(e.formField,this.widget).requestInput()}}class pu extends ea{_validate(e){e.rootGroupBox.gridData=ze.createFromHints(e.rootGroupBox)}}function kP(i,e,t){return e=BP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function BP(i){var e=OP(i,"string");return typeof e=="symbol"?e:String(e)}function OP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class dl extends te{constructor(e){super(),kP(this,"form",void 0),this.form=e}layout(e){let t=S.get(e),r=this._htmlRootGroupBox(),s;this.form.validateLogicalGrid(),s=t.availableSize().subtract(t.insets()).subtract(r.margins()),s.height-=this._headerHeight(),a().log.isTraceEnabled()&&a().log.trace("(FormLayout#layout) rootGbSize="+s),r.setSize(s)}preferredLayoutSize(e,t){t=t||{};let r=S.get(e),s=this._htmlRootGroupBox(),o;this.form.validateLogicalGrid();let n=this._headerHeight();return t.heightHint&&(t.heightHint-=n),o=s.prefSize(t).add(r.insets()).add(s.margins()),o.height+=n,o}_htmlRootGroupBox(){let e=this.form.$container.children(".root-group-box");return S.get(e)}_headerHeight(){let e=this.form.$header;return e&&e.css("position")!=="absolute"?w.prefSize(e,!0).height:0}}class fu extends Qs{constructor(e){super(e)}handle(e){this.field.toggle()}_postRenderKeyBox(e,t){if(this.field.iconId){let r=e.find(".icon").width(),s=e.find(".key-box").outerWidth(),o=e.cssPaddingLeft(),n=r/2-s/2+o;e.find(".key-box").cssLeft(n)}}}function io(i,e,t){return e=HP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HP(i){var e=NP(i,"string");return typeof e=="symbol"?e:String(e)}function NP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class qr extends le{constructor(){super(),io(this,"form",void 0),io(this,"popupStyle",void 0),io(this,"popupClosable",void 0),io(this,"popupMovable",void 0),io(this,"popupResizable",void 0),io(this,"_formDestroyHandler",void 0),this.form=null,this.toggleAction=!0,this.popupStyle=null,this.popupClosable=!1,this.popupMovable=!1,this.popupResizable=!1,this._addWidgetProperties("form"),this._formDestroyHandler=this._onFormDestroy.bind(this)}_init(e){super._init(e),this.popupStyle||(this.session.userAgent.deviceType===F.Type.MOBILE?this.popupStyle=qr.PopupStyle.MOBILE:this.popupStyle=qr.PopupStyle.DEFAULT),this._setSelected(this.selected),this._setForm(this.form)}_renderForm(){!this.rendered||this._renderSelected()}clone(e,t){return e=e||{},e.form=this.form,super.clone(e,t)}setForm(e){this.setProperty("form",e)}_setForm(e){this.form&&this.form.off("destroy",this._formDestroyHandler),this._setProperty("form",e),this.form&&(this._adaptForm(this.form),this.form.one("destroy",this._formDestroyHandler))}_adaptForm(e){e.setDisplayHint(Y.DisplayHint.VIEW),e.setModal(!1),e.setClosable(!1)}_onFormDestroy(e){(!this.popup||!this.popup.destroying)&&this.setSelected(!1),this.setForm(null);let t=this.findParent(r=>r instanceof mt);t&&!(t.destroying||t.removing)&&t.close()}_setSelected(e){this._setProperty("selected",e),this.popupStyle===qr.PopupStyle.MOBILE&&this._doActionTogglesPopup()&&(this.selected?this._openPopup():this._closePopup())}_renderSelected(){super._renderSelected(),this.$container.addClass("has-popup")}_canOpenPopup(){return this._closeOtherPopupsForSameMenu(),super._canOpenPopup()}_closeOtherPopupsForSameMenu(){this._findOtherPopupsForSameMenu().forEach(e=>{if(e.isRemovalPending()){e.removeImmediately();return}if(e._rendered){let t=e.animateRemoval;e.animateRemoval=!1,e.close(),e.animateRemoval=t}})}_findOtherPopupsForSameMenu(){return this.session.desktop.getPopups().filter(e=>e===this.popup||e.has(this)?!1:this._popupBelongsToMenu(e))}_popupBelongsToMenu(e){return!!(e.parent.original()===this.original()||e.findChild(t=>t.original()===this.original()))}_createPopup(){return this.form.rootGroupBox.setMenuBarPosition(Fe.MenuBarPosition.BOTTOM),this.popupStyle===qr.PopupStyle.MOBILE?u.create(Ah,{parent:this.session.desktop,content:this.form,title:this.form.title}):u.create(tn,{parent:this,content:this.form,anchor:this,closeOnAnchorMouseDown:!1,cssClass:"form-menu-popup",horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment,closable:this.popupClosable,movable:this.popupMovable,resizable:this.popupResizable})}_doActionTogglesPopup(){return!!this.form}_handleSelectedInEllipsis(){this.popupStyle!==qr.PopupStyle.MOBILE&&super._handleSelectedInEllipsis()}_createActionKeyStroke(){return new fu(this)}}io(qr,"PopupStyle",{DEFAULT:"default",MOBILE:"mobile"});class Jm extends il{}class mu extends su{constructor(){super(),this.validationFailedTextKey="FormValidationFailedTitle",this.emptyMandatoryElementsTextKey="FormEmptyMandatoryFieldsMessage",this.invalidElementsTextKey="FormInvalidFieldsMessage",this.saveChangesQuestionTextKey="FormSaveChangesQuestion"}init(e){u.assertParameter("widget",e.widget,Y),super.init(e)}_reset(){this.widget.visitFields(e=>{e instanceof ge&&e.resetValue()})}invalidElements(){let e=[],t=[];return this.widget.visitFields(r=>{let s=r.getValidationResult();if(!s.valid){if(!s.validByErrorStatus){t.push(s);return}s.validByMandatory||e.push(s)}}),{missingElements:e,invalidElements:t}}_invalidElementText(e){return y.plainText(e.label)}_missingElementText(e){return y.plainText(e.label)}_validateWidget(){return this.widget._validate()}_revealInvalidElement(e){this.widget.revealInvalidField(e)}markAsSaved(){this.widget.visitFields(e=>{e.markAsSaved()})}requiresSave(){let e=!1;return this.widget.visitFields(t=>{t.updateRequiresSave(),t.requiresSave&&(e=!0)}),e}}function VP(i,e,t){return e=WP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WP(i){var e=KP(i,"string");return typeof e=="symbol"?e:String(e)}function KP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ro extends le{constructor(){super(),VP(this,"systemType",void 0),this.systemType=null}}class gu extends ro{constructor(){super(),this.actionStyle=oe.ActionStyle.BUTTON,this.keyStroke="esc",this.systemType=Le.SystemType.CANCEL,this.inheritAccessibility=!1,this.preventDoubleClick=!0}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text("CancelButton"))}_doAction(){let e=this.getForm(),t=new Gt;this.trigger("action",t),t.defaultPrevented||e.cancel()}}class Qm extends ro{constructor(){super(),this.actionStyle=oe.ActionStyle.BUTTON,this.keyStroke="esc",this.systemType=Le.SystemType.CLOSE,this.inheritAccessibility=!1,this.preventDoubleClick=!0}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text("CloseButton"))}_doAction(){let e=this.getForm(),t=new Gt;this.trigger("action",t),t.defaultPrevented||e.close()}}class _u extends ro{constructor(){super(),this.actionStyle=oe.ActionStyle.BUTTON,this.keyStroke="enter",this.systemType=Le.SystemType.OK,this.preventDoubleClick=!0}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text("OkButton"))}_doAction(){let e=this.getForm(),t=new Gt;this.trigger("action",t),t.defaultPrevented||e.ok()}}class Zm extends ro{constructor(){super(),this.actionStyle=oe.ActionStyle.BUTTON,this.systemType=Le.SystemType.RESET,this.preventDoubleClick=!0}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text("ResetButton"))}_doAction(){let e=this.getForm(),t=new Gt;this.trigger("action",t),t.defaultPrevented||e.reset()}}class eg extends ro{constructor(){super(),this.actionStyle=oe.ActionStyle.BUTTON,this.keyStroke="enter",this.systemType=Le.SystemType.SAVE,this.preventDoubleClick=!0}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text("SaveButton"))}_doAction(){let e=this.getForm(),t=new Gt;this.trigger("action",t),t.defaultPrevented||e.save()}}function tg(i,e,t){return e=zP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zP(i){var e=GP(i,"string");return typeof e=="symbol"?e:String(e)}function GP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class br extends dl{constructor(e){super(e),tg(this,"autoSize",void 0),tg(this,"shrinkEnabled",void 0),this.autoSize=!0,this.shrinkEnabled=!1}layout(e){if(!this.autoSize){super.layout(e);return}let t,r=this.form.htmlComp,s=this.form.prefBounds(),o=r.margins(),n=e.windowSize();s?t=s:t=r.bounds();let l=this._calcSize(e,t,s);e.toggleClass("full-width",this.form.maximized||t.x===0&&o.horizontal()===0&&n.width===l.width).toggleClass("full-height",this.form.maximized||t.y===0&&o.vertical()===0&&n.height===l.height),r.layouted&&!this.shrinkEnabled&&(l.width=Math.max(l.width,t.width),l.height=Math.max(l.height,t.height)),w.setSize(e,l),super.layout(e)}_calcSize(e,t,r){let s,o=this.form.htmlComp,n=o.margins(),l=e.windowSize();return this.form.maximized?l:r?(s=r.dimension(),s=br.fitContainerInWindow(l,new Z,s,n),s):(s=this.preferredLayoutSize(e,{widthOnly:!0}),s=br.fitContainerInWindow(l,t.point(),s,n),s=this.preferredLayoutSize(e,{widthHint:s.width}).ceil(),s=br.fitContainerInWindow(l,t.point(),s,n),s)}static fitContainerInWindow(e,t,r,s){let o=e.width-s.horizontal()-t.x,n=e.height-s.vertical()-t.y,l=new A;return l.width=Math.min(o,r.width),l.height=Math.min(n,r.height),l}static positionContainerInWindow(e){let t=e.windowSize(),r=S.get(e).size(!0),s=(t.width-r.width)/2,o=(t.height-r.height)/2,n=o/5;return o-=n,s=Math.floor(s),o=Math.floor(o),new Z(s,o)}}function xa(i,e,t){return e=UP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UP(i){var e=qP(i,"string");return typeof e=="symbol"?e:String(e)}function qP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}let bu;class ne{constructor(){xa(this,"active",void 0),xa(this,"globalState",void 0),xa(this,"_responsiveHandlers",void 0),this.active=!0,this.globalState=null,this._responsiveHandlers=[]}init(){}destroy(){this._responsiveHandlers.forEach(e=>{e.destroy()})}setActive(e){this.active=e}setGlobalState(e){this.globalState=e}handleResponsive(e,t){if(!this.active||!e.responsiveHandler||!e.responsiveHandler.active())return!1;let r,s=e.responsiveHandler.state;return this.globalState?r=this.globalState:t<e.responsiveHandler.getCompactThreshold()&&e.responsiveHandler.acceptState(ne.ResponsiveState.COMPACT)?r=ne.ResponsiveState.COMPACT:(s===ne.ResponsiveState.COMPACT&&e.responsiveHandler.transform(ne.ResponsiveState.CONDENSED),t<e.responsiveHandler.getCondensedThreshold()&&e.responsiveHandler.acceptState(ne.ResponsiveState.CONDENSED)?r=ne.ResponsiveState.CONDENSED:r=ne.ResponsiveState.NORMAL),e.responsiveHandler.transform(r)}reset(e,t){!this.active||(!e.responsiveHandler||!e.responsiveHandler.active())&&!t||e.responsiveHandler.transform(ne.ResponsiveState.NORMAL,t)}registerHandler(e,t){e.responsiveHandler&&e.responsiveHandler.destroy(),e.responsiveHandler=t}unregisterHandler(e){e.responsiveHandler&&(e.responsiveHandler.destroy(),e.responsiveHandler=null)}static get(){return bu}}xa(ne,"ResponsiveState",{NORMAL:"normal",CONDENSED:"condensed",COMPACT:"compact"}),ie.addListener("prepare",()=>{bu||(bu=u.create(ne))});function Xi(i,e,t){return e=YP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function YP(i){var e=jP(i,"string");return typeof e=="symbol"?e:String(e)}function jP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fa{constructor(){Xi(this,"objectType",void 0),Xi(this,"widget",void 0),Xi(this,"compactThreshold",void 0),Xi(this,"condensedThreshold",void 0),Xi(this,"oldState",void 0),Xi(this,"state",void 0),Xi(this,"allowedStates",void 0),Xi(this,"transformations",void 0),Xi(this,"enabledTransformations",void 0),Xi(this,"_transformationsToApply",void 0),Xi(this,"_transformationsToReset",void 0),Xi(this,"_destroyHandler",void 0),this.widget=null,this.compactThreshold=-1,this.condensedThreshold=-1,this.oldState=ne.ResponsiveState.NORMAL,this.state=ne.ResponsiveState.NORMAL,this.allowedStates=[ne.ResponsiveState.NORMAL,ne.ResponsiveState.COMPACT],this.transformations=v.createMap(),this.enabledTransformations=v.createMap(),this._destroyHandler=this._onDestroy.bind(this)}init(e){a().extend(this,e),this.widget.one("destroy",this._destroyHandler)}destroy(){this.widget.off("destroy",this._destroyHandler)}getCompactThreshold(){return this.compactThreshold}getCondensedThreshold(){return this.condensedThreshold}active(){return!0}setAllowedStates(e){this.allowedStates=e}acceptState(e){return f.contains(this.allowedStates,e)}_registerTransformation(e,t){this.transformations[e]=t.bind(this)}_enableTransformation(e,t){let r=this.enabledTransformations[e];r||(r=[],this.enabledTransformations[e]=r),r.push(t)}_disableTransformation(e,t){f.remove(this.enabledTransformations[e],t)}_storeFieldProperty(e,t,r){e._setProperty("responsive-"+t,r)}_hasFieldProperty(e,t){return e.hasOwnProperty("responsive-"+t)}_getFieldProperty(e,t){return e["responsive-"+t]}transform(e,t){if(this.state===e&&!t)return!1;this.oldState=this.state,this.state=e;let r,s;return this.oldState!==this.state?(r=this.enabledTransformations[this.oldState]||[],s=this.enabledTransformations[this.state]||[]):(r=[],this.state!==ne.ResponsiveState.NORMAL&&f.pushAll(r,this.enabledTransformations[ne.ResponsiveState.NORMAL]),this.state!==ne.ResponsiveState.CONDENSED&&f.pushAll(r,this.enabledTransformations[ne.ResponsiveState.CONDENSED]),this.state!==ne.ResponsiveState.COMPACT&&f.pushAll(r,this.enabledTransformations[ne.ResponsiveState.COMPACT]),s=this.enabledTransformations[this.state]||[]),this._transformationsToApply=f.diff(s,r),this._transformationsToReset=f.diff(r,s),this._transform(),!0}_transform(){this._transformWidget(this.widget)}_transformWidget(e){this._transformationsToApply.forEach(t=>{this.transformations[t](e,!0)}),this._transformationsToReset.forEach(t=>{this.transformations[t](e,!1)})}_onDestroy(e){this.destroy()}}function Ea(i,e,t){return e=XP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XP(i){var e=JP(i,"string");return typeof e=="symbol"?e:String(e)}function JP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class $n extends Fa{constructor(){super(),Ea(this,"_compositeFields",void 0),Ea(this,"_formFieldAddedHandler",void 0),Ea(this,"_htmlPropertyChangeHandler",void 0),this._initDefaults(),this.allowedStates=[ne.ResponsiveState.NORMAL,ne.ResponsiveState.CONDENSED,ne.ResponsiveState.COMPACT],this._formFieldAddedHandler=this._onFormFieldAdded.bind(this),this._compositeFields=[],this._htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this)}_initDefaults(){this.compactThreshold=ue.get().formColumnWidth}_onHtmlEnvironmentPropertyChange(){this._initDefaults()}init(e){super.init(e);let t=$n.TransformationType,r=ne.ResponsiveState;this._registerTransformation(t.LABEL_POSITION_ON_FIELD,this._transformLabelPositionOnField),this._registerTransformation(t.LABEL_POSITION_ON_TOP,this._transformLabelPositionOnTop),this._registerTransformation(t.LABEL_VISIBILITY,this._transformLabelVisibility),this._registerTransformation(t.STATUS_POSITION_ON_TOP,this._transformStatusPosition),this._registerTransformation(t.STATUS_VISIBILITY,this._transformStatusVisibility),this._registerTransformation(t.VERTICAL_ALIGNMENT,this._transformVerticalAlignment),this._registerTransformation(t.GRID_COLUMN_COUNT,this._transformGridColumnCount),this._registerTransformation(t.HIDE_PLACE_HOLDER_FIELD,this._transformHidePlaceHolderField),this._registerTransformation(t.FIELD_SCALABLE,this._transformFieldScalable),this._registerTransformation(t.RADIO_BUTTON_GROUP_USE_UI_HEIGHT,this._transformRadioButtonGroupUseUiHeight),this._enableTransformation(r.CONDENSED,t.LABEL_POSITION_ON_TOP),this._enableTransformation(r.CONDENSED,t.LABEL_VISIBILITY),this._enableTransformation(r.CONDENSED,t.VERTICAL_ALIGNMENT),this._enableTransformation(r.CONDENSED,t.RADIO_BUTTON_GROUP_USE_UI_HEIGHT),this._enableTransformation(r.COMPACT,t.LABEL_POSITION_ON_TOP),this._enableTransformation(r.COMPACT,t.LABEL_VISIBILITY),this._enableTransformation(r.COMPACT,t.STATUS_POSITION_ON_TOP),this._enableTransformation(r.COMPACT,t.STATUS_VISIBILITY),this._enableTransformation(r.COMPACT,t.VERTICAL_ALIGNMENT),this._enableTransformation(r.COMPACT,t.GRID_COLUMN_COUNT),this._enableTransformation(r.COMPACT,t.HIDE_PLACE_HOLDER_FIELD),this._enableTransformation(r.COMPACT,t.FIELD_SCALABLE),this._enableTransformation(r.COMPACT,t.RADIO_BUTTON_GROUP_USE_UI_HEIGHT),ue.get().on("propertyChange",this._htmlPropertyChangeHandler),this.widget.visitFields(s=>{s instanceof xs&&(s.on("propertyChange",this._formFieldAddedHandler),this._compositeFields.push(s))})}destroy(){super.destroy(),this._compositeFields.forEach(e=>e.off("propertyChange",this._formFieldAddedHandler)),ue.get().off("propertyChange",this._htmlPropertyChangeHandler)}active(){return this.widget.responsive}getCondensedThreshold(){return this.condensedThreshold>0?this.condensedThreshold:this.widget.htmlComp.prefSize({widthOnly:!0}).width}_transform(){this.widget.visitFields(this._transformWidget.bind(this))}_transformWidget(e){if(e!==this.widget&&e instanceof Fe&&e.responsive!==null)return ye.SKIP_SUBTREE;if(!(e instanceof M))return;let t;e.htmlComp&&(e.htmlComp.suppressValidate=!0,t=e.htmlComp.getParent(),t&&(t.suppressValidate=!0)),super._transformWidget(e),e.htmlComp&&(e.htmlComp.suppressValidate=!1),t&&(t.suppressValidate=!1)}_transformLabelPositionOnField(e,t){e.parent instanceof vl||e instanceof Fs||e instanceof sd||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(M.LabelPosition.ON_FIELD)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}_transformLabelPositionOnTop(e,t){e.parent instanceof vl||e instanceof Fs||e instanceof sd||e.labelPosition===M.LabelPosition.ON_FIELD||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(M.LabelPosition.TOP)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}_transformLabelVisibility(e,t){e instanceof Fs&&(t?(this._storeFieldProperty(e,"labelVisible",e.labelVisible),e.setLabelVisible(!1)):this._hasFieldProperty(e,"labelVisible")&&e.setLabelVisible(this._getFieldProperty(e,"labelVisible")))}getGridData(e){return new ze(e.gridDataHints)}setGridData(e,t){e.setGridDataHints(t)}_transformStatusPosition(e,t){t?(this._storeFieldProperty(e,"statusPosition",e.statusPosition),e.setStatusPosition(M.StatusPosition.TOP)):this._hasFieldProperty(e,"statusPosition")&&e.setStatusPosition(this._getFieldProperty(e,"statusPosition"))}_transformStatusVisibility(e,t){t?(this._storeFieldProperty(e,"statusVisible",e.statusVisible),e.setStatusVisible(!1)):this._hasFieldProperty(e,"statusVisible")&&e.setStatusVisible(this._getFieldProperty(e,"statusVisible"))}_transformVerticalAlignment(e,t){let r=e instanceof Le&&e.displayStyle===Le.DisplayStyle.DEFAULT,s=e instanceof Fs,o=e.labelPosition===M.LabelPosition.ON_FIELD&&e.gridData&&e.gridData.h===1;if(!(r||s||o)||!e.gridData)return;let n=this.getGridData(e);t?(this._storeFieldProperty(e,"fillVertical",n.fillVertical),this._storeFieldProperty(e,"verticalAlignment",n.verticalAlignment),n.fillVertical=!1,n.verticalAlignment=1):(this._hasFieldProperty(e,"fillVertical")&&(n.fillVertical=this._getFieldProperty(e,"fillVertical")),this._hasFieldProperty(e,"verticalAlignment")&&(n.verticalAlignment=this._getFieldProperty(e,"verticalAlignment"))),this.setGridData(e,n)}_transformGridColumnCount(e,t){e instanceof Fe&&(t?(this._storeFieldProperty(e,"gridColumnCount",e.gridColumnCount),e.setGridColumnCount(1)):this._hasFieldProperty(e,"gridColumnCount")&&e.setGridColumnCount(this._getFieldProperty(e,"gridColumnCount")))}_transformHidePlaceHolderField(e,t){e instanceof ad&&(t?(this._storeFieldProperty(e,"visible",e.visible),e.setVisible(!1)):this._hasFieldProperty(e,"visible")&&e.setVisible(this._getFieldProperty(e,"visible")))}_transformFieldScalable(e,t){if(e.parent instanceof vl)return;let r=this.getGridData(e);t&&r.weightX===0?(this._storeFieldProperty(e,"weightX",r.weightX),r.weightX=1):t||this._hasFieldProperty(e,"weightX")&&(r.weightX=this._getFieldProperty(e,"weightX")),this.setGridData(e,r)}_transformRadioButtonGroupUseUiHeight(e,t){if(!(e instanceof ds))return;let r=this.getGridData(e);t&&!r.useUiHeight?(this._storeFieldProperty(e,"useUiHeight",r.useUiHeight),r.useUiHeight=!0):t||this._hasFieldProperty(e,"useUiHeight")&&(r.useUiHeight=this._getFieldProperty(e,"useUiHeight")),this.setGridData(e,r)}_onFormFieldAdded(e){this.state!==ne.ResponsiveState.NORMAL&&(e.propertyName==="fields"||e.propertyName==="tabItems")&&f.diff(e.newValue,e.oldValue).forEach(r=>r.visitFields(this._transformWidget.bind(this)))}}Ea($n,"TransformationType",{LABEL_POSITION_ON_FIELD:"labelPositionOnField",LABEL_POSITION_ON_TOP:"labelPositionOnTop",LABEL_VISIBILITY:"labelVisibility",STATUS_POSITION_ON_TOP:"statusPositionOnTop",STATUS_VISIBILITY:"statusVisibility",VERTICAL_ALIGNMENT:"verticalAlignment",GRID_COLUMN_COUNT:"gridColumnCount",HIDE_PLACE_HOLDER_FIELD:"hidePlaceHolderField",FIELD_SCALABLE:"fieldScalable",RADIO_BUTTON_GROUP_USE_UI_HEIGHT:"radioButtonGroupUseUiHeight"});class ig extends Fa{constructor(){super(),this.compactThreshold=500,this.allowedStates=[ne.ResponsiveState.NORMAL,ne.ResponsiveState.COMPACT]}init(e){super.init(e),this._registerTransformation("navigationVisible",this._transformNavigationVisible),this._enableTransformation(ne.ResponsiveState.COMPACT,"navigationVisible")}_transformNavigationVisible(e,t){t?(this._storeFieldProperty(e,"navigationVisible",e.navigationVisible),e.setNavigationVisible(!1)):this._hasFieldProperty(e,"navigationVisible")&&e.setNavigationVisible(this._getFieldProperty(e,"navigationVisible"))}}function ws(i,e,t){return e=QP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QP(i){var e=ZP(i,"string");return typeof e=="symbol"?e:String(e)}function ZP(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Aa extends Y{constructor(){super(),ws(this,"outline",void 0),ws(this,"nodes",void 0),ws(this,"tileOverviewTitle",void 0),ws(this,"scrollable",void 0),ws(this,"pageTileGrid",void 0),ws(this,"contentHtmlComp",void 0),ws(this,"$content",void 0),ws(this,"_desktopNavigationVisibilityChangeHandler",void 0),this.outline=null,this.nodes=null,this.tileOverviewTitle=null,this.scrollable=!0,this._addWidgetProperties(["pageTileGrid"]),this.$content=null,this.$title=null,this._desktopNavigationVisibilityChangeHandler=this._onDesktopNavigationVisibilityChange.bind(this)}_init(e){super._init(e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid()),this.addCssClass("dimmed-background")}_renderForm(){super._renderForm(),this.htmlComp.setLayout(new Ri),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=S.install(this.$content,this.session),this.contentHtmlComp.setLayout(new Ri({stretch:this.outline.compact})),this.$title=this.$content.appendDiv("tile-overview-title").text(this.tileOverviewTitle),S.install(this.$title,this.session),this.$title.cssMaxHeight(this.$title.cssHeight()),this._updateTitle(!1),this.findDesktop().on("propertyChange:navigationVisible",this._desktopNavigationVisibilityChangeHandler)}_remove(){this.$content=null,this.$title=null,this.findDesktop().off("propertyChange:navigationVisible",this._desktopNavigationVisibilityChangeHandler),super._remove()}_renderProperties(){super._renderProperties(),this.pageTileGrid.rendered&&(this.pageTileGrid=this._createPageTileGrid()),this._renderPageTileGrid(),this._renderScrollable()}_renderPageTileGrid(){this.pageTileGrid.render(this.$content)}_createPageTileGrid(){return u.create(Ed,{parent:this,outline:this.outline,nodes:this.nodes})}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}setPage(e){this.outline=e.getOutline(),this.nodes=e.childNodes,this.tileOverviewTitle=e.text,this.setScrollable(!this.outline.compact),this.pageTileGrid.setCompact(this.outline.compact),this.pageTileGrid.setOutline(this.outline),this.pageTileGrid.setPage(e),this.pageTileGrid.setNodes(this.nodes)}_updateTitle(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;!this.$title||(this.$title.toggleClass("animated",e),this.$title.toggleClass("removed",this.findDesktop().navigationVisible))}_onDesktopNavigationVisibilityChange(e){this._updateTitle()}}class rg extends Pa{}class sg extends Pa{_initModel(e,t){let r=super._initModel(e,t);if(!r.jsFormObjectType||!r.jsFormObjectType.length)throw new Error("jsFormObjectType not set");let s={parent:r.parent,owner:r.owner,objectType:r.jsFormObjectType,displayParent:r.displayParent,displayHint:r.displayHint,data:r.inputData};return r.jsFormModel&&(s=$.extend(!0,{},r.jsFormModel,s)),s}_createWidget(e){let t=super._createWidget(e);return t.showOnOpen=!1,t.open(),t}_onWidgetEvent(e){e.type==="save"?this._onWidgetSave(e):super._onWidgetEvent(e)}_onWidgetSave(e){this._send("save",{outputData:this.widget.data})}_onWidgetClose(e){e.preventDefault(),this._send("formClosing")}_onWidgetAbort(e){}}function D(i,e,t){return e=ex(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ex(i){var e=tx(i,"string");return typeof e=="symbol"?e:String(e)}function tx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class W extends I{constructor(){super(),D(this,"autoResizeColumns",void 0),D(this,"columnAddable",void 0),D(this,"columnLayoutDirty",void 0),D(this,"columns",void 0),D(this,"contextColumn",void 0),D(this,"checkable",void 0),D(this,"displayViewId",void 0),D(this,"checkableStyle",void 0),D(this,"cellEditorPopup",void 0),D(this,"compact",void 0),D(this,"openFieldPopupOnCellEdit",void 0),D(this,"compactHandler",void 0),D(this,"compactColumn",void 0),D(this,"dropType",void 0),D(this,"dropMaximumSize",void 0),D(this,"dragAndDropHandler",void 0),D(this,"groupingStyle",void 0),D(this,"header",void 0),D(this,"tableStatus",void 0),D(this,"rowBorders",void 0),D(this,"headerEnabled",void 0),D(this,"headerVisible",void 0),D(this,"headerMenusEnabled",void 0),D(this,"hasReloadHandler",void 0),D(this,"hierarchical",void 0),D(this,"hierarchicalStyle",void 0),D(this,"keyStrokes",void 0),D(this,"menus",void 0),D(this,"menuBar",void 0),D(this,"menuBarVisible",void 0),D(this,"contextMenu",void 0),D(this,"multiCheck",void 0),D(this,"multiSelect",void 0),D(this,"multilineText",void 0),D(this,"scrollToSelection",void 0),D(this,"selectedRows",void 0),D(this,"sortEnabled",void 0),D(this,"tableControls",void 0),D(this,"tableStatusVisible",void 0),D(this,"tableTileGridMediator",void 0),D(this,"tileMode",void 0),D(this,"tileTableHeader",void 0),D(this,"tileProducer",void 0),D(this,"footer",void 0),D(this,"footerVisible",void 0),D(this,"filters",void 0),D(this,"rows",void 0),D(this,"rootRows",void 0),D(this,"visibleRows",void 0),D(this,"estimatedRowCount",void 0),D(this,"maxRowCount",void 0),D(this,"aggregateRowHeight",void 0),D(this,"truncatedCellTooltipEnabled",void 0),D(this,"checkableColumn",void 0),D(this,"rowIconColumn",void 0),D(this,"uiCssClass",void 0),D(this,"visibleRowsMap",void 0),D(this,"rowLevelPadding",void 0),D(this,"rowsMap",void 0),D(this,"rowHeight",void 0),D(this,"rowWidth",void 0),D(this,"rowInsets",void 0),D(this,"rowMargins",void 0),D(this,"rowIconVisible",void 0),D(this,"rowIconColumnWidth",void 0),D(this,"staticMenus",void 0),D(this,"selectionHandler",void 0),D(this,"tooltips",void 0),D(this,"tableNodeColumn",void 0),D(this,"updateBuffer",void 0),D(this,"viewRangeSize",void 0),D(this,"viewRangeDirty",void 0),D(this,"viewRangeRendered",void 0),D(this,"virtual",void 0),D(this,"textFilterEnabled",void 0),D(this,"filterSupport",void 0),D(this,"filteredElementsDirty",void 0),D(this,"$data",void 0),D(this,"$emptyData",void 0),D(this,"$fillBefore",void 0),D(this,"$fillAfter",void 0),D(this,"_renderViewportBlocked",void 0),D(this,"_filterMenusHandler",void 0),D(this,"_aggregateRows",void 0),D(this,"_filteredRows",void 0),D(this,"_maxLevel",void 0),D(this,"_animationRowLimit",void 0),D(this,"_blockLoadThreshold",void 0),D(this,"_doubleClickSupport",void 0),D(this,"_permanentHeadSortColumns",void 0),D(this,"_permanentTailSortColumns",void 0),D(this,"_popupOpenHandler",void 0),D(this,"_rerenderViewPortAfterAttach",void 0),D(this,"_renderViewPortAfterAttach",void 0),D(this,"_triggerRowsSelectedPending",void 0),D(this,"_animateAggregateRows",void 0),D(this,"_postAttachActions",void 0),D(this,"_desktopPropertyChangeHandler",void 0),D(this,"_imageLoadListener",void 0),D(this,"_insertedRows",void 0),D(this,"_$mouseDownRow",void 0),D(this,"_mouseDownRowId",void 0),D(this,"_mouseDownColumn",void 0),this.autoResizeColumns=!1,this.columnAddable=!1,this.columnLayoutDirty=!1,this.columns=[],this.contextColumn=null,this.checkable=!1,this.checkableStyle=W.CheckableStyle.CHECKBOX,this.cellEditorPopup=null,this.compact=!1,this.compactHandler=u.create(yu,{table:this}),this.compactColumn=null,this.dropType=0,this.dropMaximumSize=Ae.DEFAULT_DROP_MAXIMUM_SIZE,this.groupingStyle=W.GroupingStyle.TOP,this.header=null,this.headerEnabled=!0,this.headerVisible=!0,this.headerMenusEnabled=!0,this.hasReloadHandler=!1,this.hierarchical=!1,this.hierarchicalStyle=W.HierarchicalStyle.DEFAULT,this.keyStrokes=[],this.menus=[],this.menuBar=null,this.menuBarVisible=!0,this.contextMenu=null,this.multiCheck=!0,this.multiSelect=!0,this.multilineText=!1,this.scrollToSelection=!1,this.scrollTop=0,this.selectedRows=[],this.sortEnabled=!0,this.tableControls=[],this.tableStatusVisible=!1,this.tableTileGridMediator=null,this.tileMode=!1,this.tileTableHeader=null,this.tileProducer=null,this.footer=null,this.footerVisible=!1,this.filters=[],this.rows=[],this.rootRows=[],this.visibleRows=[],this.estimatedRowCount=0,this.maxRowCount=0,this.truncatedCellTooltipEnabled=null,this.visibleRowsMap={},this.rowLevelPadding=0,this.rowsMap={},this.rowHeight=0,this.rowWidth=0,this.rowInsets=new qe,this.rowMargins=new qe,this.rowIconVisible=!1,this.rowIconColumnWidth=Me.NARROW_MIN_WIDTH,this.staticMenus=[],this.selectionHandler=new Cu(this),this.tooltips=[],this._filteredRows=[],this.tableNodeColumn=null,this._maxLevel=0,this._aggregateRows=[],this._animationRowLimit=25,this._blockLoadThreshold=25,this.updateBuffer=new Au(this),this.viewRangeSize=10,this.viewRangeDirty=!1,this.viewRangeRendered=new O(0,0),this.virtual=!0,this.textFilterEnabled=!0,this.filterSupport=this._createFilterSupport(),this.filteredElementsDirty=!1,this._doubleClickSupport=new Vs,this._permanentHeadSortColumns=[],this._permanentTailSortColumns=[],this._filterMenusHandler=this._filterMenus.bind(this),this._popupOpenHandler=this._onDesktopPopupOpen.bind(this),this._rerenderViewPortAfterAttach=!1,this._renderViewPortAfterAttach=!1,this._postAttachActions=[],this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this),this._addWidgetProperties(["tableControls","menus","keyStrokes","staticMenus","tileTableHeader","tableTileGridMediator"]),this.$data=null,this.$emptyData=null,this.$fillBefore=null,this.$fillAfter=null}_init(e){super._init(e),this.resolveConsts([{property:"hierarchicalStyle",constType:W.HierarchicalStyle},{property:"checkableStyle",constType:W.CheckableStyle},{property:"groupingStyle",constType:W.GroupingStyle}]),this._initColumns(),this.rows.forEach((t,r)=>{this.rows[r]=this._initRow(t)}),this.setFilters(this.filters),this._updateRowStructure({updateTree:!0}),this.menuBar=this._createMenuBar(),this.menuBar.on("propertyChange:visible",()=>this._refreshMenuBarClasses()),this._setSelectedRows(this.selectedRows),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setTableControls(this.tableControls),this._setTableStatus(this.tableStatus),this._calculateValuesForBackgroundEffect(),this._setTileMode(this.tileMode),this._setTileTableHeader(this.tileTableHeader),this._sortWhileInit()}_initRow(e){let t;return e instanceof Qt?t=e:t=this._createRow(e),this.rowsMap[t.id]=t,this.trigger("rowInit",{row:t}),t}_createRow(e){let t=e||{};return t.objectType=u.nvl(t.objectType,Qt),t.parent=this,u.create(t)}_initColumns(){let e=this.columns;this.columns=e.map((t,r)=>{let s,o=t;return o.session=this.session,o instanceof Me?(s=o,s._setTable(this)):(o.table=this,s=u.create(o)),s.index<0&&(s.index=r),s.checkable&&(this.checkableColumn=s),s}),this._setCheckable(this.checkable),this.rowIconVisible&&this._insertRowIconColumn(),this._setCompact(this.compact),this._calculateTableNodeColumn(),this._setHeadAndTailSortColumns(),this.columnLayoutDirty=!0}_destroy(){this._destroyColumns(),super._destroy()}_destroyColumns(){this.columns.forEach(e=>e.destroy()),this.checkableColumn=null,this.compactColumn=null,this.rowIconColumn=null,this.columns=[]}_calculateTableNodeColumn(){let e=this.visibleColumns().filter(r=>r.nodeColumnCandidate),t=f.first(e);this.tableNodeColumn&&this.tableNodeColumn!==t&&(this.tableNodeColumn.minWidth=this.tableNodeColumn.__initialMinWidth),this.tableNodeColumn=t,this.tableNodeColumn&&(this.tableNodeColumn.__initialMinWidth=this.tableNodeColumn.minWidth,this.tableNodeColumn.minWidth=this.rowLevelPadding*this._maxLevel+this.tableNodeColumn.tableNodeLevel0CellPadding+8,this.tableNodeColumn.minWidth>this.tableNodeColumn.width&&(this._isDataRendered()?this.resizeColumn(this.tableNodeColumn,this.tableNodeColumn.minWidth):this.tableNodeColumn.width=this.tableNodeColumn.minWidth))}_createLoadingSupport(){return new rr({widget:this,$container:()=>this.$container.hasClass("knight-rider-loading")?this.$container:this.$data})}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this._initTableKeyStrokeContext()}_initTableKeyStrokeContext(){this.keyStrokeContext.registerKeyStrokes([new tc(this),new ic(this),new oc(this),new nc(this),new rc(this),new sc(this),new ju(this),new Xu(this),new Qu(this),new Ju(this),new Zu(this),new ec(this),new Yu(this),new sa(this,this.showContextMenu,this),new hn(this,this.handleAppLinkAction)])}_insertBooleanColumn(){if(this.checkableStyle===W.CheckableStyle.TABLE_ROW)return;let e=u.create(oo,{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:Me.NARROW_MIN_WIDTH,table:this});f.insert(this.columns,e,0),this.checkableColumn=e}_insertRowIconColumn(){let e=0,t=u.create(Ra,{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:this.rowIconColumnWidth,table:this});this.columns[0]===this.checkableColumn&&(e=1),f.insert(this.columns,t,e),this.rowIconColumn=t}handleAppLinkAction(e){let t=a()(e.target),r=this._columnAtX(t.offset().left),s=t.findUp(o=>o.hasClass("table-row"),this.$container).data("row");this._triggerAppLinkAction(r,s,t.data("ref"),t)}_isDataRendered(){return this.rendered&&this.$data!==null}_render(){this.$container=this.$parent.appendDiv("table").addDeviceClass(),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Su(this)),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.tileMode?this._renderTileMode():this._renderData(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}_renderData(){this.$data=this.$container.appendDiv("table-data"),this.$data.on("mousedown",".table-row",this._onRowMouseDown.bind(this)).on("mouseup",".table-row",this._onRowMouseUp.bind(this)).on("dblclick",".table-row",this._onRowDoubleClick.bind(this)).on("contextmenu",e=>e.preventDefault()),this._installScrollbars({axis:"both"}),this._installImageListeners(),this._installCellTooltipSupport(),this._calculateRowInsets(),this._updateRowWidth(),this._updateRowHeight(),this._renderViewport(),this.scrollToSelection&&this.revealSelection()}_renderProperties(){super._renderProperties(),this._renderTableHeader(),this._renderMenuBarVisible(),this._renderFooterVisible(),this._renderCheckableStyle(),this._renderHierarchicalStyle(),this._renderTextFilterEnabled()}_setCssClass(e){super._setCssClass(e);let t=["table-row-level-padding"];this.cssClass&&t.push(this.cssClass);let r=t.reduce((s,o)=>s+" "+o,"");this.setRowLevelPadding(L.getSize(r,"width","width",15))}_removeData(){this._removeAggregateRows(),this._uninstallImageListeners(),this._uninstallCellTooltipSupport(),this._uninstallScrollbars(),this._removeRows(),this.$fillBefore=null,this.$fillAfter=null,this.$data.remove(),this.$data=null,this.$emptyData=null}_remove(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.session.desktop.off("popupOpen",this._popupOpenHandler),Ae.uninstallDragAndDropHandler(this),this.header=null,this.$data&&this._removeData(),this.filterSupport.remove(),super._remove()}setRowLevelPadding(e){this.setProperty("rowLevelPadding",e)}_renderRowLevelPadding(){this._rerenderViewport()}setTableControls(e){this.setProperty("tableControls",e)}_renderTableControls(){this.footer&&this.footer._renderControls()}_setTableControls(e){let t;for(t=0;t<this.tableControls.length;t++)this.keyStrokeContext.unregisterKeyStroke(this.tableControls[t]);for(this._setProperty("tableControls",e),t=0;t<this.tableControls.length;t++)this.keyStrokeContext.registerKeyStroke(this.tableControls[t]);this._updateFooterVisibility(),this.tableControls.forEach(r=>{r.tableFooter=this.footer})}_onImageLoadOrError(e){let t=a()(e.target);if(t.data("measure")==="in-progress")return;t.toggleClass("broken",e.type==="error");let r=t.closest(".table-row"),s=r.data("row");if(!s)return;let o=s.height;s.height=this._measureRowHeight(r),o!==s.height&&this.invalidateLayoutTree()}_onRowMouseDown(e){this._doubleClickSupport.mousedown(e),this._$mouseDownRow=a()(e.currentTarget),this._mouseDownRowId=this._$mouseDownRow.data("row").id,this._mouseDownColumn=this._columnAtX(e.pageX),this._$mouseDownRow.window().one("mouseup",()=>{this._$mouseDownRow=null,this._mouseDownRowId=null,this._mouseDownColumn=null}),this.setContextColumn(this._columnAtX(e.pageX)),this.selectionHandler.onMouseDown(e);let t=e.which===3,r=this._$mouseDownRow.data("row"),s=a()(e.target);if(this._isRowControl(s)&&(r.expanded?this.collapseRow(r):this.expandRow(r)),u.isOneOf(this.checkableStyle,W.CheckableStyle.TABLE_ROW,W.CheckableStyle.CHECKBOX_TABLE_ROW)&&(!t||!r.checked)&&!a()(e.target).is(".table-row-control")&&!(s.hasClass("checkable")||s.parent().hasClass("checkable"))&&this.checkRow(r,!r.checked),t)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}_isRowControl(e){return e.hasClass("table-row-control")||e.parent().hasClass("table-row-control")}_onRowMouseUp(e){let t,r=e.which;if(this._doubleClickSupport.doubleClicked())return;let s=a()(e.currentTarget);if(this.selectionHandler.onMouseUp(e),!this._$mouseDownRow||this._mouseDownRowId!==s.data("row").id)return;let o=s,n=this._columnAtX(e.pageX);if(n!==this._mouseDownColumn)return;let l=a()(e.target);if(this._isRowControl(l))return;let d=o.data("row");r===1&&(n.onMouseUp(e,o),t=this._find$AppLink(e)),t?this._triggerAppLinkAction(n,d,t.data("ref"),t):this._triggerRowClick(e,d,r,n)}_onRowDoubleClick(e){let t=a()(e.currentTarget),r=this._columnAtX(e.pageX);this.doRowAction(t.data("row"),r)}showContextMenu(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}_showContextMenu(e){if(e=e||{},!this._isDataRendered()||!this.attached||this.selectedRows.length===0)return;let t=this._filterMenusForContextMenu();if(t.length===0)return;let r=u.nvl(e.pageX,null),s=u.nvl(e.pageY,null);if(r===null||s===null){let o=this.isRowSelectedAndVisible(this.selectionHandler.lastActionRow)?this.selectionHandler.lastActionRow:this.getLastSelectedAndVisibleRow();if(o!==null){let n=o.$row,l=n.offset(),d=w.offsetBounds(this.$data);l.left+=this.$data.scrollLeft(),r=l.left+10,s=l.top+n.outerHeight()/2,s=Math.min(Math.max(s,d.y+1),d.bottom()-1)}else r=this.$data.offset().left+10,s=this.$data.offset().top+10}this.contextMenu&&this.contextMenu.close(),this.contextMenu=u.create(mt,{parent:this,menuItems:t,location:{x:r,y:s},$anchor:this.$data,menuFilter:this._filterMenusHandler}),this.contextMenu.open()}isRowSelectedAndVisible(e){return!this.isRowSelected(e)||!e.$row?!1:w.offsetBounds(e.$row).intersects(w.offsetBounds(this.$data))}getLastSelectedAndVisibleRow(){for(let e=this.viewRangeRendered.to;e>=this.viewRangeRendered.from;e--)if(this.isRowSelectedAndVisible(this.rows[e]))return this.rows[e];return null}onColumnVisibilityChanged(){this.columnLayoutDirty=!0,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"),this._isDataRendered()&&(this._updateRowWidth(),this.redraw())}_onScroll(e){let t=this.$data[0].scrollTop,r=this.$data[0].scrollLeft;this.scrollTop!==t&&this._renderViewport(),this.scrollTop=t,this.scrollLeft=r}_renderTableStatus(){this.trigger("statusChanged")}setContextColumn(e){this.setProperty("contextColumn",e)}_hasVisibleTableControls(){return this.tableControls.some(e=>e.visible)}hasAggregateTableControl(){return this.tableControls.some(e=>e instanceof Wr)}_createHeader(){return u.create(Tu,{parent:this,table:this,enabled:this.headerEnabled,headerMenusEnabled:this.headerMenusEnabled})}_createFooter(){return u.create(vu,{parent:this,table:this})}_installCellTooltipSupport(){G.install(this.$data,{parent:this,selector:".table-cell",text:this._cellTooltipText.bind(this),htmlEnabled:this._isAggregatedTooltip.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!F.get().isCustomEllipsisTooltipPossible()})}_uninstallCellTooltipSupport(){G.uninstall(this.$data)}_cellTooltipText(e){let t,r=e.parent(),s=this.columnFor$Cell(e,r),o=r.data("row");if(o&&(t=this.cell(s,o).tooltipText),t)return t;if(this._isAggregatedTooltip(e)&&e.text().trim()){let n=e.children(".text"),l=e.children(".table-cell-icon"),d=l.length&&!l.isVisible();if(n.length&&n.isContentTruncated()||d){let h=e.clone();if(h.children(".table-cell-icon").setVisible(!0),e.css("direction")==="rtl"){let p=h.children().get().map(m=>m.outerHTML).reverse();return y.join("",...p)}return h.html()}}if(this._isTruncatedCellTooltipEnabled(s)&&e.isContentTruncated())return y.plainText(e.html(),{trim:!0,removeFontIcons:!0})}setTruncatedCellTooltipEnabled(e){this.setProperty("truncatedCellTooltipEnabled",e)}_isTruncatedCellTooltipEnabled(e){return this.truncatedCellTooltipEnabled===null?!this.headerVisible||!this.headerEnabled||e.fixedWidth:this.truncatedCellTooltipEnabled}_isAggregatedTooltip(e){let t=e.parent();return t.data("aggregateRow")||t.hasClass("table-aggregate")}reload(e){!this.hasReloadHandler||(this._removeRows(),this._isDataRendered()&&(this._removeAggregateRows(),this._renderFiller()),this._triggerReload(e))}setLoading(e){!e&&this.updateBuffer.isBuffering()||super.setLoading(e)}exportToClipboard(){this._triggerClipboardExport()}_exportToClipboard(){sr.copyText({parent:this,text:this._selectedRowsToText()})}_selectedRowsToText(){let e=this.visibleColumns();return this.selectedRows.map(t=>e.map(r=>{let s=r.cell(t),o;return r instanceof oo?o=s.value?"X":"":s.htmlEnabled?o=y.plainText(s.text):o=s.text,this._unwrapText(o)}).join("	")).join(`
`)}_unwrapText(e){return y.nvl(e).split(/[\n\r]/).map(t=>t.replace(/\t/g," ")).map(t=>t.trim()).filter(t=>!!t.length).join(" ")}setMultiSelect(e){this.setProperty("multiSelect",e)}toggleSelection(){this.selectedRows.length===this.visibleRows.length?this.deselectAll():this.selectAll()}selectAll(){this.selectRows(this.visibleRows)}deselectAll(){this.selectRows([])}checkAll(e,t){let r=a().extend(t,{checked:e});this.checkRows(this.visibleRows,r)}uncheckAll(e){this.checkAll(!1,e)}updateScrollbars(){x.update(this.$data)}_sort(e){let t=this._sortColumns();return this._isSortingPossible(t)?(this.clearAggregateRows(e),t.length&&(t=f.union(t,this.columns),this._sortImpl(t),this._triggerRowOrderChanged(),this._isDataRendered()&&this._renderRowOrderChanges(),this._group(e)),!0):!1}_isSortingPossible(e){return e.every(t=>t.isSortingPossible())}_sortColumns(){let e=[];for(let t=0;t<this.columns.length;t++){let r=this.columns[t],s=r.sortIndex;s>=0&&(e[s]=r)}return e}_sortImpl(e){let t=(r,s)=>{for(let o=0;o<e.length;o++){let n=e[o],l=n.compare(r,s);if(n.sortActive&&!n.sortAscending&&(l=-l),l!==0)return l}return 0};if(this.hierarchical){this._sortHierarchical(t);let r=[];this.visitRows(s=>r.push(s)),this.rows=r}else this.rows.sort(t),this.rootRows=this.rows;this._updateRowStructure({filteredRows:!0,applyFilters:!1,visibleRows:!0})}visitRows(e,t,r){r=u.nvl(r,0),t=t||this.rootRows,t.forEach(s=>{e(s,r),this.visitRows(e,s.childRows,r+1)})}_sortHierarchical(e,t){t=t||this.rootRows,t.sort(e),t.forEach(r=>this._sortHierarchical(e,r.childRows))}_renderRowOrderChanges(){let e,t=this.$rows(),r={};t.length===this.visibleRows.length&&t.each((s,o)=>{let n=!1,l=a()(o),d=l.data("row");if(this._insertedRows){for(let h=0;h<this._insertedRows.length;h++)if(this._insertedRows[h].id===d.id){n=!0;break}}n||(e=!0,r[d.id]=l.offset().top)}),this._rerenderViewport(),this._order$AggregateRows(),this.scrollToSelection&&this.revealSelection(),e&&(t=this.$rows(),t.each((s,o)=>{let n=a()(o),l=n.data("row"),d=r[l.id];d!==void 0&&n.css("top",d-n.offset().top).animate({top:0},{progress:function(){this._triggerRowOrderChanged(l,!0),this.updateScrollbars()}.bind(this)})}))}setSortEnabled(e){this.setProperty("sortEnabled",e)}sort(e,t,r,s){r=u.nvl(r,!1),s=u.nvl(s,!1);let o=!r;s?this._removeSortColumn(e):this._addSortColumn(e,t,r),this.header&&this.header.onSortingChanged();let n=this._sort(o),l={column:e,sortAscending:e.sortAscending};s&&(l.sortingRemoved=!0),r&&(l.multiSort=!0),n||(l.sortingRequested=!0,this._animateAggregateRows=o),this.trigger("sort",l)}_addSortColumn(e,t,r){if(t=u.nvl(t,e.sortAscending?"asc":"desc"),r=u.nvl(r,!0),this._updateSortIndexForColumn(e,r),!r){let s=this._groupedColumns().length;this._sortColumns().length===1&&s===1||(e.grouped=!1)}e.sortAscending=t==="asc",e.sortActive=!0}_updateSortIndexForColumn(e,t){let r=-1;if(t)(!e.sortActive||e.sortIndex===-1)&&(r=Math.max(-1,f.max(this.columns.map(s=>s.sortIndex===void 0||s.initialAlwaysIncludeSortAtEnd?-1:s.sortIndex))),e.sortIndex=r+1,this._permanentTailSortColumns.forEach(s=>{s.sortIndex++}));else{e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortIndex=this._permanentHeadSortColumns.length),f.eachSibling(this.columns,e,o=>{o.sortActive&&this._removeSortColumnInternal(o)});let s=e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?0:1;this._permanentTailSortColumns.forEach((o,n)=>{o.sortIndex=this._permanentHeadSortColumns.length+s+n})}}_removeSortColumn(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(f.eachSibling(this.columns,e,t=>{t.sortIndex>e.sortIndex&&(t.sortIndex=t.sortIndex-1)}),this._removeSortColumnInternal(e))}_removeSortColumnInternal(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortActive=!1,e.grouped=!1,e.sortIndex=-1)}isGroupingPossible(e){let t=!0;return this.hierarchical||!this.sortEnabled?!1:this._permanentHeadSortColumns&&this._permanentHeadSortColumns.length===0?!0:e.initialAlwaysIncludeSortAtBegin?(t=!0,f.eachSibling(this._permanentHeadSortColumns,e,r=>{r.sortIndex<e.sortIndex&&(t=t&&r.grouped)}),t):e.initialAlwaysIncludeSortAtEnd?!1:(this._permanentHeadSortColumns.forEach(r=>{t=t&&r.grouped}),t)}isAggregationPossible(e){return!(e instanceof Oi)||e.grouped||!e.allowedAggregationFunctions||e.allowedAggregationFunctions.length<=1?!1:this.isGrouped()||this.hasAggregateTableControl()}changeAggregation(e,t){this.changeAggregations([e],[t])}changeAggregations(e,t){e.forEach((r,s)=>{let o=t[s];r.aggregationFunction!==o&&(r.setAggregationFunction(o),this._triggerAggregationFunctionChanged(r))}),this._group()}_addGroupColumn(e,t,r){let s=-1;!this.isGroupingPossible(e)||(t=u.nvl(t,e.sortAscending?"asc":"desc"),r=u.nvl(r,!0),e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?e.initialAlwaysIncludeSortAtBegin&&(e.grouped=!0):(r?(s=Math.max(-1,f.max(this.columns.map(o=>o.sortIndex===void 0||o.initialAlwaysIncludeSortAtEnd||!o.grouped?-1:o.sortIndex))),e.sortActive?(f.eachSibling(this.columns,e,o=>{o.sortActive&&!(o.initialAlwaysIncludeSortAtBegin||o.initialAlwaysIncludeSortAtEnd)&&o.sortIndex>s&&o.sortIndex<e.sortIndex&&o.sortIndex++}),e.sortIndex=s+1):(e.sortIndex=s+1,f.eachSibling(this.columns,e,o=>{o.sortActive&&!(o.initialAlwaysIncludeSortAtBegin||o.initialAlwaysIncludeSortAtEnd)&&o.sortIndex>s&&o.sortIndex++}),this._permanentTailSortColumns.forEach(o=>{o.sortIndex++}))):(s=this._permanentHeadSortColumns.length,e.sortActive?(f.eachSibling(this.columns,e,o=>{o.sortActive&&!(o.initialAlwaysIncludeSortAtBegin||o.initialAlwaysIncludeSortAtEnd)&&o.sortIndex>=s&&o.sortIndex<e.sortIndex&&o.sortIndex++}),e.sortIndex=s):(f.eachSibling(this.columns,e,o=>{o.sortActive&&!(o.initialAlwaysIncludeSortAtBegin||o.initialAlwaysIncludeSortAtEnd)&&o.sortIndex>=s&&o.sortIndex++}),e.sortIndex=s,this._permanentTailSortColumns.forEach(o=>{o.sortIndex++})),f.eachSibling(this.columns,e,o=>{o.sortActive&&!(o.initialAlwaysIncludeSortAtBegin||o.initialAlwaysIncludeSortAtEnd)&&o.sortIndex>=s&&(o.grouped=!1)})),e.sortAscending=t==="asc",e.sortActive=!0),e.grouped=!0)}_removeGroupColumn(e){e.grouped=!1,e.initialAlwaysIncludeSortAtBegin&&this.columns.forEach(t=>{t.sortIndex>=e.sortIndex&&(t.grouped=!1)}),this._removeSortColumn(e)}_buildRowDiv(e){let t=this.rowWidth,r="table-row";e.cssClass&&(r+=" "+e.cssClass),e.enabled||(r+=" disabled"),e.checked&&this.checkableStyle===W.CheckableStyle.TABLE_ROW&&(r+=" checked"),e.filterAccepted||(r+=" filter-not-accepted"),f.empty(e.childRows)&&(r+=" leaf");let s='<div class="'+r+'" style="width: '+t+'px">';for(let o=0;o<this.columns.length;o++){let n=this.columns[o];n.isVisible()&&(s+=n.buildCellForRow(e))}return s+="</div>",s}_calculateRowInsets(){let e=this.$data.appendDiv("table-row");this.rowMargins=w.margins(e),this.rowBorders=w.borders(e),e.remove()}_updateRowWidth(){this.rowWidth=this.visibleColumns().reduce((e,t)=>this.autoResizeColumns?e+t.width:e+t.realWidthIfAvailable(),this.rowBorders.horizontal())}_updateRealColumnWidths(e){if(!F.get().hasTableCellZoomBug())return!1;let t=!1;return e=e||this.$rows().eq(0),this.visibleColumns().forEach((r,s)=>{this._updateRealColumnWidth(r,s,e)&&(t=!0)}),t}_updateRealColumnWidth(e,t,r){if(!F.get().hasTableCellZoomBug())return!1;r=r||this.$rows().eq(0);let s=this.$cell(u.nvl(t,e),r);if(s.length===0&&e._realWidth!==null)return e._realWidth=null,!0;let o=w.size(s,{exact:!0}).width;return o!==e._realWidth?(e._realWidth=o,!0):!1}_updateRowHeight(){let e=this.$data.appendDiv("table-row"),t=this._build$AggregateRow().appendTo(this.$data);e.appendDiv("table-cell").html("&nbsp;"),t.appendDiv("table-cell table-aggregate-cell").appendSpan("text").html("&nbsp;"),this.rowHeight=this._measureRowHeight(e),this.aggregateRowHeight=this._measureRowHeight(t),e.remove(),t.remove()}_updateRowHeights(){this.rows.forEach(e=>{e.$row?e.height=this._measureRowHeight(e.$row):e.height=null}),this._aggregateRows.forEach(e=>{e.$row?e.height=this._measureRowHeight(e.$row):e.height=null})}_renderRowsInRange(e){let t="",r=0,s=!1,o=this.visibleRows;if(o.length===0)return;if(e=new O(0,this.rows.length).intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new O(0,0)))throw new Error("New range must not intersect with existing.");e.to<=this.viewRangeRendered.from&&(s=!0);let l=this.viewRangeRendered.union(e);if(l.length===2)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+l);this.viewRangeRendered=l[0],this._removeEmptyData();for(let h=e.from;h<e.to;h++){let p=o[h];t+=this._buildRowDiv(p),r++}let d=this.$data.makeElement(t);s?this.$fillBefore?d=d.insertAfter(this.$fillBefore):d=d.prependTo(this.$data):this.$fillAfter?d=d.insertBefore(this.$fillAfter):d=d.appendTo(this.$data),d.each((h,p)=>{let m=a()(p);this.viewRangeRendered.size()===r&&this._updateRealColumnWidths(m)&&(this._updateRowWidth(),this.header&&this.header.rendered&&this.header.resizeHeaderItems()),m.cssWidth(this.rowWidth);let g=o[e.from+h];W.linkRowToDiv(g,m),this._installRow(g)}),a().log.isTraceEnabled()&&(a().log.trace(r+" new rows rendered from "+e),a().log.trace(this._rowsRenderedInfo()))}_rowsRenderedInfo(){let e=this.$rows().length,t="("+this.viewRangeRendered+")";return e+" rows rendered "+t}moveRowToTop(e){let t=this.rows.indexOf(e);this.moveRow(t,0)}moveRowToBottom(e){let t=this.rows.indexOf(e);this.moveRow(t,this.rows.length-1)}moveRowUp(e){let t=this.rows.indexOf(e),r=t-1;if(this.hierarchical){let s=this.rows.filter(l=>e.parentRow===l.parentRow),o=s.indexOf(e),n=s[o-1];n?r=this.rows.indexOf(n):r=0}this.moveRow(t,r)}moveRowDown(e){let t=this.rows.indexOf(e),r=t+1;if(this.hierarchical){let s=this.rows.filter(l=>e.parentRow===l.parentRow),o=s.indexOf(e),n=s[o+1];n?r=this.rows.indexOf(n):r=this.rows.length}this.moveRow(t,r)}moveVisibleRowUp(e){let t=this.rows.indexOf(e),r=this.visibleRows.indexOf(e),s,o;if(this.hierarchical){let n=this.visibleRows.filter(l=>e.parentRow===l.parentRow);if(s=n[n.indexOf(e)-1],s)o=this.rows.indexOf(s);else return}else{if(s=this.visibleRows[r-1],!s)return;o=this.rows.indexOf(s)}this.moveRow(t,o)}moveVisibleRowDown(e){let t=this.rows.indexOf(e),r=this.visibleRows.indexOf(e),s,o;if(this.hierarchical){let n=this.visibleRows.filter(l=>e.parentRow===l.parentRow);if(s=n[n.indexOf(e)+1],s)o=this.rows.indexOf(s);else return}else{if(s=this.visibleRows[r+1],!s)return;o=this.rows.indexOf(s)}this.moveRow(t,o)}moveRow(e,t){let r=this.rows.length;e=Math.max(e,0),e=Math.min(e,r-1),t=Math.max(t,0),t=Math.min(t,r-1),e!==t&&(f.move(this.rows,e,t),this.updateRowOrder(this.rows))}_removeRowsInRange(e){let t=0,r=this.visibleRows;e=new O(0,r.length).intersect(e);let o=this.viewRangeRendered.subtract(e);if(o.length===2)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+o);this.viewRangeRendered=o[0];for(let n=e.from;n<e.to;n++){let l=r[n];this._removeRow(l),t++}a().log.isTraceEnabled()&&(a().log.trace(t+" rows removed from "+e+"."),a().log.trace(this._rowsRenderedInfo()))}removeAllRows(){this._isDataRendered()&&this.$rows().each((e,t)=>{let r=a()(t),s=r.data("row");r.hasClass("hiding")||this._removeRow(s)}),this.viewRangeRendered=new O(0,0)}_removeRows(e){if(!e){this.removeAllRows();return}let t=this.isAttachedAndRendered();e=f.ensure(e),e.forEach(r=>{let s=this.visibleRows.indexOf(r);if(s===-1)return;let o=Boolean(r.$row),n=this.viewRangeRendered.contains(s);if(t){if(!o&&n)throw new Error("Inconsistency found while removing row. Row is undefined but inside rendered view range. RowIndex: "+s);if(o&&!n)throw new Error("Inconsistency found while removing row. Row is rendered but not inside rendered view range. RowIndex: "+s)}this._removeRow(r),(n||s<this.viewRangeRendered.from)&&(s<this.viewRangeRendered.from?(this.viewRangeRendered.from--,this.viewRangeRendered.to--):s<=this.viewRangeRendered.to&&this.viewRangeRendered.to--)})}_removeRow(e){let t=e.$row;!t||(this._destroyTooltipsForRow(e),this._destroyCellEditorForRow(e),t.hasClass("hiding")||(t.remove(),e.$row=null))}_showRow(e){let t=e.$row;!t||t.is(".showing")||(t.hide(),t.addClass("showing"),t.removeClass("hiding"),t.stop().slideDown({duration:250,complete:()=>{t.removeClass("showing"),this.updateScrollbars()}}))}_hideRow(e){let t=e.$row;!t||t.is(".hiding")||(t.addClass("hiding"),t.removeClass("showing"),t.stop().slideUp({duration:250,complete:()=>{!e.$row||(t.remove(),t[0]===e.$row[0]&&(e.$row=null),this.updateScrollbars())}}))}_installRow(e){if(e.height=this._measureRowHeight(e.$row),e.hasError&&this._showCellErrorForRow(e),this.cellEditorPopup&&!this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id){let t=this.cellEditorPopup.cell.field;this.startCellEdit(this.cellEditorPopup.column,e,t)}}_calcRowLevelPadding(e){return e?this._calcRowLevelPadding(e.parentRow)+this.rowLevelPadding:-this.rowLevelPadding}_showCellErrorForRow(e){let t=this.$cellsForRow(e.$row),r=this;t.each(function(s){let o=a()(this),n=r.cellByCellIndex(s,e);n.errorStatus&&r._showCellError(e,o,n.errorStatus)})}_showCellError(e,t,r){let s=r.message,o=u.create(Fu,{parent:this,text:s,autoRemove:!1,$anchor:t,table:this});o.render(),o.row=e,this.tooltips.push(o)}_columnAtX(e){let t=0,r=this.$data.offset().left+this.rowBorders.left+this.rowMargins.left,s=this.$data.scrollLeft();if(e<r)return this.columns[0];r-=s;let o=this.visibleColumns(),n=f.find(o,l=>{if(t=r+l.width,e>=r&&e<t)return!0;r=t});return n||(n=o[o.length-1]),n}_find$AppLink(e){let t=a()(e.target),r=a()(e.delegateTarget),s=t.findUp(o=>o.hasClass("app-link"),r);return s.length>0?s:null}_filterMenus(e,t,r,s,o){return Ke.filterAccordingToSelection("Table",this.selectedRows.length,e,t,{onlyVisible:r,enableDisableKeyStrokes:s,notAllowedTypes:o})}_filterMenusForContextMenu(){return this._filterMenus(this.menus,kt.CONTEXT_MENU,!0,!1,["Header"])}setStaticMenus(e){this.setProperty("staticMenus",e),this._updateMenuBar()}_removeMenus(){}notifyRowSelectionFinished(){this._triggerRowsSelectedPending&&(this._triggerRowsSelected(),this._triggerRowsSelectedPending=!1),this.session.onRequestsDone(this._updateMenuBar.bind(this))}_triggerRowClick(e,t,r,s){this.trigger("rowClick",{originalEvent:e,row:t,mouseButton:r,column:s})}_triggerRowAction(e,t){this.trigger("rowAction",{row:e,column:t})}focusCell(e,t){let r=this.cell(e,t);this.enabledComputed&&t.enabled&&r.editable&&this.prepareCellEdit(e,t)}prepareCellEdit(e,t,r){let s=a().resolvedPromise();return this.cellEditorPopup&&(s=this.cellEditorPopup.waitForCompleteCellEdit()),s.then(this.prepareCellEditInternal.bind(this,e,t,r))}prepareCellEditInternal(e,t,r){if(this.openFieldPopupOnCellEdit=u.nvl(r,!1),!this.trigger("prepareCellEdit",{column:e,row:t}).defaultPrevented){this.selectRow(t);let o=e.createEditor(t);this.startCellEdit(e,t,o)}}cell(e,t){return e===this.rowIconColumn?u.create(Pt,{iconId:t.iconId,cssClass:y.join(" ","row-icon-cell",t.cssClass)}):e===this.checkableColumn?u.create(Pt,{value:t.checked,editable:!0,cssClass:t.cssClass}):e===this.compactColumn?u.create(Pt,{text:t.compactValue,htmlEnabled:!0}):t.cells[e.index]}cellByCellIndex(e,t){return this.cell(this.columns[e],t)}cellValue(e,t){let r=this.cell(e,t);return r&&(r.value!==void 0?r.value:"")}cellText(e,t){let r=this.cell(e,t);return r&&r.text||""}nextEditableCellPos(e,t,r){let s=this.columns.indexOf(e),o=s+1;r&&(o=s-1);let n=this.nextEditableCellPosForRow(o,t,r);if(n)return n;let l=p=>{if(!p.$row)return!1;if(o=0,r&&(o=this.columns.length-1),n=this.nextEditableCellPosForRow(o,p,r),n)return!0},d=this.rows.indexOf(t),h=d+1;return r&&(h=d-1),f.findFrom(this.rows,h,l,r),n}nextEditableCellPosForRow(e,t,r){let s=n=>{if(!n.isVisible()||n.guiOnly)return!1;let l=this.cell(n,t);return this.enabledComputed&&t.enabled&&l.editable},o=f.findFrom(this.columns,e,s,r);if(o)return{column:o,row:t}}clearAggregateRows(e){this._aggregateRows.forEach(t=>{t.prevRow&&(t.prevRow.aggregateRowAfter=null),t.nextRow&&(t.nextRow.aggregateRowBefore=null)}),this._isDataRendered()&&(this._removeAggregateRows(e),this._renderSelection()),this._aggregateRows=[]}_forEachVisibleColumn(e,t,r){let s;this.visibleColumns().forEach((o,n)=>{o[e]?(r&&(s=o.cellValueOrTextForCalculation(r)),t[n]=o[e](t[n],s)):t[n]=void 0})}_group(e){let t,r,s=this._groupedColumns(),o=this.groupingStyle===W.GroupingStyle.TOP,n=[];if(this.clearAggregateRows(),!s.length)return;let l=this.visibleRows;this._forEachVisibleColumn("aggrStart",n),l.forEach((d,h)=>{t||(t=d),this._forEachVisibleColumn("aggrStep",n,d);let p=l[h+1];(h===l.length-1||this._isNewGroup(s,d,p))&&(this._forEachVisibleColumn("aggrFinish",n),this._addAggregateRow(n,o?r:d,o?t:p),this._forEachVisibleColumn("aggrStart",n),t=null,r=d)}),this._isDataRendered()&&(this._renderAggregateRows(e),this._renderSelection())}_isNewGroup(e,t,r){let s=!1;if(!r)return!0;for(let o=0;o<e.length;o++){let n=e[o],l=n&&n.cellTextForGrouping&&typeof n.cellTextForGrouping=="function";if(s=s||l&&n.cellTextForGrouping(t)!==n.cellTextForGrouping(r),s=s||!l&&this.cellText(n,t)!==this.cellText(n,r),s)return!0}return!1}_groupedColumns(){return this.columns.filter(e=>e.grouped)}_addAggregateRow(e,t,r){let s={contents:e.slice(),prevRow:t,nextRow:r};this._aggregateRows.push(s),t&&(t.aggregateRowAfter=s),r&&(r.aggregateRowBefore=s)}_removeAggregateRows(e){this._aggregateRows.length!==0&&(e=u.nvl(e,!1),e?this._aggregateRows.forEach(t=>this._hideRow(t)):(this._aggregateRows.forEach(t=>this._removeRow(t)),this.updateScrollbars()))}_renderAggregateRows(e){let t=this.groupingStyle===W.GroupingStyle.TOP,r=t?"insertBefore":"insertAfter";e=u.nvl(e,!1),this._aggregateRows.forEach(s=>{if(s.$row)return;let o=t?s.nextRow:s.prevRow;if(!o||!o.$row)return;let n=this._build$AggregateRow(s);n[r](o.$row).width(this.rowWidth),this.visibleColumns().map(l=>a()(l.buildCellForAggregateRow(s)).appendTo(n)).forEach(l=>this._resizeAggregateCell(l)),s.height=this._measureRowHeight(n),s.$row=n,e&&this._showRow(s)})}_build$AggregateRow(e){let t=this.groupingStyle===W.GroupingStyle.TOP,r=this.$container.makeDiv("table-aggregate-row").data("aggregateRow",e);return r.toggleClass("grouping-style-top",t),r.toggleClass("grouping-style-bottom",!t),r}groupColumn(e,t,r,s){if(t=u.nvl(t,!1),s=u.nvl(s,!1),s&&this._removeGroupColumn(e),!this.isGroupingPossible(e))return;s||this._addGroupColumn(e,r,t),this.header&&this.header.onSortingChanged();let o=this._sort(!0),n={column:e,groupAscending:e.sortAscending};s&&(n.groupingRemoved=!0),t&&(n.multiGroup=!0),o||(n.groupingRequested=!0,this._animateAggregateRows=!0),this.trigger("group",n)}removeColumnGrouping(e){e&&this.groupColumn(e,!1,"asc",!0)}removeAllColumnGroupings(){this.columns.filter(e=>e.grouped).forEach(this.removeColumnGrouping.bind(this))}isGrouped(){return this.columns.some(e=>e.grouped)}setColumnBackgroundEffect(e,t){e.setBackgroundEffect(t)}_updateBackgroundEffect(){this.columns.forEach(e=>{!e.backgroundEffect||e.updateBackgroundEffect()})}_calculateValuesForBackgroundEffect(){this.columns.forEach(e=>{!e.backgroundEffect||e.calculateMinMaxValues()})}_markAutoOptimizeWidthColumnsAsDirty(){this.columns.forEach(e=>{e.autoOptimizeWidthRequired=!0})}_markAutoOptimizeWidthColumnsAsDirtyIfNeeded(e,t,r){let s=!1;for(let o=e.length-1;o>=0;o--){let n=e[o];this.cellValue(n,t)!==this.cellValue(n,r)&&(n.autoOptimizeWidthRequired=!0,e.splice(o,1),s=!0)}return s}setMultiCheck(e){this.setProperty("multiCheck",e)}checkedRows(){return this.rows.filter(e=>e.checked)}checkRow(e,t,r){let s=a().extend(r,{checked:t});this.checkRows([e],s)}checkRows(e,t){let r=a().extend({checked:!0,checkOnlyEnabled:!0},t),s=[];!this.checkable||!this.enabledComputed&&r.checkOnlyEnabled||(e=f.ensure(e),e.forEach(o=>{if(!(!o.enabled&&r.checkOnlyEnabled||o.checked===r.checked)){if(!this.multiCheck&&r.checked)for(let n=0;n<this.rows.length;n++)this.rows[n].checked&&(this.rows[n].checked=!1,s.push(this.rows[n]));o.checked=r.checked,s.push(o)}}),this._isDataRendered()&&s.forEach(o=>this._renderRowChecked(o)),this._triggerRowsChecked(s))}uncheckRow(e,t){this.uncheckRows([e],t)}uncheckRows(e,t){let r=a().extend({checked:!1},t);this.checkRows(e,r)}isTableNodeColumn(e){return this.hierarchical&&this.tableNodeColumn===e}collapseRow(e){this.collapseRows(f.ensure(e))}collapseAll(){this.expandRowsInternal(this.rootRows,!1,!0)}expandAll(){this.expandRowsInternal(this.rootRows,!0,!0)}collapseRows(e,t){this.expandRowsInternal(e,!1,t)}expandRow(e,t){this.expandRows(f.ensure(e),t)}expandRows(e,t){this.expandRowsInternal(e,!0,t)}expandRowsInternal(e,t,r){let s=[],o=[];e=e||this.rootRows,t=u.nvl(t,!0),r=u.nvl(r,!1),r?this.visitRows(n=>{n.expanded!==t&&(n.expanded=t,s.push(n),n.$row&&o.push(n))},e):s=e.filter(n=>{let l=n.expanded!==t;return l&&n.$row&&o.push(n),n.expanded=t,l}),s.length!==0&&(this._updateRowStructure({visibleRows:!0}),this._triggerRowsExpanded(s),this._isDataRendered()&&(this._renderRowDelta(),o.forEach(n=>n.animateExpansion()),e[0].$row&&x.ensureExpansionVisible({element:e[0],$element:e[0].$row,$scrollable:this.get$Scrollable(),isExpanded:n=>n.expanded,getChildren:n=>n.childRows,defaultChildHeight:this.rowHeight})))}doRowAction(e,t){this.selectedRows.length!==1||this.selectedRows[0]!==e||(t=t||this.columns[0],!(!e||!t)&&this._triggerRowAction(e,t))}insertRow(e){this.insertRows([e])}insertRows(e){let t=f.ensure(e);if(t.length===0)return;let r=this.rows.length===0;t.forEach((o,n)=>{let l=this._initRow(o);l.status=Qt.Status.INSERTED,t[n]=l,this.rows.push(l)});let s=t;this.filterSupport.applyFilters(s),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this.filterCount()>0&&s.some(o=>o.filterAccepted)&&this._triggerFilter(),this._calculateValuesForBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsInserted(s),this._sortAfterInsert(r),this._isDataRendered()&&(this.hierarchical&&this._renderRowOrderChanges(),this._insertedRows?f.pushAll(this._insertedRows,s):(this._insertedRows=s,setTimeout(()=>{this._insertedRows=null},0)),this.viewRangeDirty=!0,this._renderViewport(),this.invalidateLayoutTree())}_sortAfterInsert(e){this._sort()}_sortWhileInit(){this._sort()}deleteRow(e){this.deleteRows([e])}deleteRows(e){if(e=f.ensure(e),e.length===0)return;let t,r,s=[];this.visitRows(o=>{!this.rowsMap[o.id]||(s.push(o),this._isDataRendered()&&(this.cellEditorPopup&&this.cellEditorPopup.row.id===o.id&&this.cellEditorPopup.cancelEdit(),this._removeRows(o),t=!0),f.remove(this.rows,o),f.remove(this.visibleRows,o),this.filterCount()>0&&f.remove(this._filteredRows,o)&&(r=!0),delete this.rowsMap[o.id],this.selectionHandler.lastActionRow===o&&this.selectionHandler.clearLastSelectedRowMarker())},e),this.deselectRows(s),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),r&&this._triggerFilter(),this._group(),this._updateBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsDeleted(e),t&&(this._renderViewport(),this._renderRangeMarkers(),this._renderFiller(),this._renderEmptyData(),this.invalidateLayoutTree())}deleteAllRows(){let e=this.filterCount()>0&&this._filteredRows.length>0,t=this.rows;this._isDataRendered()&&(this.cellEditorPopup&&this.cellEditorPopup.cancelEdit(),this.selectionHandler.clearLastSelectedRowMarker(),this._removeRows()),this.rows=[],this.rowsMap={},this._filteredRows=[],this.deselectAll(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),e&&this._triggerFilter(),this._markAutoOptimizeWidthColumnsAsDirty(),this._group(),this._updateBackgroundEffect(),this._triggerAllRowsDeleted(t),this._isDataRendered()&&(this._renderFiller(),this._renderViewport(),this._renderEmptyData(),this.invalidateLayoutTree())}updateRow(e){this.updateRows([e])}updateRows(e){if(e=f.ensure(e),e.length===0)return;if(this.updateBuffer.isBuffering()){this.updateBuffer.buffer(e);return}let t,r,s,o=this.columns.filter(p=>p.autoOptimizeWidth&&!p.autoOptimizeWidthRequired),n={};this.rows.forEach((p,m)=>{n[p.id]=m});let l={},d=!1,h=e.map(p=>{let m=p.parentRow,g=this.rowsMap[p.id];if(l[p.id]=g,!g)throw new Error("Update event received for non existing row. RowId: "+p.id);p.parentRow&&(typeof p.parentRow=="string"?m=p.parentRow:v.isNullOrUndefined(p.parentRow.id)||(m=p.parentRow.id)),d=d||u.nvl(g._parentRowId,null)!==u.nvl(m,null),r=r||g.expanded!==u.nvl(p.expanded,!1);let b=this._initRow(p);return b.status===Qt.Status.NON_CHANGED&&b.cells.some((C,P)=>{let R=g.cells[P];return!R||R.value!==C.value?(b.status=Qt.Status.UPDATED,!0):!1}),this.selectionHandler.lastActionRow===g&&(this.selectionHandler.lastActionRow=b),f.replace(this.selectedRows,g,b),this.rows[n[b.id]]=b,b.filterAccepted=g.filterAccepted,this.filterCount()>0&&(t=this._applyFiltersForRow(b)||t),s=this._markAutoOptimizeWidthColumnsAsDirtyIfNeeded(o,g,b),b});this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this._triggerRowsUpdated(h),this._isDataRendered()&&(this._renderUpdateRows(h,l),d&&this._renderRowOrderChanges()),t&&this._triggerFilter(),(t||r)&&this._renderRowDelta(),this._sortAfterUpdate(),this._updateBackgroundEffect(),this.invalidateLayoutTree()}_renderUpdateRows(e,t){e.forEach(r=>{let s=t[r.id];if(!s.$row||s.$row.hasClass("hiding"))return;let o=a()(this._buildRowDiv(r));o.copyCssClasses(s.$row,W.SELECTION_CLASSES+" first last"),s.$row.replaceWith(o),W.linkRowToDiv(r,o),this._destroyTooltipsForRow(r),this._destroyCellEditorForRow(r),this._installRow(r),s.$row.hasClass("showing")&&s.$row.outerHeight()<r.$row.outerHeight()/3&&this._showRow(r)})}_sortAfterUpdate(){this._sort()}isHierarchical(){return this.hierarchical}_setHierarchical(e){this.hierarchical!==e&&(e&&this.removeAllColumnGroupings(),this._setProperty("hierarchical",e))}updateRowOrder(e){if(e=f.ensure(e),e.length!==this.rows.length)throw new Error("Row order may not be updated because lengths of the arrays differ.");this.rows=e.slice(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this.clearAggregateRows(this._animateAggregateRows),this._isDataRendered()&&this._renderRowOrderChanges(),this._triggerRowOrderChanged(),this._group(this._animateAggregateRows),this._animateAggregateRows=!1}_destroyTooltipsForRow(e){for(let t=this.tooltips.length-1;t>=0;t--)this.tooltips[t].row.id===e.id&&(this.tooltips[t].destroy(),this.tooltips.splice(t,1))}_destroyCellEditorForRow(e){this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id&&this.cellEditorPopup.destroy()}startCellEdit(e,t,r){if(r.destroyed)return;if(!this._isDataRendered()){this._postRenderActions.push(this.startCellEdit.bind(this,e,t,r));return}if(!this.$container.isAttached()){this._postAttachActions.push(this.startCellEdit.bind(this,e,t,r));return}this.trigger("startCellEdit",{column:e,row:t,field:r}),this.ensureRowRendered(t);let s=e.startCellEdit(t,r);return this.cellEditorPopup=s,this.$container.toggleClass("has-cell-editor-popup",!!s),s}endCellEdit(e,t){if(!this.cellEditorPopup){e.destroy();return}this._destroyCellEditorPopup(this._updateCellFromEditor.bind(this,this.cellEditorPopup,e,t))}_updateCellFromEditor(e,t,r){r=u.nvl(r,!1),r&&e.column.updateCellFromEditor(e.row,t),t.destroy()}completeCellEdit(){let e=this.cellEditorPopup.cell.field;if(!this.trigger("completeCellEdit",{field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell}).defaultPrevented)return this.endCellEdit(e,!0)}cancelCellEdit(){let e=this.cellEditorPopup.cell.field;this.trigger("cancelCellEdit",{field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell}).defaultPrevented||this.endCellEdit(e)}scrollTo(e,t){this.viewRangeRendered.size()!==0&&(this.ensureRowRendered(e),e.$row&&x.scrollTo(this.$data,e.$row,t))}scrollPageUp(){let e=Math.max(0,this.$data[0].scrollTop-this.$data.height());this.setScrollTop(e)}scrollPageDown(){let e=Math.min(this.$data[0].scrollHeight,this.$data[0].scrollTop+this.$data.height());this.setScrollTop(e)}setScrollTop(e){this.setProperty("scrollTop",e),this._isDataRendered()&&this._renderViewport()}_renderScrollTop(){this.rendering||x.scrollTop(this.get$Scrollable(),this.scrollTop)}get$Scrollable(){return this.$data?this.$data:this.$container}setScrollToSelection(e){this.setProperty("scrollToSelection",e)}revealSelection(){if(!this._isDataRendered()){this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this));return}this.selectedRows.length>0&&this.scrollTo(this.selectedRows[0])}revealChecked(){let e=f.find(this.rows,t=>t.checked);e&&this.scrollTo(e)}rowById(e){return this.rowsMap[e]}rowsByIds(e){return e.map(this.rowById.bind(this))}rowsToIds(e){return e.map(t=>t.id)}hasRow(e){return Boolean(this.rowsMap[e.id])}_renderSelection(e){e=f.ensure(e||this.selectedRows);let t=(r,s,o)=>{let n=r.hasClass(o);return s&&!n?(r.addClass(o),1):!s&&n?(r.removeClass(o),1):0};this._renderNoRowsSelectedMarker();for(let r=0;r<e.length;r++){let s=e[r];if(!s.$row)continue;let o=this.selectedRows.indexOf(s)!==-1,n=this.visibleRows,l=n.indexOf(s)-1,d=l>=0&&this.selectedRows.indexOf(n[l])!==-1,h=n.indexOf(s)+1,p=h<n.length&&this.selectedRows.indexOf(n[h])!==-1;o&&d&&s.aggregateRowBefore&&(d=!1),o&&p&&s.aggregateRowAfter&&(p=!1);let m=t(s.$row,o,"selected")+t(s.$row,o&&!d&&p,"select-top")+t(s.$row,o&&d&&!p,"select-bottom")+t(s.$row,o&&!d&&!p,"select-single")+t(s.$row,o&&d&&p,"select-middle");m>0&&d&&e.indexOf(n[l])===-1&&e.push(n[l]),m>0&&p&&e.indexOf(n[h])===-1&&e.push(n[h])}this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.selectedRows.indexOf(this.cellEditorPopup.row)>-1&&(this.cellEditorPopup.position(),this.cellEditorPopup.pack())}_removeSelection(){this.$container.addClass("no-rows-selected"),this.selectedRows.forEach(e=>{!e.$row||(e.$row.select(!1),e.$row.toggleClass(W.SELECTION_CLASSES,!1))})}_renderNoRowsSelectedMarker(){this.$container.toggleClass("no-rows-selected",this.selectedRows.length===0)}addRowToSelection(e,t){this.selectedRows.indexOf(e)>-1||(t=t!==void 0?t:!0,this.selectedRows.push(e),e.$row&&this._isDataRendered()&&(e.$row.select(!0),this._renderSelection(e),this.scrollToSelection&&this.revealSelection()),this._triggerRowsSelectedPending=!0,t||this.notifyRowSelectionFinished())}removeRowFromSelection(e,t){t=t!==void 0?t:!0,f.remove(this.selectedRows,e)&&(this._isDataRendered()&&this._renderSelection(e),t?this._triggerRowsSelectedPending=!0:this._triggerRowsSelected())}selectRow(e,t){this.selectRows(e,t)}selectRows(e,t){e=f.ensure(e).filter(s=>Boolean(this.visibleRowsMap[s.id])),!f.equalsIgnoreOrder(e,this.selectedRows)&&(this._isDataRendered()&&this._removeSelection(),!this.multiSelect&&e.length>1&&(e=[e[0]]),this.selectedRows=e,this._triggerRowsSelected(t),this._updateMenuBar(),this._isDataRendered()&&(this._renderSelection(),this.scrollToSelection&&this.revealSelection()))}deselectRow(e){this.deselectRows(e)}deselectRows(e){e=f.ensure(e);let t=this.selectedRows.slice();f.removeAll(t,e)&&this.selectRows(t)}isRowSelected(e){return this.selectedRows.indexOf(e)>-1}filterCount(){return this.filters.length}filteredRows(){return this._filteredRows}$rows(e){let t=".table-row";return e&&(t+=", .table-aggregate-row"),this.$data.find(t)}$aggregateRows(){return this.$data.find(".table-aggregate-row")}selectedRow(){return this.selectedRows.length>0?this.selectedRows[0]:null}$selectedRows(){return this.$data?this.$data.find(".selected"):a()()}$cellsForColIndex(e,t){let r=".table-row > div:nth-of-type("+e+")";return t&&(r+=", .table-aggregate-row > div:nth-of-type("+e+")"),this.$data.find(r)}$cellsForRow(e){return e.children(".table-cell")}$cell(e,t){let r;return typeof e!="number"?r=this.visibleColumns().indexOf(e):r=e,t.children(".table-cell").eq(r)}columnById(e){return f.find(this.columns,t=>t.id===e)}columnFor$Cell(e,t){t=t||e.parent();let r=this.$cellsForRow(t).index(e);return this.visibleColumns()[r]}columnsByIds(e){return e.map(this.columnById.bind(this))}getVisibleRows(){return this.visibleRows}_updateRowStructure(e){let t=u.nvl(e.updateTree,!1),r=u.nvl(e.filteredRows,t),s=u.nvl(e.applyFilters,r),o=u.nvl(e.filtersChanged,!1),n=u.nvl(e.visibleRows,r);t&&this._rebuildTreeStructure(),r&&this._updateFilteredRows(s,o),n&&this._updateVisibleRows()}_rebuildTreeStructure(){let e=!1;if(this.rows.forEach(t=>{t.childRows=[],e=e||!v.isNullOrUndefined(t.parentRow)}),!e){this.rootRows=this.rows,this._setHierarchical(e);return}this._setHierarchical(e),this.rootRows=[],this.rows.forEach(t=>{let r;if(v.isNullOrUndefined(t.parentRow)){t.parentRow=null,t._parentRowId=null,this.rootRows.push(t);return}if(!v.isNullOrUndefined(t.parentRow.id))r=this.rowsMap[t.parentRow.id];else{let s=t.parentRow;r=this.rowsMap[s]}if(r)t.parentRow=r,t._parentRowId=r.id,r.childRows.push(t);else throw new Error("Parent row of "+t+" can not be resolved.")}),this._maxLevel=0,this.rows=[],this.visitRows((t,r)=>{t.hierarchyLevel=r,this._maxLevel=Math.max(r,this._maxLevel),this.rows.push(t)}),this._calculateTableNodeColumn()}_updateFilteredRows(e,t){t=Boolean(t),e=u.nvl(e,!0),this._filteredRows=this.rows.filter(r=>(e&&(t=this._applyFiltersForRow(r)||t),r.filterAccepted)),t&&this._triggerFilter()}_updateVisibleRows(){if(this.visibleRows=this._computeVisibleRows(),this.visibleRowsMap=this.visibleRows.reduce((e,t)=>(e[t.id]=t,e),{}),this.initialized){let e=this.selectedRows.filter(t=>!this.visibleRowsMap[t.id]);this.deselectRows(e)}}_computeVisibleRows(e){let t=[];return e=e||this.rootRows,e.forEach(r=>{let s=this._computeVisibleRows(r.childRows);(r.filterAccepted||s.length>0)&&t.push(r),r.expandable=s.length>0,r.expanded&&(t=t.concat(s))}),t}visibleChildRows(e){return e.childRows.filter(t=>Boolean(this.visibleRowsMap[t.id]))}_renderRowDelta(){if(!this._isDataRendered())return;let e=[],t=[];this.$rows().each((r,s)=>{let o=a()(s),n=o.data("row");this.visibleRows.indexOf(n)<0?(n.$row.detach(),t.push(n)):o.hasClass("hiding")?o.stop(!1,!0):e.push(n)}),this._rerenderViewport(),t.forEach(r=>r.$row.insertAfter(this.$fillBefore)),this._order$Rows().insertAfter(this.$fillBefore),this._order$AggregateRows(),t.forEach(r=>this._hideRow(r)),this.$rows().each((r,s)=>{let o=a()(s),n=o.data("row");o.hasClass("hiding")||e.indexOf(n)<0&&this._showRow(n)}),this._renderScrollTop(),this._renderEmptyData()}_order$Rows(e){return e=e||this.$rows(),e.sort((t,r)=>{let s=a()(t),o=a()(r),n=s.data("row"),l=o.data("row");return this.rows.indexOf(n)-this.rows.indexOf(l)})}_order$AggregateRows(e){e=e||this.$aggregateRows(),e.each((t,r)=>{let s=a()(r),o=s.data("aggregateRow");!o||!o.prevRow||s.insertAfter(o.prevRow.$row)})}_applyFiltersForRow(e){return this.filterSupport.applyFiltersForElement(e)}filteredBy(){let e=[];return this.filters.forEach(t=>{t instanceof Zt&&e.push(t.createLabel())}),e}resetUserFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.filters.filter(t=>t instanceof Zt).forEach(t=>this.removeFilter(t,e)),this._triggerFilterReset()}hasUserFilter(){return this.filters.filter(e=>e instanceof Zt).length>0}resizeToFit(e,t){if(e.fixedWidth)return;let r=e.calculateOptimalWidth();v.isPlainObject(r)?r.always(this._resizeToFit.bind(this,e,t)):this._resizeToFit(e,t,r)}_resizeToFit(e,t,r){r!==-1&&(t&&t>0&&r>t&&(r=t),e.width!==r&&this.resizeColumn(e,r),e.autoOptimizeWidthRequired=!1,this._triggerColumnResizedToFit(e))}addFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e instanceof Zt){let s=this.getFilter(e.createKey());this.filterSupport.removeFilter(s,!1)}let r=this.filterSupport.addFilter(e,t);r&&r.length&&this.trigger("filterAdded",{filter:r[0]})}removeFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this.filterSupport.removeFilter(e,t);r&&r.length&&this.trigger("filterRemoved",{filter:r[0]})}removeFilterByKey(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.removeFilter(this.getFilter(e),t)}getFilter(e){return f.find(this.filters,t=>t instanceof Zt?v.equals(t.createKey(),e):!1)}setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.resetUserFilter(!1);let r=e.map(l=>this._ensureFilter(l)),s=this.filterSupport.setFilters(r,t),o=s.filtersAdded,n=s.filtersRemoved;o.forEach(l=>this.trigger("filterAdded",{filter:l})),n.forEach(l=>this.trigger("filtersRemoved",{filter:l}))}_ensureFilter(e){if(e instanceof Zt||!e.objectType)return e;let t=e;return t.column&&(t.column=this.columnById(t.column)),t.table=this,t.session=this.session,u.create(t)}filter(){this.filterSupport.filter()}_filter(e){this._updateRowStructure(a().extend({},e,{filteredRows:!0})),this._renderRowDelta(),this._group(),this.revealSelection()}_createFilterSupport(){return new Ho({widget:this,$container:()=>this.$container,getElementsForFiltering:()=>this.rows,createTextFilter:()=>u.create(mr,{session:this.session,table:this}),updateTextFilterText:(e,t)=>v.equals(e.text,t)?!1:(e.text=t,!0)})}setTextFilterEnabled(e){this.setProperty("textFilterEnabled",e)}isTextFilterFieldVisible(){return this.textFilterEnabled&&!this.footerVisible}_renderTextFilterEnabled(){this.filterSupport.renderFilterField()}updateFilteredElements(e,t){this.filteredElementsDirty&&(this._filter({filteredRows:!0,applyFilters:!1,filtersChanged:!0}),this.filteredElementsDirty=!1)}resizeColumn(e,t){e.fixedWidth||(t=Math.floor(t),e.setWidth(t),this._isDataRendered()&&this._renderResizeColumn(e,t),this._triggerColumnResized(e))}_renderResizeColumn(e,t){let r=this.visibleColumns().indexOf(e);if(r!==-1){let s=r+1;this.$cellsForColIndex(s,!0).css("min-width",t).css("max-width",t),this._updateRealColumnWidth(e),this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._updateRowHeights(),this._renderFiller(),this._renderViewport(),this.updateScrollbars(),this._renderEmptyData()}this._aggregateRows.forEach(s=>{s.$row&&this._resizeAggregateCell(this.$cell(e,s.$row))})}_resizeAggregateCell(e){let t=this._getAggrCellRange(e);this._updateAggrCell(t[0]),t.length>1&&this._updateAggrCell(t[t.length-1])}_getAggrCellRange(e){let t=[],r=e.parent(),s=this.visibleColumns(),o=e,n,l=h=>!h.hasClass("empty");if(l(e))n=e.hasClass("halign-right")?-1:1;else{n=1;let h=s.indexOf(this.columnFor$Cell(e));for(let p=h-1;p>=0&&(o=this.$cell(s[p],r),!l(o));p--);}t.push(o);let d=s.indexOf(this.columnFor$Cell(o));for(let h=d+n;h>=0&&h<s.length;h+=n){let p=this.$cell(s[h],r);if(t.push(p),l(p))break}return t}_updateAggrCell(e){let t=e.children(".text");if(!t||!t.length||e.hasClass("empty"))return;let r=e.children(".table-cell-icon").first(),s=this._getAggrCellWidth(e,r);s=this._updateAggrIconVisibility(r,t,s),t.cssMaxWidth(s)}_getWidthWithMarginCached(e){if(!e||!e.length)return 0;let t="widthWithMargin",r=e.data(t);if(r)return r;let s=e.isVisible();s||e.setVisible(!0);let o=w.size(e,{includeMargin:!0}).width;return s||e.setVisible(!1),e.data(t,o),o}_getAggrCellWidth(e,t){let r=e.cssMaxWidth()-e.cssPaddingX();t&&t.length&&t.isVisible()&&(r-=this._getWidthWithMarginCached(t));let s=this._getAggrCellRange(e);for(let o=1;o<s.length;o++){let n=s[o];if(n.hasClass("empty"))r+=n.cssMaxWidth();else{if(e.hasClass("halign-right")!==n.hasClass("halign-right")){let h=n.cssMaxWidth(),p=n.children().toArray().map(g=>a()(g)).filter(g=>g.isVisible()).map(g=>w.size(g,{includeMargin:!0}).width).reduce((g,b)=>g+b,0)+e.cssPaddingLeft(),m=h-p;n.hasClass("halign-center")&&(m/=2),r+=m}break}}return Math.max(0,r)}_updateAggrIconVisibility(e,t,r){if(!e||!e.length)return r;let s=e.isVisible(),o=this._getWidthWithMarginCached(e),n=this._getWidthWithMarginCached(t),d=r-n+(s?o:0)>o;return d===s?r:(e.setVisible(d),r+(d?-o:o))}moveColumn(e,t,r,s){r=this._considerFixedPositionColumns(t,r);let o=this.visibleColumns(),n=o[r],l=this.columns.indexOf(n);f.remove(this.columns,e),f.insert(this.columns,e,l),o=this.visibleColumns(),r=o.indexOf(e),this._calculateTableNodeColumn(),this._triggerColumnMoved(e,t,r,s),this._aggregateRows.forEach(d=>f.move(d.contents,t,r)),this._isDataRendered()&&this._rerenderViewport()}_considerFixedPositionColumns(e,t){let r=-1;return t>e?(r=f.findIndexFrom(this.visibleColumns(),e,s=>s.fixedPosition),r>-1&&(t=Math.min(t,r-1))):(r=f.findIndexFromReverse(this.visibleColumns(),e,s=>s.fixedPosition),r>-1&&(t=Math.max(t,r+1))),t}_renderColumnOrderChanges(e){let t,r=this;this.header&&this.header.onOrderChanged(e),this.$rows(!0).each(function(){let s=a()(this),o=a()(),n=s.children();for(let l=0;l<r.columns.length;l++){let d=r.columns[l];for(let h=0;h<e.length;h++)if(e[h]===d){t=n[h];break}o.push(t)}s.prepend(o)})}_triggerRowsInserted(e){this.trigger("rowsInserted",{rows:e})}_triggerRowsDeleted(e){this.trigger("rowsDeleted",{rows:e})}_triggerRowsUpdated(e){this.trigger("rowsUpdated",{rows:e})}_triggerAllRowsDeleted(e){this.trigger("allRowsDeleted",{rows:e})}_triggerRowsSelected(e){this.trigger("rowsSelected",{debounce:e})}_triggerRowsChecked(e){this.trigger("rowsChecked",{rows:e})}_triggerRowsExpanded(e){this.trigger("rowsExpanded",{rows:e})}_triggerFilter(){this.trigger("filter")}_triggerFilterReset(){this.trigger("filterReset")}_triggerAppLinkAction(e,t,r,s){this.trigger("appLinkAction",{column:e,row:t,ref:r,$appLink:s})}_triggerReload(e){this.trigger("reload",{reloadReason:e})}_triggerClipboardExport(){this.trigger("clipboardExport").defaultPrevented||this._exportToClipboard()}_triggerRowOrderChanged(e,t){let r={row:e,animating:t};this.trigger("rowOrderChanged",r)}_triggerColumnResized(e){let t={column:e};this.trigger("columnResized",t)}_triggerColumnResizedToFit(e){let t={column:e};this.trigger("columnResizedToFit",t)}_triggerColumnMoved(e,t,r,s){let o={column:e,oldPos:t,newPos:r,dragged:s};this.trigger("columnMoved",o)}_triggerAggregationFunctionChanged(e){let t={column:e};this.trigger("aggregationFunctionChanged",t)}setHeaderVisible(e){this.setProperty("headerVisible",e)}_renderHeaderVisible(){this._renderTableHeader()}setHeaderEnabled(e){this.setProperty("headerEnabled",e)}_renderHeaderEnabled(){this._removeTableHeader(),this._renderTableHeader()}setHeaderMenusEnabled(e){this.setProperty("headerMenusEnabled",e),this.header&&this.header.setHeaderMenusEnabled(this.headerMenusEnabled)}hasPermanentHeadOrTailSortColumns(){return this._permanentHeadSortColumns.length!==0||this._permanentTailSortColumns.length!==0}_setHeadAndTailSortColumns(){let e=this.columns.filter(t=>t.sortIndex>=0);e.sort((t,r)=>t.sortIndex-r.sortIndex),this._permanentHeadSortColumns=[],this._permanentTailSortColumns=[],e.forEach(t=>{t.initialAlwaysIncludeSortAtBegin?this._permanentHeadSortColumns.push(t):t.initialAlwaysIncludeSortAtEnd&&this._permanentTailSortColumns.push(t)})}setTileMode(e){this.setProperty("tileMode",e)}_setTileMode(e){e&&(this._ensureMediator(),this.tileTableHeader||this._setTileTableHeader(this._createTileTableHeader()),this.tableTileGridMediator.loadTiles(),this.tableTileGridMediator.activate()),this._setProperty("tileMode",e),!e&&this.tableTileGridMediator&&this.tableTileGridMediator.deactivate()}_ensureMediator(){this.tableTileGridMediator||(this.tableTileGridMediator=u.create(so,{parent:this,gridColumnCount:6}))}_renderTileMode(){this.tableTileGridMediator&&this.tableTileGridMediator.renderTileMode()}createTiles(e){return e.map(t=>{let r=this.createTileForRow(t);return this._adaptTile(r),r.rowId=t.id,r})}_adaptTile(e){e.gridDataHints={weightX:0}}createTileForRow(e){if(this.tileProducer)return this.tileProducer(e);throw new Error("Cannot create a tile without a producer.")}setTileProducer(e){this.setProperty("tileProducer",e)}_setTileTableHeader(e){e&&e.addCssClass("tile-table-header"),this._setProperty("tileTableHeader",e)}_createTileTableHeader(){return u.create(Wf,{parent:this})}setRowIconVisible(e){this.setProperty("rowIconVisible",e)}_setRowIconVisible(e){this._setProperty("rowIconVisible",e);let t=this.rowIconColumn;this.rowIconVisible&&!t?(this._insertRowIconColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!this.rowIconVisible&&t&&(t.destroy(),f.remove(this.columns,t),this.rowIconColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}_renderRowIconVisible(){this.columnLayoutDirty=!0,this._updateRowWidth(),this.redraw()}_renderRowIconColumnWidth(){!this.rowIconVisible||this._renderRowIconVisible()}setRowIconColumnWidth(e){this.setProperty("rowIconColumnWidth",e)}_setRowIconColumnWidth(e){this._setProperty("rowIconColumnWidth",e);let t=this.rowIconColumn;t&&(t.width=e)}_setSelectedRows(e){typeof e[0]=="string"&&(e=this.rowsByIds(e)),this._setProperty("selectedRows",e)}setMenus(e){this.setProperty("menus",e)}_setMenus(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar(),this.header&&this.header.updateMenuBar()}setMenuBarVisible(e){this.setProperty("menuBarVisible",e)}_setMenuBarVisible(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}_renderMenuBarVisible(){this.menuBarVisible?(this.menuBar.render(),this._refreshMenuBarPosition()):this.menuBar.remove(),this._updateMenuBar(),this.invalidateLayoutTree()}_refreshMenuBarPosition(){this.$container.removeClass("menubar-top"),this.$container.removeClass("menubar-bottom"),this.menuBarVisible&&this.menuBar.rendered&&(this.menuBar.position===ce.Position.TOP?(this.menuBar.$container.prependTo(this.$container),this.$container.addClass("menubar-top")):(this.menuBar.$container.appendTo(this.$container),this.$container.addClass("menubar-bottom")))}_createMenuBar(){return u.create(ce,{parent:this,position:ce.Position.BOTTOM,menuOrder:new sn(this.session,"Table"),menuFilter:this._filterMenusHandler,cssClass:"bounded"})}_updateMenuBar(){if(this.menuBarVisible){let e=["Header"],t=this._filterMenus(this.menus,kt.MENU_BAR,!1,!0,e);t=this.staticMenus.concat(t),this.menuBar.setMenuItems(t)}else this.menuBar.setMenuItems([]);if(this._refreshMenuBarClasses(),this.contextMenu){let e=this._filterMenus(this.menus,kt.CONTEXT_MENU,!0,!1,["Header"]);this.contextMenu.updateMenuItems(e)}}_refreshMenuBarClasses(){!this.$container||(this.$container.toggleClass("has-menubar",this.menuBar&&this.menuBar.visible),this.$container.toggleClass("menubar-top",this.menuBar&&this.menuBar.position===ce.Position.TOP),this.$container.toggleClass("menubar-bottom",this.menuBar&&this.menuBar.position!==ce.Position.TOP))}_setKeyStrokes(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}setTableStatus(e){this.setProperty("tableStatus",e)}_setTableStatus(e){e=E.ensure(e),this._setProperty("tableStatus",e)}setTableStatusVisible(e){this.setProperty("tableStatusVisible",e),this._updateFooterVisibility()}_updateFooterVisibility(){this.setFooterVisible(this.tableStatusVisible||this._hasVisibleTableControls())}setHierarchicalStyle(e){this.setProperty("hierarchicalStyle",e)}_renderHierarchicalStyle(){this.$container.toggleClass("structured",W.HierarchicalStyle.STRUCTURED===this.hierarchicalStyle)}setFooterVisible(e){this._setProperty("footerVisible",e),e&&!this.footer&&(this.footer=this._createFooter()),this.tableControls.forEach(t=>{t.tableFooter=this.footer}),this.rendered&&this._renderFooterVisible(),!e&&this.footer&&(this.footer.destroy(),this.footer=null)}_renderBackgroundEffect(){this.columns.forEach(e=>{!e.backgroundEffect||e._renderBackgroundEffect()})}_renderRowChecked(e){if(!this.checkable||!e.$row)return;let t;if(this.checkableStyle===W.CheckableStyle.TABLE_ROW)t=e.$row;else{if(!this.checkableColumn)throw new Error("checkableColumn not set");t=this.checkableColumn.$checkBox(e.$row)}t.toggleClass("checked",e.checked)}setCheckable(e){this.setProperty("checkable",e)}_setCheckable(e){this._setProperty("checkable",e),this._updateCheckableColumn()}_updateCheckableColumn(){let e=this.checkableColumn,t=this.checkable&&u.isOneOf(this.checkableStyle,W.CheckableStyle.CHECKBOX,W.CheckableStyle.CHECKBOX_TABLE_ROW);t&&!e?(this._insertBooleanColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!t&&e&&e.guiOnly&&(e.destroy(),f.remove(this.columns,e),this.checkableColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}_renderCheckable(){this.columnLayoutDirty=!0,this._updateRowWidth(),this.redraw()}setCheckableStyle(e){this.setProperty("checkableStyle",e)}_setCheckableStyle(e){this._setProperty("checkableStyle",e),this._updateCheckableColumn()}_renderCheckableStyle(){this.$container.toggleClass("checkable",u.isOneOf(this.checkableStyle,W.CheckableStyle.TABLE_ROW,W.CheckableStyle.CHECKBOX_TABLE_ROW)),this.$container.toggleClass("table-row-check",this.checkableStyle===W.CheckableStyle.TABLE_ROW),this._isDataRendered()&&(this._updateRowWidth(),this.redraw())}setCompact(e){this.setProperty("compact",e)}_setCompact(e){this._setProperty("compact",e),this._updateCompactColumn(),this.compactHandler&&this.compactHandler.handle(this.compact)}_updateCompactColumn(){let e=this.compactColumn;return this.compact&&!e?(this._insertCompactColumn(),!0):!this.compact&&e?(e.destroy(),f.remove(this.columns,e),this.compactColumn=null,!0):!1}_insertCompactColumn(){let e=u.create(Ru,{session:this.session,table:this,guiOnly:!0,headerMenuEnabled:!1});this.columns.push(e),this.compactColumn=e}_renderCompact(){this.columnLayoutDirty=!0,this._updateRowWidth(),this.redraw()}setGroupingStyle(e){this.setProperty("groupingStyle",e)}_setGroupingStyle(e){this._setProperty("groupingStyle",e),this._group()}_renderGroupingStyle(){this._rerenderViewport()}redraw(){!this._isDataRendered()||(this._rerenderHeaderColumns(),this._rerenderViewport(),this.invalidateLayoutTree())}_rerenderHeaderColumns(){this.header&&(this.header.rerenderColumns(),this.invalidateLayoutTree())}_renderTableHeader(){if(this.tileMode)return;let e=!1;this.headerVisible&&!this.header?(this.header=this._createHeader(),this.header.render(),this._renderEmptyData(),e=!0):!this.headerVisible&&this.header&&(this._removeTableHeader(),this._removeEmptyData(),e=!0),this.$container.toggleClass("header-invisible",!this.header),e&&this.invalidateLayoutTree()}_removeTableHeader(){this.header&&(this.header.destroy(),this.header=null)}_renderEmptyData(){!this.header||this.visibleRows.length>0||(this.$emptyData||(this.$emptyData=this.$data.appendDiv().html("&nbsp;")),this.$emptyData.css("min-width",this.rowWidth).css("max-width",this.rowWidth),this.updateScrollbars())}_removeEmptyData(){this.header&&this.visibleRows.length===0||this.$emptyData&&(this.$emptyData.remove(),this.$emptyData=null,this.updateScrollbars())}_renderFooterVisible(){!this.footer||(this.footerVisible?this._renderFooter():this._removeFooter(),this.invalidateLayoutTree(),this.filterSupport.renderFilterField())}_renderFooter(){this.footer.rendered||this.footer.render()}_removeFooter(){!this.footer.rendered||this.footer.remove()}_renderEnabled(){super._renderEnabled(),this._installOrUninstallDragAndDropHandler();let e=this.enabledComputed;this.tileMode||this.$data.setEnabled(e),this.$container.setTabbableOrFocusable(e)}_renderDisabledStyle(){super._renderDisabledStyle(),this._renderDisabledStyleInternal(this.$data)}setAutoResizeColumns(e){this.setProperty("autoResizeColumns",e)}_renderAutoResizeColumns(){!this.autoResizeColumns&&F.get().hasTableCellZoomBug()&&this.visibleColumns().forEach((e,t)=>{e._realWidth=null}),this.columnLayoutDirty=!0,this.invalidateLayoutTree()}setMultilineText(e){this.setProperty("multilineText",e)}_renderMultilineText(){this._markAutoOptimizeWidthColumnsAsDirty(),this.redraw()}setDropType(e){this.setProperty("dropType",e)}_renderDropType(){this._installOrUninstallDragAndDropHandler()}setDropMaximumSize(e){this.setProperty("dropMaximumSize",e)}_installOrUninstallDragAndDropHandler(){Ae.installOrUninstallDragAndDropHandler({target:this,doInstall:()=>this.dropType&&this.enabledComputed,selector:".table-data,.table-row",onDrop:e=>this.trigger("drop",e),dropType:()=>this.dropType,additionalDropProperties:e=>{let t=a()(e.currentTarget),r={rowId:""};if(t.hasClass("table-row")){let s=t.data("row");r.rowId=s.id}return r}})}_installImageListeners(){this._imageLoadListener=this._onImageLoadOrError.bind(this),this.$data[0].addEventListener("load",this._imageLoadListener,!0),this.$data[0].addEventListener("error",this._imageLoadListener,!0)}_uninstallImageListeners(){this.$data[0].removeEventListener("load",this._imageLoadListener,!0),this.$data[0].removeEventListener("error",this._imageLoadListener,!0)}calculateViewRangeSize(){if(this._updateRowHeight(),this.rowHeight===0)throw new Error("Cannot calculate view range with rowHeight = 0");return Math.ceil(this.$data.outerHeight()/this.rowHeight)*2}setViewRangeSize(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this._isDataRendered()&&this._renderViewport())}_calculateCurrentViewRange(){let e,t=this.$data[0].scrollTop;return this.$data[0].scrollHeight-this.$data[0].clientHeight===0?e=0:e=this._rowIndexAtScrollTop(t),this._calculateViewRangeForRowIndex(e)}_rowIndexAtScrollTop(e){let t=0,r=-1;return this.visibleRows.some((s,o)=>(t+=this._heightForRow(s),e<t?(r=o,!0):!1)),r}_heightForRow(e){let t=0,r=e.aggregateRowBefore;return this.groupingStyle===W.GroupingStyle.BOTTOM&&(r=e.aggregateRowAfter),e.height?t=e.height:t=this.rowHeight,r&&(r.height?t+=r.height:t+=this.aggregateRowHeight),t}_measureRowHeight(e){return w.size(e,{includeMargin:!0,exact:!0}).height}_calculateViewRangeForRowIndex(e){if(!this.virtual)return new O(0,this.visibleRows.length);let t=new O,r=Math.floor(this.viewRangeSize/4);return t.from=Math.max(e-r,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleRows.length),this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}_renderViewport(){if(!this.isAttachedAndRendered()){this._renderViewPortAfterAttach=!0;return}if(this._renderViewportBlocked||this.visibleColumns().length===0)return;if(!this.$container.isEveryParentVisible()){this.invalidateLayoutTree();return}let e=this._calculateCurrentViewRange();this._renderViewRange(e),this._renderLastRowAtBottomMarker(),this._renderNoRowsSelectedMarker()}_rerenderViewport(){if(!this.isAttachedAndRendered()){this._rerenderViewPortAfterAttach=!0;return}this._removeRows(),this._removeAggregateRows(),this._renderFiller(),this._renderViewport()}_renderViewRangeForRowIndex(e){let t=this._calculateViewRangeForRowIndex(e);this._renderViewRange(t)}_renderViewRange(e){if(e.from===this.viewRangeRendered.from&&e.to===this.viewRangeRendered.to&&!this.viewRangeDirty)return;this._removeRangeMarkers();let t=e.subtract(this.viewRangeRendered);if(this.viewRangeRendered.subtract(e).forEach(s=>this._removeRowsInRange(s)),t.forEach(s=>this._renderRowsInRange(s)),this.viewRangeRendered.size()>0){let s=this.visibleRows,o=s[this.viewRangeRendered.from],n=s[this.viewRangeRendered.to-1];if(!o.$row||!n.$row)throw new Error("Rows not rendered as expected. "+this.viewRangeRendered+". First: "+w.debugOutput(o.$row)+". Last: "+w.debugOutput(n.$row)+". Length: visibleRows="+this.visibleRows.length+" rows="+this.rows.length)}this._renderRangeMarkers(),this._removeAggregateRows(),this._renderAggregateRows(),this._renderFiller(),this._renderEmptyData(),this._renderBackgroundEffect(),this._renderSelection(),this.viewRangeDirty=!1}_renderLastRowAtBottomMarker(){if(this.$rows().is(":animated"))return;let e=this._lastVisibleRow();e&&e.$row?this.$data.toggleClass("last-row-at-bottom",Math.ceil(w.offsetBounds(e.$row).bottom())>=w.offsetBounds(this.$data).bottom()):this.$data.removeClass("last-row-at-bottom")}_lastVisibleRow(){return this.visibleRows[this.visibleRows.length-1]}_removeRangeMarkers(){this._modifyRangeMarkers("removeClass")}_renderRangeMarkers(){this._modifyRangeMarkers("addClass")}_modifyRangeMarkers(e){if(this.viewRangeRendered.size()===0)return;let t=this.visibleRows;r(t[this.viewRangeRendered.from],"first"),r(t[this.viewRangeRendered.to-1],"last");function r(s,o){s&&s.$row&&s.$row[e](o)}}ensureRowRendered(e){if(e.$row)return;let t=this.visibleRows.indexOf(e);t<0||this._renderViewRangeForRowIndex(t)}_renderFiller(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("table-data-fill"),this._applyFillerStyle(this.$fillBefore));let e=this._calculateFillerHeight(new O(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.cssWidth(this.rowWidth),a().log.isTraceEnabled()&&a().log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("table-data-fill"),this._applyFillerStyle(this.$fillAfter));let t=this._calculateFillerHeight(new O(this.viewRangeRendered.to,this.visibleRows.length));this.$fillAfter.cssHeight(t),this.$fillAfter.cssWidth(this.rowWidth),a().log.isTraceEnabled()&&a().log.trace("FillAfter height: "+t)}_applyFillerStyle(e){let t=e.css("background-color"),r=((1-1/this.rowHeight)*100).toFixed(2)+"%";e.css({background:"linear-gradient(to bottom, transparent, transparent "+r+", "+t+" "+r+", "+t+")",backgroundSize:"100% "+this.rowHeight+"px",backgroundColor:"transparent"})}_calculateFillerHeight(e){let t=0;for(let r=e.from;r<e.to;r++){let s=this.visibleRows[r];t+=this._heightForRow(s)}return t}containsAggregatedNumberColumn(){return this.initialized?this.visibleColumns().some(e=>e instanceof Oi&&e.aggregationFunction!=="none"):!1}updateColumnStructure(e){this._destroyColumns(),this.columns=e,this._initColumns(),this.trigger("columnStructureChanged"),this._isDataRendered()&&(this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._rerenderHeaderColumns(),this._renderEmptyData())}updateColumnOrder(e){if(e.length!==this.columns.length)throw new Error("Column order may not be updated because lengths of the arrays differ.");let t=this.columns.slice();for(let r=0;r<e.length;r++){let s=e[r],o=f.findIndex(this.columns,n=>n.id===s.id);if(o<0)throw new Error("Column with id "+s.id+"not found.");o!==r&&f.move(this.columns,o,r)}this._isDataRendered()&&this._renderColumnOrderChanges(t)}updateColumnHeaders(e){let t;for(let r=0;r<e.length;r++){let s=this.columnById(e[r].id);t=a().extend(t,s),s.text=e[r].text,s.headerTooltipText=e[r].headerTooltipText,s.headerTooltipHtmlEnabled=e[r].headerTooltipHtmlEnabled,s.headerCssClass=e[r].headerCssClass,s.headerHtmlEnabled=e[r].headerHtmlEnabled,s.headerBackgroundColor=e[r].headerBackgroundColor,s.headerForegroundColor=e[r].headerForegroundColor,s.headerFont=e[r].headerFont,s.headerIconId=e[r].headerIconId,s.sortActive=e[r].sortActive,s.sortAscending=e[r].sortAscending,s.grouped&&!e[r].grouped&&this._removeGroupColumn(s),s.grouped=e[r].grouped,!s.sortActive&&s.sortIndex!==-1?this._removeSortColumn(s):s.grouped&&s.sortActive&&s.sortIndex===-1?this._addGroupColumn(s):s.sortActive&&s.sortIndex===-1?this._addSortColumn(s):s.sortIndex=e[r].sortIndex,this._isDataRendered()&&this.header&&this.header.updateHeader(s,t)}}_attach(){this.$parent.append(this.$container),super._attach()}_postAttach(){this._rerenderViewportAfterAttach();let e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),super._postAttach()}_renderOnAttach(){super._renderOnAttach(),this._rerenderViewportAfterAttach(),this._renderViewportAfterAttach();let e=this._postAttachActions;this._postAttachActions=[],e.forEach(t=>t())}_rerenderViewportAfterAttach(){this._rerenderViewPortAfterAttach&&(this._rerenderViewport(),this._rerenderViewPortAfterAttach=!1,this._renderViewPortAfterAttach=!1)}_renderViewportAfterAttach(){this._renderViewPortAfterAttach&&(this._renderViewport(),this._renderViewPortAfterAttach=!1)}_detach(){this.$container.detach(),super._detach()}_destroyCellEditorPopup(e){if(!this.cellEditorPopup)return;let t=()=>{this.cellEditorPopup.destroy(),this.cellEditorPopup=null,this.$container&&this.$container.removeClass("has-cell-editor-popup"),e&&e()},r=this.cellEditorPopup.waitForCompleteCellEdit();r.state()==="resolved"?t():r.then(t)}setVirtual(e){this._setProperty("virtual",e)}setCellValue(e,t,r){e.setCellValue(t,r)}setCellText(e,t,r){e.setCellText(t,r)}setCellErrorStatus(e,t,r){e.setCellErrorStatus(t,r)}visibleColumns(e){return this.filterColumns(t=>t.isVisible(),e)}displayableColumns(e){return this.filterColumns(t=>t.displayable,e)}filterColumns(e,t){return t=u.nvl(t,!0),this.columns.filter(r=>e(r)&&(t||!r.guiOnly))}_onDesktopPopupOpen(e){let t=e.popup;!this.isFocusable(!1)||this.has(t)&&t instanceof mt&&(this.$container.addClass("focused"),t.one("destroy",()=>{this._isDataRendered()&&this.$container.removeClass("focused")}))}_onDesktopPropertyChange(e){e.propertyName==="dense"&&this.menuBar.invalidateLayoutTree()}markRowsAsNonChanged(e){f.ensure(e||this.rows).forEach(t=>{t.status=Qt.Status.NON_CHANGED})}static parseHorizontalAlignment(e){return e>0?"right":e===0?"center":"left"}static linkRowToDiv(e,t){e&&(e.$row=t),t&&t.data("row",e)}}D(W,"MenuTypes",{EmptySpace:"Table.EmptySpace",SingleSelection:"Table.SingleSelection",MultiSelection:"Table.MultiSelection",Header:"Table.Header"}),D(W,"HierarchicalStyle",{DEFAULT:"default",STRUCTURED:"structured"}),D(W,"GroupingStyle",{TOP:"top",BOTTOM:"bottom"}),D(W,"CheckableStyle",{CHECKBOX:"checkbox",TABLE_ROW:"tableRow",CHECKBOX_TABLE_ROW:"checkbox_table_row"}),D(W,"ReloadReason",{UNSPECIFIED:"unspecified",SEARCH:"search",OVERRIDE_ROW_LIMIT:"overrideRowLimit",RESET_ROW_LIMIT:"resetRowLimit",ORGANIZE_COLUMNS:"organizeColumns",DATA_CHANGED_TRIGGER:"dataChangedTrigger"}),D(W,"SELECTION_CLASSES","select-middle select-top select-bottom select-single selected");function ix(i,e,t){return e=rx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function rx(i){var e=sx(i,"string");return typeof e=="symbol"?e:String(e)}function sx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class So extends He{constructor(){super(),ix(this,"_rebuildingTable",void 0),this._addRemoteProperties(["contextColumn"])}_initProperties(e){super._initProperties(e),e.compactHandler=null}_postCreateWidget(){this.widget.hasUserFilter()&&this._onWidgetFilter()}_sendRowsSelected(e,t){let r={rowIds:e};this._send("rowsSelected",r,{delay:t?250:0,coalesce:function(s){return this.target===s.target&&this.type===s.type}})}_sendRowClick(e,t,r){let s={rowId:e,columnId:r,mouseButton:t};this._send("rowClick",s)}_onWidgetRowsSelected(e){let t=this.widget.rowsToIds(this.widget.selectedRows);this._sendRowsSelected(t,e.debounce)}_onWidgetRowClick(e){let t;e.column!==void 0&&(t=e.column.id),this._sendRowClick(e.row.id,e.mouseButton,t)}_onWidgetFilterAdded(e){let t=e.filter;!(t instanceof Zt)||t instanceof Zi&&t.column.guiOnly||this._send("filterAdded",t.createFilterAddedEventData())}_onWidgetFilterRemoved(e){let t=e.filter;!(t instanceof Zt)||t instanceof Zi&&t.column.guiOnly||this._send("filterRemoved",t.createFilterRemovedEventData())}_onWidgetColumnResized(e){this._sendColumnResized(e.column)}_sendColumnResized(e){if(e.fixedWidth||e.guiOnly||this.widget.autoResizeColumns)return;let t={columnId:e.id,width:e.width};this._send("columnResized",t,{delay:750,coalesce:function(r){return this.target===r.target&&this.type===r.type&&this.columnId===r.columnId},showBusyIndicator:!1})}_onWidgetAggregationFunctionChanged(e){this._sendAggregationFunctionChanged(e.column)}_sendAggregationFunctionChanged(e){if(e.guiOnly)return;let t={columnId:e.id,aggregationFunction:e.aggregationFunction};this._send("aggregationFunctionChanged",t)}_onWidgetColumnBackgroundEffectChanged(e){this._sendColumnBackgroundEffectChanged(e.column)}_sendColumnBackgroundEffectChanged(e){if(e.guiOnly)return;let t={columnId:e.id,backgroundEffect:e.backgroundEffect};this._send("columnBackgroundEffectChanged",t)}_onWidgetColumnOrganizeAction(e){this._send("columnOrganizeAction",{action:e.action,columnId:e.column.id})}_onWidgetColumnMoved(e){let t=e.newPos;this.widget.columns.forEach((r,s)=>{r.guiOnly&&t--}),this._sendColumnMoved(e.column,t)}_sendColumnMoved(e,t){if(e.guiOnly)return;let r={columnId:e.id,index:t};this._send("columnMoved",r)}_onWidgetPrepareCellEdit(e){e.preventDefault(),this._sendPrepareCellEdit(e.row,e.column)}_sendPrepareCellEdit(e,t){if(t.guiOnly)return;let r={rowId:e.id,columnId:t.id};this._send("prepareCellEdit",r)}_onWidgetCompleteCellEdit(e){e.preventDefault(),this._sendCompleteCellEdit()}_sendCompleteCellEdit(){this._send("completeCellEdit")}_onWidgetCancelCellEdit(e){e.preventDefault(),this._sendCancelCellEdit()}_sendCancelCellEdit(){this._send("cancelCellEdit")}_onWidgetRowsChecked(e){this._sendRowsChecked(e.rows)}_sendRowsChecked(e){let t={rows:[]};for(let r=0;r<e.length;r++)t.rows.push({rowId:e[r].id,checked:e[r].checked});this._send("rowsChecked",t)}_onWidgetRowsExpanded(e){this._sendRowsExpanded(e.rows)}_sendRowsExpanded(e){let t={rows:e.map(r=>({rowId:r.id,expanded:r.expanded}))};this._send("rowsExpanded",t)}_onWidgetFilter(){let e=this.widget.rowsToIds(this.widget.filteredRows());this._sendFilter(e)}_sendFilter(e){let t={};e.length===this.widget.rows.length?t.remove=!0:t.rowIds=e,this._send("filter",t,{delay:250,coalesce:function(r){return this.target===r.target&&this.type===r.type&&this.remove===r.remove},showBusyIndicator:!1})}_onWidgetSort(e){e.column.guiOnly||this._send("sort",{columnId:e.column.id,sortAscending:e.sortAscending,sortingRemoved:e.sortingRemoved,multiSort:e.multiSort,sortingRequested:e.sortingRequested})}_onWidgetGroup(e){e.column.guiOnly||this._send("group",{columnId:e.column.id,groupAscending:e.groupAscending,groupingRemoved:e.groupingRemoved,multiGroup:e.multiGroup,groupingRequested:e.groupingRequested})}_onWidgetRowAction(e){this._sendRowAction(e.row,e.column)}_sendRowAction(e,t){t.guiOnly&&(t=f.find(this.widget.columns,s=>!s.guiOnly));let r=t?t.id:null;this._send("rowAction",{rowId:e.id,columnId:r})}_onWidgetAppLinkAction(e){this._sendAppLinkAction(e.column,e.ref)}_sendAppLinkAction(e,t){this._send("appLinkAction",{columnId:e.id,ref:t})}_sendContextColumn(e){e.guiOnly&&(e=null,this.widget.contextColumn=null);let t=null;e&&(t=e.id),this._send("property",{contextColumn:t})}_onWidgetReload(e){let t={reloadReason:e.reloadReason};this._send("reload",t)}_onWidgetExportToClipboard(e){this._send("clipboardExport"),e.preventDefault()}_onWidgetEvent(e){e.type==="rowsSelected"?this._onWidgetRowsSelected(e):e.type==="rowsChecked"?this._onWidgetRowsChecked(e):e.type==="rowsExpanded"?this._onWidgetRowsExpanded(e):e.type==="filter"?this._onWidgetFilter():e.type==="sort"?this._onWidgetSort(e):e.type==="group"?this._onWidgetGroup(e):e.type==="rowClick"?this._onWidgetRowClick(e):e.type==="rowAction"?this._onWidgetRowAction(e):e.type==="prepareCellEdit"?this._onWidgetPrepareCellEdit(e):e.type==="completeCellEdit"?this._onWidgetCompleteCellEdit(e):e.type==="cancelCellEdit"?this._onWidgetCancelCellEdit(e):e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):e.type==="clipboardExport"?this._onWidgetExportToClipboard(e):e.type==="reload"?this._onWidgetReload(e):e.type==="filterAdded"?this._onWidgetFilterAdded(e):e.type==="filterRemoved"?this._onWidgetFilterRemoved(e):e.type==="columnResized"?this._onWidgetColumnResized(e):e.type==="columnMoved"?this._onWidgetColumnMoved(e):e.type==="columnBackgroundEffectChanged"?this._onWidgetColumnBackgroundEffectChanged(e):e.type==="columnOrganizeAction"?this._onWidgetColumnOrganizeAction(e):e.type==="aggregationFunctionChanged"?this._onWidgetAggregationFunctionChanged(e):e.type==="drop"&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e):super._onWidgetEvent(e)}_onRowsInserted(e){this.widget.insertRows(e),this._rebuildingTable=!1}_onRowsDeleted(e){let t=this.widget.rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteRows(t)}_onAllRowsDeleted(){this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteAllRows()}_onRowsUpdated(e){this.widget.updateRows(e)}_onRowsSelected(e){let t=this.widget.rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.selectRows(t),this.widget.selectionHandler.clearLastSelectedRowMarker()}_onRowsChecked(e){let t=[],r=[];e.forEach(s=>{let o=this.widget.rowById(s.id);s.checked?t.push(o):r.push(o)}),this.addFilterForWidgetEventType("rowsChecked"),this.widget.checkRows(t,{checked:!0,checkOnlyEnabled:!1}),this.widget.uncheckRows(r,{checkOnlyEnabled:!1})}_onRowsExpanded(e){let t=[],r=[];e.forEach(s=>{let o=this.widget.rowById(s.id);s.expanded?t.push(o):r.push(o)}),this.addFilterForWidgetEventType("rowsExpanded"),this.widget.expandRows(t),this.widget.collapseRows(r)}_onRowOrderChanged(e){let t=this.widget.rowsByIds(e);this.widget.updateRowOrder(t)}_onColumnStructureChanged(e){this._rebuildingTable=!0,this.widget.updateColumnStructure(e)}_onColumnOrderChanged(e){let t=this.widget.columnsByIds(e);this.widget.updateColumnOrder(t)}_onColumnHeadersUpdated(e){e.forEach(t=>Ve.applyTo(t)),this.widget.updateColumnHeaders(e),this.widget.tileMode&&this.widget.tableTileGridMediator&&(this.widget.tableTileGridMediator._onTableGroup(),this.widget.updateRowOrder(this.widget.rows))}_onStartCellEdit(e,t,r){let s=this.widget.columnById(e),o=this.widget.rowById(t),n=this.session.getOrCreateWidget(r,this.widget);this.widget.startCellEdit(s,o,n)}_onEndCellEdit(e){let t=this.session.getModelAdapter(e);if(!t)throw new Error("Field adapter could not be resolved. Id: "+e);this.widget.endCellEdit(t.widget)}_onRequestFocus(){this.widget.focus()}_onScrollToSelection(){this.widget.revealSelection()}_onColumnBackgroundEffectChanged(e){e.eventParts.forEach(function(t){let r=this.widget.columnById(t.columnId),s=t.backgroundEffect;this.addFilterForWidgetEvent(o=>o.type==="columnBackgroundEffectChanged"&&o.column.id===r.id&&o.column.backgroundEffect===s),r.setBackgroundEffect(s)},this)}_onRequestFocusInCell(e){let t=this.widget.rowById(e.rowId),r=this.widget.columnById(e.columnId);this.widget.focusCell(r,t)}_onAggregationFunctionChanged(e){let t=[],r=[];e.eventParts.forEach(function(s){let o=s.aggregationFunction,n=this.widget.columnById(s.columnId);this.addFilterForWidgetEvent(l=>l.type==="aggregationFunctionChanged"&&l.column.id===n.id&&l.column.aggregationFunction===o),t.push(n),r.push(o)},this),this.widget.changeAggregations(t,r)}_onFiltersChanged(e){this.addFilterForWidgetEventType("filterAdded"),this.addFilterForWidgetEventType("filterRemoved"),this.widget.setFilters(e),this._rebuildingTable||this.widget.filter()}onModelAction(e){e.type==="rowsInserted"?this._onRowsInserted(e.rows):e.type==="rowsDeleted"?this._onRowsDeleted(e.rowIds):e.type==="allRowsDeleted"?this._onAllRowsDeleted():e.type==="rowsSelected"?this._onRowsSelected(e.rowIds):e.type==="rowOrderChanged"?this._onRowOrderChanged(e.rowIds):e.type==="rowsUpdated"?this._onRowsUpdated(e.rows):e.type==="filtersChanged"?this._onFiltersChanged(e.filters):e.type==="rowsChecked"?this._onRowsChecked(e.rows):e.type==="rowsExpanded"?this._onRowsExpanded(e.rows):e.type==="columnStructureChanged"?this._onColumnStructureChanged(e.columns):e.type==="columnOrderChanged"?this._onColumnOrderChanged(e.columnIds):e.type==="columnHeadersUpdated"?this._onColumnHeadersUpdated(e.columns):e.type==="startCellEdit"?this._onStartCellEdit(e.columnId,e.rowId,e.fieldId):e.type==="endCellEdit"?this._onEndCellEdit(e.fieldId):e.type==="requestFocus"?this._onRequestFocus():e.type==="scrollToSelection"?this._onScrollToSelection():e.type==="aggregationFunctionChanged"?this._onAggregationFunctionChanged(e):e.type==="columnBackgroundEffectChanged"?this._onColumnBackgroundEffectChanged(e):e.type==="requestFocusInCell"?this._onRequestFocusInCell(e):super.onModelAction(e)}exportAdapterData(e){return e=super.exportAdapterData(e),delete e.selectedRows,e.rows=[],e.columns.forEach(t=>{delete t.classId,delete t.modelClass}),e}_initRowModel(e){let t=e||{};return t.objectType=u.nvl(t.objectType,"TableRow"),Ve.applyTo(t),t}static _createRowRemote(e){return this.modelAdapter&&(e=this.modelAdapter._initRowModel(e)),this._createRowOrig(e)}static modifyTablePrototype(){!ie.get().remote||(v.replacePrototypeFunction(W,"_createRow",So._createRowRemote,!0),v.replacePrototypeFunction(W,"_sortWhileInit",function(){this.modelAdapter?this._group():this._sortWhileInitOrig()},!0),v.replacePrototypeFunction(W,"_sortAfterInsert",function(e){this.modelAdapter?e&&this._group():this._sortAfterInsertOrig(e)},!0),v.replacePrototypeFunction(W,"_sortAfterUpdate",function(){this.modelAdapter?this._group():this._sortAfterUpdateOrig()},!0),v.replacePrototypeFunction(W,"_isSortingPossible",function(e){return this.modelAdapter?u.nvl(this.uiSortPossible,!0)&&this._isSortingPossibleOrig(e):this._isSortingPossibleOrig(e)},!0),v.replacePrototypeFunction(W,"sort",function(e,t,r,s){this.modelAdapter&&e.guiOnly||this.sortOrig(e,t,r,s)},!0),v.replacePrototypeFunction(W,"_createTileTableHeader",function(){if(!this.modelAdapter)return this._createTileTableHeaderOrig()},!0),v.replacePrototypeFunction(W,"createTiles",function(e){if(!this.modelAdapter)return this.createTilesOrig(e)},!0))}static modifyColumnPrototype(){!ie.get().remote||(v.replacePrototypeFunction(Me,"init",function(e){e.table&&e.table.modelAdapter&&!e.guiOnly&&(e=a().extend({},e),Ve.applyTo(e)),this.initOrig(e)},!0),v.replacePrototypeFunction(Me,"_ensureCell",function(e){if(this.table.modelAdapter){let t;return v.isPlainObject(e)?(t=e,t.value=this._parseValue(t.value),t.text&&t.value===void 0&&!t.errorStatus&&(t.value=this._parseValue(t.text)),t.value===void 0&&(t.value=null)):t={value:this._parseValue(e)},Ve.applyTo(t,"Cell"),u.create(Pt,t)}return this._ensureCellOrig(e)},!0),v.replacePrototypeFunction(Me,"isSortingPossible",function(){return this.table.modelAdapter?u.nvl(this.uiSortPossible,!0)&&this.installComparator():this.isSortingPossibleOrig()},!0))}static modifyBooleanColumnPrototype(){!ie.get().remote||v.replacePrototypeFunction(oo,"_toggleCellValue",function(e,t){this.table.modelAdapter||this._toggleCellValueOrig(e,t)},!0)}}ie.addListener("bootstrap",So.modifyTablePrototype),ie.addListener("bootstrap",So.modifyColumnPrototype),ie.addListener("bootstrap",So.modifyBooleanColumnPrototype);function ln(i,e,t){return e=ox(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ox(i){var e=nx(i,"string");return typeof e=="symbol"?e:String(e)}function nx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yu{constructor(){ln(this,"objectType",void 0),ln(this,"table",void 0),ln(this,"useOnlyVisibleColumns",void 0),ln(this,"maxContentLines",void 0),ln(this,"_oldStates",void 0),ln(this,"_updateHandler",void 0),this.table=null,this.useOnlyVisibleColumns=!0,this.maxContentLines=3,this._oldStates=v.createMap(),this._updateHandler=null}init(e){$.extend(this,e)}setUseOnlyVisibleColumns(e){this.useOnlyVisibleColumns=e}setMaxContentLines(e){this.maxContentLines=e}handle(e){e?(this._compactColumns(!0),this._attachTableHandler()):(this._detachTableHandler(),this._compactColumns(!1)),this._adjustTable(e),e&&this.updateValues(this.table.rows)}_adjustTable(e){e?(this._cacheAndSetProperty("headerVisible",()=>this.table.headerVisible,()=>this.table.setHeaderVisible(!1)),this._cacheAndSetProperty("autoResizeColumns",()=>this.table.autoResizeColumns,()=>this.table.setAutoResizeColumns(!0))):(this._resetProperty("headerVisible",t=>this.table.setHeaderVisible(t)),this._resetProperty("autoResizeColumns",t=>this.table.setAutoResizeColumns(t)))}_cacheAndSetProperty(e,t,r){v.isNullOrUndefined(this._oldStates[e])&&(this._oldStates[e]=t()),r()}_resetProperty(e,t){let r=this._oldStates[e];v.isNullOrUndefined(r)||(t(r),delete this._oldStates[e])}_compactColumns(e){this.table.displayableColumns(!1).forEach(t=>t.setCompacted(e,!1)),this.table.onColumnVisibilityChanged()}_attachTableHandler(){this._updateHandler==null&&(this._updateHandler=this._onTableEvent.bind(this),this.table.on("rowsInserted rowsUpdated columnStructureChanged",this._updateHandler))}_detachTableHandler(){this._updateHandler!=null&&(this.table.off("rowsInserted rowsUpdated columnStructureChanged",this._updateHandler),this._updateHandler=null)}updateValues(e){if(e.length===0)return;let t=this._getColumns();e.forEach(r=>this._updateValue(t,r))}_updateValue(e,t){t.setCompactValue(this.buildValue(e,t))}buildValue(e,t){return this._buildValue(this._createBean(e,t))}_createBean(e,t){let r=new Lu;return this._processColumns(e,t,r),this._postProcessBean(r),r}_processColumns(e,t,r){e.forEach((s,o)=>this._processColumn(s,o,t,r))}_getColumns(){return this.table.filterColumns(e=>this._acceptColumn(e))}_acceptColumn(e){return!e.guiOnly&&(!this.useOnlyVisibleColumns||e.visible&&e.displayable)}_processColumn(e,t,r,s){this._updateBean(s,e,t,r)}_updateBean(e,t,r,s){this._acceptColumnForTitle(t,r)?e.setTitleLine(this._createCompactLine(t,r,s)):this._acceptColumnForTitleSuffix(t,r)?e.setTitleSuffixLine(this._createCompactLine(t,r,s)):this._acceptColumnForSubtitle(t,r)?e.setSubtitleLine(this._createCompactLine(t,r,s)):e.addContentLine(this._createCompactLine(t,r,s))}_acceptColumnForTitle(e,t){return t===0}_acceptColumnForSubtitle(e,t){return t===1}_acceptColumnForTitleSuffix(e,t){return!1}_createCompactLine(e,t,r){let s;this._showLabel(e,t,r)&&(s=e.headerCell());let o=e.cell(r),n=new Iu(s,o);return this._adaptCompactLine(n,e,s,o),n}_showLabel(e,t,r){return!this._acceptColumnForTitle(e,t)&&!this._acceptColumnForSubtitle(e,t)&&!this._acceptColumnForTitleSuffix(e,t)}_adaptCompactLine(e,t,r,s){if(t instanceof oo){let o="",n=s.value;n?o="X":n===null&&(o="?"),e.textBlock.setText(o)}}_postProcessBean(e){e.transform({maxContentLines:this.maxContentLines}),e.title&&!e.subtitle&&!e.titleSuffix&&!e.content&&(e.setContent(e.title),e.setTitle(""))}_buildValue(e){let t=e.title+e.titleSuffix+e.subtitle?" has-header":"",r=e.moreContent?'<div class="compact-cell-more"><span class="more-link link">'.concat(this.table.session.text("More"),"</span></div>"):"";return`
<div class="compact-cell-header">
  <div class="compact-cell-title">
    <span class="left">`.concat(e.title,`</span>
    <span class="right">`).concat(e.titleSuffix,`</span>
    </div>
  <div class="compact-cell-subtitle">`).concat(e.subtitle,`</div>
</div>
<div class="compact-cell-content`).concat(t,'">').concat(e.content,`</div>
<div class="compact-cell-more-content hidden`).concat(t,'">').concat(e.moreContent,`</div>
  `).concat(r)}_onTableEvent(e){let t;e.type==="columnStructureChanged"?t=this.table.rows:t=e.rows,this.updateValues(t)}}function et(i,e,t){return e=lx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lx(i){var e=ax(i,"string");return typeof e=="symbol"?e:String(e)}function ax(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qt{constructor(){et(this,"objectType",void 0),et(this,"cells",void 0),et(this,"checked",void 0),et(this,"compactValue",void 0),et(this,"enabled",void 0),et(this,"filterAccepted",void 0),et(this,"height",void 0),et(this,"hasError",void 0),et(this,"id",void 0),et(this,"initialized",void 0),et(this,"iconId",void 0),et(this,"parentRow",void 0),et(this,"parent",void 0),et(this,"childRows",void 0),et(this,"expanded",void 0),et(this,"status",void 0),et(this,"nodeId",void 0),et(this,"hierarchyLevel",void 0),et(this,"cssClass",void 0),et(this,"aggregateRowAfter",void 0),et(this,"aggregateRowBefore",void 0),et(this,"lookupRow",void 0),et(this,"$row",void 0),et(this,"page",void 0),et(this,"expandable",void 0),this.$row=null,this.aggregateRowAfter=null,this.cells=[],this.checked=!1,this.compactValue=null,this.enabled=!0,this.filterAccepted=!0,this.height=null,this.hasError=!1,this.id=null,this.initialized=!1,this.parentRow=null,this.parent=null,this.childRows=[],this.expanded=!1,this.status=Qt.Status.NON_CHANGED,this.hierarchyLevel=0}init(e){this._init(e),this.initialized=!0}_init(e){if(!e.parent)throw new Error("missing property 'parent'");a().extend(this,e),this._initCells()}_initCells(){this.getTable().columns.forEach(e=>{if(!e.guiOnly){let t=this.cells[e.index];t=e.initCell(t,this),this.cells[e.index]=t}})}animateExpansion(){let e=this.$row;if(!e)return;let t=e.find(".table-row-control");this.expanded?t.addClassForAnimation("expand-rotate"):t.addClassForAnimation("collapse-rotate")}hasFilterAcceptedChildren(){return this.childRows.some(e=>e.filterAccepted||e.hasFilterAcceptedChildren())}getTable(){return this.parent}setCompactValue(e){this.compactValue=e}setFilterAccepted(e){this.filterAccepted=e}}et(Qt,"Status",{NON_CHANGED:"nonChanged",INSERTED:"inserted",UPDATED:"updated"});function Ts(i,e,t){return e=dx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dx(i){var e=hx(i,"string");return typeof e=="symbol"?e:String(e)}function hx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class At{constructor(e,t){Ts(this,"session",void 0),Ts(this,"locale",void 0),Ts(this,"_allData",void 0),Ts(this,"_allAxis",void 0),Ts(this,"_rows",void 0),Ts(this,"_table",void 0),this.session=t,this.locale=t.locale,this._allData=[],this._allAxis=[],this._rows=e.rows,this._table=e}addData(e,t){let r={},s=this.locale;return this._allData.push(r),r.column=e,r.format=o=>s.decimalFormat.format(o),t===At.NumberGroup.COUNT?(r.norm=o=>1,r.group=o=>o.length):t===At.NumberGroup.SUM?(r.norm=o=>isNaN(o)||o===null||o===""?null:parseFloat(o),r.group=o=>o.reduce((n,l)=>n+l)):t===At.NumberGroup.AVG&&(r.norm=o=>isNaN(o)||o===null||o===""?null:parseFloat(o),r.group=o=>{let n=o.reduce((d,h)=>d+h),l=o.reduce((d,h)=>h===null?d:d+1,0);return l===0?null:n/l}),r}addAxis(e,t){let r=[],s=this.locale,o=this.session,n=this.session.text.bind(this.session),l=n("ui.EmptyCell");return this._allAxis.push(r),r.column=e,r.normTable=[],r.sortCodeMap={},r.add=d=>{r.indexOf(d)===-1&&r.push(d)},r.reorder=()=>{r.sort((d,h)=>{if(d===null)return 1;if(h===null)return-1;let p=r.sortCodeMap[d],m=r.sortCodeMap[h];return!v.isNullOrUndefined(p)||!v.isNullOrUndefined(m)?gt.NUMERIC.compare(p,m):d-h})},r.norm=d=>{if(d===null||d==="")return null;let h=r.normTable.indexOf(d);return h===-1?r.normTable.push(d)-1:h},r.format=d=>d===null?l:r.normTable[d],r.deterministicKeyToKey=d=>r.norm(d),r.keyToDeterministicKey=d=>d===null?null:r.format(d),r.normDeterministic=d=>r.keyToDeterministicKey(r.norm(d)),e instanceof ku?(t===At.DateGroup.NONE?(r.norm=d=>d===null||d===""?null:d.getTime(),r.format=d=>{if(d===null)return null;let h=e.format;return h?h=Ft.ensure(s,h):h=s.dateFormat,h.format(new Date(d))}):t===At.DateGroup.YEAR?(r.norm=d=>d===null||d===""?null:d.getFullYear(),r.format=d=>d===null?l:String(d)):t===At.DateGroup.MONTH?(r.norm=d=>d===null||d===""?null:d.getMonth(),r.format=d=>d===null?l:s.dateFormatSymbols.months[d]):t===At.DateGroup.WEEKDAY?(r.norm=d=>d===null||d===""?null:(d.getDay()+7-s.dateFormatSymbols.firstDayOfWeek)%7,r.format=d=>d===null?l:s.dateFormatSymbols.weekdaysOrdered[d]):t===At.DateGroup.DATE&&(r.norm=d=>d===null||d===""?null:T.trunc(d).getTime(),r.format=d=>d===null?l:T.format(new Date(d),s,s.dateFormatPatternDefault)),r.deterministicKeyToKey=d=>d,r.keyToDeterministicKey=d=>d,r.normDeterministic=d=>r.norm(d)):e instanceof Oi?(r.norm=d=>isNaN(d)||d===null||d===""?null:parseFloat(d),r.format=d=>isNaN(d)||d===null?l:e.decimalFormat.format(d),r.deterministicKeyToKey=d=>d,r.keyToDeterministicKey=d=>d,r.normDeterministic=d=>r.norm(d)):e instanceof oo?(r.norm=d=>e.triStateEnabled&&d===null?-1:d===!0?1:0,r.format=d=>{if(d===-1)return n("ui.BooleanColumnGroupingMixed");if(d===0)return n("ui.BooleanColumnGroupingFalse");if(d===1)return n("ui.BooleanColumnGroupingTrue")},r.deterministicKeyToKey=d=>d,r.keyToDeterministicKey=d=>d,r.normDeterministic=d=>r.norm(d)):e instanceof Ra?(r.textIsIcon=!0,r.deterministicKeyToKey=d=>d,r.keyToDeterministicKey=d=>d,r.normDeterministic=d=>r.norm(d)):r.reorder=()=>{let d=gt.TEXT;d.install(o),r.sort((h,p)=>{if(h===null)return 1;if(p===null)return-1;let m=r.sortCodeMap[h],g=r.sortCodeMap[p];return!v.isNullOrUndefined(m)||!v.isNullOrUndefined(g)?gt.NUMERIC.compare(m,g):d.compare(r.format(h),r.format(p))})},r}calculate(){let e={},t=0;for(let r=0;r<this._rows.length;r++){let s=this._rows[r],o=[];for(let d=0;d<this._allAxis.length;d++){let h=this._allAxis[d].column,p=h.cellValueOrTextForCalculation(s),m=this._allAxis[d].norm(p);if(m!==void 0){this._allAxis[d].add(m);let g=h.cell(s);g.sortCode!==null&&(this._allAxis[d].sortCodeMap[m]=g.sortCode),o.push(m)}}let n=JSON.stringify(o),l=[];for(let d=0;d<this._allData.length;d++){let h=this._table.cellValue(this._allData[d].column,s),p=this._allData[d].norm(h);p!==void 0&&l.push(p)}e[n]?e[n].push(l):(e[n]=[l],t++)}for(let r=0;r<this._allData.length;r++){let s=this._allData[r];s.total=0,s.min=null,s.max=null;for(let n in e)if(e.hasOwnProperty(n)){let l=e[n],d=[];for(let p=0;p<l.length;p++)d.push(l[p][r]);let h=this._allData[r].group(d);if(e[n][r]=h,s.total+=h,h===null)continue;(h<s.min||s.min===null)&&(s.min=h),(h>s.max||s.min===null)&&(s.max=h)}u.nvl(s.max,0)===0&&(s.max=.1);let o=Math.ceil(Math.log(s.max)/Math.LN10)-1;s.max=Math.ceil(s.max/Math.pow(10,o))*Math.pow(10,o),s.max=Math.ceil(s.max/4)*4}for(let r=0;r<this._allAxis.length;r++){let s=this._allAxis[r];s.min=f.min(s),s.max=f.max(s),s.indexOf(null)!==-1&&(s.max=s.max+1),s.reorder()}return e.getValue=r=>{let s=JSON.stringify(r);return e.hasOwnProperty(s)?e[s]:null},e.length=t,e}columnCount(e){let t=this.columns(e),r=[],s=0;for(let o=0;o<t.length;o++){let n=t[o];r.push([n,[]]);let l=r[s][1];for(let d=0;d<this._rows.length;d++){let h=this._rows[d],p=n.cellValueOrTextForCalculation(h);l.indexOf(p)===-1&&l.push(p)}r[s][1]=l.length,s++}return r}isEmpty(){return this._rows.length===0||this.columns().length===0}columns(e){return e=u.nvl(e,!0),this._table.visibleColumns().filter(t=>!(t.guiOnly||e&&t instanceof Oi))}isMatrixValid(){return this._table.rows.length===0||this.columns(!1).length===this._table.rows[0].cells.length}}Ts(At,"DateGroup",{NONE:0,YEAR:256,MONTH:257,WEEKDAY:258,DATE:259}),Ts(At,"NumberGroup",{COUNT:-1,SUM:1,AVG:2});function $e(i,e,t){return e=ux(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ux(i){var e=cx(i,"string");return typeof e=="symbol"?e:String(e)}function cx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vu extends I{constructor(){super(),$e(this,"table",void 0),$e(this,"filterText",void 0),$e(this,"animating",void 0),$e(this,"open",void 0),$e(this,"resizing",void 0),$e(this,"selectedControl",void 0),$e(this,"searchFieldKeyStrokeContext",void 0),$e(this,"$controlContent",void 0),$e(this,"$controlContainer",void 0),$e(this,"$resizer",void 0),$e(this,"$clearIcon",void 0),$e(this,"_$controls",void 0),$e(this,"_$info",void 0),$e(this,"_compactStyle",void 0),$e(this,"_tableInfoTooltip",void 0),$e(this,"_tableStatusTooltip",void 0),$e(this,"_$infoLoad",void 0),$e(this,"_$infoSelection",void 0),$e(this,"_tableRowsChangedHandler",void 0),$e(this,"_tableFilterHandler",void 0),$e(this,"_tableFilterAddedHandler",void 0),$e(this,"_tableFilterRemovedHandler",void 0),$e(this,"_tableRowsSelectedHandler",void 0),$e(this,"_tableStatusChangedHandler",void 0),$e(this,"_tablePropertyChangeHandler",void 0),$e(this,"_focusFilterFieldKeyStroke",void 0),$e(this,"_autoHideTableStatusTooltipTimeoutId",void 0),$e(this,"_$window",void 0),$e(this,"_$body",void 0),$e(this,"_$infoFilter",void 0),$e(this,"_$infoTableStatus",void 0),$e(this,"_$infoTableStatusIcon",void 0),$e(this,"_$textFilter",void 0),this._compactStyle=!1,this.animating=!1,this.open=!1,this.resizing=!1,this.table=null,this._tableRowsChangedHandler=this._onTableRowsChanged.bind(this),this._tableFilterHandler=this._onTableFilter.bind(this),this._tableFilterAddedHandler=this._onTableFilterAdded.bind(this),this._tableFilterRemovedHandler=this._onTableFilterRemoved.bind(this),this._tableRowsSelectedHandler=this._onTableRowsSelected.bind(this),this._tableStatusChangedHandler=this._onTableStatusChanged.bind(this),this._tablePropertyChangeHandler=this._onTablePropertyChange.bind(this)}_init(e){super._init(e),this.searchFieldKeyStrokeContext=new Fr,this.searchFieldKeyStrokeContext.$bindTarget=()=>this._$textFilter,this.searchFieldKeyStrokeContext.$scopeTarget=()=>this._$textFilter,this._focusFilterFieldKeyStroke=null}_render(){let e,t;this.$container=this.$parent.appendDiv("table-footer"),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new wu(this)),this.$controlContainer=this.$container.appendDiv("table-control-container").hide(),this.$controlContent=this.$controlContainer.appendDiv("table-control-content focus-boundary"),this._$controls=this.$container.appendDiv("table-controls"),this._$info=this.$container.appendDiv("table-info"),t=this._$info.appendDiv("table-filter"),this._$textFilter=ee.makeTextField(this.$container,"table-text-filter").appendTo(t).on("input","",this._createOnFilterFieldInputFunction().bind(this)).placeholder(this.session.text("ui.FilterBy_")),this.table.$container.data("filter-field",this._$textFilter),this._focusFilterFieldKeyStroke=new Ol(this.table),this.table.keyStrokeContext.registerKeyStroke(this._focusFilterFieldKeyStroke),e=this.table.getFilter(mr.TYPE),e&&this._$textFilter.val(e.text),this.$clearIcon=t.appendSpan("clear-icon unfocusable action text-field-icon").on("mousedown",this._onDeleteFilterMouseDown.bind(this)),this._$infoLoad=this._$info.appendDiv("table-info-item table-info-load").on("click","",this._onInfoLoadClick.bind(this)),this._$infoFilter=this._$info.appendDiv("table-info-item table-info-filter").on("click","",this._onInfoFilterClick.bind(this)),this._$infoSelection=this._$info.appendDiv("table-info-item table-info-selection").on("click","",this._onInfoSelectionClick.bind(this)),this._$infoTableStatus=this._$info.appendDiv("table-info-item table-info-status").on("mousedown",this._onStatusMouseDown.bind(this)),this._$infoTableStatusIcon=this._$infoTableStatus.appendSpan("icon font-icon"),this._renderControls(),this._renderInfo(),this._updateInfoVisibility(),this.table.on("rowsInserted",this._tableRowsChangedHandler),this.table.on("rowsDeleted",this._tableRowsChangedHandler),this.table.on("allRowsDeleted",this._tableRowsChangedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("statusChanged",this._tableStatusChangedHandler),this.table.on("propertyChange",this._tablePropertyChangeHandler),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}getFocusableElement(){return this._$textFilter}_renderProperties(){this._updateHasFilterText()}_remove(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this._hideTableStatusTooltip(),this.$resizer=null,this.$controlContainer.stop(!1,!0),this.animating=!1,this.open=!1,this.table.keyStrokeContext.unregisterKeyStroke(this._focusFilterFieldKeyStroke),this._focusFilterFieldKeyStroke=null,this.table.off("rowsInserted",this._tableRowsChangedHandler),this.table.off("rowsDeleted",this._tableRowsChangedHandler),this.table.off("allRowsDeleted",this._tableRowsChangedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("statusChanged",this._tableStatusChangedHandler),this.table.off("propertyChange",this._tablePropertyChangeHandler),super._remove()}_renderResizerVisible(){this.selectedControl.resizerVisible?(this._renderResizer(),this.$controlContainer.addClass("has-resizer")):this.$resizer&&(this.$resizer.remove(),this.$resizer=null,this.$controlContainer.removeClass("has-resizer"))}_renderResizer(){if(this.$resizer)return;this.$resizer=this.$controlContainer.prependDiv("table-control-resize").on("mousedown","",e.bind(this));function e(t){let r=this.$controlContainer.height(),s=Math.floor(t.pageY);this._$window.on("mousemove.tablefooter",o.bind(this)).one("mouseup",n.bind(this)),this._$body.addClass("row-resize"),this.resizing=!0;function o(l){if(!this.rendered)return;let h=Math.floor(l.pageY)-s,p=this.table.$container.height()-this.table.footer.$container.height(),m=Math.min(r-h,p);this.$controlContainer.height(m);let g=w.insets(this.$controlContainer);this.$controlContent.outerHeight(m-g.vertical()),this._revalidateTableLayout()}function n(){this.selectedControl&&this.rendered&&this.$controlContainer.height()<100&&this.selectedControl.setSelected(!1),this._$window.off("mousemove.tablefooter"),this._$body.removeClass("row-resize"),this.resizing=!1}return!1}}_renderControls(){let e=this.table.tableControls;e?e.forEach(t=>{t.setParent(this),t.render(this._$controls)}):this._$controls.empty()}_renderInfo(){this._renderInfoLoad(),this._renderInfoTableStatus(),this._renderInfoFilter(),this._renderInfoSelection()}_renderInfoLoad(){let e=this._$infoLoad,t=this.table.rows.length,r=this.table.estimatedRowCount,s=this.table.maxRowCount;e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoadedMin")):e.appendSpan().text(this.session.text("ui.NumRowsLoadedMin")),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoaded",this.computeCountInfo(t))):r&&r>t?e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t,r))):e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t))),this.table.hasReloadHandler&&(r&&s&&t<r&&t<s?r<s?e.appendSpan("table-info-button").text(this.session.text("ui.LoadAllData")).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.LoadNData",this.computeCountInfo(s))).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.ReloadData")).appendTo(e))),e.setEnabled(this.table.hasReloadHandler),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}_renderInfoFilter(){let e=this._$infoFilter,t=this.table.filteredRows().length,r=this.table.filteredBy().join(", ");e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredMin")):e.appendSpan().text(this.session.text("ui.NumRowsFilteredMin")),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(r?t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredBy",this.computeCountInfo(t),r)):e.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.computeCountInfo(t),r)):t<=1?e.appendSpan().text(this.session.text("ui.NumRowFiltered",this.computeCountInfo(t))):e.appendSpan().text(this.session.text("ui.NumRowsFiltered",this.computeCountInfo(t))),this.table.hasUserFilter()&&e.appendSpan("table-info-button").text(this.session.text("ui.RemoveFilter")).appendTo(e)),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}_renderInfoSelection(){let e=this._$infoSelection,t=this.table.filteredRows().length,r=this.table.selectedRows.length,s=t>0&&t===r;e.empty(),this._compactStyle?(r<=1?e.appendSpan().text(this.session.text("ui.NumRowSelectedMin")):e.appendSpan().text(this.session.text("ui.NumRowsSelectedMin")),e.appendSpan("table-info-button").text(this.computeCountInfo(r))):(r<=1?e.appendSpan().text(this.session.text("ui.NumRowSelected",this.computeCountInfo(r))):e.appendSpan().text(this.session.text("ui.NumRowsSelected",this.computeCountInfo(r))),e.appendSpan("table-info-button").text(this.session.text(s?"ui.SelectNone":"ui.SelectAll")).appendTo(e)),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}_renderInfoTableStatus(){let e=this._$infoTableStatus,t=this.table.tableStatus;e.removeClass(E.SEVERITY_CSS_CLASSES),t&&e.addClass(t.cssClass()),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}_updateInfoVisibility(){this._updateInfoFilterVisibility(),this._updateInfoSelectionVisibility(),this._updateInfoTableStatusVisibility()}_updateInfoFilterVisibility(){let e=this.table.filteredBy().length>0;this._setInfoVisible(this._$infoFilter,e)}_updateInfoSelectionVisibility(){let e=this.table.multiSelect;this._setInfoVisible(this._$infoSelection,e)}_updateInfoTableStatusVisibility(){if(this.table.tableStatus){let t=null;u.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")||(this._$infoTableStatus.addClass("tooltip-active"),t=function(){this.table.tableStatus&&!u.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")&&this._showTableStatusTooltip()}.bind(this)),this._setInfoVisible(this._$infoTableStatus,!0,t)}else this._hideTableStatusTooltip(),this._setInfoVisible(this._$infoTableStatus,!1)}_setInfoVisible(e,t,r){if(e.isVisible()===t&&!(t&&e.hasClass("hiding"))){r&&r();return}if(!this.rendered){e.setVisible(t);return}if(t){let o={progress:this.revalidateLayout.bind(this),complete:()=>{r&&r()}};e.data("animationComplete",o.complete),e[0].style.width===""&&e.cssWidth(0),e.stop().removeClass("hiding").setVisible(!0).cssWidthToContentAnimated(o)}else e.addClass("hiding"),e.stop().animate({width:0},{progress:this.revalidateLayout.bind(this),complete:()=>{e.removeClass("hiding"),e.setVisible(!1)}})}_toggleTableInfoTooltip(e,t){this._tableInfoTooltip?this._tableInfoTooltip.destroy():(this._tableInfoTooltip=u.create(t,{parent:this,tableFooter:this,arrowPosition:50,arrowPositionUnit:"%",$anchor:e}),this._tableInfoTooltip.one("destroy",()=>{this._tableInfoTooltip=null}),this._tableInfoTooltip.render())}computeCountInfo(e,t){return e=u.nvl(e,0),t?this.session.text("ui.TableRowCount",this.session.text("ui.CountOfApproxTotal",this.session.locale.decimalFormat.format(e),this.session.locale.decimalFormat.format(t))):e===0?this._compactStyle?this.session.text("ui.TableRowCount",this.session.locale.decimalFormat.format(0)):this.session.text("ui.TableRowCount0"):e===1?this.session.text("ui.TableRowCount1"):this.session.text("ui.TableRowCount",this.session.locale.decimalFormat.format(e))}_revalidateTableLayout(){this.table.htmlComp.revalidateLayoutTree()}openControlContainer(e){this.open;let t=this.$controlContent.data("control");this.animating&&t!==e&&t.onControlContainerClosed(),this.animating=!0,this.open=!0;let r=this.computeControlContainerHeight(this.table,e),s=w.insets(this.$controlContainer);this.$controlContent.outerHeight(r-s.vertical()),this.$controlContainer[0].style.height===""&&this.$controlContainer.outerHeight(0),this.$controlContainer.outerHeight()>r&&this.table.invalidateLayoutTree(),this.$controlContainer.stop(!0).show().delay(1).animate({height:r},{duration:this.rendered?e.animateDuration:0,complete:function(){this.animating=!1,e.onControlContainerOpened(),this.table.invalidateLayoutTree()}.bind(this)})}closeControlContainer(e,t){if(!this.open)return;t=a().extend({},{animate:!0},t),this.open=!1,this.animating=!0,this.table.invalidateLayoutTree();let r=function(){this.animating=!1,this.$controlContainer.hide(),e.onControlContainerClosed()}.bind(this);t.animate?this.$controlContainer.stop(!0).show().animate({height:0},{duration:e.animateDuration,complete:r}):r()}computeControlContainerHeight(e,t,r){let s=0,o=0,n=w.size(e.$container).height,l=0,d=w.margins(u.nvl(e.$data,e.$container)),h=d.top+d.bottom,p=e.menuBar,m=e.footer,g=e.htmlComp,b=g.availableSize().subtract(g.insets());if(!!m){if(e.menuBarVisible&&p.visible){let C=S.get(p.$container);s=Zr.size(C,b).height}if(o=w.size(m.$container).height,m.open&&(m.animating?l=u.nvl(t&&t.height,l):(l=w.size(m.$controlContainer).height,!m.resizing&&r&&(l=Math.max(t&&t.height,l)))),this.table.htmlComp.layouted){let C=n-(h+s+o);l=Math.min(l,C)}return l}}_hideTableStatusTooltip(){clearTimeout(this._autoHideTableStatusTooltipTimeoutId),this._tableStatusTooltip&&this._tableStatusTooltip.destroy()}_showTableStatusTooltip(){if(this._tableStatusTooltip&&(this._tableStatusTooltip.destroy(),this._tableStatusTooltip=null),!this.rendered&&!this.rendering)return;let e=this.table.tableStatus,t=e?e.message:null;y.empty(t)||(this._tableStatusTooltip=u.create(lr,{parent:this,text:t,severity:e.severity,autoRemove:!e.isError(),$anchor:this._$infoTableStatusIcon}),this._tableStatusTooltip.one("destroy",()=>{this._tableStatusTooltip=null}),this._tableStatusTooltip.render(),this._$infoTableStatus.addClass("tooltip-active"),this._tableStatusTooltip.on("remove",()=>{this._$infoTableStatus.removeClass("tooltip-active"),clearTimeout(this._autoHideTableStatusTooltipTimeoutId),this.table.tableStatus&&!this.table.tableStatus.isError()&&(this.table.tableStatus.uiState="auto-hidden")}),clearTimeout(this._autoHideTableStatusTooltipTimeoutId),!e.isError()&&!e.isWarning()&&!e.uiState&&(this.table.tableStatus.uiState="auto-hidden",this._autoHideTableStatusTooltipTimeoutId=setTimeout(()=>this._hideTableStatusTooltip(),5e3)))}_updateHasFilterText(){this._$textFilter.toggleClass("has-text",!!this._$textFilter.val())}onControlSelected(e){let t=this.selectedControl;this.selectedControl=e,e&&(this._renderResizerVisible(),t&&t.height!==e.height&&this.openControlContainer(e))}_onStatusMouseDown(e){this._tableStatusTooltip?(this._hideTableStatusTooltip(),this.table.tableStatus.uiState="user-hidden"):(this._showTableStatusTooltip(),this._tableStatusTooltip.rendered&&(this.table.tableStatus.uiState="user-shown"))}_createOnFilterFieldInputFunction(){let e=a().debounce(this._applyFilter.bind(this));return function(t){this._updateHasFilterText(),e()}}_onDeleteFilterMouseDown(e){this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter(),e.preventDefault()}_applyFilter(){let e=this._$textFilter.val();if(this.filterText!==e)if(this.filterText=e,e){let t=u.create(mr,{session:this.session,table:this.table});t.text=e,this.table.addFilter(t)}else this.table.removeFilterByKey(mr.TYPE)}_onInfoLoadClick(){if(!!this._$infoLoad.isEnabled())if(this._compactStyle)this._toggleTableInfoTooltip(this._$infoLoad,"TableInfoLoadTooltip");else{let e=this.table.rows.length,t=this.table.estimatedRowCount,r=this.table.maxRowCount;t&&r&&e<t&&e<r?this.table.reload(W.ReloadReason.OVERRIDE_ROW_LIMIT):this.table.reload()}}_onInfoFilterClick(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoFilter,"TableInfoFilterTooltip"):this.table.resetUserFilter()}_onInfoSelectionClick(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoSelection,"TableInfoSelectionTooltip"):this.table.toggleSelection()}_onTableRowsChanged(e){this._renderInfoLoad()}_onTableFilter(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),this._renderInfoSelection()}_onTableFilterAdded(e){if(this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter instanceof Zt&&e.filter.filterType===mr.TYPE){let t=e.filter;this._$textFilter.val()!==t.text&&(this._$textFilter.val(t.text),this._updateHasFilterText(),this._applyFilter())}}_onTableFilterRemoved(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter instanceof Zt&&e.filter.filterType===mr.TYPE&&(this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter())}_onTableRowsSelected(e){this._renderInfoSelection()}_onTableStatusChanged(e){this._renderInfoTableStatus(),this._updateInfoTableStatusVisibility()}_onTablePropertyChange(e){e.propertyName==="multiSelect"&&this._updateInfoSelectionVisibility()}}function px(i,e,t){return e=fx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fx(i){var e=mx(i,"string");return typeof e=="symbol"?e:String(e)}function mx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wu extends te{constructor(e){super(),px(this,"_tableFooter",void 0),this._tableFooter=e}layout(e){let t,r=this._tableFooter._$controls,s=this._tableFooter._$info,o=s.find(".table-info-item"),n=w.size(e).width,l=w.size(r,!0).width,d=w.size(s,!0).width;o.each(function(){let m=a()(this);m.isVisible()&&!m.hasClass("hiding")&&(m.data("oldWidth",m.outerWidth()),m.css("width","auto"))}),s.css("max-width",""),this._tableFooter._compactStyle&&(this._tableFooter._compactStyle=!1,this._tableFooter._renderInfo()),d=w.size(s,!0).width,l+d<=n&&(this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.destroy(),t=!0),t||(this._tableFooter._compactStyle=!0,this._tableFooter._renderInfo(),d=w.size(s,!0).width,l+d<=n&&(t=!0),s.css("max-width",Math.max(n-l-s.cssMarginX(),0)));let h=this._tableFooter.htmlComp.layouted;this._setInfoItemsSize(o,h);let p=this._tableFooter._tableStatusTooltip;p&&p.rendered&&p.position(),this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.rendered&&this._tableFooter._tableInfoTooltip.position(),this._tableFooter.table.tableControls.forEach(m=>m.revalidateLayout())}_setInfoItemsSize(e,t){e.each(function(){let r=a()(this);if(r.isVisible()&&!r.hasClass("hiding")){let s=r.data("animationComplete");t?(r.stop().cssWidthAnimated(r.data("oldWidth"),r.outerWidth(),{complete:s}),r.removeData("oldWidth")):r.cssWidth(r.outerWidth())}})}}function gx(i,e,t){return e=_x(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _x(i){var e=bx(i,"string");return typeof e=="symbol"?e:String(e)}function bx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class og extends lr{constructor(){super(...arguments),gx(this,"tableFooter",void 0)}_init(e){super._init(e),this.tableFooter=e.tableFooter;let t=u.create(le,{parent:this,text:this.session.text("ui.RemoveFilter")});t.on("action",this._onRemoveFilterClick.bind(this)),this.setMenus(t)}_renderText(){let e=this.tableFooter.table,t=e.filteredRows().length,r=e.filteredBy().join(", ");this.$content.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.tableFooter.computeCountInfo(t),r))}_onRemoveFilterClick(){this.tableFooter.table.resetUserFilter(),this.destroy()}}function yx(i,e,t){return e=vx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vx(i){var e=wx(i,"string");return typeof e=="symbol"?e:String(e)}function wx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ng extends lr{constructor(){super(...arguments),yx(this,"tableFooter",void 0)}_init(e){super._init(e),this.tableFooter=e.tableFooter;let t=u.create(le,{parent:this,text:this.session.text("ui.ReloadData")});t.on("action",this._onReloadClick.bind(this)),this.setMenus(t)}_renderText(){let e=this.tableFooter.table,t=e.rows.length;this.$content.text(this.session.text("ui.NumRowsLoaded",this.tableFooter.computeCountInfo(t)))}_onReloadClick(){this.tableFooter.table.reload(),this.destroy()}}function Tx(i,e,t){return e=Sx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Sx(i){var e=Cx(i,"string");return typeof e=="symbol"?e:String(e)}function Cx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class lg extends lr{constructor(){super(...arguments),Tx(this,"tableFooter",void 0)}_init(e){super._init(e),this.tableFooter=e.tableFooter;let t=u.create(le,{parent:this,text:this.session.text("ui.SelectNone")});t.on("action",this._onSelectNoneClick.bind(this));let r=u.create(le,{parent:this,text:this.session.text("ui.SelectAll")});r.on("action",this._onSelectAllClick.bind(this)),this.setMenus([t,r])}_renderText(){let e=this.tableFooter.table,t=e.selectedRows.length;this.$content.text(this.session.text("ui.NumRowsSelected",this.tableFooter.computeCountInfo(t)))}_onSelectNoneClick(){this.tableFooter.table.deselectAll(),this.destroy()}_onSelectAllClick(){this.tableFooter.table.selectAll(),this.destroy()}}function jt(i,e,t){return e=Px(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Px(i){var e=xx(i,"string");return typeof e=="symbol"?e:String(e)}function xx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tu extends I{constructor(){super(),jt(this,"headerMenusEnabled",void 0),jt(this,"table",void 0),jt(this,"dragging",void 0),jt(this,"columnMoved",void 0),jt(this,"menuBar",void 0),jt(this,"tableHeaderMenu",void 0),jt(this,"$menuBarContainer",void 0),jt(this,"$filler",void 0),jt(this,"_tableDataScrollHandler",void 0),jt(this,"_tableAddFilterRemovedHandler",void 0),jt(this,"_tableColumnResizedHandler",void 0),jt(this,"_tableColumnMovedHandler",void 0),jt(this,"_renderedColumns",void 0),jt(this,"_$window",void 0),jt(this,"_$body",void 0),jt(this,"_fixTimeout",void 0),this.dragging=!1,this.headerMenusEnabled=!0,this.table=null,this._tableDataScrollHandler=this._onTableDataScroll.bind(this),this._tableAddFilterRemovedHandler=this._onTableAddFilterRemoved.bind(this),this._tableColumnResizedHandler=this._onTableColumnResized.bind(this),this._tableColumnMovedHandler=this._onTableColumnMoved.bind(this),this._renderedColumns=[]}_init(e){super._init(e),this.menuBar=u.create(ce,{parent:this,tabbable:!1,position:ce.Position.BOTTOM,menuOrder:new rs}),this.menuBar.on("propertyChange",this._onMenuBarPropertyChange.bind(this)),this.updateMenuBar()}_render(){this.$container=this.table.$data.beforeDiv("table-header").cssBorderLeftWidth(this.table.rowBorders.left||""),this.$filler=this.$container.appendDiv("table-header-item filler").css("visibility","hidden"),this.$menuBarContainer=this.$container.appendDiv("menubar-container").setVisible(this.menuBar.visible),this.menuBar.render(this.$menuBarContainer),this._$window=this.$container.window(),this._$body=this.$container.body(),this._renderColumns(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("filterAdded",this._tableAddFilterRemovedHandler),this.table.on("filterRemoved",this._tableAddFilterRemovedHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler)}_remove(){this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("filterAdded",this._tableAddFilterRemovedHandler),this.table.off("filterRemoved",this._tableAddFilterRemovedHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this._removeColumns(),super._remove()}rerenderColumns(){this._removeColumns(),this._renderColumns()}_renderColumns(){let e=this._visibleColumns();e.forEach(this._renderColumn,this),e.length===0&&this.$filler.css("visibility","visible").html("&nbsp;").addClass("empty"),this._reconcileScrollPos()}_renderColumn(e,t){let r=e.realWidthIfAvailable(),s=this._visibleColumns(),o=t===0,n=t===s.length-1,l=this.$filler.beforeDiv("table-header-item").setEnabled(this.enabled).data("column",e),d=w.margins(l);r-=d.horizontal(),l.cssMinWidth(r).cssMaxWidth(r),l.appendSpan("table-header-item-text"),this.enabled&&l.on("click",this._onHeaderItemClick.bind(this)).on("mousedown",this._onHeaderItemMouseDown.bind(this)),this.session.inspector&&Vo.applyInfo(e,l),o&&l.addClass("first"),n&&l.addClass("last"),e.$header=l,this._installHeaderItemTooltip(e),this._decorateHeader(e);let h=e.showSeparator;if(n&&!this.enabled&&(h=!1),h){let p=this.$filler.beforeDiv("table-header-resize");e.fixedWidth||!this.enabled?p.setEnabled(!1):p.on("mousedown","",this._onSeparatorMouseDown.bind(this)).on("dblclick",this._onSeparatorDblclick.bind(this)),e.$separator=p}this._renderedColumns.push(e)}_removeColumns(){this._renderedColumns.slice().forEach(this._removeColumn,this)}_removeColumn(e){e.$header&&(e.$header.remove(),e.$header=null),e.$separator&&(e.$separator.remove(),e.$separator=null),f.remove(this._renderedColumns,e)}resizeHeaderItem(e){if(!e||!e.$header)return;let t=e.$header,r=e.realWidthIfAvailable(),s=w.margins(t),o=this.menuBar.visible?this.$menuBarContainer.outerWidth(!0):0,n=this._visibleColumns(),l=n.indexOf(e),d=l===n.length-1;if(r-=s.horizontal(),d&&o>0){let h=this.$container.width()-this.table.rowWidth+w.insets(this.$container).right;if(h<o){let p=o;e.$separator&&(p+=e.$separator.width()),h>0&&(p-=h);let m=r;r=Math.max(r-p,e.minWidth),this.$filler.cssWidth(m-r)}}t.cssMinWidth(r).cssMaxWidth(r)}resizeHeaderItems(){this._visibleColumns().forEach(this.resizeHeaderItem.bind(this))}_reconcileScrollPos(){let e=this.table.get$Scrollable().scrollLeft(),t=this._lastVisibleColumn();this.resizeHeaderItem(t),this.$container.scrollLeft(e),this.$menuBarContainer.cssRight(-1*e)}_arrangeHeaderItems(e){let t=this;e.each(function(){a()(this).css("left",a()(this).data("old-pos")-a()(this).offset().left).animate({left:0},{progress:function(r,s,o){let n=a()(this);!n.isSelected()||(x.scrollHorizontalTo(t.table.$data,n),t.tableHeaderMenu&&t.tableHeaderMenu.rendered&&t.tableHeaderMenu.position())}})})}_installHeaderItemTooltip(e){G.install(e.$header,{parent:this,text:this._headerItemTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!F.get().isCustomEllipsisTooltipPossible(),htmlEnabled:this._headerItemTooltipHtmlEnabled.bind(this)})}_installHeaderItemTooltips(){this._visibleColumns().forEach(this._installHeaderItemTooltip,this)}_uninstallHeaderItemTooltip(e){G.uninstall(e.$header)}_uninstallHeaderItemTooltips(){this._visibleColumns().forEach(this._uninstallHeaderItemTooltip,this)}_headerItemTooltipText(e){let t=e.data("column");if(t&&y.hasText(t.headerTooltipText))return t.headerTooltipText;let r=e.children(".table-header-item-text");if(r.isContentTruncated()||e.width()+e.position().left>e.parent().width()){let s=y.plainText(r.html(),{trim:!0});if(y.hasText(s))return s}return null}_headerItemTooltipHtmlEnabled(e){return e.data("column").headerTooltipHtmlEnabled}setHeaderMenusEnabled(e){this.setProperty("headerMenusEnabled",e)}_renderHeaderMenusEnabled(){this._visibleColumns().forEach(e=>this._decorateHeader(e))}openHeaderMenu(e){this.tableHeaderMenu&&this.closeHeaderMenu(),this.tableHeaderMenu=e.createTableHeaderMenu(this),this.tableHeaderMenu.open(),e.trigger("headerMenuOpen",{menu:this.tableHeaderMenu}),this.tableHeaderMenu.one("destroy",()=>{e.trigger("headerMenuClose",{menu:this.tableHeaderMenu})})}closeHeaderMenu(){this.tableHeaderMenu.destroy(),this.tableHeaderMenu=null}findHeaderItems(){return this.$container.find(".table-header-item:not(.filler)")}updateHeader(e,t){!e.isVisible()||this._decorateHeader(e,t)}_decorateHeader(e,t){this._renderColumnCssClass(e,t),this._renderColumnText(e),this._renderColumnIconId(e),this._renderColumnState(e),this._renderColumnLegacyStyle(e),this._renderColumnHeaderMenuEnabled(e),this._renderColumnHorizontalAlignment(e)}_renderColumnCssClass(e,t){let r=e.$header;t&&r.removeClass(t.headerCssClass),r.addClass(e.headerCssClass)}_renderColumnText(e){let t=e.text,r=e.$header,s=r.children(".table-header-item-text");e.headerHtmlEnabled||(t=y.nl2br(t)),s.htmlOrNbsp(t,"empty"),this._updateColumnIconAndTextStyle(e)}_renderColumnIconId(e){e.$header.icon(e.headerIconId),this._updateColumnIconAndTextStyle(e)}_renderColumnHorizontalAlignment(e){e.$header.removeClass("halign-left halign-center halign-right"),e.$header.addClass("halign-"+W.parseHorizontalAlignment(e.horizontalAlignment))}_updateColumnIconAndTextStyle(e){let t=e.$header.data("$icon"),r=e.$header.children(".table-header-item-text");t&&t.toggleClass("with-text",!!e.text),r.setVisible(!(t&&r.html()==="&nbsp;")),e.$header.toggleClass("table-header-item-icon-only",!!(e.headerIconId&&!e.text))}_renderColumnLegacyStyle(e){L.legacyStyle(e,e.$header,"header")}_renderColumnHeaderMenuEnabled(e){e.$header.toggleClass("disabled",!this._isHeaderMenuEnabled(e)||!this.enabled)}_renderColumnState(e){let t=e.$header,r=this.table.getFilter(e.id);t.children(".table-header-item-state").remove();let s=t.appendSpan("table-header-item-state");if(s.empty(),t.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),s.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),e.sortActive){let o=e.sortAscending?"asc":"desc";e.grouped&&t.addClass("group-"+o),t.addClass("sorted sort-"+o),s.addClass("sorted sort-"+o)}if(e.grouped||r){let o=s.appendDiv("left");e.grouped&&(t.addClass("grouped"),s.addClass("grouped"),o.appendDiv().text("G")),r&&(t.addClass("filtered"),s.addClass("filtered"),o.appendDiv().text("F"))}s.appendDiv("right"),this._adjustColumnMinWidth(e)}_adjustColumnMinWidth(e){let t=this.table.getFilter(e.id);e.sortActive||e.grouped||t?(e.minWidth<Me.DEFAULT_MIN_WIDTH&&(e.__minWidthWithoutState=e.minWidth,e.__widthWithoutState=e.width,e.minWidth=Me.DEFAULT_MIN_WIDTH),e.width<e.minWidth&&this.table.resizeColumn(e,e.minWidth)):v.isNullOrUndefined(e.__minWidthWithoutState)||(e.minWidth=e.__minWidthWithoutState,e.width===Me.DEFAULT_MIN_WIDTH&&this.table.resizeColumn(e,e.__widthWithoutState),e.__minWidthWithoutState=null,e.__widthWithoutState=null)}updateMenuBar(){let e=this.table._filterMenus(this.table.menus,kt.HEADER);this.menuBar.setHiddenByUi(!this.enabled),this.menuBar.setMenuItems(e)}_onTableColumnResized(e){let t=e.column,r=this._lastVisibleColumn();this.resizeHeaderItem(t),r!==t&&this.resizeHeaderItem(r)}onSortingChanged(){this._visibleColumns().forEach(this._renderColumnState,this)}_onTableColumnMoved(e){let t=e.column,r=e.oldPos,s=e.newPos,o=t.$header,n=this.findHeaderItems(),l=n.eq(r),d=l.next(".table-header-resize"),h=this._visibleColumns(),p=h.length-1;n.each(function(){a()(this).data("old-pos",a()(this).offset().left)}),s<r?n.eq(s).before(l):(n.eq(s).after(l),l.before(l.next(".table-header-resize"))),l.after(d),n.length>0&&(n.eq(0).removeClass("first"),n.eq(n.length-1).removeClass("last")),h.length>0&&(h[0].$header.addClass("first"),h[p].$header.addClass("last")),(r===p||s===p)&&h.forEach(m=>this.resizeHeaderItem(m)),e.dragged?o.css("left",parseInt(o.css("left"),0)+o.data("old-pos")-o.offset().left).addClass("releasing").animateAVCSD("left",0,()=>o.removeClass("releasing")):this._arrangeHeaderItems(n)}_visibleColumns(){return this.table.visibleColumns()}_lastVisibleColumn(){return f.last(this._visibleColumns())}onOrderChanged(e){let t=this.findHeaderItems();t.each(function(){a()(this).data("old-pos",a()(this).offset().left)}),this._visibleColumns().forEach(r=>{let s=r.$header,o=s.next(".table-header-resize");this.$container.append(s),this.$container.append(o)}),this.$container.append(this.$filler),this._arrangeHeaderItems(t)}_isHeaderMenuEnabled(e){return!!(e.headerMenuEnabled&&this.headerMenusEnabled)}_onHeaderItemClick(e){let t=a()(e.currentTarget),r=t.data("column");return this.dragging||this.columnMoved?(this.dragging=!1,this.columnMoved=!1):this.table.sortEnabled&&(e.shiftKey||e.ctrlKey||!this._isHeaderMenuEnabled(r))?this.table.sort(r,t.hasClass("sort-asc")?"desc":"asc",e.shiftKey):this.tableHeaderMenu&&this.tableHeaderMenu.isOpenFor(t)?this.closeHeaderMenu():this._isHeaderMenuEnabled(r)&&this.openHeaderMenu(r),!1}_onHeaderItemMouseDown(e){if(e.button>0)return;let t=0,r=this,s=Math.floor(e.pageX),o=a()(e.currentTarget),n=o.data("column"),l=this._visibleColumns().indexOf(n),d=l,h=o.outerWidth(),p=o.siblings(".table-header-item:not(.filler)");if(n.fixedPosition)return;this.dragging=!1,this.columnMoved=!1,this._$window.on("mousemove.tableheader","",m).one("mouseup","",C);function m(P){if(t=Math.floor(P.pageX)-s,-2<t&&t<2)return;r.dragging=!0,o.addClass("moving"),r.$container&&r.$container.addClass("moving"),o.css("left",t);let R=b(o);p.each(function(k){let N=a()(this),be=b(N);R<be&&k<l?N.css("left",h):R>be&&k>=l?N.css("left",-h):N.css("left",0)}),r.tableHeaderMenu&&(r.tableHeaderMenu.destroy(),r.tableHeaderMenu=null),r.rendered&&r._uninstallHeaderItemTooltips()}function g(P){let R=P.html(),k=P.html("<span>"+R+"</span>").find("span:first").width();return P.html(R),k}function b(P){return P.hasClass("halign-right")?P.offset().left+P.outerWidth()-g(P)/2:P.offset().left+g(P)/2}function C(P){if(r._$window&&r._$window.off("mousemove.tableheader"),!r.dragging)return!0;(t<0?p:a()(p.get().reverse())).each(function(k){if(a()(this).css("left")!=="0px")return d=r._visibleColumns().indexOf(a()(this).data("column")),!1}),d>-1&&l!==d?(r.table.moveColumn(o.data("column"),l,d,!0),r.dragging=!1,r.columnMoved=!0):(o.addClass("releasing"),o.animateAVCSD("left","",()=>{r.dragging=!1,o.removeClass("releasing")})),p.each(function(){a()(this).css("left","")}),o.removeClass("moving"),r.$container&&r.$container.removeClass("moving"),r.rendered&&r._installHeaderItemTooltips()}}_onSeparatorDblclick(e){if(!(e.button>0))if(e.shiftKey)this._visibleColumns().forEach(function(t){this.table.resizeToFit(t)},this);else{let t=a()(e.target).prev(),r=t.data("column");this.table.resizeToFit(r)}}_onSeparatorMouseDown(e){if(e.button>0)return;let t=Math.floor(e.pageX),r=a()(e.target).prev(),s=r.data("column"),o=this,n=s.width,l=this.$container.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth+this.table.rowBorders.horizontal()),d=this.table.$data.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth);this._$window.on("mousemove.tableheader",h).one("mouseup",p),this._$body.addClass("col-resize"),e.preventDefault();function h(m){let g=Math.floor(m.pageX)-t,b=n+g;b=Math.max(b,s.minWidth),o.rendered&&b!==s.width&&o.table.resizeColumn(s,b)}function p(m){l.remove(),d.remove(),o._$window&&o._$window.off("mousemove.tableheader"),o._$body&&o._$body.removeClass("col-resize"),o.table.rendered&&s.width!==n&&o.table.resizeColumn(s,s.width)}}_onTableDataScroll(){x.fix(this.$menuBarContainer),this._reconcileScrollPos(),this._fixTimeout=x.unfix(this.$menuBarContainer,this._fixTimeout)}_onMenuBarPropertyChange(e){this.rendered&&e.propertyName==="visible"&&this.$menuBarContainer.setVisible(e.newValue)}_onTableAddFilterRemoved(e){if(!(e.filter instanceof Zi))return;let t=e.filter.column;e.filter.filterType===Zi.TYPE&&t.$header&&this._renderColumnState(t)}}function Q(i,e,t){return e=Fx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Fx(i){var e=Ex(i,"string");return typeof e=="symbol"?e:String(e)}function Ex(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ci extends pe{constructor(){super(),Q(this,"column",void 0),Q(this,"tableHeader",void 0),Q(this,"compact",void 0),Q(this,"table",void 0),Q(this,"filterTable",void 0),Q(this,"filter",void 0),Q(this,"filterCheckedMode",void 0),Q(this,"filterSortMode",void 0),Q(this,"hasFilterTable",void 0),Q(this,"hasFilterFields",void 0),Q(this,"leftGroups",void 0),Q(this,"moveGroup",void 0),Q(this,"hierarchyGroup",void 0),Q(this,"toBeginButton",void 0),Q(this,"forwardButton",void 0),Q(this,"backwardButton",void 0),Q(this,"toEndButton",void 0),Q(this,"sortingGroup",void 0),Q(this,"sortAscButton",void 0),Q(this,"sortDescButton",void 0),Q(this,"sortAscAddButton",void 0),Q(this,"sortDescAddButton",void 0),Q(this,"columnActionsGroup",void 0),Q(this,"addColumnButton",void 0),Q(this,"removeColumnButton",void 0),Q(this,"modifyColumnButton",void 0),Q(this,"groupButton",void 0),Q(this,"groupAddButton",void 0),Q(this,"barChartButton",void 0),Q(this,"colorGradient1Button",void 0),Q(this,"colorGradient2Button",void 0),Q(this,"filterFieldsGroupBox",void 0),Q(this,"$rightGroups",void 0),Q(this,"$headerItem",void 0),Q(this,"$columnActions",void 0),Q(this,"$columnFilters",void 0),Q(this,"$filterTableGroup",void 0),Q(this,"$filterToggleChecked",void 0),Q(this,"$filterTableGroupTitle",void 0),Q(this,"$filterSortOrder",void 0),Q(this,"$filterFieldsGroup",void 0),Q(this,"$body",void 0),Q(this,"_onColumnMovedHandler",void 0),Q(this,"_tableFilterHandler",void 0),Q(this,"_tableHeaderScrollHandler",void 0),Q(this,"_filterTableRowsCheckedHandler",void 0),this.column=null,this.tableHeader=null,this.table=null,this.filter=null,this.filterCheckedMode=Ci.CheckedMode.ALL,this.filterSortMode=Ci.SortMode.ALPHABETICALLY,this.hasFilterTable=!1,this.hasFilterFields=!1,this.animateOpening=!0,this.animateRemoval=!0,this.focusableContainer=!0,this.leftGroups=[],this.moveGroup=null,this.toBeginButton=null,this.forwardButton=null,this.backwardButton=null,this.toEndButton=null,this.sortingGroup=null,this.sortDescButton=null,this.sortAscAddButton=null,this.sortDescAddButton=null,this.columnActionsGroup=null,this.addColumnButton=null,this.removeColumnButton=null,this.modifyColumnButton=null,this.groupButton=null,this.groupAddButton=null,this.barChartButton=null,this.colorGradient1Button=null,this.colorGradient2Button=null,this.$rightGroups=[],this.$headerItem=null,this.$columnActions=null,this.$columnFilters=null,this.$filterTableGroup=null,this.$filterToggleChecked=null,this.$filterTableGroupTitle=null,this.$filterSortOrder=null,this.$filterFieldsGroup=null,this._onColumnMovedHandler=this._onColumnMoved.bind(this),this._tableHeaderScrollHandler=this._onAnchorScroll.bind(this),this.on("locationChange",this._onLocationChange.bind(this)),this.inheritAccessibility=!1}_init(e){e.scrollType=e.scrollType||"none",super._init(e),this.tableHeader=e.tableHeader,this.column=e.column,this.table=this.tableHeader.table,this.$headerItem=this.$anchor,this.table.on("columnMoved",this._onColumnMovedHandler),this.filter=this.table.getFilter(this.column.id),this.filter||(this.filter=this.column.createFilter()),this.filter.calculate(),this.filter.on("filterFieldsChanged",this._updateFilterTable.bind(this)),this._updateFilterTableCheckedMode(),this.hasFilterTable=this.filter.availableValues.length>0,this.hasFilterFields=this.filter.hasFilterFields,this.hasFilterTable&&(this._tableFilterHandler=this._onFilterTableChanged.bind(this),this.table.on("filterAdded",this._tableFilterHandler),this.table.on("filterRemoved",this._tableFilterHandler),this._filterTableRowsCheckedHandler=this._onFilterTableRowsChecked.bind(this))}_createLayout(){return new Eo(this)}_render(){this.leftGroups=[],this.$rightGroups=[],this.$headerItem.select(!0),this.$container=this.$parent.appendDiv("popup table-header-menu"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$body=this.$container.appendDiv("table-header-menu-body"),S.install(this.$body,this.session),this._installScrollbars({axis:"y",scrollShadow:"none"}),this.$columnActions=this.$body.appendDiv("table-header-menu-actions"),(this.hasFilterTable||this.hasFilterFields)&&(this.$columnFilters=this.$body.appendDiv("table-header-menu-filters"),S.install(this.$columnFilters,this.session).setLayout(new Ri)),this.tableHeader.$container.on("scroll",this._tableHeaderScrollHandler),this.table.visibleColumns().filter(t=>!t.fixedPosition).length>1&&!this.column.fixedPosition&&this.leftGroups.push(this._renderMovingGroup()),this.table.sortEnabled&&this.leftGroups.push(this._renderSortingGroup()),this._isColumnActionsGroupVisible()&&this.leftGroups.push(this._renderColumnActionsGroup()),(this.table.isGroupingPossible(this.column)||this.column.grouped)&&this.leftGroups.push(this._renderGroupingGroup()),this.leftGroups.push(this._renderHierarchyGroup()),this.table.isAggregationPossible(this.column)&&this.leftGroups.push(this._renderAggregationGroup()),this.column instanceof Oi&&this.leftGroups.push(this._renderColoringGroup()),this.hasFilterTable&&this.$rightGroups.push(this._renderFilterTable()),this.hasFilterFields&&this.$rightGroups.push(this._renderFilterFields()),this._onColumnMoved(),this.table.enabled&&this.table.$container.addClass("focused")}validateFocus(){this.filterFieldsGroupBox&&this.filterFieldsGroupBox.focus(),super.validateFocus()}get$Scrollable(){return this.$body}_updateFirstLast(){e(this.leftGroups.filter(r=>r.isVisible())),e(this.$rightGroups);function e(r){r.forEach((s,o,n)=>{t(s,"first",o===0),t(s,"last",o===n.length-1)})}function t(r,s,o){(r instanceof Lr?r.$container:r).toggleClass(s,o)}}_remove(){this.filterTable&&this.filterTable.off("rowsChecked",this._filterTableRowsCheckedHandler),this.tableHeader.rendered&&this.tableHeader.$container.off("scroll",this._tableHeaderScrollHandler),this.$headerItem.select(!1),this.table.off("columnMoved",this._onColumnMovedHandler),this.table.off("filterAdded",this._tableFilterHandler),this.table.off("filterRemoved",this._tableFilterHandler),super._remove(),this.table.rendered&&this.table.$container.removeClass("focused")}_renderMovingGroup(){let e=this.table,t=this.column,r=e.visibleColumns().indexOf(t);return this.moveGroup=u.create(Lr,{parent:this,textKey:"ui.Move",cssClass:"first"}),this.toBeginButton=u.create(ut,{parent:this.moveGroup,text:"${textKey:ui.toBegin}",cssClass:"move move-top"}),this.toBeginButton.on("action",()=>{e.moveColumn(t,r,0),r=e.visibleColumns().indexOf(t)}),this.forwardButton=u.create(ut,{parent:this.moveGroup,text:"${textKey:ui.forward}",cssClass:"move move-up"}),this.forwardButton.on("action",()=>{e.moveColumn(t,r,Math.max(r-1,0)),r=e.visibleColumns().indexOf(t)}),this.backwardButton=u.create(ut,{parent:this.moveGroup,text:"${textKey:ui.backward}",cssClass:"move move-down"}),this.backwardButton.on("action",()=>{e.moveColumn(t,r,Math.min(r+1,e.header.findHeaderItems().length-1)),r=e.visibleColumns().indexOf(t)}),this.toEndButton=u.create(ut,{parent:this.moveGroup,text:"${textKey:ui.toEnd}",cssClass:"move move-bottom"}),this.toEndButton.on("action",()=>{e.moveColumn(t,r,e.header.findHeaderItems().length-1),r=e.visibleColumns().indexOf(t)}),this.moveGroup.render(this.$columnActions),this.moveGroup}_onColumnMoved(){let e=this.table,t=this.column;if(this.moveGroup){let r=e.visibleColumns(),s=e.visibleColumns().indexOf(t),o=r[s-1]&&!r[s-1].fixedPosition,n=r[s+1]&&!r[s+1].fixedPosition;this.toBeginButton.setEnabled(o),this.forwardButton.setEnabled(o),this.backwardButton.setEnabled(n),this.toEndButton.setEnabled(n)}this.hierarchyGroup.setVisible(this.table.isTableNodeColumn(t)),this._updateFirstLast()}_isColumnActionsGroupVisible(){return this.table.columnAddable||this.column.removable||this.column.modifiable}_renderColumnActionsGroup(){let e=this.column,t=this;return this.columnActionsGroup=u.create(Lr,{parent:this,textKey:"ui.Column"}),this.addColumnButton=u.create(ut,{parent:this.columnActionsGroup,text:"${textKey:ui.addColumn}",cssClass:"add-column",visible:this.table.columnAddable}),this.addColumnButton.on("action",r.bind(this,"add")),this.removeColumnButton=u.create(ut,{parent:this.columnActionsGroup,text:"${textKey:ui.removeColumn}",cssClass:"remove-column",visible:this.column.removable}),this.removeColumnButton.on("action",r.bind(this,"remove")),this.modifyColumnButton=u.create(ut,{parent:this.columnActionsGroup,text:"${textKey:ui.changeColumn}",cssClass:"change-column",visible:this.column.modifiable}),this.modifyColumnButton.on("action",r.bind(this,"modify")),this.columnActionsGroup.render(this.$columnActions),this.columnActionsGroup;function r(s){t.close(),this.table.trigger("columnOrganizeAction",{action:s,column:e})}}_renderSortingGroup(){let e=this.table,t=this.column,r=this;return this.sortingGroup=u.create(Lr,{parent:this,textKey:"ColumnSorting"}),e.hasPermanentHeadOrTailSortColumns()||(this.sortAscButton=u.create(ut,{parent:this.sortingGroup,text:"${textKey:ui.ascending}",cssClass:"sort sort-asc",direction:"asc",toggleAction:!0}),this.sortAscButton.on("action",s.bind(this.sortAscButton)),this.sortDescButton=u.create(ut,{parent:this.sortingGroup,text:"${textKey:ui.descending}",cssClass:"sort sort-desc",direction:"desc",toggleAction:!0}),this.sortDescButton.on("action",s.bind(this.sortDescButton))),this.sortAscAddButton=u.create(ut,{parent:this.sortingGroup,text:"${textKey:ui.ascendingAdditionally}",cssClass:"sort sort-asc-add",direction:"asc",toggleAction:!0}),this.sortAscAddButton.on("action",o.bind(this.sortAscAddButton)),this.sortDescAddButton=u.create(ut,{parent:this.sortingGroup,text:"${textKey:ui.descendingAdditionally}",cssClass:"sort sort-desc-add",direction:"desc",toggleAction:!0}),this.sortDescAddButton.on("action",o.bind(this.sortDescAddButton)),this._updateSortingSelectedState(),this.sortingGroup.render(this.$columnActions),this.sortingGroup;function s(){r.close(),n(this.direction,!1,!this.selected)}function o(){r.close(),n(this.direction,!0,!this.selected)}function n(l,d,h){e.sort(t,l,d,h),r._updateSortingSelectedState()}}_updateSortingSelectedState(){if(!this.table.sortEnabled)return;let e=!1,t=this._sortColumnCount();if(this.sortingGroup.children.forEach(r=>r.setSelected(!1)),t===1&&!this.table.hasPermanentHeadOrTailSortColumns())this.column.sortActive?this.column.sortAscending?this.sortAscButton.setSelected(!0):this.sortDescButton.setSelected(!0):e=!0;else if((t>1||this.table.hasPermanentHeadOrTailSortColumns())&&(e=!0,this.column.sortActive)){this.column.sortAscending?this.sortAscAddButton.setSelected(!0):this.sortDescAddButton.setSelected(!0);let r=this.column.sortIndex+1+"";this.sortAscAddButton.setIconId(r),this.sortDescAddButton.setIconId(r)}this.sortAscAddButton.setVisible(e),this.sortDescAddButton.setVisible(e)}_renderGroupingGroup(){let e=this,t=this.table,r=this.column,s=this._groupColumnCount(),o=u.create(Lr,{parent:this,textKey:"ui.Grouping"});return this.groupButton=u.create(ut,{parent:o,text:"${textKey:ui.groupingApply}",cssClass:"group",additional:!1,toggleAction:!0}),this.groupButton.on("action",n.bind(this.groupButton)),this.groupAddButton=u.create(ut,{parent:o,text:"${textKey:ui.additionally}",cssClass:"group-add",additional:!0,toggleAction:!0}),this.groupAddButton.on("action",n.bind(this.groupAddButton)),s===0?this.groupAddButton.setVisible(!1):s===1&&this.column.grouped?(this.groupButton.setSelected(!0),this.groupAddButton.setVisible(!1)):s>1&&this.groupAddButton.setVisible(!0),t.hasPermanentHeadOrTailSortColumns()&&s>0&&(this.groupButton.setVisible(!1),this.groupAddButton.setVisible(!0)),this.column.grouped&&(s===1?this.groupAddButton.setSelected(!0):s>1&&(this.groupAddButton.setSelected(!0),this.groupAddButton.setIconId(this.column.sortIndex+1+""))),o.render(this.$columnActions),o;function n(){let l=r.sortIndex>=0&&!r.sortAscending?"desc":"asc";e.close(),t.groupColumn(r,this.additional,l,!this.selected)}}_renderHierarchyGroup(){let e=this.table,t=this;return this.hierarchyGroup=u.create(Lr,{parent:this,textKey:"ui.Hierarchy",visible:this.table.isTableNodeColumn(this.column)}),u.create(ut,{parent:this.hierarchyGroup,text:"${textKey:ui.CollapseAll}",cssClass:"hierarchy-collapse-all",enabled:!!f.find(e.rows,o=>o.expanded&&!f.empty(o.childRows))}).on("action",()=>{t.close(),e.collapseAll()}),u.create(ut,{parent:this.hierarchyGroup,text:"${textKey:ui.ExpandAll}",cssClass:"hierarchy-expand-all",enabled:!!f.find(e.rows,o=>!o.expanded&&!f.empty(o.childRows))}).on("action",()=>{t.close(),e.expandAll()}),this.hierarchyGroup.render(this.$columnActions),this.hierarchyGroup}_renderAggregationGroup(){let e=this.table,t=this.column,r=t.aggregationFunction,s=this,o=u.create(Lr,{parent:this,textKey:"ui.Aggregation"}),n=f.ensure(t.allowedAggregationFunctions),l=n.indexOf("none")!==-1;return d("${textKey:ui.Sum}","sum"),d("${textKey:ui.Average}","avg"),d("${textKey:ui.Minimum}","min"),d("${textKey:ui.Maximum}","max"),o.children.forEach(p=>p.setSelected(p.aggregation===r)),o.render(this.$columnActions),o;function d(p,m){if(n.indexOf(m)!==-1){let g=u.create(ut,{parent:o,text:p,cssClass:"aggregation-function "+m,aggregation:m,toggleAction:l});g.on("action",h.bind(g))}}function h(){s.close(),e.changeAggregation(t,this.aggregation===r?"none":this.aggregation)}}_renderColoringGroup(){let e=this.table,t=this.column,r=this,s=t.backgroundEffect,o=u.create(Lr,{parent:this,textKey:"ui.Coloring"});return this.colorGradient1Button=u.create(ut,{parent:o,text:"${textKey:ui.fromRedToGreen}",cssClass:"color color-gradient1",backgroundEffect:"colorGradient1",toggleAction:!0}),this.colorGradient1Button.on("action",n.bind(this.colorGradient1Button)),this.colorGradient2Button=u.create(ut,{parent:o,text:"${textKey:ui.fromGreenToRed}",cssClass:"color color-gradient2",backgroundEffect:"colorGradient2",toggleAction:!0}),this.colorGradient2Button.on("action",n.bind(this.colorGradient2Button)),F.get().supportsCssGradient()&&(this.barChartButton=u.create(ut,{parent:o,text:"${textKey:ui.withBarChart}",cssClass:"color color-bar-chart",backgroundEffect:"barChart",toggleAction:!0}),this.barChartButton.on("action",n.bind(this.barChartButton))),o.children.forEach(l=>l.setSelected(l.backgroundEffect===s)),o.render(this.$columnActions),o;function n(){r.close(),e.setColumnBackgroundEffect(t,this.selected?this.backgroundEffect:null)}}_renderFilterTable(){this.$filterTableGroup=this.$columnFilters.appendDiv("table-header-menu-group first"),S.install(this.$filterTableGroup,this.session).setLayout(new Ri);let t=this.$filterTableGroup.appendDiv("table-header-menu-filter-actions");this.$filterSortOrder=t.appendDiv("link table-header-menu-toggle-sort-order").on("click",this._onSortModeClick.bind(this)).addClass(this.filterSortMode.cssClass),this.$filterToggleChecked=t.appendDiv("link table-header-menu-filter-toggle-checked").text(this.session.text(this.filterCheckedMode.text)).on("click",this._onFilterCheckedModeClick.bind(this)),this.$filterTableGroupTitle=this.$filterTableGroup.appendDiv("table-header-menu-group-text").text(this._filterByText()),S.install(this.$filterTableGroupTitle,this.session),this.filterTable=this._createFilterTable(),this.filterTable.on("rowsChecked",this._filterTableRowsCheckedHandler);let r=[];return this.filter.availableValues.forEach(s=>{let o={cells:[u.create(Pt,{text:this.filter.column instanceof Oi?s.text:null,value:this.filter.column instanceof Oi?s.key:s.text,iconId:s.iconId,htmlEnabled:s.htmlEnabled,cssClass:s.cssClass}),s.count,s.key===null?1:0],checked:this.filter.selectedValues.indexOf(s.key)>-1,dataMap:{filterValue:s}};r.push(o)}),this.filterTable.insertRows(r),this.filterTable.render(this.$filterTableGroup),setTimeout(this.filterTable.revealChecked.bind(this.filterTable)),this.$filterTableGroup}_createFilterTable(){let e=Me;return this.column instanceof Oi&&(e=Oi),u.create(W,{parent:this,headerVisible:!1,multiSelect:!1,autoResizeColumns:!0,checkable:!0,cssClass:"table-header-menu-filter-table",checkableStyle:W.CheckableStyle.TABLE_ROW,columns:[{objectType:e,text:"filter-value",width:120,sortActive:!0,sortIndex:1,horizontalAlignment:-1},{objectType:Oi,text:"aggregate-count",cssClass:"table-header-menu-filter-number-column",width:50,minWidth:32,autoOptimizeWidth:!0},{objectType:Oi,displayable:!1,sortActive:!0,sortIndex:0}]})}_filterByText(){let e=this.session.text("ui.Filter"),t=this.filter.selectedValues.length,r=this.filter.availableValues.length;return t&&r?e+=" "+this.session.text("ui.FilterInfoXOfY",t+"",r+""):r&&(e+=" "+this.session.text("ui.FilterInfoCount",r+"")),e}_onFilterCheckedModeClick(){let e=Ci.CheckedMode,t=this.filterCheckedMode.checkAll;this.filter.selectedValues=[],this.filterCheckedMode===e.ALL?(this.filterCheckedMode=e.NONE,this.filter.availableValues.forEach(r=>this.filter.selectedValues.push(r.key))):this.filterCheckedMode=e.ALL,this.filterTable.checkAll(t),this._updateFilterTableActions()}_onSortModeClick(){let e=Ci.SortMode;this.filterSortMode===e.ALPHABETICALLY?(this.filterTable.sort(this.filterTable.columns[1],"desc"),this.filterSortMode=e.AMOUNT):(this.filterTable.sort(this.filterTable.columns[2],"asc"),this.filterTable.sort(this.filterTable.columns[0],"asc",!0),this.filterSortMode=e.ALPHABETICALLY),this._updateFilterTableActions()}_updateFilterTable(){this.filter.filterActive()?this.table.addFilter(this.filter):this.table.removeFilterByKey(this.column.id)}_updateFilterTableActions(){this.$filterToggleChecked.text(this.session.text(this.filterCheckedMode.text));let e=Ci.SortMode,t=this.filterSortMode===Ci.SortMode.ALPHABETICALLY;this.$filterSortOrder.toggleClass(e.ALPHABETICALLY.cssClass,t),this.$filterSortOrder.toggleClass(e.AMOUNT.cssClass,!t)}_renderFilterFields(){this.filterFieldsGroupBox=u.create(Nf,{parent:this,filter:this.filter}),this.$filterFieldsGroup=this.$columnFilters.appendDiv("table-header-menu-group");let e=S.install(this.$filterFieldsGroup,this.session);e.setLayout(new Ri);let t=this.$filterFieldsGroup.appendDiv("table-header-menu-group-text").text(this.filter.filterFieldsTitle());return e=S.install(t,this.session),this.filterFieldsGroupBox.render(this.$filterFieldsGroup),this.$filterFieldsGroup}isOpenFor(e){return this.rendered&&this.belongsTo(e)}_countColumns(e){return this.table.visibleColumns().reduce((t,r)=>t+(r[e]?1:0),0)}_sortColumnCount(){return this._countColumns("sortActive")}_groupColumnCount(){return this._countColumns("grouped")}_renderCompact(){this.$body.toggleClass("compact",this.compact),this.invalidateLayoutTree()}setCompact(e){this.setProperty("compact",e)}_onLocationChange(e){let t=w.offsetBounds(this.$headerItem),r=this.tableHeader.$container;this.$container.setVisible(!0);let s=w.offsetBounds(this.$container),o=x.isLocationInView(new Z(t.x,t.y),r);o||(o=x.isLocationInView(new Z(t.x+t.width,t.y+t.height),r),o=o&&x.isLocationInView(new Z(s.x+s.width,s.y),r)),this.$container.setVisible(o)}_onAnchorScroll(e){this.position()}_onFilterTableRowsChecked(e){this.filter.selectedValues=[],this.filterTable.rows.forEach(t=>{t.checked&&this.filter.selectedValues.push(t.dataMap.filterValue.key)}),this._updateFilterTable()}_onFilterTableChanged(){this.$filterTableGroupTitle.text(this._filterByText()),this._updateFilterTableCheckedMode(),this._updateFilterTableActions()}_updateFilterTableCheckedMode(){this.filter.selectedValues.length===0?this.filterCheckedMode=Ci.CheckedMode.ALL:this.filterCheckedMode=Ci.CheckedMode.NONE}_onMouseDownOutside(e){this.$headerItem.isOrHas(e.target)||this.close()}}Q(Ci,"CheckedMode",{ALL:{checkAll:!0,text:"ui.SelectAllFilter"},NONE:{checkAll:!1,text:"ui.SelectNoneFilter"}}),Q(Ci,"SortMode",{ALPHABETICALLY:{text:"ui.SortAlphabeticallyFilter",cssClass:"table-header-menu-toggle-sort-order-alphabetically"},AMOUNT:{text:"ui.SortByAmountFilter",cssClass:"table-header-menu-toggle-sort-order-amount"}});function Ax(i,e,t){return e=Dx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Dx(i){var e=Mx(i,"string");return typeof e=="symbol"?e:String(e)}function Mx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Eo extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}layout(e){if(super.layout(e),!this.popup.hasFilterFields&&!this.popup.hasFilterTable)return;let t,r=this.popup.$columnFilters,s=w.insets(r),o=w.margins(r),n=new A;if(this.popup.$body.hasClass("compact")?t=S.get(r).prefSize():(t=this.preferredLayoutSize(e).subtract(w.insets(e)),t=t.subtract(o)),t.width=r.cssWidth(),r.cssHeight(t.height),this.popup.hasFilterFields){let d=this.popup.$filterFieldsGroup;S.get(d.find(".form-field")).setSize(new A(t.width-s.horizontal(),this._filterFieldsGroupBoxHeight())),n=w.size(d,!0)}if(this.popup.hasFilterTable){let d=this.popup.$filterTableGroup,h=w.insets(d),p=this.popup.filterTable.htmlComp,m=t.height-s.vertical();m-=n.height,m-=this._groupTitleHeight(d),m-=h.vertical(),m=Math.min(m,Eo.TABLE_MAX_HEIGHT),p.setSize(new A(t.width-s.horizontal(),m))}this._setMaxWidth();let l=w.size(this.popup.$columnActions);this._setMaxWidth(l.width)}_adjustSizeWithAnchor(e){let t=this.popup.htmlComp,r=this.popup.windowPaddingX,s=t.margins(),o=t.offsetBounds(),d=this.popup.$container.window().width()-s.horizontal()-o.x-r;return o.width>d&&(this.popup.$body.addClass("compact"),e=this.preferredLayoutSize(this.popup.$container)),super._adjustSizeWithAnchor(e)}_groupTitleHeight(e){return w.size(e.find(".table-header-menu-group-text"),!0).height}_filterFieldsGroupBoxHeight(){return this.popup.filterFieldsGroupBox.htmlComp.prefSize().height}preferredLayoutSize(e,t){let r=0,s=0,o=w.insets(e),n=this._getMaxWidth();if(this._setMaxWidth(),s=w.size(this.popup.$columnActions,!0).height,this.popup.hasFilterTable){let d=this.popup.$filterTableGroup,h=this.popup.filterTable.htmlComp.size(!0).height,p=w.insets(d);h=Math.min(h,Eo.TABLE_MAX_HEIGHT);let m=h;m+=this._groupTitleHeight(d),m+=p.vertical(),r+=m}if(this.popup.hasFilterFields){let d=this.popup.$filterFieldsGroup,h=w.insets(d),p=this._filterFieldsGroupBoxHeight();p+=this._groupTitleHeight(d),p+=h.vertical(),r+=p}if(this.popup.hasFilterFields||this.popup.hasFilterTable){let d=w.margins(this.popup.$columnFilters),h=w.insets(this.popup.$columnFilters);r+=d.vertical(),r+=h.vertical()}let l=w.prefSize(e);return this.popup.$body.hasClass("compact")?l.height=s+r+o.vertical():l.height=Math.max(s,r)+o.vertical(),this._setMaxWidth(n),l}_getMaxWidth(){return parseInt(this.popup.$columnActions.css("max-width"),10)}_setMaxWidth(e){this.popup.$columnActions.css("max-width",e||"")}}Ax(Eo,"TABLE_MAX_HEIGHT",330);function Da(i,e,t){return e=$x(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $x(i){var e=Rx(i,"string");return typeof e=="symbol"?e:String(e)}function Rx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Lr extends I{constructor(){super(),Da(this,"text",void 0),Da(this,"textKey",void 0),Da(this,"last",void 0),Da(this,"$text",void 0),this.text=null,this.textKey=null,this.visible=!0,this.last=!1}_init(e){super._init(e),this.text=u.nvl(this.text,this.session.text(this.textKey))}_render(){this.$container=this.$parent.appendDiv("table-header-menu-group buttons"),this.$text=this.$container.appendDiv("table-header-menu-group-text"),this.cssClass&&this.$container.addClass(this.cssClass),this._renderText(),this.children.forEach(e=>e.render()),ke.updateFirstLastMarker(this.children)}appendText(e){this.text=this.session.text(this.textKey)+" "+e,this.rendered&&this._renderText()}resetText(){this.text=this.session.text(this.textKey),this.rendered&&this._renderText()}_renderText(){this.$text.text(this.text)}setLast(e){this.setProperty("last",e)}_renderLast(){this.$container.toggleClass("last",this.last)}}function hl(i,e,t){return e=Lx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Lx(i){var e=Ix(i,"string");return typeof e=="symbol"?e:String(e)}function Ix(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ut extends oe{constructor(){super(),hl(this,"aggregation",void 0),hl(this,"backgroundEffect",void 0),hl(this,"direction",void 0),hl(this,"additional",void 0),hl(this,"$icon",void 0),this.textVisible=!1,this.tabbable=!0}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new ha(this))}_render(){super._render(),this.$container=this.$container.addClass("table-header-menu-command button").unfocusable().on("mouseenter",this._onMouseOver.bind(this)).on("mouseleave",this._onMouseOut.bind(this)),this.$icon=this.$container.appendSpan("icon font-icon")}_renderProperties(){super._renderProperties(),this._renderToggleAction()}_onMouseOver(){let e=this.selected?this.session.text("ui.remove"):this.text;this.parent.appendText(e)}_onMouseOut(){this.parent.resetText()}_renderToggleAction(){this.$container.toggleClass("togglable",this.toggleAction)}_renderIconId(){this.iconId?this.$icon.attr("data-icon",this.iconId):this.$icon.removeAttr("data-icon")}}function ag(i,e,t){return e=kx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kx(i){var e=Bx(i,"string");return typeof e=="symbol"?e:String(e)}function Bx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Su extends te{constructor(e){super(),ag(this,"table",void 0),ag(this,"_dataHeightPositive",void 0),this.table=e,this._dataHeightPositive=!1}layout(e){let t=0,r=0,s=0,o=0,n=0,l=this.table.tableTileGridMediator?this.table.tableTileGridMediator.tileAccordion:null,d=this.table.$data,h=w.margins(u.nvl(d,this.table.$container)),p=h.top+h.bottom,m=this.table.menuBar,g=this.table.footer,b=this.table.header,C=this.table.tileTableHeader,P=this.table.visibleColumns(),R=P[P.length-1],k=this.table.htmlComp,N=k.availableSize({exact:!0}).subtract(k.insets());if(this.table.menuBarVisible&&m.visible){let Ye=S.get(m.$container),ri=Zr.size(Ye,N);Ye.setSize(ri),t=ri.height}if(e.css("--menubar-height",t+"px"),b&&(s=w.size(b.$container).height,b.menuBar&&b.menuBar.validateLayout()),g){r=w.size(g.$container).height,n=g.computeControlContainerHeight(this.table,g.selectedControl,!this._dataHeightPositive);let Ye=w.insets(g.$controlContainer);g.animating||(g.$controlContainer.cssHeight(n),g.$controlContent.outerHeight(n-Ye.vertical()),g.revalidateLayout())}if(C&&C.visible){let Ye=C.htmlComp.prefSize({widthHint:N.width});Ye.width=N.width,Ye=Ye.subtract(C.htmlComp.margins()),C.htmlComp.setSize(Ye),o=Ye.height}let be=p+t+n+r+s+o,st=N.height-be;e.css("--controls-height",be+"px"),d?(d.css("height","calc(100% - "+be+"px)"),this._dataHeightPositive=d.height()>0):l&&l.htmlComp&&(l.htmlComp.setSize(new A(N.width,st)),x.update(l.$container),this._dataHeightPositive=st>0),this.table.tileMode||(this._layoutColumns(),b&&b.resizeHeaderItem(R),this.table.setViewRangeSize(this.table.calculateViewRangeSize()),k.layouted||this.table._renderScrollTop(),this.table._renderViewport(),k.layouted||this.table._renderScrollTop(),this.table.tooltips.forEach(Ye=>{Ye.rendered&&Ye.position()}),this.table.cellEditorPopup&&this.table.cellEditorPopup.rendered&&(this.table.cellEditorPopup.position(),this.table.cellEditorPopup.pack()),this.table.updateScrollbars())}_layoutColumns(e){this._autoOptimizeColumnsWidths();let t=this.table.htmlComp,r=this.table.columnLayoutDirty||!t.sizeCached;if(!r){let s=e||t.size().width;r=t.sizeCached.width!==s}r&&(this.table.autoResizeColumns&&this._autoResizeColumns(e),this._updateRealColumnWidths(),this.table.columnLayoutDirty=!1)}_updateRealColumnWidths(){this.table._updateRealColumnWidths()&&(this.table._updateRowWidth(),this.table.header&&this.table.header.rendered&&this.table.header.resizeHeaderItems(),this.table.$rows(!0).css("width",this.table.rowWidth))}_autoOptimizeColumnsWidths(){this.table.visibleColumns().forEach(e=>{e.autoOptimizeWidth&&e.autoOptimizeWidthRequired&&this.table.resizeToFit(e,e.autoOptimizeMaxWidth)})}_autoResizeColumns(e){let t,r,s=[],o=0,n=0,l=e||this.table.$data.width(),d=Math.floor(l-(this.table.rowBorders.horizontal()+this.table.rowMargins.horizontal()));if(this.table.visibleColumns().forEach(m=>{m.fixedWidth||m.autoOptimizeWidth?d-=m.width:(s.push(m),o+=m.width,n+=m.initialWidth)}),d===o)return;let h=d,p=s.filter(m=>{let g=Math.max(m.minWidth,m.initialWidth);return n===0?r=1/s.length:r=m.initialWidth/n,t=Math.floor(r*h),t<g?(t=g,h=Math.max(h-t,0),!0):!1});p.forEach((m,g)=>{let b=Math.max(m.minWidth,m.initialWidth);f.remove(s,m),t=b,n-=m.initialWidth,g===p.length-1&&h>0&&s.length===0&&(t+=h,h=0),t!==m.width&&this.table.resizeColumn(m,t)}),d=h,s.forEach((m,g)=>{n===0?r=1/s.length:r=m.initialWidth/n,t=Math.floor(r*d),h-=t,g===s.length-1&&h>0&&(t+=h,h=0),t!==m.width&&this.table.resizeColumn(m,t)})}preferredLayoutSize(e,t){return this.table.tileMode?new Ri().preferredLayoutSize(e,t):(this._layoutColumns(t.widthHint),this.table._renderViewport(),super.preferredLayoutSize(e,t))}}function hr(i,e,t){return e=Ox(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ox(i){var e=Hx(i,"string");return typeof e=="symbol"?e:String(e)}function Hx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cu{constructor(e){hr(this,"table",void 0),hr(this,"mouseMoveSelectionEnabled",void 0),hr(this,"lastActionRow",void 0),hr(this,"mouseOverHandler",void 0),hr(this,"select",void 0),hr(this,"counterDebug",void 0),hr(this,"fromIndex",void 0),hr(this,"toIndex",void 0),hr(this,"_mouseDown",void 0),hr(this,"_prevSelectedRowIndex",void 0),hr(this,"_maxSelectedRowIndex",void 0),this.table=e,this.mouseMoveSelectionEnabled=!0,this._mouseDown=!1,this.lastActionRow=null,this.mouseOverHandler=null,this.select=!0,this.counterDebug=0,this.fromIndex=-1,this.toIndex=-1,this._prevSelectedRowIndex=-1,this._maxSelectedRowIndex=-1}clearLastSelectedRowMarker(){this.lastActionRow=null}onMouseDown(e){let t=a()(e.currentTarget),r=t.data("row"),s=t.isSelected(),o=this.table.visibleRows;if(this._mouseDown=!0,this.select=!0,this.table.multiSelect&&e.shiftKey){if(this.table.selectedRows.indexOf(r)>-1)return;if(this.table.selectedRows.length===0&&(this.lastActionRow=r),!this.lastActionRow){let n=o.indexOf(r),l=this.table.selectedRows[0],d=this.table.selectedRows[this.table.selectedRows.length-1];n<=(o.indexOf(l)+o.indexOf(d))/2?this.lastActionRow=l:this.lastActionRow=d,this._maxSelectedRowIndex=o.indexOf(d),this._prevSelectedRowIndex=o.indexOf(this.lastActionRow)}this.fromIndex=o.indexOf(this.lastActionRow)}else e.ctrlKey?this.select=!s:(!s||this.table.selectedRows.length>1&&e.which!==3)&&(this.table._removeSelection(),this.table.selectedRows=[]);this.fromIndex<0&&(this.fromIndex=o.indexOf(r)),(e.which!==3||!s)&&(this.toIndex=o.indexOf(r),this.handleSelection(e),this.table.notifyRowSelectionFinished()),this.mouseMoveSelectionEnabled&&e.which!==3&&(this.table.$data.off("mouseover",this.mouseOverHandler),this.mouseOverHandler=this.onMouseOver.bind(this),this.table.$data.on("mouseover",".table-row",this.mouseOverHandler)),t.window().one("mouseup.selectionHandler",this.onMouseUp.bind(this)),this.lastActionRow=r}onMouseOver(e){let r=a()(e.currentTarget).data("row"),s=this.table.visibleRows;this.toIndex=s.indexOf(r),this.handleSelection(e),this.lastActionRow=r}handleSelection(e){let t,r=this.table.visibleRows;if(this.table.multiSelect){let s=this.toIndex,o=s<this._prevSelectedRowIndex,n=s>this._prevSelectedRowIndex,l=this._prevSelectedRowIndex<this.fromIndex,d=this._prevSelectedRowIndex>this.fromIndex;if(!e.ctrlKey){if(o&&d?t=r.slice(s+1,this._maxSelectedRowIndex+1):n&&l&&(t=r.slice(this._maxSelectedRowIndex,s)),t&&e.shiftKey){let h=this.getMinMaxSelectionIndizes();t=t.reduce((p,m)=>{let g=r.indexOf(m);return u.isOneOf(g,h[0],h[1])&&p.push(m),p},[])}t&&t.forEach(h=>this.table.removeRowFromSelection(h,!0))}this._maxSelectedRowIndex=o?Math.min(this._maxSelectedRowIndex,s):n?Math.max(this._maxSelectedRowIndex,s):s,this._prevSelectedRowIndex=s}else this.select&&(this.table._removeSelection(),this.table.selectedRows=[]),this.fromIndex=this.toIndex;this._selectRange(this.fromIndex,this.toIndex,this.select)}_selectRange(e,t,r){let s=this.table.visibleRows,o=Math.min(e,t),n=Math.max(e,t)+1,l=s.slice(o,n);r?l.forEach(d=>this.table.addRowToSelection(d,!0)):l.forEach(d=>this.table.removeRowFromSelection(d,!0))}getMinMaxSelectionIndizes(){let e=this.table.selectedRows,t=this.table.visibleRows;if(!e||e.length===0)return[-1,-1];let r=-1,s=-1;return e.forEach(o=>{let n=t.indexOf(o);(r===-1||n<r)&&(r=n),(s===-1||n>s)&&(s=n)}),[r,s]}onMouseUp(e){!this._mouseDown||!this.table.rendered||(this._mouseDown=!1,this.table.$data.off("mouseover",this.mouseOverHandler),this.fromIndex=-1,this.toIndex=-1,this.select=!0,this.table.notifyRowSelectionFinished())}}function Ue(i,e,t){return e=Nx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Nx(i){var e=Vx(i,"string");return typeof e=="symbol"?e:String(e)}function Vx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class so extends I{constructor(){super(),Ue(this,"table",void 0),Ue(this,"tileAccordion",void 0),Ue(this,"tiles",void 0),Ue(this,"tileMappings",void 0),Ue(this,"tilesMap",void 0),Ue(this,"groupForTileMap",void 0),Ue(this,"tableState",void 0),Ue(this,"exclusiveExpand",void 0),Ue(this,"gridColumnCount",void 0),Ue(this,"tileGridLayoutConfig",void 0),Ue(this,"withPlaceholders",void 0),Ue(this,"_isUpdatingTiles",void 0),Ue(this,"_tableHierarchyFilter",void 0),Ue(this,"_destroyHandler",void 0),Ue(this,"_tileAccordionPropertyChangeHandler",void 0),Ue(this,"_tileAccordionActionHandler",void 0),Ue(this,"_tileAccordionClickHandler",void 0),Ue(this,"_tableFilterAddedHandler",void 0),Ue(this,"_tableFilterRemovedHandler",void 0),Ue(this,"_tableFilterHandler",void 0),Ue(this,"_tableGroupHandler",void 0),Ue(this,"_tableRowsSelectedHandler",void 0),Ue(this,"_tableRowsInsertedHandler",void 0),Ue(this,"_tableRowsDeletedHandler",void 0),Ue(this,"_tableAllRowsDeletedHandler",void 0),Ue(this,"_tableRowOrderChangedHandler",void 0),Ue(this,"_tablePropertyChangeHandler",void 0),this.table=null,this.tileAccordion=null,this.tiles=[],this.tileMappings=[],this.tilesMap={},this.groupForTileMap={},this.tableState={},this._tileAccordionPropertyChangeHandler=this._onTileAccordionPropertyChange.bind(this),this._tileAccordionActionHandler=this._onTileAccordionAction.bind(this),this._tileAccordionClickHandler=this._onTileAccordionClick.bind(this),this._tableFilterAddedHandler=this._onTableFilterAdded.bind(this),this._tableFilterRemovedHandler=this._onTableFilterRemoved.bind(this),this._tableFilterHandler=this._onTableFilter.bind(this),this._tableGroupHandler=this._onTableGroup.bind(this),this._tableRowsSelectedHandler=this._onTableRowsSelected.bind(this),this._tableRowsInsertedHandler=this._onTableRowsInserted.bind(this),this._tableRowsDeletedHandler=this._onTableRowsDeleted.bind(this),this._tableAllRowsDeletedHandler=this._onTableAllRowsDeleted.bind(this),this._tableRowOrderChangedHandler=this._onTableRowOrderChangedHandler.bind(this),this._tablePropertyChangeHandler=this._onTablePropertyChange.bind(this),this._destroyHandler=this._uninstallListeners.bind(this),this.exclusiveExpand=!1,this.gridColumnCount=null,this.tileGridLayoutConfig=null,this.withPlaceholders=null,this._addWidgetProperties(["tileAccordion","tiles","tileMappings"])}init(e){super._init(e),this.table=this.parent,this.tileAccordion||(this.tileAccordion=this._createTileAccordion(),this._installListeners()),this.tableState.headerVisible=this.table.headerVisible,this._setTiles(this.tiles),this._setTileMappings(this.tileMappings)}_installListeners(){this.tileAccordion.on("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.on("tileAction",this._tileAccordionActionHandler),this.tileAccordion.on("tileClick",this._tileAccordionClickHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("group",this._tableGroupHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler),this.table.on("rowsDeleted",this._tableRowsDeletedHandler),this.table.on("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.on("rowOrderChanged",this._tableRowOrderChangedHandler),this.table.on("propertyChange",this._tablePropertyChangeHandler),this.tileAccordion.on("destroy",this._destroyHandler),this.table.on("destroy",this._destroyHandler)}_uninstallListeners(){this.tileAccordion.off("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.off("tileAction",this._tileAccordionActionHandler),this.tileAccordion.off("tileClick",this._tileAccordionClickHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("group",this._tableGroupHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),this.table.off("rowsDeleted",this._tableRowsDeletedHandler),this.table.off("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.off("rowOrderChanged",this._tableRowOrderChangedHandler),this.table.off("propertyChange",this._tablePropertyChangeHandler),this.tileAccordion.off("destroy",this._destroyHandler),this.table.off("destroy",this._destroyHandler)}setGridColumnCount(e){this.setProperty("gridColumnCount",e),this.tileAccordion&&this.tileAccordion.setGridColumnCount(e)}setTileGridLayoutConfig(e){this.setProperty("tileGridLayoutConfig",e),this.tileAccordion&&this.tileAccordion.setTileGridLayoutConfig(e)}setWithPlaceholders(e){this.setProperty("withPlaceholders",e),this.tileAccordion&&this.tileAccordion.setWithPlaceholders(e)}_setTileMappings(e){if(this._setProperty("tileMappings",e),!e)return;let t=e.map(this.resolveMapping,this);this._setTiles(t)}setTiles(e){this.setProperty("tiles",e)}_setTiles(e){this._isUpdatingTiles=!0,f.removeAll(this.tiles,e),this.reset(),this._setTilesInternal(e),this._isUpdatingTiles=!1}_setTilesInternal(e){if(e.some(r=>this.table.rowsMap[r.rowId]===void 0)){this.table.initialized?this.table.one("rowsInserted",this._setTilesInternal.bind(this,e)):this.table.one("init",this._setTilesInternal.bind(this,e));return}this._refreshTilesMap(e),this._initGroups(e),this._setProperty("tiles",e),this.tileAccordion.setTiles(this.tiles),this._updateGroupVisibility(),this._syncSelectionFromTableToTile()}loadTiles(){let e=this.table.rows.filter(r=>!r.parentRow),t=this.table.createTiles(e);t&&this.setTiles(t)}resolveMapping(e){let t=e.tile;return t.rowId=e.tableRow,t.setParent(this),t.setOwner(this),t}_refreshTilesMap(e){e||(e=this.tiles,this.tilesMap={}),e.forEach(t=>{this.tilesMap[t.rowId]=t})}getTilesForRows(e){return e.map(t=>this.tilesMap[t.id]).filter(t=>!!t)}_initGroups(e){let t=f.find(this.table.columns,r=>r.grouped&&r.sortIndex===0);e.forEach(r=>{let s=this.table.rowsMap[r.rowId],o=t?t.cellTextForGrouping(s):"default";o=u.nvl(o,""),this.groupForTileMap[s.id]=o;let n=this.tileAccordion.getGroupById(o);n||(n=this._createTileGroup(o,t,s),this._adaptTileGrid(n.body),this.tileAccordion.insertGroup(n)),r.parent=n})}_adaptTileGrid(e){v.mandatoryFunction(e,"_showContextMenu");let t=e._showContextMenu;e._showContextMenu=r=>{v.mandatoryFunction(this.table,"_filterMenusForContextMenu"),r.menuItems=this.table._filterMenusForContextMenu(),u.assertProperty(this.table,"_filterMenusHandler"),r.menuFilter=this.table._filterMenusHandler,t.call(e,r)},e.keyStrokeContext.$bindTarget=this.table.keyStrokeContext.$bindTarget}_createTileAccordion(){return u.create(Wp,{parent:this.table,virtual:!0,selectable:!0,multiSelect:this.table.multiSelect,exclusiveExpand:this.exclusiveExpand,gridColumnCount:this.gridColumnCount,tileGridLayoutConfig:this.tileGridLayoutConfig,withPlaceholders:this.withPlaceholders})}_createTileGroup(e,t,r){let s,o,n;if(t){s=t.htmlEnabled;let l=t.createAggrGroupCell(r);o=l.text,n=l.iconId}return u.create(Si,{parent:this.tileAccordion,id:e,headerVisible:e!=="default",title:o,titleHtmlEnabled:s,iconId:n,body:{objectType:_o,scrollable:!1}})}activate(){this.tableState.headerVisible=this.table.headerVisible,this.table.setHeaderVisible(!1),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!0),this.table.tableControls.forEach(t=>{t instanceof Wr&&(this.tableState.aggregateTableControlSelected=t.selected,t.setSelected(!1,{closeWhenUnselected:!0,animate:!1}),t.setVisible(!1))}),this.tableState.loadingSupportContainer=this.table.loadingSupport.options$Container,this.table.loadingSupport.options$Container=function(){return this.tileAccordion.$container}.bind(this),f.find(this.table.rows,t=>!!t.parentRow)!==null&&(this._tableHierarchyFilter=u.create(lc,{table:this.table}),this.table.addFilter(this._tableHierarchyFilter)),this._syncFiltersFromTableToTile(),this._syncScrollTopFromTableToTile()}deactivate(){this.table.tableControls.forEach(e=>{e instanceof Wr&&e.setVisible(!0)}),this.table._setProperty("headerVisible",this.tableState.headerVisible),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!1),this.tableState.loadingSupportContainer&&(this.table.loadingSupport.options$Container=this.tableState.loadingSupportContainer),this._tableHierarchyFilter&&(this.table.removeFilter(this._tableHierarchyFilter),this._tableHierarchyFilter=null),this._syncScrollTopFromTileGridToTable(),this.reset()}reset(){this.tilesMap={},this.groupForTileMap={},this.tileAccordion.deleteAllTiles(),this.tileAccordion.deleteAllGroups(),this.tiles.forEach(e=>e.destroy())}renderTileMode(){this.table.tileMode?(this.table.$data&&this.table._removeData(),this._renderTileTableHeader(),this._renderTileAccordion()):(this._removeTileTableHeader(),this._removeTileAccordion(),this.table._renderData(),this.table._renderTableHeader(),this.tableState.aggregateTableControlSelected&&f.find(this.table.tableControls,e=>e instanceof Wr).setSelected(!0)),this.table._refreshMenuBarPosition()}destroy(){this.tiles.forEach(e=>e.destroy()),this.tileAccordion.destroy(),this.tileAccordion=null}insertTiles(e){e=f.ensure(e),e.length!==0&&this.setTiles(this.tiles.concat(e))}deleteTiles(e){e||(e=this.tiles.slice()),f.removeAll(this.tiles,e),e.forEach(t=>{delete this.tilesMap[t.rowId],delete this.groupForTileMap[t.rowId];let r=this.tileAccordion.getGroupByTile(t);r&&r.body.tiles.length===1&&this.tileAccordion.deleteGroup(r),t.destroy()}),this.tileAccordion.deleteTiles(e)}_onTileAccordionPropertyChange(e){!this.table.tileMode||(e.propertyName==="selectedTiles"?(this._syncSelectionFromTileGridToTable(e.source.getSelectedTiles()),this.tileAccordion.rendered&&this.tileAccordion.$container.document(!0).getSelection().removeAllRanges()):e.propertyName==="filteredTiles"&&this._updateGroupVisibility())}_onTileAccordionAction(e){!this.table.tileMode||this.table.doRowAction(this.table.rowsMap[e.tile.rowId])}_onTileAccordionClick(e){!this.table.tileMode||this.table._triggerRowClick(e.originalEvent,this.table.rowsMap[e.tile.rowId],e.mouseButton)}_onTableRowsSelected(e){!this.table.tileMode||this._syncSelectionFromTableToTile()}_onTableRowsInserted(e){!this.table.tileMode||this.insertTiles(this.table.createTiles(e.rows))}_onTableRowsDeleted(e){!this.table.tileMode||this.deleteTiles(this.getTilesForRows(e.rows))}_onTableAllRowsDeleted(e){!this.table.tileMode||this.deleteTiles()}_onTableRowOrderChangedHandler(e){!this.table.tileMode||a().isEmptyObject(this.tilesMap)||(this.tiles=this.table.rows.map(t=>this.tilesMap[t.id]),this.tileAccordion.setTiles(this.tiles))}_onTableGroup(e){!this.table.tileMode||(this.tileAccordion.deleteAllGroups(),this._initGroups(this.tiles),this.tileAccordion.setTiles(this.tiles))}_onTableFilterAdded(e){!this.table.tileMode||this._addFilter(e.filter)}_onTableFilterRemoved(e){!this.table.tileMode||this.tileAccordion.removeFilter(e.filter.tileFilter)}_addFilter(e){let t={table:this.table,accept:r=>{let s=this.table.rowsMap[r.rowId];return s?e.accept(s):!1}};e.tileFilter&&this.tileAccordion.removeFilter(e.tileFilter,!1),e.tileFilter=t,this.tileAccordion.addFilter(t)}_onTableFilter(e){!this.table.tileMode||this.tileAccordion.filter()}_syncSelectionFromTableToTile(){this.tileAccordion&&this.tileAccordion.selectTiles(this.getTilesForRows(this.table.selectedRows))}_syncSelectionFromTileGridToTable(e){if(!this._isUpdatingTiles){let t=e.map(r=>this.table.rowsMap[r.rowId]).filter(r=>Boolean(r));this.table.selectRows(t)}}_updateGroupVisibility(){this.tileAccordion.groups.forEach(e=>{let t=e.body,r=t.filters.length>0&&t.filteredTiles.length===0;e.setVisible(!r),e.setTitleSuffix(t.filteredTiles.length+"")})}_syncScrollTopFromTableToTile(){let e=this.table._rowIndexAtScrollTop(this.table.scrollTop);if(e<=0)return;let t=this.tilesMap[this.table.rows[e].id];if(!t)return;this.tileAccordion.scrollTop=null;let r={align:"top"};if(!t.rendered){this.table.session.layoutValidator.schedulePostValidateFunction(t.reveal.bind(t,r));return}t.reveal(r)}_syncScrollTopFromTileGridToTable(){let e=this.tileAccordion.tileAtScrollTop(this.tileAccordion.scrollTop);if(e){let t={align:"top"};this.table._isDataRendered()?this.table.scrollTo(this.table.rowsMap[e.rowId],t):this.table.session.layoutValidator.schedulePostValidateFunction(this.table.scrollTo.bind(this.table,this.table.rowsMap[e.rowId],t))}}_syncFiltersFromTableToTile(){this.tileAccordion&&(this.tileAccordion.setFilters([]),this.table.filters.forEach(e=>this._addFilter(e)))}_onTablePropertyChange(e){e.propertyName==="multiSelect"&&this.tileAccordion.setMultiSelect(e.newValue)}_renderTileTableHeader(){this.table.tileTableHeader&&this.table.tileTableHeader.render()}_removeTileTableHeader(){this.table.tileTableHeader&&this.table.tileTableHeader.remove()}_renderTileAccordion(){this.tileAccordion.rendered||this.tileAccordion.render()}_removeTileAccordion(){this.tileAccordion.rendered&&this.tileAccordion.remove()}}class Pu extends He{static modifyTableTileGridMediator(){!ie.get().remote||(v.replacePrototypeFunction(so,"loadTiles",function(){if(!this.modelAdapter)return this.loadTilesOrig()},!0),v.replacePrototypeFunction(so,"_onTableRowsInserted",function(e){if(!this.modelAdapter)return this._onTableRowsInsertedOrig(e)},!0),v.replacePrototypeFunction(so,"_onTableRowsDeleted",function(e){if(!this.modelAdapter)return this._onTableRowsDeletedOrig(e)},!0),v.replacePrototypeFunction(so,"_onTableAllRowsDeleted",function(e){if(!this.modelAdapter)return this._onTableAllRowsDeletedOrig(e)},!0))}}ie.addListener("bootstrap",Pu.modifyTableTileGridMediator);function ul(i,e,t){return e=Wx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Wx(i){var e=Kx(i,"string");return typeof e=="symbol"?e:String(e)}function Kx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ma extends I{constructor(){super(),ul(this,"table",void 0),ul(this,"page",void 0),ul(this,"row",void 0),ul(this,"_tableRowsUpdatedHandler",void 0),ul(this,"_tableRowsInsertedHandler",void 0),this.table=null,this.page=null,this.row=null,this._tableRowsUpdatedHandler=this._onTableRowsUpdated.bind(this),this._tableRowsInsertedHandler=this._onTableRowsInserted.bind(this)}_init(e){super._init(e),this.row=this.page.row,this.table.on("rowsUpdated",this._tableRowsUpdatedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler)}_destroy(){this.table.off("rowsUpdated",this._tableRowsUpdatedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),super._destroy()}_render(){this.$container=this.$parent.appendDiv("table-row-detail"),this.htmlComp=S.install(this.$container,this.session),this._renderRow()}_renderRow(){this.table.visibleColumns().forEach(this._renderCell.bind(this)),this.invalidateLayoutTree()}_renderCell(e){let t=this.table.cell(e,this.row);if(y.empty(t.text)&&!t.iconId)return;let r;e.headerHtmlEnabled?r=y.plainText(e.text):r=e.text,y.empty(r)&&(e.headerTooltipHtmlEnabled?r=y.plainText(e.headerTooltipText):r=e.headerTooltipText);let s=e.cellTextForRowDetail(this.row),o=this.$container.appendDiv("table-row-detail-field");y.empty(r)||o.appendSpan("table-row-detail-name").text(r+": ");let n=t.iconId,l=!y.empty(s);n&&o.appendIcon(n,"table-row-detail-icon").toggleClass("with-text",l),l&&o.appendSpan("table-row-detail-value").html(s)}_refreshRow(){this.$container.empty(),this._renderRow()}_onTableRowsUpdated(e){if(!this.rendered)return;let t=e.rows,r=f.find(t,s=>s.id===this.row.id);!r||(this.row=r,this._refreshRow())}_onTableRowsInserted(e){!this.rendered||e.source.rows.indexOf(this.page.row)<0||(this.row=this.page.row,this._refreshRow())}}function dg(i,e,t){return e=zx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zx(i){var e=Gx(i,"string");return typeof e=="symbol"?e:String(e)}function Gx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hg extends I{constructor(){super(),dg(this,"tableRow",void 0),dg(this,"tile",void 0),this.tableRow=null,this.tile=null,this._addWidgetProperties(["tile"])}}class ug extends He{}function xu(i,e,t){return e=Ux(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ux(i){var e=qx(i,"string");return typeof e=="symbol"?e:String(e)}function qx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fu extends lr{constructor(){super(...arguments),xu(this,"table",void 0),xu(this,"row",void 0),xu(this,"_rowOrderChangedFunc",void 0)}_init(e){super._init(e),this.table=e.table}_render(){super._render(),this._rowOrderChangedFunc=e=>{e.animating?e.row===this.row&&this.position():this.position()},this.table.on("rowOrderChanged",this._rowOrderChangedFunc)}_remove(){super._remove(),this.table.off("rowOrderChanged",this._rowOrderChangedFunc)}}function Eu(i,e,t){return e=Yx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Yx(i){var e=jx(i,"string");return typeof e=="symbol"?e:String(e)}function jx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Au{constructor(e){Eu(this,"promises",void 0),Eu(this,"table",void 0),Eu(this,"_rowMap",void 0),this._rowMap={},this.promises=[],this.table=e}pushPromise(e){this.promises.push(e),this.table._renderViewportBlocked=!0,this.table.setLoading(!0);let t=function(){f.remove(this.promises,e),this.promises.length===0&&this.process()}.bind(this);e.then(t,t)}isBuffering(){return this.promises.length>0}buffer(e){e=f.ensure(e),e.forEach(t=>{this._rowMap[t.id]=t})}process(){if(this.table.destroyed)return;let e=v.values(this._rowMap);this.table.updateRows(e),this._rowMap={},this.table.setLoading(!1),this.table._renderViewportBlocked=!1,this.table._isDataRendered()&&this.table._renderViewport()}}function Xx(i,e,t){return e=Jx(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Jx(i){var e=Qx(i,"string");return typeof e=="symbol"?e:String(e)}function Qx(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Du extends Ko{constructor(){super(),Xx(this,"table",void 0),this.table=null}_init(e){super._init(e)}_data(){let e=[];return e.push([null,this.session.text("NoGrouping"),"BOLD"]),this.table.visibleColumns().forEach(t=>{this.table.isGroupingPossible(t)&&e.push([t,u.nvl(t.text,t.headerTooltipText)])}),e}_dataToLookupRow(e){return u.create(jr,{key:e[0],text:e[1],font:e[2]})}}function Zx(i,e,t){return e=eF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function eF(i){var e=tF(i,"string");return typeof e=="symbol"?e:String(e)}function tF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Mu extends Ko{constructor(){super(),Zx(this,"table",void 0),this.table=null}_data(){let e=[];return this.table.visibleColumns().forEach(t=>{t.isSortingPossible()&&(e.push([{column:t,asc:!0},u.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.ascending")+")",ve.LONG_ARROW_UP_BOLD]),e.push([{column:t,asc:!1},u.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.descending")+")",ve.LONG_ARROW_DOWN_BOLD]))}),e}_dataToLookupRow(e){return u.create(jr,{key:e[0],text:e[1],iconId:e[2]})}}const gt={TEXT:{collator:null,installed:!1,install(i){return this.installed?!!this.collator:(F.get().supportsInternationalization()?(this.collator=new window.Intl.Collator(i.locale.languageTag),a().log.isInfoEnabled()&&a().log.info("(comparators.TEXT#install) Browser supports i18n - installed Intl.Collator, can sort in Browser")):a().log.isInfoEnabled()&&a().log.info("(comparators.TEXT#install) Browser doesn't support i18n. Must sort on server"),this.installed=!0,!!this.collator)},compare(i,e){return!i&&!e?0:i?e?this.collator?this.collator.compare(i,e):i<e?-1:i>e?1:0:1:-1},compareIgnoreCase(i,e){return i||(i=null),e||(e=null),i===e?0:i===null?-1:e===null?1:this.compare(i.toLowerCase(),e.toLowerCase())}},NUMERIC:{install(i){return!0},compare(i,e){return v.isNullOrUndefined(i)&&v.isNullOrUndefined(e)?0:v.isNullOrUndefined(i)?-1:v.isNullOrUndefined(e)?1:i<e?-1:i>e?1:0}},ALPHANUMERIC:{collator:null,installed:!1,install(i){return gt.TEXT.install(i),this.collator=gt.TEXT.collator,!!this.collator&&gt.NUMERIC.install(i)},compare(i,e){return this._compare(i,e,!1)},compareIgnoreCase(i,e){return this._compare(i,e,!0)},_compare(i,e,t){if(!i&&!e)return 0;if(!i)return-1;if(!e)return 1;let r="(([0-9]+)|([^0-9]+))",s=new RegExp(r,"g"),o=new RegExp(r,"g"),n=s.exec(i+""),l=o.exec(e+"");for(;n&&l;){let d=parseInt(n[1],0),h=parseInt(l[1],0);if(!isNaN(d)&&!isNaN(h)){let p=gt.NUMERIC.compare(d,h);if(p!==0)return p}else{let p=t?gt.TEXT.compareIgnoreCase(n[1],l[1]):gt.TEXT.compare(n[1],l[1]);if(p!==0)return p}n=s.exec(i+""),l=o.exec(e+"")}return!n&&!l?0:n?1:-1}},compare(i){let e=0;for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return r.some(o=>{if(o.length!==2)throw new Error("The pair must have exactly 2 elements");return e=i(o[0],o[1]),e!==0}),e}};function V(i,e,t){return e=iF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iF(i){var e=rF(i,"string");return typeof e=="symbol"?e:String(e)}function rF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Me extends Il{constructor(){super(),V(this,"objectType",void 0),V(this,"id",void 0),V(this,"autoOptimizeWidth",void 0),V(this,"autoOptimizeWidthRequired",void 0),V(this,"session",void 0),V(this,"autoOptimizeMaxWidth",void 0),V(this,"cssClass",void 0),V(this,"compacted",void 0),V(this,"editable",void 0),V(this,"removable",void 0),V(this,"modifiable",void 0),V(this,"fixedWidth",void 0),V(this,"fixedPosition",void 0),V(this,"grouped",void 0),V(this,"headerCssClass",void 0),V(this,"headerIconId",void 0),V(this,"headerHtmlEnabled",void 0),V(this,"headerTooltipText",void 0),V(this,"headerBackgroundColor",void 0),V(this,"headerForegroundColor",void 0),V(this,"headerFont",void 0),V(this,"headerTooltipHtmlEnabled",void 0),V(this,"horizontalAlignment",void 0),V(this,"htmlEnabled",void 0),V(this,"initialAlwaysIncludeSortAtBegin",void 0),V(this,"initialAlwaysIncludeSortAtEnd",void 0),V(this,"index",void 0),V(this,"initialized",void 0),V(this,"guiOnly",void 0),V(this,"mandatory",void 0),V(this,"optimalWidthMeasurer",void 0),V(this,"sortActive",void 0),V(this,"checkable",void 0),V(this,"sortAscending",void 0),V(this,"sortIndex",void 0),V(this,"summary",void 0),V(this,"type",void 0),V(this,"width",void 0),V(this,"initialWidth",void 0),V(this,"minWidth",void 0),V(this,"showSeparator",void 0),V(this,"table",void 0),V(this,"tableNodeColumn",void 0),V(this,"maxLength",void 0),V(this,"text",void 0),V(this,"textWrap",void 0),V(this,"filterType",void 0),V(this,"comparator",void 0),V(this,"displayable",void 0),V(this,"visible",void 0),V(this,"textBased",void 0),V(this,"headerMenuEnabled",void 0),V(this,"tableNodeLevel0CellPadding",void 0),V(this,"expandableIconLevel0CellPadding",void 0),V(this,"nodeColumnCandidate",void 0),V(this,"$header",void 0),V(this,"$separator",void 0),V(this,"_realWidth",void 0),V(this,"_tableColumnsChangedHandler",void 0),this.autoOptimizeWidth=!1,this.autoOptimizeWidthRequired=!1,this.autoOptimizeMaxWidth=-1,this.compacted=!1,this.removable=!1,this.cssClass=null,this.editable=!1,this.modifiable=!1,this.fixedWidth=!1,this.fixedPosition=!1,this.grouped=!1,this.headerCssClass=null,this.headerIconId=null,this.headerHtmlEnabled=!1,this.headerTooltipText=null,this.headerTooltipHtmlEnabled=!1,this.horizontalAlignment=-1,this.htmlEnabled=!1,this.index=-1,this.initialized=!1,this.mandatory=!1,this.optimalWidthMeasurer=new $u(this),this.sortActive=!1,this.sortAscending=!0,this.sortIndex=-1,this.summary=!1,this.type="text",this.width=60,this.initialWidth=void 0,this.minWidth=Me.DEFAULT_MIN_WIDTH,this.showSeparator=!0,this.table=null,this.tableNodeColumn=!1,this.maxLength=4e3,this.text=null,this.textWrap=!1,this.filterType="TextColumnUserFilter",this.comparator=gt.TEXT,this.displayable=!0,this.visible=!0,this.textBased=!0,this.headerMenuEnabled=!0,this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13,this.nodeColumnCandidate=!0,this._tableColumnsChangedHandler=this._onTableColumnsChanged.bind(this),this._realWidth=null,this.$header=null,this.$separator=null}init(e){this.session=e.session,a().extend(this,e),this.initialWidth===void 0&&(this.initialWidth=u.nvl(this.width,0)),this._init(e),this.initialized=!0}_init(e){Ce.resolveTextProperty(this,"text"),Ce.resolveTextProperty(this,"headerTooltipText"),ve.resolveIconProperty(this,"headerIconId"),this._setTable(this.table),this._setDisplayable(this.displayable),this._setAutoOptimizeWidth(this.autoOptimizeWidth)}destroy(){this._destroy(),this._setTable(null)}_destroy(){}_setTable(e){this.table&&this.table.off("columnMoved columnStructureChanged",this._tableColumnsChangedHandler),this.table=e,this.table&&this.table.on("columnMoved columnStructureChanged",this._tableColumnsChangedHandler)}initCell(e,t){let r=this._ensureCell(e);return this._initCell(r),v.isNullOrUndefined(r.text)&&this._updateCellText(t,r),r}_ensureCell(e){let t;if(e instanceof Pt)t=e,t.value=this._parseValue(t.value);else{let r=Pt;t=u.create(r,{value:this._parseValue(e)})}return t}_parseValue(e){return e}_updateCellText(e,t){let r=t.value;if(!e)return;let s=this._formatValue(r,e);v.isPromise(s)?this.setCellTextDeferred(s,e,t):this.setCellText(e,s,t)}_formatValue(e,t){return u.nvl(e,"")}_initCell(e){return e.cssClass=u.nvl(e.cssClass,this.cssClass),e.editable=u.nvl(e.editable,this.editable),e.horizontalAlignment=u.nvl(e.horizontalAlignment,this.horizontalAlignment),e.htmlEnabled=u.nvl(e.htmlEnabled,this.htmlEnabled),e.mandatory=u.nvl(e.mandatory,this.mandatory),e}buildCellForRow(e){let t=this.cell(e);return this.buildCell(t,e)}buildCellForAggregateRow(e){let t;if(this.grouped){let r=this.table.groupingStyle===W.GroupingStyle.TOP?e.nextRow:e.prevRow;t=this.createAggrGroupCell(r)}else{let r=e.contents[this.table.columns.indexOf(this)];t=this.createAggrValueCell(r)}return this.buildCell(t,{})}buildCell(e,t){u.assertParameter("cell",e,Pt);let r=this.table.isTableNodeColumn(this),s=0;r&&(s=this.table._calcRowLevelPadding(t));let o=this._text(e),n=this._icon(e.iconId,!!o)||"",l=this._cellCssClass(e,r),d=this._cellStyle(e,r,s);e.errorStatus&&(t.hasError=!0);let h;return!o&&!n?(h="&nbsp;",l=y.join(" ",l,"empty")):e.flowsLeft?h=o+n:h=n+o,r&&t.expandable&&(this.tableNodeColumn=!0,h=this._expandIcon(t.expanded,s)+h,t.expanded&&(l+=" expanded")),this._buildCell(e,h,d,l)}_buildCell(e,t,r,s){return'<div class="'+s+'" style="'+r+'">'+t+"</div>"}_expandIcon(e,t){let r="padding-left: "+(t+this.expandableIconLevel0CellPadding)+"px",s="table-row-control";return e&&(s+=" expanded"),'<div class="'+s+'" style="'+r+'"></div>'}_icon(e,t){let r,s;if(!!e)return r="table-cell-icon",t&&(r+=" with-text"),s=ve.parseIconId(e),s.isFontIcon()?(r+=" font-icon",'<span class="'+s.appendCssClass(r)+'">'+s.iconCharacter+"</span>"):(r+=" image-icon",'<img class="'+r+'" src="'+s.iconUrl+'">')}_text(e){let t=e.text||"";return e.htmlEnabled||(t=e.encodedText()||"",this.table.multilineText&&(t=y.nl2br(t,!1)),t&&(t='<span class="text">'+t+"</span>")),t}_cellCssClass(e,t){let r="table-cell";e.mandatory&&(r+=" mandatory"),(!this.table.multilineText||!this.textWrap)&&(r+=" white-space-nowrap"),e.editable&&(r+=" editable"),e.errorStatus&&(r+=" has-error"),e.iconId&&!e.text&&(r+=" icon-only"),r+=" halign-"+W.parseHorizontalAlignment(e.horizontalAlignment);let s=this.table.visibleColumns(),o=s.indexOf(this);return o===0&&(r+=" first"),o===s.length-1&&(r+=" last"),t&&(r+=" table-node"),e.cssClass&&(r+=" "+e.cssClass),r}_cellStyle(e,t,r){let s,o=this.width;return o===0?"display: none;":(s="min-width: "+o+"px; max-width: "+o+"px; ",t&&(s+=" padding-left: "+(this.tableNodeLevel0CellPadding+r)+"px; "),s+=L.legacyStyle(e),s)}onMouseUp(e,t){let r=t.data("row"),s=this.cell(r);this.isCellEditable(r,s,e)&&this.table.prepareCellEdit(this,r,!0)}isCellEditable(e,t,r){return this.table.enabledComputed&&e.enabled&&t.editable&&!r.ctrlKey&&!r.shiftKey}startCellEdit(e,t){let r=e.$row,s=this.cell(e),o=this.table.$cell(this,r);s.field=t,s.field.gridData.horizontalAlignment=s.horizontalAlignment;let n=this._createEditorPopup(e,s);return n.$anchor=o,n.open(this.table.$data),n}_createEditorPopup(e,t){let r=Vu;return u.create(r,{parent:this.table,column:this,row:e,cell:t})}cell(e){return this.table.cell(this,e)}headerCell(){let e=Pt;return u.create(e,{value:this.text,text:this.text,iconId:this.headerIconId,cssClass:this.headerCssClass,tooltipText:this.headerTooltipText,htmlEnabled:this.headerHtmlEnabled})}selectedCell(){let e=this.table.selectedRow();return this.table.cell(this,e)}cellValueOrText(e){return this.textBased?this.table.cellText(this,e):this.table.cellValue(this,e)}cellValue(e){return this.table.cellValue(this,e)}cellText(e){return this.table.cellText(this,e)}cellValueOrTextForCalculation(e){let t=this.cell(e),r=this.cellValueOrText(e);return v.isNullOrUndefined(r)?null:this._preprocessValueOrTextForCalculation(r,t)}_preprocessValueOrTextForCalculation(e,t){return typeof e=="string"?this._preprocessTextForCalculation(e,t==null?void 0:t.htmlEnabled):e}_preprocessTextForCalculation(e,t){return this._preprocessText(e,{removeHtmlTags:t,removeNewlines:!0,trim:!0})}cellTextForGrouping(e){let t=this.cell(e);return this._preprocessTextForGrouping(t.text,t.htmlEnabled)}_preprocessTextForGrouping(e,t){return this._preprocessText(e,{removeHtmlTags:t,trim:!0})}cellTextForTextFilter(e){let t=this.cell(e);return this._preprocessTextForTextFilter(t.text,t.htmlEnabled)}_preprocessTextForTextFilter(e,t){return this._preprocessText(e,{removeHtmlTags:t})}cellTextForRowDetail(e){let t=this.cell(e);return this._preprocessText(this._text(t),{removeHtmlTags:t.htmlEnabled})}_preprocessText(e,t){return e==null||(t=t||{},t.removeHtmlTags&&(e=y.plainText(e)),t.removeNewlines&&(e=e.replace(`
`," ")),t.trim&&(e=e.trim())),e}setCellValue(e,t){let r=this.cell(e);this._setCellValue(e,t,r),this._updateCellText(e,r)}_setCellValue(e,t,r){t=this._parseValue(t),r.value!==t&&e.status===Qt.Status.NON_CHANGED&&(e.status=Qt.Status.UPDATED),r.setValue(t)}setCellTextDeferred(e,t,r){e.done(s=>this.setCellText(t,s,r)).fail(s=>{this.setCellText(t,"",r),a().log.error("Could not resolve cell text for value "+r.value,s)}),this.table.updateBuffer.pushPromise(e)}setCellText(e,t,r){r||(r=this.cell(e)),r.text!==t&&(r.setText(t),e.initialized&&this.table&&this.table.updateRow(e))}setCellErrorStatus(e,t,r){r||(r=this.cell(e)),r.setErrorStatus(t)}setCellIconId(e,t){let r=this.cell(e);r.iconId!==t&&(r.setIconId(t),e.initialized&&this.table.updateRow(e))}setHorizontalAlignment(e){!this.setProperty("horizontalAlignment",e)||(this.table.rows.forEach(r=>this.cell(r).setHorizontalAlignment(e)),this.table.updateRows(this.table.rows),this.table.header&&this.table.header.updateHeader(this))}setEditable(e){!this.setProperty("editable",e)||(this.table.rows.forEach(r=>this.cell(r).setEditable(e)),this.table.updateRows(this.table.rows))}setMandatory(e){!this.setProperty("mandatory",e)||(this.table.rows.forEach(r=>this.cell(r).setMandatory(e)),this.table.updateRows(this.table.rows))}setCssClass(e){!this.setProperty("cssClass",e)||(this.table.rows.forEach(r=>this.cell(r).setCssClass(e)),this.table.updateRows(this.table.rows))}setWidth(e){!this.setProperty("width",e)||this.table.resizeColumn(this,e)}createAggrGroupCell(e){let t=this.cell(e),r=Pt;return this.initCell(u.create(r,{value:t.value,text:this.cellTextForGrouping(e),iconId:t.iconId,horizontalAlignment:this.horizontalAlignment,htmlEnabled:!1,cssClass:"table-aggregate-cell"+(t.cssClass?" "+t.cssClass:""),backgroundColor:"inherit",flowsLeft:this.horizontalAlignment>0}))}createAggrValueCell(e){return this.createAggrEmptyCell()}createAggrEmptyCell(){let e=Pt;return this.initCell(u.create(e,{empty:!0,cssClass:"table-aggregate-cell"}))}calculateOptimalWidth(){return this.optimalWidthMeasurer.measure()}createFilter(){return u.create(this.filterType,{session:this.session,table:this.table,column:this})}createTableHeaderMenu(e){let t=this.$header;return u.create(Ci,{parent:e,column:t.data("column"),tableHeader:e,$anchor:t})}createEditor(e){let t=this._createEditor(e),r=this.cell(e);this._initEditorField(t,r),t.setLabelVisible(!1),t.setFieldStyle(M.FieldStyle.CLASSIC);let s=new ze(t.gridDataHints);return s.horizontalAlignment=r.horizontalAlignment,t.setGridDataHints(s),t}_initEditorField(e,t){t.errorStatus?this._updateEditorFromInvalidCell(e,t):this._updateEditorFromValidCell(e,t)}_updateEditorFromValidCell(e,t){e.setValue(t.value)}_updateEditorFromInvalidCell(e,t){e.setErrorStatus(t.errorStatus),e.setDisplayText(t.text)}_createEditor(e){return u.create(Wi,{parent:this.table,maxLength:this.maxLength,multilineText:this.table.multilineText,wrapText:this.textWrap})}updateCellFromEditor(e,t){t.errorStatus?this._updateCellFromInvalidEditor(e,t):this._updateCellFromValidEditor(e,t)}_updateCellFromInvalidEditor(e,t){this.setCellErrorStatus(e,t.errorStatus),this.setCellText(e,t.displayText)}_updateCellFromValidEditor(e,t){this.setCellErrorStatus(e,null),this.setCellValue(e,t.value)}installComparator(){return this.comparator.install(this.session)}isSortingPossible(){return this.installComparator(),!0}compare(e,t){let r=this.table.cell(this,e),s=this.table.cell(this,t);if(r.sortCode!==null||s.sortCode!==null)return gt.NUMERIC.compare(r.sortCode,s.sortCode);let o=this.cellValueOrText(e),n=this.cellValueOrText(t);return this.comparator.compare(o,n)}isVisible(){return this.displayable&&this.visible&&!this.compacted}setVisible(e,t){this.visible!==e&&this._setVisible(e,t)}_setVisible(e,t){this._setProperty("visible",e),u.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}setDisplayable(e,t){this.displayable!==e&&this._setDisplayable(e,t)}_setDisplayable(e,t){this._setProperty("displayable",e),u.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}setCompacted(e,t){this.compacted!==e&&this._setCompacted(e,t)}_setCompacted(e,t){this._setProperty("compacted",e),u.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}setAutoOptimizeWidth(e){this.setProperty("autoOptimizeWidth",e)}_setAutoOptimizeWidth(e){this._setProperty("autoOptimizeWidth",e),this.autoOptimizeWidthRequired=e,this.initialized&&(this.table.columnLayoutDirty=!0,this.table.invalidateLayoutTree())}setMaxLength(e){this.setProperty("maxLength",e)}setText(e){this.setProperty("text",e)&&this.table.header&&this.table.header.updateHeader(this)}setHeaderIconId(e){this.setProperty("headerIconId",e)&&this.table.header&&this.table.header.updateHeader(this)}setHeaderCssClass(e){let t=a().extend({},this);this.setProperty("headerCssClass",e)&&this.table.header&&this.table.header.updateHeader(this,t)}setHeaderHtmlEnabled(e){this.setProperty("headerHtmlEnabled",e)&&this.table.header&&this.table.header.updateHeader(this)}setHeaderTooltipText(e){this.setProperty("headerTooltipText",e)}setHeaderTooltipHtmlEnabled(e){this.setProperty("headerTooltipHtmlEnabled",e)}setTextWrap(e){this.setProperty("textWrap",e)&&this.table.rendered&&this.table.multilineText&&(this.autoOptimizeWidthRequired=!0,this.table.redraw())}isContentValid(e){let t=this.cell(e),r=!t.errorStatus||t.errorStatus.severity!==E.Severity.ERROR,s=!t.mandatory||this._hasCellValue(t);return{valid:r&&s,validByErrorStatus:r,validByMandatory:s}}_hasCellValue(e){return!!e.value}_onTableColumnsChanged(e){this.table.visibleColumns().indexOf(this)===0?(this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13):(this.tableNodeLevel0CellPadding=23,this.expandableIconLevel0CellPadding=8)}realWidthIfAvailable(){return this._realWidth||this.width}}V(Me,"DEFAULT_MIN_WIDTH",60),V(Me,"SMALL_MIN_WIDTH",38),V(Me,"NARROW_MIN_WIDTH",34);function Ss(i,e,t){return e=sF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sF(i){var e=oF(i,"string");return typeof e=="symbol"?e:String(e)}function oF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class $u{constructor(e){Ss(this,"column",void 0),Ss(this,"table",void 0),Ss(this,"deferred",void 0),Ss(this,"imageCount",void 0),Ss(this,"completeImageCount",void 0),Ss(this,"$measurement",void 0),Ss(this,"_imageLoadOrErrorHandler",void 0),Ss(this,"_columnCellContents",void 0),this.column=e,this.table=null,this.$measurement=null,this.deferred=null,this.imageCount=0,this.completeImageCount=0,this._imageLoadOrErrorHandler=this._onImageLoadOrError.bind(this),this._columnCellContents={}}measure(){if(a().log.isDebugEnabled()&&a().log.debug("Optimal width measuring started for column "+this.column.id),this.table=this.column.table,this.$measurement&&(a().log.isDebugEnabled()&&a().log.debug("Optimal width measuring aborted for column "+this.column.id),this._resolve(-1)),this.$measurement=this.table.$data.makeDiv("hidden"),this.imageCount=0,this.completeImageCount=0,this._appendElements(),this.table.$data.append(this.$measurement),this.completeImageCount>=this.imageCount){let e=this._measure();return a().log.isDebugEnabled()&&a().log.debug("Optimal width measuring done (sync) for column "+this.column.id+": "+e),this.remove(),e}return a().log.isDebugEnabled()&&a().log.debug("Not all images loaded, deferring measurement for column "+this.column.id+". Images complete: "+this.completeImageCount+"/"+this.imageCount),this.$measurement[0].addEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].addEventListener("error",this._imageLoadOrErrorHandler,!0),this.deferred=a().Deferred(),this.deferred.promise()}remove(){!this.$measurement||(this.$measurement[0].removeEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].removeEventListener("error",this._imageLoadOrErrorHandler,!0),this.$measurement.remove(),this.$measurement=null)}_measure(){let e=this.column.minWidth,t=0;return this.$measurement.addClass("invisible").removeClass("hidden").children().each(function(){this.dataset.overlap&&(t=Math.max(t,parseInt(this.dataset.overlap,10))),e=Math.max(e,w.size(a()(this),!0).width)}),e+t}_resolve(e){this.remove(),this.deferred&&(this.deferred.resolve(e),this.deferred=null)}_appendElements(){this._appendHeader(),this._appendRows(),this._appendAggregateRows()}_appendHeader(){this.column.$header&&this._appendToMeasurement(this.column.$header.clone())}_appendRows(){this.table.rows.forEach(this._appendRow.bind(this)),this._columnCellContents={}}_appendRow(e){let t=this.column.buildCellForRow(e);this._columnCellContents[t]||(this._columnCellContents[t]=!0,this._appendToMeasurement(a()(t)))}_appendAggregateRows(){this.table._aggregateRows.forEach(this._appendAggregateRow.bind(this))}_appendAggregateRow(e){this._appendToMeasurement(this._build$CellForAggregateRow(e))}_build$CellForAggregateRow(e){let t=this.table.visibleColumns(),r=t.indexOf(this.column),s=this.table._build$AggregateRow(e);s.appendTo(this.table.$data),t.map(l=>l.buildCellForAggregateRow(e)).forEach(l=>a()(l).appendTo(s));let o=s.children().eq(r),n=this._getAggregateOverlap(o);return n>0&&(o[0].dataset.overlap=n+""),s.detach(),o}_getAggregateOverlap(e){if(!e||!e.length||e.hasClass("empty"))return 0;let t=this.table._getAggrCellRange(e);if(t.length<2)return 0;let r=t[t.length-1];if(r.hasClass("empty")||e.hasClass("halign-right")===r.hasClass("halign-right"))return 0;let s=r.children(".text");if(!s||!s.length)return 0;let o=w.size(s).width-r.cssMaxWidth()+r.cssPaddingLeft();if(o<=0)return 0;for(let n=t.length-1;n>0;n--){let l=t[n];l.hasClass("empty")&&(o-=l.cssMaxWidth())}return Math.max(0,o)}_appendToMeasurement(e){e.find("img").each((r,s)=>{let o=a()(s);o.data("measure","in-progress"),s.complete&&(o.data("complete",s.complete),this.completeImageCount++),this.imageCount++}),e.css({minWidth:"",maxWidth:""}).appendTo(this.$measurement)}_onImageLoadOrError(e){if(!a()(e.target).data("complete")&&(this.completeImageCount++,a().log.isTraceEnabled()&&a().log.trace("Images complete (async) "+this.completeImageCount+"/"+this.imageCount,e.target.src),this.completeImageCount>=this.imageCount)){let r=this._measure();a().log.isDebugEnabled()&&a().log.debug("Optimal width measuring done (async) for column "+this.column.id+": "+r),this._resolve(r)}}}class cg extends Me{constructor(){super(),this.comparator=gt.ALPHANUMERIC}}class pg extends Me{buildCellForRow(e){let t=this.cell(e),r=this._cellCssClass(t),s=this._cellStyle(t),o=a()(super._buildCell(t,"",s,r)),n=this.table.cellValue(this,e);return t.errorStatus&&(e.hasError=!0),this._renderValue(o,n),o[0].outerHTML}_renderValue(e,t){}_plainTextForRow(e){let t=this.table.cell(this,e);if(!t.plainText){let r=this.buildCellForRow(e);t.plainText=y.plainText(r)}return t.plainText}cellValueOrTextForCalculation(e){let t=this._plainTextForRow(e);return this._preprocessTextForCalculation(t)}cellTextForGrouping(e){let t=this._plainTextForRow(e);return this._preprocessTextForGrouping(t)}cellTextForTextFilter(e){let t=this._plainTextForRow(e);return this._preprocessTextForTextFilter(t)}compare(e,t){let r=this._plainTextForRow(e),s=this._plainTextForRow(t);return this.comparator.compareIgnoreCase(r,s)}}function nF(i,e,t){return e=lF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lF(i){var e=aF(i,"string");return typeof e=="symbol"?e:String(e)}function aF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class oo extends Me{constructor(){super(),nF(this,"triStateEnabled",void 0),this.comparator=gt.NUMERIC,this.filterType="ColumnUserFilter",this.horizontalAlignment=0,this.minWidth=Me.SMALL_MIN_WIDTH,this.triStateEnabled=!1,this.textBased=!1}_formatValue(e,t){return this.triStateEnabled&&e===null?"?":e?"X":""}buildCell(e,t){let r="",s=t.enabled,o=this.table.isTableNodeColumn(this),n=0;if(o&&(n=this.table._calcRowLevelPadding(t)),e.empty)return super.buildCell(e,t);s=s&&e.editable;let l=this._cellCssClass(e,o),d=this._cellStyle(e,o,n);s||(l+=" disabled");let h="check-box";return e.value===!0&&(h+=" checked"),this.triStateEnabled&&e.value!==!0&&e.value!==!1&&(h+=" undefined"),s||(h+=" disabled"),o&&t.expandable&&(this.tableNodeColumn=!0,r=this._expandIcon(t.expanded,n)+r,t.expanded&&(l+=" expanded")),r=r+'<div class="'+h+'"></div>',this._buildCell(e,r,d,l)}$checkBox(e){return this.table.$cell(this,e).children(".check-box")}_cellCssClass(e,t){let r=super._cellCssClass(e);return r=r.replace(" editable",""),r+=" checkable",t&&(r+=" table-node"),r}onMouseUp(e,t){let r=t.data("row"),s=this.cell(r);this.table.checkableColumn===this?this.table.checkRow(r,!r.checked):this.isCellEditable(r,s,e)&&this._toggleCellValue(r,s)}_toggleCellValue(e,t){let r=t.value;this.triStateEnabled?r===!1?this.setCellValue(e,!0):r===!0?this.setCellValue(e,null):r===null&&this.setCellValue(e,!1):this.setCellValue(e,!r)}_createEditor(e){return u.create(Fs,{parent:this.table,triStateEnabled:this.triStateEnabled})}cellTextForGrouping(e){let t=this.cell(e);return this.triStateEnabled&&t.value===null?this.session.text("ui.BooleanColumnGroupingMixed"):t.value===!0?this.session.text("ui.BooleanColumnGroupingTrue"):this.session.text("ui.BooleanColumnGroupingFalse")}setTriStateEnabled(e){this.triStateEnabled!==e&&(this.triStateEnabled=e,this.table.rows.forEach(t=>this._updateCellText(t,this.cell(t))))}}class Ru extends Me{constructor(){super(),this.cssClass="compact-cell",this.htmlEnabled=!0,this.width=120,this.textWrap=!0}_onMoreLinkAction(e,t){let s=this.table.$cell(this,e).find(".compact-cell-more-content"),o=!s.isVisible();s.setVisible(o),t.setVisible(!o),this.table.invalidateLayoutTree()}onMouseUp(e,t){let r=$(e.target),s=$(e.delegateTarget),o=r.findUp(n=>n.hasClass("more-link"),s);o.length>0&&this._onMoreLinkAction(t,o)}}function es(i,e,t){return e=dF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dF(i){var e=hF(i,"string");return typeof e=="symbol"?e:String(e)}function hF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Lu{constructor(){es(this,"title",void 0),es(this,"titleLine",void 0),es(this,"titleSuffix",void 0),es(this,"titleSuffixLine",void 0),es(this,"subtitle",void 0),es(this,"subtitleLine",void 0),es(this,"contentLines",void 0),es(this,"content",void 0),es(this,"moreContent",void 0),this.title="",this.titleSuffix="",this.subtitle="",this.content="",this.moreContent="",this.contentLines=[]}setTitle(e){this.title=u.nvl(e,"")}setTitleLine(e){this.titleLine=e}setTitleSuffix(e){this.titleSuffix=u.nvl(e,"")}setTitleSuffixLine(e){this.titleSuffixLine=e}setSubtitle(e){this.subtitle=u.nvl(e,"")}setSubtitleLine(e){this.subtitleLine=e}addContentLine(e){this.contentLines.push(e)}setContent(e){this.content=u.nvl(e,"")}setMoreContent(e){this.moreContent=u.nvl(e,"")}transform(e){let t=u.nvl(e.removeEmptyContentLines,!0),r=u.nvl(e.maxContentLines,1e3);this.titleLine&&this.setTitle(this.titleLine.build()),this.titleSuffixLine&&this.setTitleSuffix(this.titleSuffixLine.build()),this.subtitleLine&&this.setSubtitle(this.subtitleLine.build());let s=[];t&&(s=this.contentLines.filter(l=>!!l.build())),r+1===s.length&&r++;let o=Math.min(s.length,r),n=y.join(`
`,...s.slice(0,o).map(l=>l.build()));if(n&&this.setContent(n),o<s.length){let l=y.join(`
`,...s.slice(o,s.length).map(d=>d.build()));this.setMoreContent(l)}}}function fg(i,e,t){return e=uF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function uF(i){var e=cF(i,"string");return typeof e=="symbol"?e:String(e)}function cF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Iu{constructor(e,t){fg(this,"labelBlock",void 0),fg(this,"textBlock",void 0),this.labelBlock=null,this.textBlock=null,e instanceof Pt?this.setLabelBlock(this.convertHeaderCellToBlock(e)):this.setLabelBlock(new cl(e)),t instanceof Pt?this.setTextBlock(this.convertCellToBlock(t)):this.setTextBlock(new cl(t))}convertHeaderCellToBlock(e){return this.convertCellToBlock(e)}convertCellToBlock(e){let t=new cl;return e!=null&&(t.setText(e.text),t.setIcon(e.iconId),t.setEncodeHtmlEnabled(!e.htmlEnabled)),t}setLabelBlock(e){u.assertParameter("block",e),this.labelBlock=e}setTextBlock(e){u.assertParameter("block",e),this.textBlock=e}build(){let e=this.labelBlock.build();e&&(e+=": ");let t=this.textBlock.build();return t?`
<div class="compact-cell-line">
  <span class="compact-cell-line-label">`.concat(e,`</span>
  <span class="compact-cell-line-value">`).concat(t,`</span>
</div>`):""}}function an(i,e,t){return e=pF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pF(i){var e=fF(i,"string");return typeof e=="symbol"?e:String(e)}function fF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class cl{constructor(e,t){an(this,"text",void 0),an(this,"icon",void 0),an(this,"encodeHtmlEnabled",void 0),an(this,"nlToBrEnabled",void 0),an(this,"htmlToPlainTextEnabled",void 0),an(this,"_processedText",void 0),this.text="",this.icon="",this._processedText=null,this.encodeHtmlEnabled=!0,this.nlToBrEnabled=!1,this.htmlToPlainTextEnabled=!1,this.setText(e),this.setIcon(t)}setText(e){this.text=u.nvl(e,"")}processedText(){return this._processedText==null&&(this._processedText=this.processText()),this._processedText}setIcon(e){this.icon=u.nvl(e,"")}setEncodeHtmlEnabled(e){this.encodeHtmlEnabled!==e&&(this._processedText=null),this.encodeHtmlEnabled=e}setNlToBrEnabled(e){this.nlToBrEnabled!==e&&(this._processedText=null),this.nlToBrEnabled=e}setHtmlToPlainTextEnabled(e){this.htmlToPlainTextEnabled!==e&&(this._processedText=null),this.htmlToPlainTextEnabled=e}processText(){let e=this.text;return this.htmlToPlainTextEnabled?(this.nlToBrEnabled&&(e=y.nl2br(e,!1)),e=y.plainText(e)):this.encodeHtmlEnabled&&(e=y.encode(e)),this.nlToBrEnabled&&(e=y.nl2br(e,!1)),e}build(){return this.icon?$("<div>").appendIcon(this.icon).addClass(this.processedText()?" with-text":"").parent()[0].innerHTML+this.processedText():this.processedText()}}function $a(i,e,t){return e=mF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function mF(i){var e=gF(i,"string");return typeof e=="symbol"?e:String(e)}function gF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ku extends Me{constructor(){super(),$a(this,"format",void 0),$a(this,"groupFormat",void 0),$a(this,"hasDate",void 0),$a(this,"hasTime",void 0),this.format=null,this.groupFormat="yyyy",this.hasDate=!0,this.hasTime=!1,this.filterType="DateColumnUserFilter",this.comparator=gt.NUMERIC,this.textBased=!1}_init(e){super._init(e),this._setFormat(this.format),this._setGroupFormat(this.groupFormat)}setFormat(e){this.setProperty("format",e)}_setFormat(e){e||(e=this._getDefaultFormat(this.session.locale));let t=Ft.ensure(this.session.locale,e);this._setProperty("format",t),this.initialized&&this.table.rows.forEach(r=>this._updateCellText(r,this.cell(r)))}setGroupFormat(e){this.setProperty("groupFormat",e)}_setGroupFormat(e){e||(e=this._getDefaultFormat(this.session.locale));let t=Ft.ensure(this.session.locale,e);this._setProperty("groupFormat",t),this.initialized&&this.table._group()}_formatValue(e,t){return this.format.format(e)}_parseValue(e){return T.ensure(e)}_getDefaultFormat(e){return this.hasDate&&this.hasTime?e.dateFormatPatternDefault+" "+e.timeFormatPatternDefault:this.hasDate?e.dateFormatPatternDefault:e.timeFormatPatternDefault}cellTextForGrouping(e){let t=this.table.cellValue(this,e);return this.groupFormat.format(t)}_createEditor(e){return u.create(Kt,{parent:this.table,hasDate:this.hasDate,hasTime:this.hasTime})}}class Ra extends Me{constructor(){super(),this.minWidth=Me.NARROW_MIN_WIDTH,this.filterType="ColumnUserFilter",this.textBased=!1}_initCell(e){return super._initCell(e),e.text=null,e.iconId=e.value||e.iconId,e}_formatValue(e,t){return null}setCellValue(e,t){super.setCellValue(e,t),this.setCellIconId(e,this.cell(e).value)}cellTextForGrouping(e){return this.table.cell(this,e).value}createAggrGroupCell(e){let t=super.createAggrGroupCell(e);return t.text=null,t}}function Bi(i,e,t){return e=_F(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _F(i){var e=bF(i,"string");return typeof e=="symbol"?e:String(e)}function bF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Oi extends Me{constructor(){super(),Bi(this,"aggregationFunction",void 0),Bi(this,"backgroundEffect",void 0),Bi(this,"decimalFormat",void 0),Bi(this,"minValue",void 0),Bi(this,"maxValue",void 0),Bi(this,"calcMinValue",void 0),Bi(this,"calcMaxValue",void 0),Bi(this,"allowedAggregationFunctions",void 0),Bi(this,"aggrStart",void 0),Bi(this,"aggrStep",void 0),Bi(this,"aggrFinish",void 0),Bi(this,"aggrSymbol",void 0),Bi(this,"backgroundEffectFunc",void 0),this.aggregationFunction="sum",this.backgroundEffect=null,this.decimalFormat=null,this.minValue=null,this.maxValue=null,this.calcMinValue=null,this.calcMaxValue=null,this.horizontalAlignment=1,this.filterType="NumberColumnUserFilter",this.comparator=gt.NUMERIC,this.textBased=!1,this.allowedAggregationFunctions=["sum","avg","min","max","none"]}_init(e){super._init(e),this._setDecimalFormat(this.decimalFormat),this._setAggregationFunction(this.aggregationFunction)}setDecimalFormat(e){this.setProperty("decimalFormat",e)}_setDecimalFormat(e){e||(e=this._getDefaultFormat(this.session.locale));let t=Ur.ensure(this.session.locale,e);this._setProperty("decimalFormat",t),this.initialized&&this.table.rows.forEach(r=>this._updateCellText(r,this.cell(r)))}_getDefaultFormat(e){return e.decimalFormatPatternDefault}_formatValue(e,t){return this.decimalFormat.format(e)}_parseValue(e){return Ge.ensure(e)}setAggregationFunction(e){this.setProperty("aggregationFunction",e)}_setAggregationFunction(e){if(this._setProperty("aggregationFunction",e),e==="sum")this.aggrStart=wt.sumStart,this.aggrStep=wt.sumStep,this.aggrFinish=wt.sumFinish,this.aggrSymbol=wt.sumSymbol;else if(e==="avg")this.aggrStart=wt.avgStart,this.aggrStep=wt.avgStep,this.aggrFinish=wt.avgFinish,this.aggrSymbol=wt.avgSymbol;else if(e==="min")this.aggrStart=wt.minStart,this.aggrStep=wt.minStep,this.aggrFinish=wt.minFinish,this.aggrSymbol=wt.minSymbol;else if(e==="max")this.aggrStart=wt.maxStart,this.aggrStep=wt.maxStep,this.aggrFinish=wt.maxFinish,this.aggrSymbol=wt.maxSymbol;else if(e==="none"){let t=()=>{};this.aggrStart=t,this.aggrStep=t,this.aggrFinish=t,this.aggrSymbol=void 0}}createAggrValueCell(e){let t=this._formatValue(e),r=Pt;return u.create(r,{text:t,iconId:t?this.aggrSymbol:null,horizontalAlignment:this.horizontalAlignment,cssClass:"table-aggregate-cell "+this.aggregationFunction,flowsLeft:this.horizontalAlignment>0})}_cellStyle(e,t,r){let s=super._cellStyle(e,t,r);if(!this.backgroundEffect||e.value===void 0||y.contains(e.cssClass,"table-aggregate-cell"))return s;this.backgroundEffectFunc||(this.backgroundEffectFunc=this._resolveBackgroundEffectFunc());let o=this.backgroundEffectFunc(this._preprocessValueOrTextForCalculation(e.value));return o.backgroundColor&&(s+="background-color: "+o.backgroundColor+";"),o.backgroundImage&&(s+="background-image: "+o.backgroundImage+";"),s}_preprocessValueOrTextForCalculation(e,t){return this.decimalFormat.round(e)}setBackgroundEffect(e){!this.setProperty("backgroundEffect",e)||(this.backgroundEffectFunc=this._resolveBackgroundEffectFunc(),this.table.trigger("columnBackgroundEffectChanged",{column:this}),this.backgroundEffect&&(this.calcMinValue===null||this.calcMaxValue===null)&&this.calculateMinMaxValues(),this.backgroundEffect||(this.calcMinValue=null,this.calcMaxValue=null),this.table.rendered&&this._renderBackgroundEffect())}updateBackgroundEffect(){this.calculateMinMaxValues(),this.table.rendered&&this._renderBackgroundEffect()}_resolveBackgroundEffectFunc(){let e=this.backgroundEffect;if(e==="colorGradient1")return this._colorGradient1.bind(this);if(e==="colorGradient2")return this._colorGradient2.bind(this);if(e==="barChart")return this._barChart.bind(this);if(e!==null)return a().log.warn("Unsupported backgroundEffect: "+e),()=>({})}_renderBackgroundEffect(){this.table.visibleRows.forEach(e=>{if(!e.$row)return;let t=this.cell(e),r=this.table.$cell(this,e.$row);t.value!==void 0&&(r[0].style.cssText=this._cellStyle(t))})}calculateMinMaxValues(){let e,t,r=this.table.rows;for(let s=0;s<r.length;s++){let o=r[s],n=this.cellValueOrTextForCalculation(o);(n<e||e===void 0)&&(e=n),(n>t||t===void 0)&&(t=n)}this.calcMinValue=u.nvl(e,null),this.calcMaxValue=u.nvl(t,null)}_colorGradient1(e){let t=L.get("column-background-effect-gradient1-start","backgroundColor"),r=L.get("column-background-effect-gradient1-end","backgroundColor"),s=L.rgb(t.backgroundColor),o=L.rgb(r.backgroundColor);return this._colorGradient(e,s,o)}_colorGradient2(e){let t=L.get("column-background-effect-gradient2-start","backgroundColor"),r=L.get("column-background-effect-gradient2-end","backgroundColor"),s=L.rgb(t.backgroundColor),o=L.rgb(r.backgroundColor);return this._colorGradient(e,s,o)}_colorGradient(e,t,r){let s=(e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue),o=Math.ceil(t.red-s*(t.red-r.red)),n=Math.ceil(t.green-s*(t.green-r.green)),l=Math.ceil(t.blue-s*(t.blue-r.blue));return{backgroundColor:"rgb("+o+","+n+", "+l+")"}}_barChart(e){let t=Math.ceil((e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue)*100)+"",r=L.get("column-background-effect-bar-chart","backgroundColor").backgroundColor;return{backgroundImage:"linear-gradient(to left, "+r+" 0%, "+r+" "+t+"%, transparent "+t+"%, transparent 100% )"}}_createEditor(e){return u.create(fo,{parent:this.table,maxValue:this.maxValue,minValue:this.minValue,decimalFormat:this.decimalFormat})}_hasCellValue(e){return!v.isNullOrUndefined(e.value)}}function Cs(i,e,t){return e=yF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yF(i){var e=vF(i,"string");return typeof e=="symbol"?e:String(e)}function vF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mg extends Me{constructor(){super(),Cs(this,"codeType",void 0),Cs(this,"lookupCall",void 0),Cs(this,"browseHierarchy",void 0),Cs(this,"browseMaxRowCount",void 0),Cs(this,"browseAutoExpandAll",void 0),Cs(this,"browseLoadIncremental",void 0),Cs(this,"activeFilterEnabled",void 0),Cs(this,"_lookupCallBatchContext",void 0),this.codeType=null,this.lookupCall=null,this.browseHierarchy=!1,this.browseMaxRowCount=ae.DEFAULT_BROWSE_MAX_COUNT,this.browseAutoExpandAll=!0,this.browseLoadIncremental=!1,this.activeFilterEnabled=!1,this._lookupCallBatchContext=null}_init(e){super._init(e),this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType)}_initCell(e){return super._initCell(e),e.sortCode=this._calculateCellSortCode(e),e}_calculateCellSortCode(e){if(!this.codeType)return null;let t=Tt.get(this.codeType,e.value);return t?t.sortCode:null}_updateAllCellSortCodes(){this.table.rows.map(e=>this.cell(e)).forEach(e=>e.setSortCode(this._calculateCellSortCode(e)))}setLookupCall(e){this.setProperty("lookupCall",e)}_setLookupCall(e){let t=ei.ensure(e,this.session);this._setProperty("lookupCall",t),this.initialized&&this._updateAllCellSortCodes()}setCodeType(e){this.setProperty("codeType",e)}_setCodeType(e){if(this._setProperty("codeType",e),e){let t=Yl;this.lookupCall=u.create(t,{session:this.session,codeType:e})}this.initialized&&this._updateAllCellSortCodes()}setBrowseHierarchy(e){this.setProperty("browseHierarchy",e)}setBrowseMaxRowCount(e){this.setProperty("browseMaxRowCount",e)}setBrowseAutoExpandAll(e){this.setProperty("browseAutoExpandAll",e)}setBrowseLoadIncremental(e){this.setProperty("browseLoadIncremental",e)}setActiveFilterEnabled(e){this.setProperty("activeFilterEnabled",e)}_formatValue(e,t){if(!this.lookupCall)return u.nvl(e,"");if(this.lookupCall.batch)return this._batchFormatValue(e);let r=this.lookupCall.clone();return this.trigger("prepareLookupCall",{lookupCall:r,row:t}),r.textByKey(e)}_batchFormatValue(e){if(v.isNullOrUndefined(e))return $.resolvedPromise("");let t=this._lookupCallBatchContext;if(!t){const r=$.Deferred();t={keySet:new Set,result:r.promise()},this._lookupCallBatchContext=t,setTimeout(()=>{this._lookupCallBatchContext=null;let s=this.lookupCall.clone();this.trigger("prepareLookupCall",{lookupCall:s}),s.textsByKeys([...t.keySet]).then(o=>r.resolve(o)).catch(o=>r.reject(o))})}return t.keySet.add(e),t.result.then(r=>r[v.ensureValidKey(e)]||"")}_updateEditorFromValidCell(e,t){if(v.isNullOrUndefined(t.value)){e.setValue(null);return}let r=new jr;r.key=t.value,r.text=t.text,e.setLookupRow(r)}_createEditor(e){let t=u.create(ae,{parent:this.table,codeType:this.codeType,lookupCall:this.lookupCall?this.lookupCall.clone():null,browseHierarchy:this.browseHierarchy,browseMaxRowCount:this.browseMaxRowCount,browseAutoExpandAll:this.browseAutoExpandAll,browseLoadIncremental:this.browseLoadIncremental,activeFilterEnabled:this.activeFilterEnabled});return t.on("prepareLookupCall",r=>{this.trigger("prepareLookupCall",{lookupCall:r.lookupCall,row:e})}),t.on("lookupCallDone",r=>{this.trigger("lookupCallDone",{result:r.result})}),t}_updateCellFromValidEditor(e,t){this.setCellErrorStatus(e,null);let r=this.cell(e),s=r.text,o=t.displayText;r.setText(o),this._setCellValue(e,t.value,r),e.initialized&&s!==o&&r.text===o&&this.table.updateRow(e),this._updateCellText(e,r)}_hasCellValue(e){let t=e.value;return v.isNumber(t)?!v.isNullOrUndefined(t):!!t}_setCellValue(e,t,r){super._setCellValue(e,t,r),r.setSortCode(this._calculateCellSortCode(r))}}class Bu extends Qs{constructor(e){super(e),this.renderingHints.offset=6}handle(e){this.field.toggle()}_postRenderKeyBox(e,t){if(this.field.iconId){let r=e.find(".icon").width(),s=e.find(".key-box").outerWidth(),o=e.cssPaddingLeft(),n=r/2-s/2+o;e.find(".key-box").cssLeft(n)}}}function ur(i,e,t){return e=wF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wF(i){var e=TF(i,"string");return typeof e=="symbol"?e:String(e)}function TF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yr extends oe{constructor(){super(),ur(this,"tableFooter",void 0),ur(this,"table",void 0),ur(this,"contentRendered",void 0),ur(this,"height",void 0),ur(this,"animateDuration",void 0),ur(this,"resizerVisible",void 0),ur(this,"denseClass",void 0),ur(this,"tableControlKeyStrokeContext",void 0),ur(this,"$contentContainer",void 0),this.tableFooter=null,this.contentRendered=!1,this.height=null,this.animateDuration=null,this.resizerVisible=!0,this.toggleAction=!0,this.showTooltipWhenSelected=!1}_init(e){this.parent=e.parent,this.table=this.getTable(),super._init(e),this.denseClass=this.session.desktop.dense?" dense":"",yr.CONTAINER_SIZE=L.getSize("table-control-container"+this.denseClass,"height","height",yr.CONTAINER_SIZE),this.height=yr.CONTAINER_SIZE,this.animateDuration=yr.CONTAINER_ANIMATE_DURATION,this._setSelected(this.selected)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.tableControlKeyStrokeContext=this._createKeyStrokeContextForTableControl()}_createKeyStrokeContextForTableControl(){let e=new Oe;return e.$scopeTarget=()=>this.tableFooter.$controlContent,e.$bindTarget=()=>this.tableFooter.$controlContent,e.registerKeyStroke(new qu(this)),e}_createLayout(){return new jo}_render(){let e="table-control ";this.cssClass&&(e+=this.cssClass+"-table-control"),this.$container=this.$parent.appendDiv(e).on("mousedown",this._onMouseDown.bind(this)).data("control",this),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}remove(){this.removeContent(),super.remove()}_renderContent(e){}_removeContent(){}removeContent(){this.contentRendered&&(this._removeContent(),this.cssClass&&(this.tableFooter.$controlContainer.removeClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.removeClass(this.cssClass+"-table-control-content")),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.tableControlKeyStrokeContext),this.contentRendered=!1)}renderContent(){!this.contentRendered&&!this.isContentAvailable()||!this.selected||(this.tableFooter.open||this.tableFooter.openControlContainer(this),this.contentRendered||(this.cssClass&&(this.tableFooter.$controlContainer.addClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.addClass(this.cssClass+"-table-control-content")),this.tableFooter.$controlContent.data("control",this),this._renderContent(this.tableFooter.$controlContent),this.session.keyStrokeManager.installKeyStrokeContext(this.tableControlKeyStrokeContext),this.htmlComp&&this.htmlComp.invalidateLayoutTree(!1),this.contentRendered=!0))}get$Scrollable(){return this.$contentContainer}_renderSelected(e,t){e=u.nvl(e,this.selected),t=$.extend({},{closeWhenUnselected:!0},t),this.$container.select(e),e?(this.tableFooter.onControlSelected(this),this.renderContent()):this.rendered&&(t.closeWhenUnselected&&this===this.tableFooter.selectedControl?(this.tableFooter.onControlSelected(null),this.tableFooter.closeControlContainer(this,t)):this.removeContent()),this._updateTooltip()}isContentAvailable(){return!0}toggle(){!this.enabledComputed||(this.tableFooter.selectedControl===this?this.setSelected(!1):this.setSelected(!0))}setSelected(e,t){e&&!this.visible||e!==this.selected&&(this.tableFooter&&this.tableFooter.selectedControl&&this.tableFooter.selectedControl!==this&&this.tableFooter.selectedControl.setSelected(!1,{closeWhenUnselected:!1}),this._setSelected(e),t=$.extend({},{closeWhenUnselected:!0},t),this.rendered?this._renderSelected(e,t):t.closeWhenUnselected&&this.tableFooter&&this===this.tableFooter.selectedControl&&!e&&this.tableFooter.onControlSelected(null))}_setSelected(e){this._setProperty("selected",e)}_configureTooltip(){let e=super._configureTooltip();return e.cssClass="table-control-tooltip",e}_onMouseDown(e){this.toggle()}onControlContainerOpened(){}onControlContainerClosed(){this.removeContent()}_createActionKeyStroke(){return new Bu(this)}getTable(){let e=this.parent;for(;e;){if(e instanceof W)return e;e=e.parent}return null}}ur(yr,"CONTAINER_SIZE",345),ur(yr,"CONTAINER_ANIMATE_DURATION",350);class La extends bs{_goOffline(){this.widget.isContentAvailable()||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}_goOnline(){this.widget.isContentAvailable()||this.widget.setEnabled(this._enabledBeforeOffline)}}function Ou(i,e,t){return e=SF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function SF(i){var e=CF(i,"string");return typeof e=="symbol"?e:String(e)}function CF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Co extends qr{constructor(){super(),Ou(this,"tableControl",void 0),Ou(this,"_tableControlPropertyChangeHandler",void 0),Ou(this,"_tableControlDestroyHandler",void 0),this.tableControl=null,this._tableControlPropertyChangeHandler=this._onTableControlPropertyChange.bind(this),this._tableControlDestroyHandler=this._onTableControlDestroy.bind(this),this._addCloneProperties(["tableControl"])}_init(e){if(super._init(e),!this.tableControl)throw new Error("Cannot adapt to undefined tableControl");this._installListeners()}_destroy(){this._uninstallListeners(),super._destroy()}_installListeners(){this.tableControl.on("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.on("destroy",this._tableControlDestroyHandler)}_uninstallListeners(){this.tableControl.off("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.off("destroy",this._tableControlDestroyHandler)}_render(){super._render(),this.$container.attr("data-tableControlAdapter",this.tableControl.id)}_onTableControlPropertyChange(e){let t={};t[e.propertyName]=e.newValue,t=Co.adaptTableControlProperties(t);for(let r in t)this.setProperty(r,t[r])}_onTableControlDestroy(e){this.destroy(),this._uninstallListeners()}doAction(){return this.tableControl.doAction()}setSelected(e){this.tableControl.setSelected(e)}static adaptTableControlProperties(e,t){t=t||{},["text","iconId","enabled","visible","selected","tooltipText","keyStroke","keyStrokes","modelClass","classId","form"].forEach(r=>{t[r]=e[r]});for(let r in t)t[r]===void 0&&delete t[r];return t}}function Ps(i,e,t){return e=PF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function PF(i){var e=xF(i,"string");return typeof e=="symbol"?e:String(e)}function xF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wr extends yr{constructor(){super(),Ps(this,"aggregateRow",void 0),Ps(this,"_tableDataScrollHandler",void 0),Ps(this,"_tableColumnResizedHandler",void 0),Ps(this,"_tableColumnMovedHandler",void 0),Ps(this,"_tableColumnStructureChangedHandler",void 0),Ps(this,"_tableChangedHandler",void 0),Ps(this,"_aggregationFunctionChangedHandler",void 0),this._tableDataScrollHandler=this._onTableDataScroll.bind(this),this._tableColumnResizedHandler=this._onTableColumnResized.bind(this),this._tableColumnMovedHandler=this._onTableColumnMoved.bind(this),this._tableColumnStructureChangedHandler=this._onTableColumnStructureChanged.bind(this),this._tableChangedHandler=this._onTableChanged.bind(this),this._aggregationFunctionChangedHandler=this._onAggregationFunctionChanged.bind(this),this.animateDuration=Wr.CONTAINER_ANIMATE_DURATION,this.aggregateRow=[],this.cssClass="aggregate",this.height=0,this.iconId=ve.SUM,this.tooltipText="${textKey:ui.Total}",this.resizerVisible=!1}_init(e){super._init(e),this.table.on("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.on("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}_destroy(){super._destroy(),this.table.off("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.off("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}_render(){super._render(),this._updateEnabledAndSelectedState(),this.height=this.table.rowHeight+w.insets(this.table.footer.$controlContainer).vertical()}_renderContent(e){this.$contentContainer=e.appendDiv("table-aggregate"),this._aggregate(),this._renderAggregate(),this._reconcileScrollPos(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler),this.table.on("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}_removeContent(){this.$contentContainer.remove(),this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this.table.off("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}_renderAggregate(){let e=[];this.table.visibleColumns().forEach((t,r)=>{let s,o,n;s=this.aggregateRow[r];let l=s==null||t.grouped;l?o=t.createAggrEmptyCell():o=t.createAggrValueCell(s),n=a()(t.buildCell(o,{})),l||e.push(n),this._installCellTooltip(n),this.aggregateRow.selection&&n.addClass("selection"),n.appendTo(this.$contentContainer)}),this.aggregateRow.selection&&this.$contentContainer.addClass("selection"),e.forEach(t=>this.table._resizeAggregateCell(t))}_rerenderAggregate(){this.$contentContainer.empty(),this._renderAggregate(),this._reconcileScrollPos()}_installCellTooltip(e){G.install(e,{parent:this,text:this.table._cellTooltipText.bind(this.table),htmlEnabled:!0,arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!F.get().isCustomEllipsisTooltipPossible()})}_aggregate(){let e,t=[],r=this.table.selectedRows;r.length>1?(e=r,t.selection=!0):e=this.table.filteredRows(),this.table._forEachVisibleColumn("aggrStart",t),e.forEach(s=>this.table._forEachVisibleColumn("aggrStep",t,s)),this.table._forEachVisibleColumn("aggrFinish",t),this.aggregateRow=t,this.contentRendered&&this.selected&&this._rerenderAggregate()}_reconcileScrollPos(){let e=this.table.$data.scrollLeft();this.$contentContainer.scrollLeft(e)}_updateEnabledAndSelectedState(e){if(!this.initialized)return;let t=this.table.containsAggregatedNumberColumn();t?e&&!this.table.isGrouped()&&this.setSelected(!0):this.selected&&this.setSelected(!1),this.setEnabled(t)}_setEnabled(e){super._setEnabled(e),this._updateEnabledAndSelectedState()}_setSelected(e){this._setProperty("selected",e),this._updateEnabledAndSelectedState()}_onTableDataScroll(){this._reconcileScrollPos()}_onTableChanged(){this._aggregate()}_onAggregationFunctionChanged(){this._updateEnabledAndSelectedState(!0),this.contentRendered&&this.selected&&this._aggregate()}_onTableColumnResized(){this._rerenderAggregate()}_onTableColumnMoved(e){f.move(this.aggregateRow,e.oldPos,e.newPos),this._rerenderAggregate()}_onTableColumnStructureChanged(){this._updateEnabledAndSelectedState(),this.contentRendered&&this.selected&&this._aggregate()}}Ps(Wr,"CONTAINER_ANIMATE_DURATION",200);class Hu extends La{static modifyAggregateTableControlPrototype(){!ie.get().remote||v.replacePrototypeFunction(Wr,"_onTableColumnStructureChanged",function(e){this.modelAdapter?this._updateEnabledAndSelectedState():this._onTableColumnStructureChangedOrig()},!0)}}ie.addListener("bootstrap",Hu.modifyAggregateTableControlPrototype);function gg(i,e,t){return e=FF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FF(i){var e=EF(i,"string");return typeof e=="symbol"?e:String(e)}function EF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _g extends yr{constructor(){super(),gg(this,"form",void 0),gg(this,"_formDestroyedHandler",void 0),this._addWidgetProperties("form"),this._formDestroyedHandler=this._onFormDestroyed.bind(this)}_init(e){super._init(e),this._setForm(this.form)}_createLayout(){return new Nu(this)}_renderContent(e){this.form.renderInitialFocusEnabled=!1,this.form.render(e);let t=this.form.rootGroupBox;t.controls[0]instanceof mn&&t.controls[0].$container.addClass("in-table-control"),this.form.$container.height(e.height()),this.form.$container.width(e.width()),this.form.htmlComp.validateRoot=!0,this.form.htmlComp.validateLayout()}_removeContent(){this.form&&this.form.remove()}_removeForm(){this.removeContent()}_renderForm(e){this.renderContent()}isContentAvailable(){return!!this.form}setForm(e){this.setProperty("form",e)}_setForm(e){this.form&&this.form.off("destroy",this._formDestroyedHandler),e&&(e.on("destroy",this._formDestroyedHandler),this._adaptForm(e)),this._setProperty("form",e)}_adaptForm(e){e.rootGroupBox.setMenuBarPosition(Fe.MenuBarPosition.BOTTOM),e.setDisplayHint(Y.DisplayHint.VIEW),e.setModal(!1),e.setAskIfNeedSave(!1),e.setClosable(!1)}onControlContainerOpened(){!this.form||!this.form.rendered||this.form.renderInitialFocus()}_onFormDestroyed(e){this._removeForm(),this._setForm(null)}}class bg extends La{}function AF(i,e,t){return e=DF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DF(i){var e=MF(i,"string");return typeof e=="symbol"?e:String(e)}function MF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Nu extends te{constructor(e){super(),AF(this,"control",void 0),this.control=e}layout(e){if(!this.control.contentRendered||!this.control.form)return;let t=this.control.form,r=t.htmlComp,s=w.size(this.control.tableFooter.$controlContent),o=s.subtract(r.margins());if(r.setSize(o),t.rootGroupBox.controls[0]instanceof mn){let l=t.rootGroupBox.controls[0].selectedTab,d=document.activeElement;l&&l.scrollable&&d&&l.$body.has(d)&&x.scrollTo(l.$body,a()(d))}}}function no(i,e,t){return e=$F(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $F(i){var e=RF(i,"string");return typeof e=="symbol"?e:String(e)}function RF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vu extends pe{constructor(){super(),no(this,"table",void 0),no(this,"column",void 0),no(this,"row",void 0),no(this,"cell",void 0),no(this,"_rowOrderChangedFunc",void 0),no(this,"_pendingCompleteCellEdit",void 0),no(this,"_keyStrokeHandler",void 0),this.table=null,this.column=null,this.row=null,this.cell=null,this._pendingCompleteCellEdit=null,this._keyStrokeHandler=this._onKeyStroke.bind(this)}_init(e){e.scrollType=e.scrollType||"position",super._init(e),this.table=e.column.table,this.link(this.cell.field)}_createLayout(){return new Ku(this)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new Gu(this),new Uu(this)])}_createCloseKeyStroke(){return new zu(this)}_open(e){this.render(e),this.position(),this.pack()}_getDefaultOpen$Parent(){return this.table.$data}_render(){super._render();let e="",t=this.table.visibleColumns(),r=t.indexOf(this.column);r===0?e="first":r===t.length-1&&(e="last"),this.$container.addClass("cell-editor-popup "+e).data("popup",this);let s=this.cell.field;s.mode=M.Mode.CELLEDITOR,s.render(),s.prepareForCellEdit({cssClass:e}),this.$anchor.css("visibility","hidden"),this._rowOrderChangedFunc=o=>{o.animating?o.row===this.row&&this.position():this.position()},this.table.on("rowOrderChanged",this._rowOrderChangedFunc),this.table.enabled&&this.table.$container.addClass("focused"),this.session.keyStrokeManager.on("keyStroke",this._keyStrokeHandler)}_alignWithSelection(){let e=this._rowSelectionBounds().y;e<0&&(this.$container.cssMarginTop(e),this.$container.addClass("overflow-top"))}_rowSelectionBounds(){let e=new re,t=getComputedStyle(this.row.$row[0],":after");return t&&(e=new re(a().pxToNumber(t.left),a().pxToNumber(t.top),a().pxToNumber(t.width),a().pxToNumber(t.height))),e}_postRender(){super._postRender();let e=this.cell.field;e.onCellEditorRendered&&e.onCellEditorRendered({openFieldPopup:this.table.openFieldPopupOnCellEdit,cellEditorPopup:this})}_remove(){super._remove(),this.session.keyStrokeManager.off("keyStroke",this._keyStrokeHandler),this.table.off("rowOrderChanged",this._rowOrderChangedFunc),this.table.rendered&&this.table.$container.removeClass("focused"),this.$anchor.css("visibility","")}position(e){let t=this.table.$data,r=this.row.$row,s=this.$anchor,o=t.cssPaddingLeft()+r.cssMarginLeft()+r.cssBorderLeftWidth();this._alignWithSelection();let n=w.bounds(s),l=w.bounds(r);this.setLocation(new Z(o+n.x,t.scrollTop()+l.y))}completeEdit(e){if(this._pendingCompleteCellEdit)return this._pendingCompleteCellEdit;let r=this.cell.field.acceptInput();return!r||!u.nvl(e,!0)?(this._pendingCompleteCellEdit=a().resolvedPromise(),this.table.completeCellEdit()):this._pendingCompleteCellEdit=r.then(()=>this.table.completeCellEdit()),this._pendingCompleteCellEdit.then(()=>{this._pendingCompleteCellEdit=a().resolvedPromise()}),this._pendingCompleteCellEdit}isCompleteCellEditRequested(){return!!this._pendingCompleteCellEdit}cancelEdit(){this.table.cancelCellEdit(),this.remove()}_onMouseDownOutside(e){let t=a()(e.target).closest(".table-row",this.table.$container[0]);this.completeEdit(),t.length>0&&!t.isAttached()&&this._propagateMouseDownToTableRow(e)}_propagateMouseDownToTableRow(e){let r=this.table.$container.document(!0).elementFromPoint(e.pageX,e.pageY),s=a()(r);s.closest(".table-row",this.table.$container[0]).length!==0&&lt.propagateEvent(s[0],e)}_onKeyStroke(e){!this._invokeCompleteEditBeforeKeyStroke(e)||this.completeEdit(!1)}_invokeCompleteEditBeforeKeyStroke(e){return!(!this.session.keyStrokeManager.invokeAcceptInputOnActiveValueField(e.keyStroke,e.keyStrokeContext)||this.$container.isOrHas(e.keyStrokeContext.$getScopeTarget()))}waitForCompleteCellEdit(){return this._pendingCompleteCellEdit?this._pendingCompleteCellEdit.promise():a().resolvedPromise()}}function Wu(i,e,t){return e=LF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LF(i){var e=IF(i,"string");return typeof e=="symbol"?e:String(e)}function IF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ku extends te{constructor(e){super(),Wu(this,"cellEditorPopup",void 0),Wu(this,"_field",void 0),Wu(this,"_htmlContainer",void 0),this.cellEditorPopup=e,this._field=e.cell.field,this._htmlContainer=e.htmlComp}layout(e){let t=this._field.htmlComp,r=this._htmlContainer.availableSize({exact:!0}).subtract(this._htmlContainer.insets()).subtract(t.margins());t.setSize(r)}preferredLayoutSize(e,t){let r=this.cellEditorPopup.row.$row,s=this.cellEditorPopup.$anchor,o=w.bounds(s,{exact:!0}),n=w.bounds(r,{exact:!0}),l=this.cellEditorPopup.$container.cssMarginLeft();l<0&&(o.width=o.width+-l);let d=this.cellEditorPopup._rowSelectionBounds().height;return d&&(this._htmlContainer.$comp.toggleClass("overflow-bottom",d>n.height&&this._htmlContainer.$comp.cssMarginTop()===0),n.height=d),new A(o.width,n.height)}}class zu extends B{constructor(e){super(),this.field=e,this.which=[_.ESC],this.stopPropagation=!0}handle(e){this.field.cancelEdit()}}class Gu extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER],this.stopPropagation=!0}handle(e){this.field.completeEdit()}}class Uu extends B{constructor(e){super(),this.field=e,this.which=[_.TAB],this.shift=void 0}_accept(e){return super._accept(e)&&!this.field.isCompleteCellEditRequested()}handle(e){let t=e.shiftKey,r=this.field.table,s=this.field.column,o=this.field.row;this.field.completeEdit().then(()=>{let n=r.nextEditableCellPos(s,o,t);n&&r.prepareCellEdit(n.column,n.row)})}}class Ir extends B{constructor(e){super(),this.repeatable=!0,this.field=e,this.shift=e.multiSelect?void 0:!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}_accept(e){if(!super._accept(e))return!1;if(!this.field.visibleRows.length)return this._applyPropagationFlags(e),!1;let r=this.field.$container.activeElement(),s=r[0].tagName.toLowerCase(),o=this.field.$container.data("filter-field");return(!o||r[0]!==o[0])&&(s==="textarea"||s==="input")&&(!e.originalEvent||e.originalEvent&&!e.originalEvent.smartFieldEvent)?!1:(this.field.$container.addClass("keyboard-navigation"),!0)}_viewportInfo(){let e=this.field,t={},r=e.visibleRows;if(r.length===0)return t;let s=w.offsetBounds(e.$data),o=w.insets(e.$data),n=e.$data.cssMarginTop();s=s.subtract(o),n<0&&(s.y-=Math.abs(n),s.height+=Math.abs(n));let l=this._findFirstRowInViewport(e,s),d=this._findLastRowInViewport(e,r.indexOf(l),s);return t.firstRow=l,t.lastRow=d,t}firstRowAfterSelection(){let e=this.field.$selectedRows();if(!e.length)return;let t=this.field.visibleRows,r=e.last().data("row"),s=this.field.filteredRows().indexOf(r);return t[s+1]}firstRowBeforeSelection(){let e=this.field.$selectedRows();if(!e.length)return;let t=this.field.visibleRows,r=e.first().data("row"),s=this.field.visibleRows.indexOf(r);return t[s-1]}_findLastSelectedRowBefore(e,t){let r=e.visibleRows;if(t===0)return r[t];let s=f.findFromReverse(r,t,(o,n)=>{let l=r[n-1];return l?!e.isRowSelected(l):!1});return s||(s=r[0]),s}_findLastSelectedRowAfter(e,t){let r=e.visibleRows;if(t===r.length-1)return r[t];let s=f.findFrom(r,t,(o,n)=>{let l=r[n+1];return l?!e.isRowSelected(l):!1});return s||(s=r[r.length-1]),s}_findFirstRowInViewport(e,t){let r=e.visibleRows;return f.find(r,(s,o)=>{let n=s.$row;if(!n)return!1;let l=n.offset(),d=s.$row.cssMarginTop();return d<0&&(l.top+=Math.abs(d)),t.contains(l.left,l.top)})}_findLastRowInViewport(e,t,r){let s=e.visibleRows;return t===s.length-1?s[t]:f.findFromForward(s,t,(o,n)=>{let l=s[n+1];if(!l)return!0;let d=l.$row;if(!d)return!0;let h=w.offsetBounds(d);return!r.contains(h.x,h.y+h.height-1)})}_isEnabled(){return!this.field.tileMode&&super._isEnabled()}}class qu extends B{constructor(e){super(),this.field=e,this.which=[_.ESC],this.stopPropagation=!0,this.renderingHints.render=!1}handle(e){this.field.toggle()}}class Yu extends B{constructor(e){super(),this.field=e,this.which=[_.C],this.ctrl=!0,this.renderingHints.render=!1,this.inheritAccessibility=!1}handle(e){this.field.exportToClipboard()}}class ju extends Ir{constructor(e){super(e),this.which=[_.SUBTRACT,_.LEFT],this.renderingHints.text="-",this.renderingHints.$drawingArea=(t,r)=>{let s=this.field.selectedRows[0];if(s)return s.$row}}_accept(e){if(!super._accept(e))return!1;let r=this.field.selectedRows[0];return r?r.expanded&&r.expandable?!0:!!r.parentRow:!1}handle(e){let t=this.field.selectedRows[0];if(!t)return;let r=this.field,s=!1;t.expanded&&t.expandable?(r.collapseRow(t),s=!0):t.parentRow&&(r.selectRow(t.parentRow),r.selectionHandler.lastActionRow=t.parentRow,s=!0),s&&!r.isFocused()&&r.focus()}}class Xu extends Ir{constructor(e){super(e),this.which=[_.ADD,_.RIGHT],this.renderingHints.text="+",this.renderingHints.$drawingArea=(t,r)=>{let s=this.field.selectedRows[0];if(s)return s.$row}}_accept(e){if(!super._accept(e))return!1;let r=this.field.selectedRows[0];return r?r.expandable:!1}handle(e){let t=this.field,r=t.selectedRows[0];if(!!r&&r.expandable){if(r.expanded){let s=t.visibleChildRows(r);t.selectRow(s[0]),t.selectionHandler.lastActionRow=s[0]}else t.expandRow(r);t.isFocused()||t.focus()}}}class Ju extends B{constructor(e){super(),this.field=e,this.ctrl=!0,this.which=[_.A],this.renderingHints.offset=14,this.renderingHints.$drawingArea=(t,r)=>this.field.footer?this.field.footer._$infoSelection.find(".table-info-button"):null,this.inheritAccessibility=!1}handle(e){let t=this.field;t.toggleSelection(),t.selectionHandler.lastActionRow=null}}class Qu extends B{constructor(e){super(),this.field=e,this.ctrl=!0,this.which=[_.ENTER],this.stopPropagation=!0,this.renderingHints.$drawingArea=(t,r)=>{let s=r._editPosition,o=this.field.visibleColumns().indexOf(s.column);return o===0?s.row.$row:this.field.$cell(o,s.row.$row)}}_accept(e){if(!super._accept(e)||this.field.cellEditorPopup)return!1;let r=this.field.selectedRows;if(!r.length)return!1;let s=this.field.nextEditableCellPosForRow(0,r[0]);return s?(e._editPosition=s,!0):!1}handle(e){let t=e._editPosition;this.field.prepareCellEdit(t.column,t.row,!0)}}class Zu extends B{constructor(e){super(),this.field=e,this.which=[_.F5],this.renderingHints.offset=14,this.renderingHints.$drawingArea=(t,r)=>this.field.footer?this.field.footer._$infoLoad.find(".table-info-button"):null}_accept(e){return super._accept(e)&&this.field.hasReloadHandler}handle(e){this.field.reload()}}class ec extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE],this.stopPropagation=!0,this.renderingHints.render=!1}_accept(e){return super._accept(e)&&this.field.checkable&&this.field.selectedRows.length>0}handle(e){let t=this.field.selectedRows.filter(s=>s.enabled),r=t.some(s=>!s.checked);t.forEach(s=>this.field.checkRow(s,r))}}class tc extends Ir{constructor(e){super(e),this.which=[_.UP],this.renderingHints.text="↑",this.renderingHints.$drawingArea=(t,r)=>{let s=this.firstRowBeforeSelection();if(s)return s.$row}}handle(e){let t=this.field,r=t.visibleRows,s=t.selectedRows,o=t.selectionHandler.lastActionRow,n=-1,l=-1,d,h;if(o&&(n=r.indexOf(o)),r.length>1&&(s.length>0||n>-1)){if(n<0&&(r.length===s.length?o=f.last(r):o=f.first(s),n=r.indexOf(o)),n===0)return;if(l=n-1,h=r[l],d=[h],e.shiftKey)if(t.isRowSelected(h)){d=[],f.pushAll(d,s);let p=t.selectionHandler.getMinMaxSelectionIndizes();u.isOneOf(n,p[0],p[1])&&f.remove(d,o)}else d=f.union(d,s),h=this._findLastSelectedRowBefore(t,l)}else d=[f.last(r)],h=d[0];t.selectionHandler.lastActionRow=h,t.selectRows(d,!0),t.scrollTo(h),t.isFocused()||t.focus()}}class ic extends Ir{constructor(e){super(e),this.which=[_.DOWN],this.renderingHints.text="↓",this.renderingHints.$drawingArea=(t,r)=>{let s=this.firstRowAfterSelection();if(s)return s.$row}}handle(e){let t=this.field,r=t.visibleRows,s=t.selectedRows,o=t.selectionHandler.lastActionRow,n=-1,l=-1,d,h;if(o&&(n=r.indexOf(o)),r.length>1&&(s.length>0||n>-1)){if(n<0&&(r.length===s.length?o=f.first(r):o=f.last(s),n=r.indexOf(o)),n===r.length-1)return;if(l=n+1,d=r[l],h=[d],e.shiftKey)if(t.isRowSelected(d)){h=[],f.pushAll(h,s);let p=t.selectionHandler.getMinMaxSelectionIndizes();u.isOneOf(n,p[0],p[1])&&f.remove(h,o)}else h=f.union(s,h),d=this._findLastSelectedRowAfter(t,l)}else h=[f.first(r)],d=h[0];t.selectionHandler.lastActionRow=d,t.selectRows(h,!0),t.scrollTo(d),t.isFocused()||t.focus()}}class rc extends Ir{constructor(e){super(e),this.which=[_.HOME],this.renderingHints.text="Home",this.renderingHints.$drawingArea=(t,r)=>{let s=this._viewportInfo();if(s.firstRow)return s.firstRow.$row}}handle(e){let t=this.field,r=t.visibleRows,s=f.first(r),o=t.selectedRows,n=[],l=t.selectionHandler.lastActionRow,d=-1;e.shiftKey&&o.length>0?(l&&(d=r.indexOf(l)),d<0&&(l=f.first(o),d=r.indexOf(l)),n=r.slice(0,d),n=f.union(n,o)):n=[s],t.selectionHandler.lastActionRow=s,t.selectRows(n),t.scrollTo(s),t.isFocused()||t.focus()}}class sc extends Ir{constructor(e){super(e),this.which=[_.END],this.renderingHints.text="End",this.renderingHints.$drawingArea=(t,r)=>{let s=this._viewportInfo();if(s.lastRow)return s.lastRow.$row}}handle(e){let t=this.field,r=t.visibleRows,s=f.last(r),o=t.selectedRows,n=[],l=t.selectionHandler.lastActionRow,d=-1;e.shiftKey&&o.length>0?(l&&(d=r.indexOf(l)),d<0&&(l=f.last(o),d=r.indexOf(l)),n=r.slice(d+1,r.length),n=f.union(o,n)):n=[s],t.selectionHandler.lastActionRow=s,t.selectRows(n),t.scrollTo(s),t.isFocused()||t.focus()}}class oc extends Ir{constructor(e){super(e),this.which=[_.PAGE_UP],this.renderingHints.text="PgUp",this.renderingHints.$drawingArea=(t,r)=>{let s=this._viewportInfo();if(s.firstRow)return s.firstRow.$row}}handle(e){let t=this.field,r=this._viewportInfo(),s=t.visibleRows,o=t.selectedRows,n=f.first(o),l=t.selectionHandler.lastActionRow,d=-1,h;!r.firstRow&&(t.scrollPageUp(),r=this._viewportInfo(),!r.firstRow)||(l&&(d=s.indexOf(l)),d<0&&(l=n,d=s.indexOf(l)),!(o.length>0&&l===r.firstRow&&!(o.length>1&&!e.shiftKey)&&(t.scrollPageUp(),r=this._viewportInfo(),!r.firstRow))&&(e.shiftKey&&o.length>0?(h=s.slice(s.indexOf(r.firstRow),d),h=f.union(o,h)):h=[r.firstRow],t.selectionHandler.lastActionRow=r.firstRow,t.selectRows(h,!0),t.isFocused()||t.focus()))}}class nc extends Ir{constructor(e){super(e),this.which=[_.PAGE_DOWN],this.renderingHints.text="PgDn",this.renderingHints.$drawingArea=(t,r)=>{let s=this._viewportInfo();if(s.lastRow)return s.lastRow.$row}}handle(e){let t=this.field,r=this._viewportInfo(),s=t.visibleRows,o=t.selectedRows,n=f.last(o),l=t.selectionHandler.lastActionRow,d=-1,h;!r.lastRow&&(t.scrollPageDown(),r=this._viewportInfo(),!r.lastRow)||(l&&(d=s.indexOf(l)),d<0&&(l=n,d=s.indexOf(l)),!(o.length>0&&l===r.lastRow&&!(o.length>1&&!e.shiftKey)&&(t.scrollPageDown(),r=this._viewportInfo(),!r.lastRow))&&(e.shiftKey&&o.length>0?(h=s.slice(d+1,s.indexOf(r.lastRow)+1),h=f.union(o,h)):h=[r.lastRow],t.selectionHandler.lastActionRow=r.lastRow,t.selectRows(h,!0),t.isFocused()||t.focus()))}}function Ia(i,e,t){return e=kF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kF(i){var e=BF(i,"string");return typeof e=="symbol"?e:String(e)}function BF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zt extends ir{constructor(){super(),Ia(this,"objectType",void 0),Ia(this,"session",void 0),Ia(this,"table",void 0),Ia(this,"filterType",void 0),this.session=null}init(e){if(this.session=e.session,!this.session)throw new Error("Session expected: "+this);this._init(e)}_init(e){a().extend(this,e)}createFilterAddedEventData(){return{filterType:this.filterType}}createFilterRemovedEventData(){return{filterType:this.filterType}}createKey(){return this.filterType}equals(e){return e instanceof Zt?v.equals(this.createKey(),e.createKey()):!1}}function lo(i,e,t){return e=OF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function OF(i){var e=HF(i,"string");return typeof e=="symbol"?e:String(e)}function HF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zi extends Zt{constructor(){super(),lo(this,"column",void 0),lo(this,"hasFilterFields",void 0),lo(this,"availableValues",void 0),lo(this,"selectedValues",void 0),lo(this,"matrix",void 0),lo(this,"xAxis",void 0),this.filterType=Zi.TYPE,this.hasFilterFields=!1,this.availableValues=[],this.selectedValues=[]}axisGroup(){return At.NumberGroup.COUNT}calculate(){let e,t;this.matrix=new At(this.table,this.session),this.matrix.addData(this.column,At.NumberGroup.COUNT),this.xAxis=this.matrix.addAxis(this.column,this.axisGroup());let r=this.matrix.calculate();this.selectedValues.forEach(s=>{e=!1,this.xAxis.some(o=>this.xAxis.keyToDeterministicKey(o)===s?(e=!0,!0):!1),e||(this.xAxis.push(this.xAxis.deterministicKeyToKey(s)),t=!0)}),t&&this.xAxis.reorder(),this.availableValues=[],this.xAxis.forEach(s=>{let o=this.xAxis.keyToDeterministicKey(s),n=this.xAxis.format(s),l=null;s!==null&&this.xAxis.textIsIcon&&(l=n,n=null);let d=r.getValue([s]);this.availableValues.push({key:o,text:n,iconId:l,htmlEnabled:!1,cssClass:null,count:d?d[0]:0})})}createFilterAddedEventData(){let e=super.createFilterAddedEventData();return e.columnId=this.column.id,e.selectedValues=this.selectedValues,e}createFilterRemovedEventData(){let e=super.createFilterRemovedEventData();return e.columnId=this.column.id,e}createLabel(){return this.column.headerHtmlEnabled?y.plainText(this.column.text).replace(/\n/g," "):this.column.text||""}createKey(){return this.column.id}accept(e){this.xAxis||this.calculate();let t=!0,r=!0,s=this.column.cellValueOrTextForCalculation(e),o=this.xAxis.normDeterministic(s);return this.tableFilterActive()&&(t=this.selectedValues.indexOf(o)>-1),this.fieldsFilterActive()&&(r=this.acceptByFields(s,o,e)),t&&r}filterActive(){return this.tableFilterActive()||this.fieldsFilterActive()}tableFilterActive(){return this.selectedValues.length>0}triggerFilterFieldsChanged(){this.trigger("filterFieldsChanged")}acceptByFields(e,t,r){return!0}fieldsFilterActive(){return!1}addFilterFields(e){}modifyFilterFields(){}filterFieldsTitle(){return null}createComparator(){return gt.NUMERIC}}lo(Zi,"TYPE","column");function ka(i,e,t){return e=NF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NF(i){var e=VF(i,"string");return typeof e=="symbol"?e:String(e)}function VF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yg extends Zi{constructor(){super(),ka(this,"dateFrom",void 0),ka(this,"dateTo",void 0),ka(this,"dateFromField",void 0),ka(this,"dateToField",void 0),this.dateFrom=null,this.dateFromField=null,this.dateTo=null,this.dateToField=null,this.hasFilterFields=!0}_init(e){super._init(e),this.dateFrom=T.parseJsonDate(e.dateFrom),this.dateTo=T.parseJsonDate(e.dateTo)}axisGroup(){return this.column.hasDate?At.DateGroup.YEAR:At.DateGroup.NONE}createFilterAddedEventData(){let e=super.createFilterAddedEventData();return e.dateFrom=T.toJsonDate(this.dateFrom),e.dateTo=T.toJsonDate(this.dateTo),e}fieldsFilterActive(){return!!this.dateFrom||!!this.dateTo}acceptByFields(e,t,r){if(!e)return!1;let s=e.valueOf(),o=this.dateFrom?this.dateFrom.valueOf():null,n=this.dateTo?T.shift(this.dateTo,0,0,1).valueOf()-1:null;if(o&&n)return s>=o&&s<=n;if(o)return s>=o;if(n)return s<=n;throw new Error("illegal state")}filterFieldsTitle(){return this.session.text("ui.DateRange")}addFilterFields(e){this.dateFromField=e.addFilterField(Kt,"ui.from"),this.dateFromField.setValue(this.dateFrom),this.dateFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.dateToField=e.addFilterField(Kt,"ui.to"),this.dateToField.setValue(this.dateTo),this.dateToField.on("propertyChange",this._onPropertyChange.bind(this))}_onPropertyChange(e){e.propertyName==="value"&&(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,a().log.isDebugEnabled()&&a().log.debug("(DateColumnUserFilter#_onAcceptInput) dateFrom="+this.dateFrom+" dateTo="+this.dateTo),this.triggerFilterFieldsChanged())}modifyFilterFields(){this.dateFromField.$field.on("input","",a().debounce(this._onInput.bind(this))),this.dateToField.$field.on("input","",a().debounce(this._onInput.bind(this)))}_onInput(e){!this.dateFromField.rendered||(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,this.triggerFilterFieldsChanged())}}function Ba(i,e,t){return e=WF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WF(i){var e=KF(i,"string");return typeof e=="symbol"?e:String(e)}function KF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vg extends Zi{constructor(){super(),Ba(this,"numberFrom",void 0),Ba(this,"numberTo",void 0),Ba(this,"numberFromField",void 0),Ba(this,"numberToField",void 0),this.numberFrom=null,this.numberFromField=null,this.numberTo=null,this.numberToField=null,this.hasFilterFields=!0}createFilterAddedEventData(){let e=super.createFilterAddedEventData();return e.numberFrom=this.numberFrom,e.numberTo=this.numberTo,e}fieldsFilterActive(){return v.isNumber(this.numberFrom)||v.isNumber(this.numberTo)}acceptByFields(e,t,r){let s=v.isNumber(this.numberFrom),o=v.isNumber(this.numberTo);if(s&&o)return t>=this.numberFrom&&t<=this.numberTo;if(s)return t>=this.numberFrom;if(o)return t<=this.numberTo}filterFieldsTitle(){return this.session.text("ui.NumberRange")}addFilterFields(e){this.numberFromField=e.addFilterField(fo,"ui.from"),this.numberFromField.decimalFormat=this.column.decimalFormat,this.numberFromField.setValue(this.numberFrom),this.numberFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.numberToField=e.addFilterField(fo,"ui.to"),this.numberToField.decimalFormat=this.column.decimalFormat,this.numberToField.setValue(this.numberTo),this.numberToField.on("propertyChange",this._onPropertyChange.bind(this))}_onPropertyChange(e){e.propertyName==="value"&&(this.numberFrom=this.numberFromField.value,this.numberTo=this.numberToField.value,a().log.isDebugEnabled()&&a().log.debug("(NumberColumnUserFilter#_onPropertyChange) numberFrom="+this.numberFrom+" numberTo="+this.numberTo),this.triggerFilterFieldsChanged())}}function wg(i,e,t){return e=zF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zF(i){var e=GF(i,"string");return typeof e=="symbol"?e:String(e)}function GF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tg extends Zi{constructor(){super(),wg(this,"freeText",void 0),wg(this,"freeTextField",void 0),this.freeText=null,this.freeTextField=null,this.hasFilterFields=!0}createFilterAddedEventData(){let e=super.createFilterAddedEventData();return e.freeText=this.freeText,e}fieldsFilterActive(){return y.hasText(this.freeText)}acceptByFields(e,t,r){let s=y.nvl(this.freeText).toLowerCase();return y.nvl(this.column.cellTextForTextFilter(r)).toLowerCase().indexOf(s)>-1}filterFieldsTitle(){return this.session.text("ui.FreeText")}addFilterFields(e){this.freeTextField=u.create(Wi,{parent:e,labelVisible:!1,statusVisible:!1,maxLength:100,displayText:this.freeText,updateDisplayTextOnModify:!0}),this.freeTextField.on("acceptInput",this._onAcceptInput.bind(this)),e.addField0(this.freeTextField)}_onAcceptInput(e){let t=this.freeTextField.$field.val();this.freeText=t.trim(),a().log.isDebugEnabled()&&a().log.debug("(TextColumnUserFilter#_onAcceptInput) freeText="+this.freeText),this.triggerFilterFieldsChanged()}modifyFilterFields(){this.freeTextField.removeMandatoryIndicator()}}function Oa(i,e,t){return e=UF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UF(i){var e=qF(i,"string");return typeof e=="symbol"?e:String(e)}function qF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mr extends Zt{constructor(){super(),Oa(this,"text",void 0),Oa(this,"_cachedText",void 0),Oa(this,"_cachedTextLowerCase",void 0),this.filterType=mr.TYPE}createFilterAddedEventData(){let e=super.createFilterAddedEventData();return e.text=this.text,e}createLabel(){return this.text}accept(e){let t=this.table.visibleColumns().reduce((s,o)=>s+o.cellTextForTextFilter(e)+" ",""),r=u.nvl(this.text,"");return r!==this._cachedText&&(this._cachedText=r,this._cachedTextLowerCase=r.toLowerCase()),t=t.trim().toLowerCase(),t.indexOf(this._cachedTextLowerCase)>-1}}Oa(mr,"TYPE","text");function YF(i,e,t){return e=jF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jF(i){var e=XF(i,"string");return typeof e=="symbol"?e:String(e)}function XF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class lc{constructor(){YF(this,"table",void 0)}init(e){a().extend(this,e)}accept(e){return!e.parentRow}createLabel(){return this.table.session.text("ui.TileView")}}function Ha(i,e,t){return e=JF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function JF(i){var e=QF(i,"string");return typeof e=="symbol"?e:String(e)}function QF(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Sg{constructor(e){Ha(this,"acceptedKeys",void 0),Ha(this,"keySupplier",void 0),Ha(this,"active",void 0),Ha(this,"alwaysAcceptedRowIds",void 0),this.acceptedKeys=[],this.keySupplier=e||(t=>t.lookupRow&&t.lookupRow.key),this.active=!0,this.alwaysAcceptedRowIds=[]}accept(e){if(!this.active||f.empty(this.acceptedKeys)||this.alwaysAcceptedRowIds.indexOf(e.id)!==-1)return!0;let t=this.keySupplier(e);return this.acceptedKeys.indexOf(t)!==-1}setAcceptedKeys(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.acceptedKeys=f.ensure(t)}setActive(e){this.active=e}setAlwaysAcceptedRowIds(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.alwaysAcceptedRowIds=t}}function Na(i,e,t){return e=ZF(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ZF(i){var e=eE(i,"string");return typeof e=="symbol"?e:String(e)}function eE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cg{constructor(e){Na(this,"acceptedText",void 0),Na(this,"textSupplier",void 0),Na(this,"active",void 0),Na(this,"alwaysAcceptedRowIds",void 0),this.acceptedText=null,this.textSupplier=e||(t=>t.lookupRow&&t.lookupRow.text),this.active=!0,this.alwaysAcceptedRowIds=[]}accept(e){if(!this.active||y.empty(this.acceptedText)||this.alwaysAcceptedRowIds.indexOf(e.id)!==-1)return!0;let t=this.textSupplier(e);return y.empty(t)?!1:y.contains(t.toLowerCase(),this.acceptedText.toLowerCase())}setAcceptedText(e){this.acceptedText=e}setActive(e){this.active=e}setAlwaysAcceptedRowIds(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.alwaysAcceptedRowIds=t}}function Va(i,e,t){return e=tE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tE(i){var e=iE(i,"string");return typeof e=="symbol"?e:String(e)}function iE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wa extends I{constructor(){super(),Va(this,"preselectedTime",void 0),Va(this,"selectedTime",void 0),Va(this,"viewDate",void 0),Va(this,"resolution",void 0),this.preselectedTime=null,this.selectedTime=null,this.resolution=null}_init(e){super._init(e),this.resolution=e.timeResolution}_render(){this.$container=this.$parent.appendDiv("time-picker").toggleClass("touch-only",F.get().supportsOnlyTouch()),this.$parent.appendDiv("time-picker-separator"),this.htmlComp=S.install(this.$container,this.session),this._renderTimeSelection(),this._installScrollbars()}_renderTimeSelection(){let e,t=T.trunc(new Date),r=T.ceil(new Date,this.resolution),s=0,o,n,l=this.$parent.makeDiv("day-table");for(e=0;e<24;e++){t.setMinutes(0),s=t.getHours(),o=l.appendDiv("hour-row");let d=o.appendDiv("cell  hours").data("time",new Date(t)).on("click",this._onTimeClick.bind(this));for(r.getHours()===t.getHours()&&d.addClass("now"),d.appendSpan("text").text(T.format(t,this.session.locale,"HH"));s===t.getHours();)n=o.appendDiv("cell minutes").data("time",new Date(t)).on("click",this._onTimeClick.bind(this)),n.appendSpan("text").text(T.format(t,this.session.locale,"mm")),T.isSameTime(r,t)&&n.addClass("now"),t.setMinutes(t.getMinutes()+this.resolution)}return l.appendTo(this.$container),l}_installScrollbars(e){this._uninstallScrollbars(),super._installScrollbars({axis:"y"})}_scrollTo(e){!e||(this.parent instanceof za?setTimeout(()=>{this.rendered&&x.scrollTo(this.$container,e,"center")}):x.scrollTo(this.$container,e,"center"))}preselectTime(e){e&&this.setSelectedTime(null),this.setPreselectedTime(e)}setPreselectedTime(e){this.setProperty("preselectedTime",e)}_renderPreselectedTime(){let e;this.$container.find(".cell").each((t,r)=>{let s=a()(r),o=s.data("time");s.removeClass("preselected"),this.preselectedTime&&(s.hasClass("hours")&&this.preselectedTime.getHours()===o.getHours()||s.hasClass("minutes")&&T.isSameTime(this.preselectedTime,o))&&(s.addClass("preselected"),e=s)}),this._scrollTo(e)}selectTime(e){e&&this.setPreselectedTime(null),this.setSelectedTime(e)}setSelectedTime(e){this.setProperty("selectedTime",e)}_renderSelectedTime(){let e;this.$container.find(".cell").each((t,r)=>{let s=a()(r),o=s.data("time");s.removeClass("selected"),this.selectedTime&&(s.hasClass("hours")&&this.selectedTime.getHours()===o.getHours()||s.hasClass("minutes")&&T.isSameTime(this.selectedTime,o))&&(s.addClass("selected"),e=s)}),this._scrollTo(e)}shiftSelectedTime(e,t,r){let s=this.preselectedTime;this.selectedTime&&(s=T.shiftTime(this.selectedTime,e,t*this.resolution,r)),s&&this.selectTime(this._snapToTimeGrid(s))}_snapToTimeGrid(e){if(!e)return e;let t=e.getMinutes();return t=parseInt(t/this.resolution+"")*this.resolution,e.setMinutes(t),e}_onTimeClick(e){let t=a()(e.currentTarget),r=new Date(t.data("time"));this.selectTime(r),this.trigger("timeSelect",{time:r})}}function Pg(i,e,t){return e=rE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function rE(i){var e=sE(i,"string");return typeof e=="symbol"?e:String(e)}function sE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ka extends pe{constructor(){super(),Pg(this,"picker",void 0),Pg(this,"field",void 0),this.windowPaddingX=0,this.windowPaddingY=0,this.picker=null}_init(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,super._init(e),this.picker=u.create(Wa,{parent:this,timeResolution:e.timeResolution})}_createLayout(){return new ac(this)}_render(){this.$container=this.$parent.appendDiv("popup time-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===M.FieldStyle.ALTERNATIVE),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.findDesktop().adjustOverlayOrder(this),this.picker.render()}getTimePicker(){return this.picker}_isMouseDownOnAnchor(e){let t=e.target;return this.field.$timeField.isOrHas(t)||this.field.$timeFieldIcon.isOrHas(t)||this.field.$timeClearIcon&&this.field.$timeClearIcon.isOrHas(t)}}class ac extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}layout(e){let t,r=this.popup.htmlComp,s=this.popup.picker.htmlComp;super.layout(e),t=r.size().subtract(r.insets()).subtract(s.margins()),s.setSize(t),this.popup.htmlComp.layouted&&this.popup.position()}preferredLayoutSize(e,t){let r,s=this.popup.htmlComp,o=this.popup.picker.htmlComp;return r=o.prefSize().add(s.insets()).add(o.margins()),r}}class za extends el{_init(e){super._init(e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this)),this.addCssClass("time-picker-touch-popup")}_initWidget(e){this._widget=u.create(Wa,{parent:this,timeResolution:e.timeResolution})}_render(){super._render(),this._field.$container.addClass("time")}getTimePicker(){return this._widget}_onFieldAcceptInput(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),(e.errorStatus?e.errorStatus.containsStatus(vi):!1)||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput(e.whileTyping)}_acceptInput(){this._field.acceptTime(),this.close()}}function H(i,e,t){return e=oE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function oE(i){var e=nE(i,"string");return typeof e=="symbol"?e:String(e)}function nE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fe extends I{constructor(){super(),H(this,"toggleBreadcrumbStyleEnabled",void 0),H(this,"breadcrumbTogglingThreshold",void 0),H(this,"autoCheckChildren",void 0),H(this,"checkable",void 0),H(this,"checkableStyle",void 0),H(this,"displayStyle",void 0),H(this,"dropType",void 0),H(this,"dropMaximumSize",void 0),H(this,"lazyExpandingEnabled",void 0),H(this,"menus",void 0),H(this,"contextMenu",void 0),H(this,"menuBar",void 0),H(this,"keyStrokes",void 0),H(this,"multiCheck",void 0),H(this,"nodes",void 0),H(this,"nodesMap",void 0),H(this,"nodePaddingLevelCheckable",void 0),H(this,"nodePaddingLevelNotCheckable",void 0),H(this,"nodePaddingLevelDiffParentHasIcon",void 0),H(this,"nodePaddingLeft",void 0),H(this,"nodeCheckBoxPaddingLeft",void 0),H(this,"nodeControlPaddingLeft",void 0),H(this,"nodePaddingLevel",void 0),H(this,"scrollToSelection",void 0),H(this,"scrollTopHistory",void 0),H(this,"selectedNodes",void 0),H(this,"prevSelectedNode",void 0),H(this,"filters",void 0),H(this,"textFilterEnabled",void 0),H(this,"filterSupport",void 0),H(this,"filteredElementsDirty",void 0),H(this,"filterAnimated",void 0),H(this,"rebuildSuppressed",void 0),H(this,"breadcrumbFilter",void 0),H(this,"dragAndDropHandler",void 0),H(this,"checkedNodes",void 0),H(this,"groupedNodes",void 0),H(this,"visibleNodesFlat",void 0),H(this,"visibleNodesMap",void 0),H(this,"viewRangeRendered",void 0),H(this,"viewRangeDirty",void 0),H(this,"viewRangeSize",void 0),H(this,"startAnimationFunc",void 0),H(this,"runningAnimations",void 0),H(this,"runningAnimationsFinishFunc",void 0),H(this,"nodeHeight",void 0),H(this,"nodeWidth",void 0),H(this,"maxNodeWidth",void 0),H(this,"nodeWidthDirty",void 0),H(this,"requestFocusOnNodeControlMouseDown",void 0),H(this,"initialTraversing",void 0),H(this,"$data",void 0),H(this,"$fillBefore",void 0),H(this,"$fillAfter",void 0),H(this,"_additionalContainerClasses",void 0),H(this,"_renderViewportBlocked",void 0),H(this,"_doubleClickSupport",void 0),H(this,"_$animationWrapper",void 0),H(this,"_$expandAnimationWrappers",void 0),H(this,"_filterMenusHandler",void 0),H(this,"_popupOpenHandler",void 0),H(this,"_inSelectionPathList",void 0),H(this,"_scrollDirections",void 0),H(this,"_changeNodeTaskScheduled",void 0),H(this,"_$mouseDownNode",void 0),this.toggleBreadcrumbStyleEnabled=!1,this.breadcrumbTogglingThreshold=null,this.autoCheckChildren=!1,this.checkable=!1,this.checkableStyle=fe.CheckableStyle.CHECKBOX_TREE_NODE,this.displayStyle=fe.DisplayStyle.DEFAULT,this.dropType=0,this.dropMaximumSize=Ae.DEFAULT_DROP_MAXIMUM_SIZE,this.lazyExpandingEnabled=!0,this.menus=[],this.contextMenu=null,this.menuBar=null,this.keyStrokes=[],this.multiCheck=!0,this.nodes=[],this.nodesMap={},this.nodePaddingLevelCheckable=23,this.nodePaddingLevelNotCheckable=18,this.nodePaddingLevelDiffParentHasIcon=null,this.nodePaddingLeft=null,this.nodeCheckBoxPaddingLeft=29,this.nodeControlPaddingLeft=null,this.nodePaddingLevel=this.nodePaddingLevelNotCheckable,this.scrollToSelection=!1,this.scrollTop=0,this.scrollTopHistory=[],this.selectedNodes=[],this.prevSelectedNode=null,this.filters=[],this.textFilterEnabled=!0,this.filterSupport=this._createFilterSupport(),this.filteredElementsDirty=!1,this.filterAnimated=!0,this.checkedNodes=[],this.groupedNodes={},this.visibleNodesFlat=[],this.visibleNodesMap={},this._addWidgetProperties(["menus","keyStrokes"]),this._additionalContainerClasses="",this._doubleClickSupport=new Vs,this._$animationWrapper=null,this._$expandAnimationWrappers=[],this._filterMenusHandler=this._filterMenus.bind(this),this._popupOpenHandler=this._onDesktopPopupOpen.bind(this),this._inSelectionPathList={},this._changeNodeTaskScheduled=!1,this.viewRangeRendered=new O(0,0),this.viewRangeSize=20,this.startAnimationFunc=function(){this.runningAnimations++}.bind(this),this.runningAnimations=0,this.runningAnimationsFinishFunc=function(){this.runningAnimations--,this.runningAnimations<=0&&(this.runningAnimations=0,this._renderViewportBlocked=!1,this.invalidateLayoutTree())}.bind(this),this.nodeHeight=0,this.nodeWidth=0,this.maxNodeWidth=0,this.nodeWidthDirty=!1,this.$data=null,this._scrollDirections="both",this.requestFocusOnNodeControlMouseDown=!0,this._$mouseDownNode=null}_init(e){super._init(e),this.setFilters(this.filters,!1),this.addFilter(new dc(this),!1),this.breadcrumbFilter=new hc(this),this.displayStyle===fe.DisplayStyle.BREADCRUMB&&this.addFilter(this.breadcrumbFilter,!1),this.initialTraversing=!0,this._setCheckable(this.checkable),this.ensureTreeNodes(this.nodes),this._initNodes(this.nodes),this.initialTraversing=!1,this.menuBar=u.create(ce,{parent:this,position:ce.Position.BOTTOM,menuOrder:new sn(this.session,"Tree"),menuFilter:this._filterMenusHandler,cssClass:"bounded"}),this._updateItemPath(!0),this._setDisplayStyle(this.displayStyle),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus)}_initNodes(e,t){e||(e=this.nodes),fe.visitNodes(this._initTreeNode.bind(this),e,t),typeof this.selectedNodes[0]=="string"&&(this.selectedNodes=this.nodesByIds(this.selectedNodes)),this._updateSelectionPath(),e.forEach(r=>this.applyFiltersForNode(r)),fe.visitNodes((r,s)=>this._addToVisibleFlatList(r,!1),e,t)}ensureTreeNodes(e){for(let t=0;t<e.length;t++){let r=e[t];r.childNodeIndex=u.nvl(r.childNodeIndex,t),!(r instanceof ts)&&(e[t]=this._createTreeNode(r))}}_createTreeNode(e){return e=e||{},e.objectType=u.nvl(e.objectType,ts),e.parent=this,u.create(e)}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this._initTreeKeyStrokeContext()}_initTreeKeyStrokeContext(){let e=Se.NONE;this.keyStrokeContext.registerKeyStrokes([new uc(this),new Ga(this,e),new Ua(this,e),new cc(this,e),new Ya(this,e),new qa(this,e),new ja(this,e)])}_setMenus(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}_updateMenuBar(){let e=this._filterMenus(this.menus,kt.MENU_BAR,!1,!0);this.menuBar.setMenuItems(e);let t=this._filterMenus(this.menus,kt.CONTEXT_MENU,!0);this.contextMenu&&this.contextMenu.updateMenuItems(t)}_setKeyStrokes(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}_resetTreeNode(e,t){e.reset()}isSelectedNode(e){return this.selectedNodes.indexOf(e)>-1}_updateSelectionPath(){let e=this.selectedNodes[0];if(!e)return;this._inSelectionPathList[e.id]=!0,e.childNodes.forEach(r=>{this._inSelectionPathList[r.id]=!0});let t=e.parentNode;for(;t;)this._inSelectionPathList[t.id]=!0,t=t.parentNode}_initTreeNode(e,t){this.nodesMap[e.id]=e,t&&(e.parentNode=t,e.level=e.parentNode.level+1),e.checked&&this.checkedNodes.push(e),this._initTreeNodeInternal(e,t),this._updateMarkChildrenChecked(e,!0,e.checked),e.initialized=!0}_initTreeNodeInternal(e,t){}_destroy(){super._destroy(),this.visitNodes(this._destroyTreeNode.bind(this)),this.nodes=[]}_destroyTreeNode(e){delete this.nodesMap[e.id],this._removeFromFlatList(e,!1),e.destroy(),this._onNodeDeleted&&this._onNodeDeleted(e)}_onNodeDeleted(e){}visitNodes(e,t){return fe.visitNodes(e,this.nodes,t)}_render(){this.$container=this.$parent.appendDiv("tree"),this._additionalContainerClasses&&this.$container.addClass(this._additionalContainerClasses);let e=new pl(this);this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(e),this._renderData(),this.menuBar.render(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this._renderCheckableStyle()}_renderData(){this.$data=this.$container.appendDiv("tree-data").on("contextmenu",this._onContextMenu.bind(this)).on("mousedown",".tree-node",this._onNodeMouseDown.bind(this)).on("mouseup",".tree-node",this._onNodeMouseUp.bind(this)).on("dblclick",".tree-node",this._onNodeDoubleClick.bind(this)).on("mousedown",".tree-node-control",this._onNodeControlMouseDown.bind(this)).on("mouseup",".tree-node-control",this._onNodeControlMouseUp.bind(this)).on("dblclick",".tree-node-control",this._onNodeControlDoubleClick.bind(this)),S.install(this.$data,this.session),this.isHorizontalScrollingEnabled()&&this.$data.toggleClass("scrollable-tree",!0),this._installScrollbars({axis:this._scrollDirections}),this._installNodeTooltipSupport(),this._updateNodeDimensions(),this._renderDisplayStyle(),this._renderViewport()}_renderProperties(){super._renderProperties(),this._renderTextFilterEnabled()}_postRender(){super._postRender(),this._renderSelection()}_remove(){this.session.desktop.off("popupOpen",this._popupOpenHandler),this.filterSupport.remove(),this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this.visitNodes(this._resetTreeNode.bind(this)),Ae.uninstallDragAndDropHandler(this),this._uninstallNodeTooltipSupport(),this.$fillBefore=null,this.$fillAfter=null,this.$data=null,this.viewRangeRendered=new O(0,0),super._remove()}isHorizontalScrollingEnabled(){return this._scrollDirections==="both"||this._scrollDirections==="x"}isTreeNodeCheckEnabled(){return this.checkableStyle===fe.CheckableStyle.CHECKBOX_TREE_NODE}_onScroll(e){let t=this.scrollToSelection;this.scrollToSelection=!1;let r=this.$data[0].scrollTop,s=this.$data[0].scrollLeft;this.scrollTop!==r&&this.rendered&&this._renderViewport(),this.scrollTop=r,this.scrollLeft=s,this.scrollToSelection=t}setScrollTop(e){this.setProperty("scrollTop",e),this.rendered&&(this._renderViewport(),this._renderScrollTop())}_renderScrollTop(){this.rendering||x.scrollTop(this.$data,this.scrollTop)}get$Scrollable(){return this.$data}_renderViewport(){if(this.runningAnimations>0||this._renderViewportBlocked||!this.$container.isEveryParentVisible())return;let e=this._calculateCurrentViewRange();this._renderViewRange(e)}_calculateCurrentViewRange(){let e,t=this.$data[0].scrollTop;return this.$data[0].scrollHeight-this.$data[0].clientHeight===0&&this.visibleNodesFlat.length>0?e=this.visibleNodesFlat[0]:e=this._nodeAtScrollTop(t),this._calculateViewRangeForNode(e)}_rerenderViewport(){this._renderViewportBlocked||(this._removeRenderedNodes(),this._renderFiller(),this._updateDomNodeWidth(),this._renderViewport())}_removeRenderedNodes(){this.$data.find(".tree-node").each((t,r)=>{let s=a()(r),o=s.data("node");s.hasClass("hiding")||this._removeNode(o)}),this.viewRangeRendered=new O(0,0)}_renderViewRangeForNode(e){let t=this._calculateViewRangeForNode(e);this._renderViewRange(t)}_renderNodesInRange(e){let t=!1,r=this.visibleNodesFlat;if(r.length===0)return;if(e=new O(0,r.length).intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new O(0,0)))throw new Error("New range must not intersect with existing.");e.to<=this.viewRangeRendered.from&&(t=!0);let o=this.viewRangeRendered.union(e);if(o.length===2)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+o);this.viewRangeRendered=o[0];let n=this.ensureRangeVisible(e);a().log.isTraceEnabled()&&a().log.trace(n+" new nodes rendered from "+e)}ensureRangeVisible(e){let t=this.visibleNodesFlat,r=[];for(let s=e.from;s<e.to;s++){let o=t[s];o.attached||r.push(o)}return this._insertNodesInDOM(r),r.length}_renderFiller(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("tree-data-fill"));let e=this._calculateFillerDimension(new O(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e.height),this.isHorizontalScrollingEnabled()&&(this.$fillBefore.cssWidth(e.width),this.maxNodeWidth=Math.max(e.width,this.maxNodeWidth)),a().log.isTraceEnabled()&&a().log.trace("FillBefore height: "+e.height),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("tree-data-fill"));let t={height:0,width:0};t=this._calculateFillerDimension(new O(this.viewRangeRendered.to,this.visibleNodesFlat.length)),this.$fillAfter.cssHeight(t.height),this.isHorizontalScrollingEnabled()&&(this.$fillAfter.cssWidth(t.width),this.maxNodeWidth=Math.max(t.width,this.maxNodeWidth)),a().log.isTraceEnabled()&&a().log.trace("FillAfter height: "+t.height)}_calculateFillerDimension(e){let t=0;this.rendered&&(t=this.$data.width());let r={height:0,width:Math.max(t,this.maxNodeWidth)};for(let s=e.from;s<e.to;s++){let o=this.visibleNodesFlat[s];r.height+=this._heightForNode(o),r.width=Math.max(r.width,this._widthForNode(o))}return r}_removeNodesInRange(e){let t,r=0,s=this.visibleNodesFlat;e=new O(0,s.length).intersect(e);let n=this.viewRangeRendered.subtract(e);if(n.length===2)throw new Error("Can only remove nodes at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(let l=e.from;l<e.to;l++)t=s[l],this._removeNode(t),r++;a().log.isTraceEnabled()&&a().log.trace(r+" nodes removed from "+e+".")}_removeNode(e){let t=e.$node;!t||t.hasClass("hiding")||(t.detach(),e.attached=!1)}_renderViewRange(e){if(e.from===this.viewRangeRendered.from&&e.to===this.viewRangeRendered.to&&!this.viewRangeDirty){this.nodeWidthDirty&&(this._renderFiller(),this._updateDomNodeWidth());return}if(this.viewRangeDirty)this.viewRangeRendered=e,this.ensureRangeVisible(e);else{let t=e.subtract(this.viewRangeRendered),r=this.viewRangeRendered.subtract(e),s=new O(0,this.visibleNodesFlat.length);r.forEach(o=>{this._removeNodesInRange(o),s.to<o.to&&(this.viewRangeRendered=e)}),t.forEach(o=>{this._renderNodesInRange(o)})}if(this.viewRangeRendered.size()>0){let t=this.visibleNodesFlat,r=t[this.viewRangeRendered.from],s=t[this.viewRangeRendered.to-1];if(this.viewRangeDirty){let o=r.$node.prevAll(".tree-node"),n=s.$node.nextAll(".tree-node");this._cleanupNodes(o),this._cleanupNodes(n)}if(!r.attached||!s.attached)throw new Error("Nodes not rendered as expected. "+this.viewRangeRendered+". First: "+w.debugOutput(r.$node)+". Last: "+w.debugOutput(s.$node)+". Length: visibleNodesFlat="+this.visibleNodesFlat.length+" nodes="+this.nodes.length+" nodesMap="+Object.keys(this.nodesMap).length)}this._postRenderViewRange(),this.viewRangeDirty=!1}_postRenderViewRange(){this._renderFiller(),this._updateDomNodeWidth(),this._renderSelection()}_visibleNodesInViewRange(){return this.visibleNodesFlat.slice(this.viewRangeRendered.from,this.viewRangeRendered.to)}_updateDomNodeWidth(){if(!this.isHorizontalScrollingEnabled()||!this.rendered||!this.nodeWidthDirty)return;let e=this._visibleNodesInViewRange(),t=this.maxNodeWidth;t=e.reduce((r,s)=>Math.max(s.width,r),u.nvl(t,0)),e.forEach(r=>r.$node.cssWidth(t)),this.nodeWidthDirty=!1}_cleanupNodes(e){for(let t=0;t<e.length;t++)this._removeNode(e.eq(t).data("node"))}_nodeAtScrollTop(e){let t=0,r;this.visibleNodesFlat.some((o,n)=>(t+=this._heightForNode(o),e<t?(r=o,!0):!1));let s=this.visibleNodesFlat.length;return!r&&s>0&&(r=this.visibleNodesFlat[s-1]),r}_heightForNode(e){let t=0;return e.height?t=e.height:t=this.nodeHeight,t}_widthForNode(e){let t=0;return e.width?t=e.width:t=this.nodeWidth,t}_calculateViewRangeForNode(e){let t=new O,r=Math.floor(this.viewRangeSize/fe.VIEW_RANGE_DIVISOR),s,o=this.visibleNodesFlat.indexOf(e);return t.from=Math.max(o-r,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleNodesFlat.length),!e||o===-1||(s=this.viewRangeSize-t.size(),s>0&&(t.from=Math.max(t.to-this.viewRangeSize,0))),t}calculateViewRangeSize(){if(this._updateNodeDimensions(),this.nodeHeight===0)throw new Error("Cannot calculate view range with nodeHeight = 0");let e=fe.VIEW_RANGE_DIVISOR/2,t=Math.ceil(this.$data.outerHeight()/this.nodeHeight)*e;return Math.max(fe.VIEW_RANGE_DIVISOR,t)}setViewRangeSize(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.rendered&&this._renderViewport())}_updateNodeDimensions(){let e=this._createTreeNode(),t=this._renderNode(e).appendTo(this.$data);if(this.nodeHeight=t.outerHeight(!0),this.isHorizontalScrollingEnabled()){let r=this.nodeWidth;this.nodeWidth=t.outerWidth(!0),r!==this.nodeWidth&&(this.viewRangeDirty=!0)}e.reset()}updateNodeHeights(){this.visibleNodesFlat.forEach(e=>{e.attached?e.height=e.$node.outerHeight(!0):e.height=null})}removeAllNodes(){this._removeNodes(this.nodes)}_removeNodes(e,t){e.length!==0&&(e.forEach(r=>{this._removeFromFlatList(r,!0),r.childNodes.length>0&&this._removeNodes(r.childNodes,r),r.$node&&(this._$animationWrapper&&this._$animationWrapper.find(r.$node).length>0&&this._$animationWrapper.stop(!1,!0),r.reset())}),f.ensure(t).forEach(r=>{r&&r.$node&&r.childNodes.length===0&&r.$node.removeClass("expanded lazy")}),this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()))}_renderNode(e){let t=this._computeNodePaddingLeft(e);return e.render(this.$container,t),e.$node}_removeMenus(){}_filterMenus(e,t,r,s){return Ke.filterAccordingToSelection("Tree",this.selectedNodes.length,e,t,{onlyVisible:r,enableDisableKeyStrokes:s})}_renderEnabled(){super._renderEnabled(),this._installOrUninstallDragAndDropHandler();let e=this.enabledComputed;this.$data.setEnabled(e),this.$container.setTabbableOrFocusable(e)}_renderDisabledStyle(){super._renderDisabledStyle(),this._renderDisabledStyleInternal(this.$data)}setCheckable(e){this.setProperty("checkable",e)}_setCheckable(e){this._setProperty("checkable",e),this._updateNodePaddingLevel()}_updateNodePaddingLevel(){this.isBreadcrumbStyleActive()?this.nodePaddingLevel=0:this.checkable?this.nodePaddingLevel=this.nodePaddingLevelCheckable:this.nodePaddingLevel=this.nodePaddingLevelNotCheckable}setCheckableStyle(e){this.setProperty("checkableStyle",e)}_renderCheckable(){let e=r=>Boolean(r.$node),t=r=>{let s=r.$node,o=s.children(".tree-node-control"),n=s.children(".tree-node-checkbox");r._updateControl(o),this.checkable?n.length===0&&r._renderCheckbox():n.remove(),s.cssPaddingLeft(this._computeNodePaddingLeft(r)),r.childNodes&&r.childNodes.filter(e).forEach(t)};this.nodes.filter(e).forEach(t)}_renderDisplayStyle(){this.$container.toggleClass("breadcrumb",this.isBreadcrumbStyleActive()),this.nodePaddingLeft=null,this.nodeControlPaddingLeft=null;let e=v.values(this.nodesMap).filter(t=>!!t.$node).map(t=>t.$node.get(0));this._updateNodePaddingsLeft(a()(e)),this.invalidateLayoutTree()}_renderExpansion(e,t){let r={expandLazyChanged:!1,expansionChanged:!1};a().extend(r,t);let s=e.$node,o=e.expanded;!s||s.length===0||e.childNodes.length!==0&&(s.toggleClass("lazy",o&&e.expandedLazy),!(!r.expansionChanged&&!r.expandLazyChanged)&&(o?s.addClass("expanded"):s.removeClass("expanded")))}_renderSelection(){this.selectedNodes.length===0&&this.nodes.forEach(e=>{e.rendered&&e.$node.addClass("child-of-selected")}),this.$container.toggleClass("no-nodes-selected",this.selectedNodes.length===0),this.selectedNodes.forEach(e=>{if(!this.visibleNodesMap[e.id])return;let t=e.parentNode;for(t&&t.rendered&&t.$node.addClass("parent-of-selected");t;)t.rendered&&t.$node.addClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach(r=>{r.rendered&&r.$node.addClass("child-of-selected")}),e.rendered&&e.$node.select(!0)});for(let e=this.viewRangeRendered.from;e<this.viewRangeRendered.to&&!(e>=this.visibleNodesFlat.length);e++){let t=this.visibleNodesFlat[e];t&&t.rendered&&t.$node.toggleClass("group",Boolean(this.groupedNodes[t.id]))}this._updateNodePaddingsLeft(),this._highlightPrevSelectedNode(),this.scrollToSelection&&this.revealSelection()}_renderCheckableStyle(){this.$data.toggleClass("checkable",this.isTreeNodeCheckEnabled())}_highlightPrevSelectedNode(){!this.isBreadcrumbStyleActive()||!this.prevSelectedNode||!this.prevSelectedNode.rendered||this.prevSelectedNode.prevSelectionAnimationDone||this.prevSelectedNode.$node.hasClass("animate-prev-selected")||this.prevSelectedNode.$node.addClassForAnimation("animate-prev-selected").oneAnimationEnd(()=>{this.prevSelectedNode.prevSelectionAnimationDone=!0})}_removeSelection(){this.selectedNodes.length===0&&this.nodes.forEach(e=>{e.rendered&&e.$node.removeClass("child-of-selected")}),this.prevSelectedNode&&this.prevSelectedNode.rendered&&this.prevSelectedNode.$node.removeClass("animate-prev-selected"),this.selectedNodes.forEach(this._removeNodeSelection,this)}_removeNodeSelection(e){e.rendered&&e.$node.select(!1);let t=e.parentNode;for(t&&t.rendered&&t.$node.removeClass("parent-of-selected");t&&t.rendered;)t.$node.removeClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach(r=>{r.rendered&&r.$node.removeClass("child-of-selected")})}setDropType(e){this.setProperty("dropType",e)}_renderDropType(){this._installOrUninstallDragAndDropHandler()}setDropMaximumSize(e){this.setProperty("dropMaximumSize",e)}_installOrUninstallDragAndDropHandler(){Ae.installOrUninstallDragAndDropHandler({target:this,doInstall:()=>this.dropType&&this.enabledComputed,selector:".tree-data,.tree-node",onDrop:e=>this.trigger("drop",e),dropType:()=>this.dropType,additionalDropProperties:e=>{let t=a()(e.currentTarget),r={nodeId:""};if(t.hasClass("tree-node")){let s=t.data("node");r.nodeId=s.id}return r}})}_updateMarkChildrenChecked(e,t,r,s){if(!this.checkable)return;if(s){let n=!1;for(let l=0;l<e.childNodes.length;l++){let d=e.childNodes[l];if(d.checked||d.childrenChecked){e.childrenChecked=!0,r=!0,n=!0,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0);break}}n||(e.childrenChecked=!1,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1))}if(!e.parentNode||e.parentNode.checked)return;let o=!1;if(!r&&!t){let n=!1;for(let l=0;l<e.parentNode.childNodes.length;l++){let d=e.parentNode.childNodes[l];if(d.checked||d.childrenChecked){n=!0;break}}n!==e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=n,o=!0)}r&&!e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=!0,o=!0),o&&(this._updateMarkChildrenChecked(e.parentNode,t,r),this.rendered&&e.parentNode.$node&&(r?e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0):e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1)))}_installNodeTooltipSupport(){G.install(this.$data,{parent:this,selector:".tree-node",text:this._nodeTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!F.get().isCustomEllipsisTooltipPossible()})}_uninstallNodeTooltipSupport(){G.uninstall(this.$data)}_nodeTooltipText(e){let t=e.data("node");if(t.tooltipText)return t.tooltipText;if(this._isTruncatedNodeTooltipEnabled()&&e.isContentTruncated())return t.$text.text()}_isTruncatedNodeTooltipEnabled(){return!0}setDisplayStyle(e){this.displayStyle!==e&&(this._renderViewportBlocked=!0,this._setDisplayStyle(e),this.rendered&&this._renderDisplayStyle(),this._renderViewportBlocked=!1)}_setDisplayStyle(e){if(this._setProperty("displayStyle",e),this.displayStyle===fe.DisplayStyle.BREADCRUMB){if(this.selectedNodes.length>0){let t=this.selectedNodes[0];t.expanded||this.expandNode(t)}this.filterAnimated=!1,this.addFilter(this.breadcrumbFilter,!1),this.filterVisibleNodes()}else this.removeFilter(this.breadcrumbFilter),this.filterAnimated=!0;this._updateNodePaddingLevel()}_updateNodePaddingsLeft(e){(e||this.$nodes()).each((r,s)=>{let o=a()(s),n=o.data("node"),l=this._computeNodePaddingLeft(n);o.cssPaddingLeft(v.isNullOrUndefined(l)?"":l),n._updateControl(o.children(".tree-node-control"))})}setBreadcrumbStyleActive(e){e?this.setDisplayStyle(fe.DisplayStyle.BREADCRUMB):this.setDisplayStyle(fe.DisplayStyle.DEFAULT)}isNodeInBreadcrumbVisible(e){return this._inSelectionPathList[e.id]===void 0?!1:this._inSelectionPathList[e.id]}isBreadcrumbStyleActive(){return this.displayStyle===fe.DisplayStyle.BREADCRUMB}setToggleBreadcrumbStyleEnabled(e){this.setProperty("toggleBreadcrumbStyleEnabled",e)}setBreadcrumbTogglingThreshold(e){this.setProperty("breadcrumbTogglingThreshold",e)}expandNode(e,t){this.setNodeExpanded(e,!0,t)}collapseNode(e,t){this.setNodeExpanded(e,!1,t)}collapseAll(){this.rebuildSuppressed=!0,this.visitNodes(e=>this.collapseNode(e)),this.rendered&&this._rerenderViewport(),this.rebuildSuppressed=!1}setNodeExpanded(e,t,r){r=r||{};let s=r.lazy;v.isNullOrUndefined(s)&&(e.expanded===t?s=e.expandedLazy:t?s=e.lazyExpandingEnabled:s=!1);let o=u.nvl(r.renderAnimated,!0);if(this.lazyExpandingEnabled||(s=!1),this.isBreadcrumbStyleActive()&&!t&&this.selectedNodes.indexOf(e)>-1){this.setNodeExpanded(e,!0,r);return}if(r.collapseChildNodes){let l=v.valueCopy(r);l.renderExpansion=!1,e.childNodes.forEach(d=>{d.expanded&&this.collapseNode(d,l)})}let n={expansionChanged:!1,expandLazyChanged:!1};(e.expanded!==t||e.expandedLazy!==s)&&(n.expansionChanged=e.expanded!==t,n.expandLazyChanged=e.expandedLazy!==s,e.expanded=t,e.expandedLazy=s,n.expansionChanged?e.parentNode?this._rebuildParent(e.parentNode,r):e.filterAccepted?this._addToVisibleFlatList(e,!1):this._removeFromFlatList(e,!1):n.expandLazyChanged&&this.applyFiltersForNode(e,!1,o),this.groupedNodes[e.id]&&this._updateItemPath(!1,e),e.expanded?e.ensureLoadChildren().done(this._addChildrenToFlatList.bind(this,e,null,o,null,!0)):this._removeChildrenFromFlatList(e,o),this.trigger("nodeExpanded",{node:e,expanded:t,expandedLazy:s}),this.viewRangeDirty=!0),this.rendered&&u.nvl(r.renderExpansion,!0)&&this._renderExpansion(e,n),this.rendered&&this.ensureExpansionVisible(e)}setNodeExpandedRecursive(e,t,r){fe.visitNodes(s=>this.setNodeExpanded(s,t,r),e)}_rebuildParent(e,t){if(!this.rebuildSuppressed&&(e.expanded||e.expandedLazy?this._addChildrenToFlatList(e,null,!0,null,!0):this._removeChildrenFromFlatList(e,!1),this.rendered&&u.nvl(t.renderExpansion,!0))){let r={expansionChanged:!0};this._renderExpansion(e,r)}}_removeChildrenFromFlatList(e,t){if(this.visibleNodesMap[e.id]){let s=this.visibleNodesFlat.indexOf(e),o=0,n=e.level,l=[];t=t&&this.rendered,this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this._$expandAnimationWrappers.forEach(d=>d.stop(!1,!0));for(let d=s+1;d<this.visibleNodesFlat.length&&this.visibleNodesFlat[d].level>n;d++){let h=this.visibleNodesFlat[d];this.isHorizontalScrollingEnabled()&&h.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),delete this.visibleNodesMap[this.visibleNodesFlat[d].id],h.attached&&t?(this._$animationWrapper||(this._$animationWrapper=a()('<div class="animation-wrapper">').insertBefore(h.$node),this._$animationWrapper.data("parentNode",e)),h.isDescendantOf(this._$animationWrapper.data("parentNode"))&&this._$animationWrapper.append(h.$node),h.attached=!1,h.displayBackup=h.$node.css("display"),l.push(h)):h.attached&&!t&&this.hideNode(h,!1,!1),o++}return this.visibleNodesFlat.splice(s+1,o),t&&(this._renderViewportBlocked=!0,l.length>0?this._$animationWrapper.animate({height:0},{start:this.startAnimationFunc,complete:r.bind(this,l),step:()=>this.revalidateLayoutTree(),duration:200,queue:!1}):this._$animationWrapper?(this._$animationWrapper.remove(),this._$animationWrapper=null,r.call(this,l)):this._renderViewportBlocked=!1),l}return[];function r(s){s.forEach(o=>{o.$node.detach(),o.$node.css("display",o.displayBackup),o.displayBackup=null}),this._$animationWrapper&&(this._$animationWrapper.remove(),this._$animationWrapper=null),this.runningAnimationsFinishFunc()}}_removeFromFlatList(e,t){if(this.visibleNodesMap[e.id]){let r=this.visibleNodesFlat.indexOf(e);this._removeChildrenFromFlatList(e,!1),this.isHorizontalScrollingEnabled()&&e.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),this.visibleNodesFlat.splice(r,1),delete this.visibleNodesMap[e.id],this.hideNode(e,t)}}_addToVisibleFlatList(e,t){if(!this.visibleNodesMap[e.id]&&e.filterAccepted&&(!e.parentNode||e.parentNode.expanded&&this.visibleNodesMap[e.parentNode.id]))if(this.initialTraversing)this._addToVisibleFlatListNoCheck(e,this.visibleNodesFlat.length,t);else{let r=this._findInsertPositionInFlatList(e);this._addToVisibleFlatListNoCheck(e,r,t)}}_addChildrenToFlatList(e,t,r,s,o){if(!this.visibleNodesMap[e.id])return 0;let n=Boolean(s);return t=t||this.visibleNodesFlat.indexOf(e),r=r&&this.rendered,this._$animationWrapper&&!n&&this._$animationWrapper.stop(!1,!0),s?s.setInsertAt(t):s=this.newInsertBatch(t+1),e.childNodes.forEach((l,d)=>{if(!l.initialized||((l.filterDirty||o)&&this.applyFiltersForNode(l,!1).newlyHidden.forEach(g=>this._removeFromFlatList(g,!1)),!l.filterAccepted))return;let h;this.visibleNodesMap[l.id]?(this.insertBatchInVisibleNodes(s,this._showNodes(s),r),this.checkAndHandleBatchAnimationWrapper(e,!1,s),s=this.newInsertBatch(s.nextBatchInsertIndex()),s=this._addChildrenToFlatListIfExpanded(1,l,h,r,s,o)):(s.insertNodes.push(l),this.visibleNodesMap[l.id]=!0,s=this.checkAndHandleBatch(s,e,r),s=this._addChildrenToFlatListIfExpanded(0,l,h,r,s,o))}),n||(this.insertBatchInVisibleNodes(s,this._showNodes(s),r),this.invalidateLayoutTree()),s}_addChildrenToFlatListIfExpanded(e,t,r,s,o,n){return t.expanded&&t.childNodes.length&&(o.containsNode(t.parentNode)||o.length()>1?r=o.insertAt():r=this._findInsertPositionInFlatList(t),r+=e,o=this._addChildrenToFlatList(t,r,s,o,n)),o}_showNodes(e){return this.viewRangeRendered.from+this.viewRangeSize>=e.lastBatchInsertIndex()&&this.viewRangeRendered.from<=e.lastBatchInsertIndex()}_findInsertPositionInFlatList(e){let t,r=e.parentNode;r?t=r.childNodes:t=this.nodes;let s=e,o=t.filter(m=>Boolean(this.visibleNodesMap[m.id])||m===s);if(o.length===0)return this._findPositionInFlatList(r)+1;let n=o.indexOf(e);if(n===0)return this._findPositionInFlatList(r)+1;let l=o[n-1],d=this._findPositionInFlatList(l);if(d===-1)return this._findPositionInFlatList(r)+1;let h,p;for(h=d;h<this.visibleNodesFlat.length;h++)if(p=this.visibleNodesFlat[h],!this._isInSameSubTree(l,p))return h;return this.visibleNodesFlat.length}_findPositionInFlatList(e){return this.visibleNodesFlat.indexOf(e)}_isInSameSubTree(e,t){do{if(t===e||t.parentNode===e)return!0;t=t.parentNode}while(t);return!1}isChildOfSelectedNodes(e){for(;e;){if(this.selectedNodes.indexOf(e.parentNode)>-1)return!0;e=e.parentNode}return!1}newInsertBatch(e){return{insertNodes:[e,0],$animationWrapper:null,lastBatchInsertIndex:function(){return this.isEmpty()?this.insertAt():this.insertAt()+this.insertNodes.length-3},nextBatchInsertIndex:function(){return this.lastBatchInsertIndex()+(this.isEmpty()?1:2)},isEmpty:function(){return this.insertNodes.length===2},length:function(){return this.insertNodes.length-2},insertAt:function(){return this.insertNodes[0]},setInsertAt:function(t){this.insertNodes[0]=t},containsNode:function(t){return this.insertNodes.indexOf(t)!==-1}}}checkAndHandleBatchAnimationWrapper(e,t,r){if(t&&this.viewRangeRendered.from<=r.lastBatchInsertIndex()&&this.viewRangeRendered.to>=r.lastBatchInsertIndex()&&!r.$animationWrapper){let o=r.lastBatchInsertIndex()-1,n=this.viewRangeRendered.from===r.lastBatchInsertIndex()?null:this.visibleNodesFlat[o];if(n&&o>=this.viewRangeRendered.from&&o<this.viewRangeRendered.to&&!n.attached&&this.showNode(n,!1,o),n&&n.attached)r.$animationWrapper=a()('<div class="animation-wrapper">').insertAfter(n.$node);else if(e.attached)r.$animationWrapper=a()('<div class="animation-wrapper">').insertAfter(e.$node);else if(this.$fillBefore)r.$animationWrapper=a()('<div class="animation-wrapper">').insertAfter(this.$fillBefore);else{let l=this.visibleNodesFlat[r.lastBatchInsertIndex()];r.$animationWrapper=a()('<div class="animation-wrapper">').insertBefore(l.$node)}r.animationCompleteFunc=s,this._$expandAnimationWrappers.push(r.$animationWrapper)}function s(){r.$animationWrapper.replaceWith(r.$animationWrapper.contents()),f.remove(this._$expandAnimationWrappers,r.$animationWrapper),r.$animationWrapper=null,this.runningAnimationsFinishFunc()}}checkAndHandleBatch(e,t,r){return this.viewRangeRendered.from-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!1,!1),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),this.checkAndHandleBatchAnimationWrapper(t,r,e),this.viewRangeRendered.from+this.viewRangeSize-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!0,r),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),e}insertBatchInVisibleNodes(e,t,r){if(!e.isEmpty())if(this.visibleNodesFlat.splice(...e.insertNodes),t){let s=e.insertAt();for(let o=2;o<e.insertNodes.length;o++){let n=e.insertNodes[o];this.showNode(n,!1,s),e.$animationWrapper&&e.$animationWrapper.append(n.$node),s++}if(e.$animationWrapper){let o=e.$animationWrapper.outerHeight();e.$animationWrapper.css("height",0).animate({height:o},{start:this.startAnimationFunc,complete:e.animationCompleteFunc.bind(this),step:()=>this.revalidateLayoutTree(),duration:200,queue:!1})}}else e.$animationWrapper&&e.animationCompleteFunc&&e.animationCompleteFunc.call(this)}_addToVisibleFlatListNoCheck(e,t,r){f.insert(this.visibleNodesFlat,e,t),this.visibleNodesMap[e.id]=!0,this.showNode(e,r,t)}scrollTo(e,t){this.viewRangeRendered.size()!==0&&(e.attached||this._renderViewRangeForNode(e),e.attached&&x.scrollTo(this.$data,e.$node,t))}revealSelection(){if(!this.rendered){this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this));return}this.selectedNodes.length>0&&(this.visibleNodesMap[this.selectedNodes[0].id]||this._expandAllParentNodes(this.selectedNodes[0]),this.scrollTo(this.selectedNodes[0]),this.ensureExpansionVisible(this.selectedNodes[0]))}ensureExpansionVisible(e){!e||!e.$node||this.selectedNodes[0]!==e||x.ensureExpansionVisible({element:e,$element:e.$node,$scrollable:this.get$Scrollable(),isExpanded:t=>t.expanded,getChildren:t=>t.childNodes,nodePaddingLevel:this.nodePaddingLevel,defaultChildHeight:this.nodeHeight})}deselectAll(){this.selectNodes([])}selectNode(e,t){this.selectNodes(e,t)}selectNodes(e,t){e=f.ensure(e),!f.equalsIgnoreOrder(e,this.selectedNodes)&&(this.rendered&&(this._rememberScrollTopBeforeSelection(),this._removeSelection()),this.prevSelectedNode&&(this.prevSelectedNode.prevSelectionAnimationDone=!1),this.prevSelectedNode=this.selectedNodes[0],this._setSelectedNodes(e,t),this.rendered&&(this._renderSelection(),this._updateScrollTopAfterSelection()))}_rememberScrollTopBeforeSelection(){this.isBreadcrumbStyleActive()?this.selectedNodes.length>0&&(this.scrollTopHistory[this.selectedNodes[0].level]=this.$data[0].scrollTop):this.scrollTopHistory=[]}_updateScrollTopAfterSelection(){if(!this.isBreadcrumbStyleActive())return;let e=-1;this.selectedNodes.length>0&&(e=this.selectedNodes[0].level),this.scrollTopHistory.splice(e+1);let t=this.scrollTopHistory[e];t>=0&&this.setScrollTop(t)}_setSelectedNodes(e,t){this.selectedNodes=e.slice(),this._nodesSelectedInternal(e),this._triggerNodesSelected(t),this.selectedNodes.length>0&&!this.visibleNodesMap[this.selectedNodes[0].id]&&this._expandAllParentNodes(this.selectedNodes[0]),this._updateItemPath(!0),this.isBreadcrumbStyleActive()&&(this.selectedNodes.length>0&&!this.selectedNodes[0].expanded&&(this.expandNode(this.selectedNodes[0]),this.selectedNodes[0].filterDirty=!0),this.filter()),this.session.onRequestsDone(this._updateMenuBar.bind(this))}_nodesSelectedInternal(e){}deselectNode(e){this.deselectNodes(e)}deselectNodes(e,t){e=f.ensure(e),t=t||{},t.collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.selectedNodes)));let r=this.selectedNodes.slice();f.removeAll(r,e)&&this.selectNodes(r)}isNodeSelected(e){return this.selectedNodes.indexOf(e)>-1}_computeNodePaddingLeft(e){if(this._computeNodePaddings(),this.isBreadcrumbStyleActive())return this.nodePaddingLeft;let t=this.nodePaddingLeft+this._computeNodePaddingLeftForLevel(e);return this.checkable&&(t+=this.nodeCheckBoxPaddingLeft),t}_computeNodeControlPaddingLeft(e){return this.nodeControlPaddingLeft+this._computeNodePaddingLeftForLevel(e)}_computeNodePaddingLeftForLevel(e){if(this.checkable||!this.nodePaddingLevelDiffParentHasIcon)return e.level*this.nodePaddingLevel;let t=0,r=e.parentNode;for(;r;)t+=this.nodePaddingLevel,r.iconId&&!r.childNodes[0].iconId&&(t+=this.nodePaddingLevelDiffParentHasIcon),r=r.parentNode;return t}_computeNodePaddings(){if(this.nodePaddingLeft!==null&&this.nodeControlPaddingLeft!==null&&this.nodePaddingLevelDiffParentHasIcon!==null)return;let e=this.$data.appendDiv("tree-node"),t=e.appendDiv("tree-node-control");this.nodePaddingLeft===null&&(this.nodePaddingLeft=e.cssPaddingLeft()),this.nodeControlPaddingLeft===null&&(this.nodeControlPaddingLeft=t.cssPaddingLeft()),this.nodePaddingLevelDiffParentHasIcon===null&&(this.nodePaddingLevelDiffParentHasIcon=this.$container.cssPxValue("--node-padding-level-diff-parent-has-icon")),e.remove()}_expandAllParentNodes(e){let t,r=e,s=[];r=e;let o=[];for(;r.parentNode;)s.push(r.parentNode),this.visibleNodesMap[r.id]||o.push(r),r=r.parentNode;for(t=s.length-1;t>=0;t--)o.indexOf(s[t])!==-1&&this._addToVisibleFlatList(s[t],!1),s[t].expanded||this.expandNode(s[t],{renderExpansion:!1,renderAnimated:!1});this.rendered&&o.length>0&&(this._rerenderViewport(),this.invalidateLayoutTree())}_updateChildNodeIndex(e,t){if(!(!e||!e.length))for(let r=u.nvl(t,0);r<e.length;r++)e[r].childNodeIndex=r}insertNode(e,t){this.insertNodes([e],t)}insertNodes(e,t){let r=f.ensure(e).slice();if(r.length===0)return;this.ensureTreeNodes(r);let s=r;if(t&&!(t instanceof ts))throw new Error("parent has to be a tree node: "+t);if(s.sort((o,n)=>o.childNodeIndex-n.childNodeIndex),t){if(t.childNodes&&t.childNodes.length>0?(s.forEach(o=>{t.childNodes.indexOf(o)<0&&f.insert(t.childNodes,o,o.childNodeIndex)}),this._updateChildNodeIndex(t.childNodes,s[0].childNodeIndex)):s.forEach(o=>t.childNodes.push(o)),this._initNodes(s,t),this.groupedNodes[t.id]&&this._updateItemPath(!1,t),this.rendered){let o={expansionChanged:!0};this._renderExpansion(t,o),this.ensureExpansionVisible(t)}}else this.nodes&&this.nodes.length>0?(s.forEach(o=>{this.nodes.indexOf(o)<0&&f.insert(this.nodes,o,o.childNodeIndex)}),this._updateChildNodeIndex(this.nodes,s[0].childNodeIndex)):f.pushAll(this.nodes,s),this._initNodes(s,t);this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()),this.trigger("nodesInserted",{nodes:s,parentNode:t})}updateNode(e){this.updateNodes([e])}updateNodes(e){if(e=f.ensure(e),e.length===0)return;let t=[];e.forEach(r=>{let s,o=this.nodesMap[r.id];r===o?s=!0:s=this._applyUpdatedNodeProperties(o,r),s&&(this.applyFiltersForNode(o),this._updateItemPath(!1,o.parentNode),this.rendered&&o._decorate()),t.push(o)}),this.trigger("nodesUpdated",{nodes:t})}_applyUpdatedNodeProperties(e,t){let r=!1;return e.leaf!==t.leaf&&(e.leaf=t.leaf,r=!0),e.enabled!==t.enabled&&(e.enabled=t.enabled,r=!0),e.lazyExpandingEnabled!==t.lazyExpandingEnabled&&(e.lazyExpandingEnabled=t.lazyExpandingEnabled,(!t.lazyExpandingEnabled||!this.lazyExpandingEnabled)&&(e.expandedLazy=!1),r=!0),r}deleteNode(e,t){this.deleteNodes([e],t)}deleteAllNodes(){this.deleteAllChildNodes()}deleteNodes(e,t){let r=[],s=[],o=[];e=f.ensure(e).slice(),e.length!==0&&(e.forEach(n=>{let l=t||n.parentNode;if(l){if(n.parentNode!==l)throw new Error("Unexpected parent. Node.parent: "+n.parentNode+", parentNode: "+t);f.remove(l.childNodes,n),s.indexOf(l)===-1&&s.push(l)}else f.remove(this.nodes,n),o=this.nodes;this._destroyTreeNode(n),r.push(n),this._updateMarkChildrenChecked(n,!1,!1),fe.visitNodes(this._destroyTreeNode.bind(this),n.childNodes)}),s.forEach(n=>this._updateChildNodeIndex(n.childNodes)),this._updateChildNodeIndex(o),this.deselectNodes(r,{collectChildren:!0}),this.uncheckNodes(r,{collectChildren:!0}),this.rendered&&this._removeNodes(r,t||s),this.trigger("nodesDeleted",{nodes:e,parentNode:t}))}_collectNodesIfDescendants(e,t){let r=[];return t.forEach(s=>{e.some(o=>o.isAncestorOf(s))&&r.push(s)}),r}deleteAllChildNodes(e){let t;e?(t=e.childNodes,e.childNodes=[]):(t=this.nodes,this.nodes=[]),fe.visitNodes(r.bind(this),t),this.deselectNodes(t,{collectChildren:!0}),this.uncheckNodes(t,{collectChildren:!0}),this.rendered&&this._removeNodes(t,e),this.trigger("allChildNodesDeleted",{parentNode:e});function r(s){this._destroyTreeNode(s),this._updateMarkChildrenChecked(s,!1,!1)}}updateNodeOrder(e,t){if(e=f.ensure(e),this._updateChildNodeIndex(e),t){if(t.childNodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");t.childNodes=e.slice(),this._removeChildrenFromFlatList(t,!1),t.expanded&&this._addChildrenToFlatList(t,null,!1)}else{if(this.nodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");this.nodes=e.slice(),this.nodes.forEach(r=>{this._removeFromFlatList(r,!1),this._addToVisibleFlatList(r,!1),r.expanded&&this._addChildrenToFlatList(r,null,!1)})}this.trigger("childNodeOrderChanged",{parentNode:t})}checkNode(e,t,r){let s=a().extend(r,{checked:t});this.checkNodes([e],s)}checkNodes(e,t){let r={checked:!0,checkOnlyEnabled:!0,checkChildren:this.autoCheckChildren,triggerNodesChecked:!0};a().extend(r,t);let s=[];!this.checkable||!this.enabledComputed&&r.checkOnlyEnabled||(e=f.ensure(e),e.forEach(o=>{if(!o.enabled&&r.checkOnlyEnabled||o.checked===r.checked||!o.filterAccepted){r.checkChildren&&this.checkNodes(o.childNodes,r);return}if(!this.multiCheck&&r.checked){for(let n=0;n<this.checkedNodes.length;n++)this.checkedNodes[n].checked=!1,this._updateMarkChildrenChecked(this.checkedNodes[n],!1,!1,!0),s.push(this.checkedNodes[n]);this.checkedNodes=[]}if(o.checked=r.checked,o.checked?this.checkedNodes.push(o):f.remove(this.checkedNodes,o),s.push(o),this._updateMarkChildrenChecked(o,!1,r.checked,!0),r.checkChildren){let n=a().extend({},r,{triggerNodesChecked:!1});this.checkNodes(o.childNodes,n)}}),r.triggerNodesChecked&&s.length>0&&this.trigger("nodesChecked",{nodes:s}),this.rendered&&s.forEach(o=>o._renderChecked()))}uncheckNode(e,t){let r=a().extend({checkOnlyEnabled:!0},t);this.uncheckNodes([e],r)}uncheckNodes(e,t){let r={checked:!1,collectChildren:!1};a().extend(r,t),r.collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.checkedNodes))),this.checkNodes(e,r)}_triggerNodesSelected(e){this.trigger("nodesSelected",{debounce:e})}_showContextMenu(e){let t=function(r){if(!this.rendered)return;let s=this._filterMenus(this.menus,kt.CONTEXT_MENU,!0),o=a()(r.currentTarget);s.length!==0&&(this.contextMenu&&this.contextMenu.close(),this.contextMenu=u.create(mt,{parent:this,menuItems:s,location:{x:r.pageX,y:r.pageY},$anchor:o,menuFilter:this._filterMenusHandler}),this.contextMenu.open())};this.session.onRequestsDone(t.bind(this),e)}_onNodeMouseDown(e){if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;let t=a()(e.currentTarget),r=t.data("node");if(!!this.hasNode(r))return this._$mouseDownNode=t,t.window().one("mouseup",()=>{this._$mouseDownNode=null}),this.selectNodes(r),this.checkable&&r.enabled&&this._isCheckboxClicked(e)&&(F.get().loosesFocusIfPseudoElementIsRemoved()&&this.focusAndPreventDefault(e),this.checkNode(r,!r.checked)),!0}_onNodeMouseUp(e){if(this._doubleClickSupport.doubleClicked())return!1;let t=a()(e.currentTarget),r=t.data("node");if(!(!this._$mouseDownNode||this._$mouseDownNode[0]!==t[0]))return this.trigger("nodeClick",{node:r}),!0}_isCheckboxClicked(e){return this.isTreeNodeCheckEnabled()?!0:a()(e.target).is(".check-box")}_updateItemPath(e,t){let r,s,o;if(e&&(this.groupedNodes={},this._inSelectionPathList={}),!t){if(r=this.selectedNodes,r.length===0)return;for(s=r[0],e&&(this._inSelectionPathList[s.id]=!0,s.childNodes&&s.childNodes.forEach(l=>{this._inSelectionPathList[l.id]=!0})),o=s.level;s.parentNode;){let l=s.parentNode;if(this._isGroupingEnd(l)&&!t&&(t=s,!e))break;e&&(this._inSelectionPathList[l.id]=!0),s=l}t=t||r[0],this.groupedNodes[t.id]=!0}s=t,s&&s.expanded&&this.groupedNodes[s.id]&&n.call(this,s.childNodes);function n(l){l.forEach(d=>{this.groupedNodes[d.id]=!0,d._decorate(),d.filterDirty&&this.applyFiltersForNode(d),d.expanded&&d.filterAccepted&&n.call(this,d.childNodes)})}}_isGroupingEnd(e){return!1}selectedNode(){return this.selectedNodes.length===0?null:this.selectedNodes[0]}$selectedNodes(){return this.$data.find(".selected")}$nodes(){return this.$data.find(".tree-node")}addFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.addFilter(e,t)}removeFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.removeFilter(e,t)}setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.setFilters(e,t)}filter(){this.filterSupport.filter()}_filter(){let e=[],t=[];return this.nodes.forEach(r=>{let s=this.applyFiltersForNode(r,!1,this.filterAnimated);e.push(...s.newlyHidden),t.push(...s.newlyShown)}),{newlyHidden:e,newlyShown:t}}updateFilteredElements(e,t){!this.filteredElementsDirty||(t.textFilterText&&this.nodesByIds(Object.keys(this.nodesMap)).filter(r=>r.filterAccepted).forEach(r=>this._expandAllParentNodes(r)),e.newlyShown.forEach(r=>this._addToVisibleFlatList(r,this.filterAnimated)),e.newlyHidden.forEach(r=>this._removeFromFlatList(r,this.filterAnimated)),this.filteredElementsDirty=!1)}filterVisibleNodes(e){let t=[];for(let r=this.visibleNodesFlat.length-1;r>=0;r--){let s=this.visibleNodesFlat[r],o=this._applyFiltersForNodeRec(s,!0,e);o.newlyHidden.length&&(s.filterAccepted||t.push(...o.newlyHidden),this.viewRangeDirty=!0)}t.forEach(r=>this._removeFromFlatList(r,e)),this._nodesFiltered(t)}_nodesFiltered(e){this.deselectNodes(e)}applyFiltersForNode(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._applyFiltersForNodeRec(e,!0,r),o=e.parentNode;for(;o;){let n=this._applyFiltersForNodeRec(o,!1,r);s.newlyHidden.unshift(...n.newlyHidden),s.newlyShown.unshift(...n.newlyShown),o=o.parentNode}return this._nodesFiltered(s.newlyHidden),t&&(s.newlyShown.forEach(n=>this._addToVisibleFlatList(n,r)),s.newlyHidden.forEach(n=>this._removeFromFlatList(n,r))),s}_applyFiltersForNodeRec(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[],o=[];r=r&&this.filterAnimated;let n=this._applyFiltersForNode(e),l=!1;return e.level<32&&(t?e.childNodes.forEach(d=>{let h=this._applyFiltersForNodeRec(d,!0,r);s.push(...h.newlyHidden),o.push(...h.newlyShown),l=l||d.filterAccepted}):e.filterAccepted||(l=e.childNodes.some(d=>d.filterAccepted))),!e.filterAccepted&&l&&(e.setFilterAccepted(!0),n=!n),n&&((e.filterAccepted?o:s).unshift(e),this.rendered&&(this.viewRangeDirty=!0)),{newlyHidden:s,newlyShown:o}}_applyFiltersForNode(e){let t=this.filterSupport.applyFiltersForElement(e);return(t||e.filterDirty)&&(e.filterDirty=!1,e.childNodes.forEach(r=>{r.filterDirty=!0})),t}_createFilterSupport(){return new Ho({widget:this,$container:()=>this.$container,filterElements:this._filter.bind(this),getElementText:e=>e.text})}setTextFilterEnabled(e){this.setProperty("textFilterEnabled",e)}isTextFilterFieldVisible(){return this.textFilterEnabled}_renderTextFilterEnabled(){this.filterSupport.renderFilterField()}_insertNodesInDOM(e,t){!this.rendered&&!this.rendering||(e=e.filter(r=>{let s=t===void 0?this.visibleNodesFlat.indexOf(r):t;return s===-1||!(this.viewRangeRendered.from+this.viewRangeSize>=s&&this.viewRangeRendered.from<=s&&this.viewRangeSize>0)||r.attached?!1:(r.rendered||this._renderNode(r),r._decorate(),this._insertNodeInDOMAtPlace(r,s),this.prevSelectedNode===r&&this._highlightPrevSelectedNode(),r.rendered=!0,r.attached=!0,!0)}),this._installNodes(e))}_installNodes(e){this.isHorizontalScrollingEnabled()&&e.forEach(t=>{t.$node.css("width","auto"),t.$node.css("display","inline-block")}),e.forEach(t=>{if(t.height=t.$node.outerHeight(!0),!this.isHorizontalScrollingEnabled())return;let r=t.$node.outerWidth(),s=t.width?t.width:0;s===this.maxNodeWidth&&r<this.maxNodeWidth?(this.maxNodeWidth=0,this.nodeWidthDirty=!0):r>this.maxNodeWidth?(this.maxNodeWidth=r,this.nodeWidthDirty=!0):r===s&&r===0&&(this.nodeWidthDirty=!0),t.width=r}),this.isHorizontalScrollingEnabled()&&e.forEach(t=>{this.nodeWidthDirty||t.$node.css("width",this.maxNodeWidth),t.$node.css("display","")})}_ensureNodeInDOM(e,t,r){e&&!e.attached&&e===this.visibleNodesFlat[r]&&r>=this.viewRangeRendered.from&&r<this.viewRangeRendered.to&&this.showNode(e,t,r)}_insertNodeInDOMAtPlace(e,t){let r=e.$node;if(t===0){this.$fillBefore?r.insertAfter(this.$fillBefore):this.$data.prepend(r);return}let s=this.visibleNodesFlat[t-1];if(this._ensureNodeInDOM(s,!1,t-1),s.attached){r.insertAfter(s.$node);return}if(t+1<this.visibleNodesFlat.length){let o=this.visibleNodesFlat[t+1];if(o.attached){r.insertBefore(o.$node);return}}this.$fillBefore?r.insertAfter(this.$fillBefore):this.$data.prepend(r)}showNode(e,t,r){if(!this.rendered||e.attached&&!e.$node.hasClass("hiding")||(e.attached||(this._ensureNodeInDOM(e.parentNode,t,r-1),this._insertNodesInDOM([e],r)),!e.rendered))return;let s=e.$node;if(s.is(".showing"))return;s.removeClass("hiding");let o=this;t&&(s.addClass("showing"),s.hide(),s.stop(!1,!0).slideDown({duration:250,start:o.startAnimationFunc,complete:()=>{o.runningAnimationsFinishFunc(),s.removeClass("showing")}}))}hideNode(e,t,r){if(!this.rendered||!e.attached)return;this.viewRangeDirty=!0;let s=this,o=e.$node;!o||o.is(".hiding")||(o.removeClass("showing"),t?(o.addClass("hiding"),this._renderViewportBlocked=!0,o.stop(!1,!0).slideUp({duration:250,start:s.startAnimationFunc,complete:()=>{s.runningAnimationsFinishFunc(),o.removeClass("hiding"),o.hasClass("showing")||(o.css("display",""),o.detach(),e.attached=!1)}})):r||(o.detach(),e.attached=!1,s.invalidateLayoutTree()))}nodesToIds(e){return e.map(t=>t.id)}nodesByIds(e){return e.map(t=>this.nodesMap[t])}nodeById(e){return this.nodesMap[e]}hasNode(e){return Boolean(this.nodeById(e.id))}_onNodeDoubleClick(e){if(this.isBreadcrumbStyleActive())return;let t=a()(e.currentTarget),r=t.data("node"),s=!t.hasClass("expanded");this.doNodeAction(r,s)}doNodeAction(e,t){this.trigger("nodeAction",{node:e}),this.checkable===!0&&this.isTreeNodeCheckEnabled()&&e.enabled||this.setNodeExpanded(e,t,{lazy:!1})}_onNodeControlMouseDown(e){if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;let t=a()(e.currentTarget).parent(),r=t.data("node"),s=!t.hasClass("expanded"),o={lazy:!1};if(t.hasClass("lazy"))if(e.ctrlKey||e.shiftKey)s=!1,o.collapseChildNodes=!0;else return this.expandNode(r,o),!1;return this.requestFocusOnNodeControlMouseDown&&this.focus(),this.selectNodes(r),this.setNodeExpanded(r,s,o),a().suppressEvent(e),!0}_onNodeControlMouseUp(e){return!1}_onNodeControlDoubleClick(e){return!1}_onContextMenu(e){e.preventDefault(),this._showContextMenu(e)}changeNode(e){this.applyFiltersForNode(e),this.rendered&&(e._decorate(),!!this.nodePaddingLevelDiffParentHasIcon&&!!this.visibleNodesMap[e.id]&&(e.expanded||!!e.parentNode)&&!this._changeNodeTaskScheduled&&(queueMicrotask(()=>{this._updateNodePaddingsLeft(),this._changeNodeTaskScheduled=!1}),this._changeNodeTaskScheduled=!0)),this.trigger("nodeChanged",{node:e})}_onDesktopPopupOpen(e){let t=e.popup;!this.isFocusable(!1)||this.has(t)&&t instanceof mt&&(this.$container.addClass("focused"),t.one("destroy",()=>{this.rendered&&this.$container.removeClass("focused")}))}updateScrollbars(){x.update(this.$data)}static collectSubtree(e,t){if(!e)return a()();let r=parseFloat(e.attr("data-level")),s=e.next();for(;s.length>0;){let n=parseFloat(s.attr("data-level"));if(isNaN(n)||n<=r)break;s=s.next()}let o=e.nextUntil(s);return(t===void 0||t)&&(o=o.add(e)),o}static visitNodes(e,t,r){let s,o;if(!!t)for(s=0;s<t.length;s++)o=t[s],!e(o,r)&&o.childNodes.length>0&&fe.visitNodes(e,o.childNodes,o)}}H(fe,"DisplayStyle",{DEFAULT:"default",BREADCRUMB:"breadcrumb"}),H(fe,"CheckableStyle",{CHECKBOX:"checkbox",CHECKBOX_TREE_NODE:"checkbox_tree_node"}),H(fe,"MenuTypes",{EmptySpace:"Tree.EmptySpace",SingleSelection:"Tree.SingleSelection",MultiSelection:"Tree.MultiSelection",Header:"Tree.Header"}),H(fe,"VIEW_RANGE_DIVISOR",4);class Rn extends He{constructor(){super(),this._addRemoteProperties(["displayStyle"])}_sendNodesSelected(e,t){let r={nodeIds:e};this._send("nodesSelected",r,{delay:t?250:0,coalesce:function(s){return this.target===s.target&&this.type===s.type}})}_onWidgetNodeClick(e){this._send("nodeClick",{nodeId:e.node.id})}_onWidgetNodeAction(e){this._send("nodeAction",{nodeId:e.node.id})}_onWidgetNodesSelected(e){let t=this.widget.nodesToIds(this.widget.selectedNodes);this._sendNodesSelected(t,e.debounce)}_onWidgetNodeExpanded(e){this._send("nodeExpanded",{nodeId:e.node.id,expanded:e.expanded,expandedLazy:e.expandedLazy})}_onWidgetNodesChecked(e){this._sendNodesChecked(e.nodes)}_sendNodesChecked(e){let t={nodes:[]};for(let r=0;r<e.length;r++)t.nodes.push({nodeId:e[r].id,checked:e[r].checked});this._send("nodesChecked",t)}_onWidgetEvent(e){e.type==="nodesSelected"?this._onWidgetNodesSelected(e):e.type==="nodeClick"?this._onWidgetNodeClick(e):e.type==="nodeAction"?this._onWidgetNodeAction(e):e.type==="nodeExpanded"?this._onWidgetNodeExpanded(e):e.type==="nodesChecked"?this._onWidgetNodesChecked(e):e.type==="drop"&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e):super._onWidgetEvent(e)}onModelAction(e){e.type==="nodesInserted"?this._onNodesInserted(e.nodes,e.commonParentNodeId):e.type==="nodesUpdated"?this._onNodesUpdated(e.nodes):e.type==="nodesDeleted"?this._onNodesDeleted(e.nodeIds,e.commonParentNodeId):e.type==="allChildNodesDeleted"?this._onAllChildNodesDeleted(e.commonParentNodeId):e.type==="nodesSelected"?this._onNodesSelected(e.nodeIds):e.type==="nodeExpanded"?this._onNodeExpanded(e.nodeId,e):e.type==="nodeChanged"?this._onNodeChanged(e.nodeId,e):e.type==="nodesChecked"?this._onNodesChecked(e.nodes):e.type==="childNodeOrderChanged"?this._onChildNodeOrderChanged(e.childNodeIds,e.parentNodeId):e.type==="requestFocus"?this._onRequestFocus():e.type==="scrollToSelection"?this._onScrollToSelection():super.onModelAction(e)}_onNodesInserted(e,t){let r;if(t!=null&&(r=this.widget.nodesMap[t],!r))throw new Error("Parent node could not be found. Id: "+t);this.widget.insertNodes(e,r)}_onNodesUpdated(e){this.widget.updateNodes(e)}_onNodesDeleted(e,t){let r;if(t!=null&&(r=this.widget.nodesMap[t],!r))throw new Error("Parent node could not be found. Id: "+t);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked");let s=this.widget.nodesByIds(e);this.widget.deleteNodes(s,r)}_onAllChildNodesDeleted(e){let t;if(e!=null&&(t=this.widget.nodesMap[e],!t))throw new Error("Parent node could not be found. Id: "+e);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked"),this.widget.deleteAllChildNodes(t)}_onNodesSelected(e){this.addFilterForWidgetEvent(r=>r.type==="nodesSelected"&&f.equals(e,this.widget.nodesToIds(this.widget.selectedNodes)));let t=this.widget.nodesByIds(e);this.widget.selectNodes(t)}_onNodeExpanded(e,t){let r=this.widget.nodesMap[e],s={lazy:t.expandedLazy},o=v.createMap();o[e]=!0,t.recursive&&fe.visitNodes(n=>{o[n.id]=!0},r.childNodes),this.addFilterForWidgetEvent(n=>n.type==="nodeExpanded"&&o[n.node.id]&&t.expanded===n.expanded&&t.expandedLazy===n.expandedLazy),this.widget.setNodeExpanded(r,t.expanded,s),t.recursive&&this.widget.setNodeExpandedRecursive(r.childNodes,t.expanded,s)}_onNodeChanged(e,t){let r=this.widget.nodesMap[e];Ve.applyTo(t,"TreeNode"),r.text=t.text,r.cssClass=t.cssClass,r.iconId=t.iconId,r.tooltipText=t.tooltipText,r.foregroundColor=t.foregroundColor,r.backgroundColor=t.backgroundColor,r.font=t.font,r.htmlEnabled=t.htmlEnabled,this.widget.changeNode(r)}_onNodesChecked(e){let t=[],r=[];e.forEach(s=>{let o=this.widget.nodeById(s.id);s.checked?t.push(o):r.push(o)}),this.addFilterForWidgetEventType("nodesChecked"),this.widget.checkNodes(t,{checked:!0,checkChildren:!1,checkOnlyEnabled:!1}),this.widget.uncheckNodes(r,{checkChildren:!1,checkOnlyEnabled:!1})}_onChildNodeOrderChanged(e,t){let r=this.widget.nodeById(t),s=this.widget.nodesByIds(e);this.widget.updateNodeOrder(s,r)}_onRequestFocus(){this.widget.focus()}_onScrollToSelection(){this.widget.revealSelection()}_initNodeModel(e){return e=e||{},e.objectType=u.nvl(e.objectType,this._getDefaultNodeObjectType()),Ve.applyTo(e),e}_getDefaultNodeObjectType(){return"TreeNode"}static _createTreeNodeRemote(e){return this.modelAdapter&&(e=this.modelAdapter._initNodeModel(e)),this._createTreeNodeOrig(e)}static modifyTreePrototype(){!ie.get().remote||v.replacePrototypeFunction(fe,"_createTreeNode",Rn._createTreeNodeRemote,!0)}}ie.addListener("bootstrap",Rn.modifyTreePrototype);function we(i,e,t){return e=lE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lE(i){var e=aE(i,"string");return typeof e=="symbol"?e:String(e)}function aE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ts{constructor(){we(this,"objectType",void 0),we(this,"checked",void 0),we(this,"childNodes",void 0),we(this,"cssClass",void 0),we(this,"enabled",void 0),we(this,"expanded",void 0),we(this,"expandedLazy",void 0),we(this,"htmlEnabled",void 0),we(this,"iconId",void 0),we(this,"id",void 0),we(this,"initialExpanded",void 0),we(this,"lazyExpandingEnabled",void 0),we(this,"leaf",void 0),we(this,"level",void 0),we(this,"parent",void 0),we(this,"parentNode",void 0),we(this,"session",void 0),we(this,"text",void 0),we(this,"tooltipText",void 0),we(this,"foregroundColor",void 0),we(this,"backgroundColor",void 0),we(this,"font",void 0),we(this,"initialized",void 0),we(this,"rendered",void 0),we(this,"attached",void 0),we(this,"destroyed",void 0),we(this,"filterAccepted",void 0),we(this,"filterDirty",void 0),we(this,"childrenLoaded",void 0),we(this,"childrenChecked",void 0),we(this,"height",void 0),we(this,"width",void 0),we(this,"displayBackup",void 0),we(this,"prevSelectionAnimationDone",void 0),we(this,"$node",void 0),we(this,"$text",void 0),we(this,"childNodeIndex",void 0),we(this,"_loadChildrenPromise",void 0),this.$node=null,this.$text=null,this.attached=!1,this.checked=!1,this.childNodes=[],this.childrenLoaded=!1,this.childrenChecked=!1,this.cssClass=null,this.destroyed=!1,this.enabled=!0,this.expanded=!1,this.expandedLazy=!1,this.filterAccepted=!0,this.filterDirty=!1,this.htmlEnabled=!1,this.iconId=null,this.id=null,this.initialized=!1,this.initialExpanded=!1,this.lazyExpandingEnabled=!1,this.leaf=!1,this.level=0,this.parent=null,this.parentNode=void 0,this.prevSelectionAnimationDone=!1,this.rendered=!1,this.session=null,this.text=null,this._loadChildrenPromise=null}init(e){let t=this._jsonModel();t&&(e=a().extend({},t,e)),this._init(e),e.initialExpanded===void 0&&(this.initialExpanded=this.expanded)}destroy(){this.destroyed||(this._destroy(),this.destroyed=!0)}_destroy(){}getTree(){return this.parent}_init(e){u.assertParameter("parent",e.parent,fe),this.session=e.session||e.parent.session,a().extend(this,e),Ce.resolveTextProperty(this,"text"),ve.resolveIconProperty(this,"iconId"),this.hasChildNodes()&&this.getTree().ensureTreeNodes(this.childNodes)}_jsonModel(){return null}reset(){this.$node&&(this.$node.remove(),this.$node=null),this.rendered=!1,this.attached=!1}hasChildNodes(){return this.childNodes.length>0}isAncestorOf(e){for(;e;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}isDescendantOf(e){return e===this.parentNode?!0:this.parentNode?this.parentNode.isDescendantOf(e):!1}setFilterAccepted(e){this.filterAccepted=e}loadChildren(){return a().resolvedPromise()}ensureLoadChildren(){if(this.childrenLoaded)return a().resolvedPromise();if(this._loadChildrenPromise)return this._loadChildrenPromise;let e=this.loadChildren();return e.state()==="resolved"?(this._loadChildrenPromise=null,e):(this._loadChildrenPromise=e,e.done(this._onLoadChildrenDone.bind(this)),e)}_onLoadChildrenDone(){this._loadChildrenPromise=null}setText(e){this.text=e}render(e,t){this.$node=e.makeDiv("tree-node").data("node",this).attr("data-nodeid",this.id).attr("data-level",this.level),v.isNullOrUndefined(t)||this.$node.cssPaddingLeft(t),this.$text=this.$node.appendSpan("text"),this._renderControl(),this.getTree().checkable&&this._renderCheckbox(),this._renderText(),this._renderIcon()}_renderText(){this.htmlEnabled?this.$text.html(this.text):this.$text.textOrNbsp(this.text)}_renderChecked(){!this.rendered||this.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("checked",this.checked)}_renderIcon(){this.$node.toggleClass("has-icon",!!this.iconId),this.$node.icon(this.iconId,e=>e.insertBefore(this.$text))}$icon(){return this.$node.children(".icon")}_renderControl(){let e=this.$node.prependDiv("tree-node-control");this._updateControl(e)}_updateControl(e){let t=this.getTree();e.toggleClass("checkable",t.checkable),e.cssPaddingLeft(t._computeNodeControlPaddingLeft(this)),e.setVisible(!this.leaf)}_renderCheckbox(){this.$node.prependDiv("tree-node-checkbox").appendDiv("check-box").toggleClass("checked",this.checked).toggleClass("disabled",!this.enabled).toggleClass("children-checked",!!this.childrenChecked)}_decorate(){if(!this.$node)return;let e=this.$node,t=this.getTree();e.attr("class",this._preserveCssClasses(e)),e.addClass(this.cssClass),e.toggleClass("leaf",!!this.leaf),e.toggleClass("expanded",!!this.expanded&&this.childNodes.length>0),e.toggleClass("lazy",e.hasClass("expanded")&&this.expandedLazy),e.toggleClass("group",!!t.groupedNodes[this.id]),e.setEnabled(!!this.enabled),e.children(".tree-node-control").setVisible(!this.leaf),e.children(".tree-node-checkbox").children(".check-box").toggleClass("disabled",!this.enabled),(!this.parentNode&&t.selectedNodes.length===0||t.isChildOfSelectedNodes(this))&&e.addClass("child-of-selected"),this._renderText(),this._renderIcon(),L.legacyStyle(this._getStyles(),e),this.parentNode&&this.parentNode.expandedLazy&&!this.parentNode.childNodes.some(s=>!!t.visibleNodesMap[s.id])&&this.parentNode.$node&&this.parentNode.$node.removeClass("lazy")}_getStyles(){return this}_preserveCssClasses(e){let t="tree-node";return e.isSelected()&&(t+=" selected"),e.hasClass("ancestor-of-selected")&&(t+=" ancestor-of-selected"),e.hasClass("parent-of-selected")&&(t+=" parent-of-selected"),t}}function xg(i,e,t){return e=dE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dE(i){var e=hE(i,"string");return typeof e=="symbol"?e:String(e)}function hE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class pl extends te{constructor(e){super(),xg(this,"tree",void 0),xg(this,"nodeDimensionsDirty",void 0),this.tree=e,this.nodeDimensionsDirty=!1}layout(e){this._layout(e),x.update(this.tree.$data)}_layout(e){let t=this.tree.menuBar,r=t.htmlComp,s=this.tree.htmlComp,o=s.availableSize({exact:!0}).subtract(s.insets());this.tree.toggleBreadcrumbStyleEnabled&&this._sizeChanged(s)&&this.tree.setBreadcrumbStyleActive(Math.floor(o.width)<=this.tree.breadcrumbTogglingThreshold);let n=0,l;t.$container.isVisible()&&(l=Zr.size(r,o),r.setSize(l),n+=l.height),e.css("--menubar-height",((l||{}).height||0)+"px"),this._setDataHeight(n),this.tree.setViewRangeSize(this.tree.calculateViewRangeSize()),this.nodeDimensionsDirty=this.nodeDimensionsDirty||this._sizeChanged(s),this.nodeDimensionsDirty&&(this.nodeDimensionsDirty=!1,this.tree.isHorizontalScrollingEnabled()?(this.tree.nodeWidthDirty=!0,this.tree.maxNodeWidth=0):(this.tree.updateNodeHeights(),this.tree._renderViewport(),this.tree._renderFiller())),s.layouted||this.tree._renderScrollTop(),this.tree._renderViewport(),s.layouted||this.tree._renderScrollTop()}_sizeChanged(e){return e.sizeCached&&Math.ceil(e.sizeCached.width)!==Math.ceil(e.size().width)}_setDataHeight(e){let t=this.tree.$data;e+=t.cssMarginTop()+t.cssMarginBottom(),t.css("height",e===0?"100%":"calc(100% - "+e+"px)")}preferredLayoutSize(e,t){return this.tree._renderViewport(),this.tree.htmlComp.layouted||(this.nodeDimensionsDirty=!0),w.prefSize(e,t)}}function uE(i,e,t){return e=cE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cE(i){var e=pE(i,"string");return typeof e=="symbol"?e:String(e)}function pE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class dc{constructor(e){uE(this,"tree",void 0),this.tree=e}accept(e){if(e.expanded||(e.childNodes.forEach(t=>{t._lazyNodeFilterAccepted=!1}),!e.parentNode||!e.parentNode.expandedLazy||!e.parentNode.lazyExpandingEnabled||!this.tree.lazyExpandingEnabled))return!0;for(let t=0;t<this.tree.selectedNodes.length;t++){let r=this.tree.selectedNodes[t];if(typeof r=="string")break;if(r===e)return e._lazyNodeFilterAccepted=!0,!0}return!!e._lazyNodeFilterAccepted}}function fE(i,e,t){return e=mE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function mE(i){var e=gE(i,"string");return typeof e=="symbol"?e:String(e)}function gE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hc{constructor(e){fE(this,"tree",void 0),this.tree=e}accept(e){return this.tree.selectedNodes.length===0?e.parentNode===void 0:this.tree.isNodeInBreadcrumbVisible(e)}}class is extends B{constructor(e,t){super(),this.field=e,this.repeatable=!0,this.stopPropagation=!0,this.renderingHints.hAlign=ht.RIGHT,this.ctrl=Se.isCtrl(t),this.shift=Se.isShift(t),this.alt=Se.isAlt(t),this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}_accept(e){return super._accept(e)?(this.field.selectedNodes.length>0&&(e._treeCurrentNode=this.field.selectedNodes[0],e._$treeCurrentNode=e._treeCurrentNode.$node),this.field.$container.addClass("keyboard-navigation"),!0):!1}handle(e){let t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t,!0)}_computeNewSelection(e){return[]}selectNodesAndReveal(e,t){this.field.selectNodes(e,t),this.field.revealSelection(),this.field.isFocused()||this.field.focus()}}class uc extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE],this.renderingHints.render=!1}_accept(e){return super._accept(e)&&this.field.checkable&&this.field.selectedNodes.length>0}handle(e){let t=this.field.selectedNodes.filter(s=>s.enabled),r=t.some(s=>!s.checked);t.forEach(s=>this.field.checkNode(s,r))}}class Ga extends is{constructor(e,t){super(e,t),this.which=[_.UP],this.renderingHints.text="↑",this.renderingHints.$drawingArea=(r,s)=>{let o=this._computeNewSelection(s._treeCurrentNode);if(o)return o.$node}}_computeNewSelection(e){let t=this.field.visibleNodesFlat;if(t.length!==0)return e?t[t.indexOf(e)-1]:f.last(t)}}class Ua extends is{constructor(e,t){super(e,t),this.which=[_.DOWN],this.renderingHints.text="↓",this.renderingHints.$drawingArea=(r,s)=>{let o=this._computeNewSelection(s._treeCurrentNode);if(o)return o.$node}}_computeNewSelection(e){let t=this.field.visibleNodesFlat;if(t.length!==0)return e?t[t.indexOf(e)+1]:t[0]}}class qa extends is{constructor(e,t){super(e,t),this.which=[_.END],this.renderingHints.$drawingArea=(r,s)=>{let o=this._computeNewSelection(s._treeCurrentNode);if(o)return o.$node}}handle(e){let t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t)}_computeNewSelection(e){let t=this.field.visibleNodesFlat;if(t.length!==0)return f.last(t)}}class cc extends is{constructor(e,t){super(e,t),this.which=[_.HOME],this.renderingHints.hAlign=ht.RIGHT,this.renderingHints.$drawingArea=(r,s)=>{if(this.field.visibleNodesFlat.length>0)return this.field.visibleNodesFlat[0].$node}}handle(e){this.field.collapseAll(),this.field.visibleNodesFlat.length>0&&this.selectNodesAndReveal(this.field.visibleNodesFlat[0])}}class Ya extends is{constructor(e,t){super(e,t),this.which=[_.SUBTRACT],this.renderingHints.text="-",this.renderingHints.$drawingArea=(r,s)=>{let o=s._treeCurrentNode;if(o.expanded)return o.$node;if(o.parentNode)return o.parentNode.$node}}_accept(e){let t=super._accept(e),r=e._treeCurrentNode;return t&&!!r&&(r.expanded||!!r.parentNode)}handle(e){let t=e._treeCurrentNode;t.expanded?this.field.collapseNode(t):t.parentNode&&this.selectNodesAndReveal(t.parentNode,!0)}}class ja extends is{constructor(e,t){super(e,t),this.which=[_.ADD],this.renderingHints.text="+",this.renderingHints.$drawingArea=(r,s)=>{let o=s._treeCurrentNode;if(this.isNodeExpandable(o))return o.$node;if(o.childNodes.length>0)return o.childNodes[0].$node}}_accept(e){let t=super._accept(e),r=e._treeCurrentNode;return t&&r&&(this.isNodeExpandable(r)||r.childNodes.length>0)}isNodeExpandable(e){return!e.expanded&&!e.leaf}handle(e){let t=e._treeCurrentNode;if(this.isNodeExpandable(t))this.field.expandNode(t,{lazy:!1});else{let r=t.childNodes.filter(function(s){return this.field.visibleNodesFlat.indexOf(s)>-1},this);r.length>0&&this.selectNodesAndReveal(r[0],!0)}}}function _E(i,e,t){return e=bE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bE(i){var e=yE(i,"string");return typeof e=="symbol"?e:String(e)}function yE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fg extends fe{constructor(){super(),_E(this,"$nodesContainer",void 0),this._scrollDirections="y"}_initTreeKeyStrokeContext(){this.keyStrokeContext.registerKeyStrokes([new fc(this),new mc(this),new gc(this),new _c(this)])}_createTreeNode(e){return e=u.nvl(e,{}),e.parent=this,u.create(pc,e)}_render(){this.$container=this.$parent.appendDiv("compact-tree");let e=new pl(this);this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(e),this.$data=this.$container.appendDiv("tree-data"),this._installScrollbars({borderless:!0}),this.menuBar=u.create(ce,{parent:this,menuOrder:new sn(this.session,"Tree")}),this.menuBar.render(),this.$nodesContainer=this.$data.appendDiv("nodes"),this._updateNodeDimensions(),this._renderViewport(),this.invalidateLayoutTree()}_calculateCurrentViewRange(){return this.viewRangeSize=this.visibleNodesFlat.length,new O(0,Math.max(this.visibleNodesFlat.length,0))}calculateViewRangeSize(){return this.visibleNodesFlat.length}_insertNodeInDOMAtPlace(e,t){let r=this.visibleNodesFlat[t-1],s;if(!r)e.$node.prependTo(this.$nodesContainer);else if(r.level<e.level)e.$node.insertAfter(r.$node.children()[0]);else{s=r.$node;for(let o=0;o<r.level-e.level;o++)s=s.parent();e.$node.insertAfter(s)}}selectNodes(e,t){let r=[];e=f.ensure(e),e.forEach(s=>{s.isSection()?s.childNodes.length>0&&r.push(s.childNodes[0]):r.push(s)}),super.selectNodes(r,t)}_renderExpansion(e,t){}_updateItemPath(e,t){}}class pc extends ts{render(e,t){let r=this.getTree();if(this.isSection()){let s=r.$container.makeDiv("section expanded").data("node",this);s.appendDiv("title").text(this.text),this.$node=s}else{let s=this.parentNode.$node;this.$node=s.makeDiv("section-node").data("node",this).on("mousedown",r._onNodeMouseDown.bind(r)).on("mouseup",r._onNodeMouseUp.bind(r))}}_decorate(){if(!this.$node)return;let e,t=this.$node;t.hasClass("section")?(t=t.children("title"),e="title"):(e="section-node",t.isSelected()&&(e+=" selected")),t.removeClass(),t.addClass(e),t.addClass(this.cssClass),t.text(this.text),L.legacyStyle(this,t),y.hasText(this.tooltipText)&&t.attr("title",this.tooltipText)}isSection(){return this.level===0}}class dn extends B{constructor(e){super(),this.repeatable=!0,this.field=e,this.keyStrokeMode=B.Mode.DOWN}_accept(e){if(!super._accept(e)||!this.field.nodes||!this.field.nodes.length)return!1;let r=this.field.$nodesContainer.find(".section-node.selected"),s=r.data("node"),o=this._findNextNode(r,s);return o?(e._nextNode=o,!0):!1}handle(e){this.field.selectNodes(e._nextNode),this.field.checkNode(e._nextNode,!0)}_findNextNode(e,t){throw new Error("method must be overwritten by subclass")}}class fc extends dn{constructor(e){super(e),this.which=[_.UP],this.renderingHints.text="↑"}_findNextNode(e,t){return t?e.prev(".section-node").data("node")||e.parent().prev(".section").children(".section-node").last().data("node"):f.last(f.last(this.field.nodes).childNodes)}}class mc extends dn{constructor(e){super(e),this.which=[_.DOWN],this.renderingHints.text="↓"}_findNextNode(e,t){return t?e.next(".section-node").data("node")||e.parent().next(".section").children(".section-node").first().data("node"):f.first(f.first(this.field.nodes).childNodes)}}class gc extends dn{constructor(e){super(e),this.renderingHints.text="←",this.which=[_.LEFT]}_findNextNode(e,t){return e.parent().prev(".section").children(".section-node").first().data("node")||e.parent().children(".section-node").not(e).first().data("node")}}class _c extends dn{constructor(e){super(e),this.renderingHints.text="→",this.which=[_.RIGHT]}_findNextNode(e,t){return e.parent().next(".section").children(".section-node").first().data("node")}}function vE(i,e){let t=i.is("div");if(arguments.length===2)t?i.text(e):i.val(e);else return t?i.text():i.val()}const ee={makeTextField(i,e){return i.makeElement("<input>",e).attr("type","text").attr("autocomplete","NoAutocomplete").disableSpellcheck()},appendIcon(i,e){let t=i.appendSpan("icon unfocusable text-field-icon");return e&&t.addClass(e),t},initTouch(i,e){i.embedded=u.nvl(e.embedded,!1),i.touchMode=u.nvl(e.touchMode,F.get().supportsOnlyTouch())},valOrText:vE,makeInputOrDiv(i,e){return i.touchMode?ee.makeInputDiv(i,e):ee.makeTextField(i.$container,e)},makeInputDiv(i,e){return i.$container.makeDiv(y.join(" ","input-field",e))},handleOnClick(i){return i.enabledComputed&&!i.embedded&&!i.popup},activateFirstField(i,e){let t=ke.findFirstFocusableWidget(e,i);t&&t.activate()},linkElementWithLabel(i,e){let t=e.attr("id");t||(t=ke.createUniqueId("lbl"),e.attr("id",t));let r=i.attr("aria-labelledby")||"";r&&(t+=" "+r),i.attr("aria-labelledby",t)},eventOutsideProposalField(i,e){let t=o(i.$field,e)||o(i.$icon,e)||o(i.$clearIcon,e),r=n(i.popup,e),s=n(i.tooltip(),e);return!t&&!r&&!s;function o(l,d){return l&&l.isOrHas(d)}function n(l,d){return l&&l.rendered&&l.$container.isOrHas(d)}},selectAllParentTabsOf(i){!i||!(i instanceof M)||i.visitParentFields(ee.selectIfIsTab)},selectIfIsTab(i){!i||!(i instanceof Tp)||i.select()},adjustStatusPositionForScrollShadow(i,e){i.htmlComp&&(i.htmlComp.suppressInvalidate=!0),e()?ke.preserveAndSetProperty(()=>i.setStatusPosition(M.StatusPosition.TOP),()=>i.statusPosition,i,"_statusPositionOrig"):ke.resetProperty(t=>i.setStatusPosition(t),i,"_statusPositionOrig"),i.htmlComp&&(i.htmlComp.suppressInvalidate=!1)}};function wE(i,e,t){return e=TE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function TE(i){var e=SE(i,"string");return typeof e=="symbol"?e:String(e)}function SE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hn extends B{constructor(e,t){super(),wE(this,"appLinkTriggerFunction",void 0),this.field=e,this.appLinkTriggerFunction=t,this.which=[_.SPACE],this.renderingHints.render=!1}_accept(e){return super._accept(e)&&a()(e.target).hasClass("app-link")}handle(e){this.appLinkTriggerFunction.call(this.field,e)}}function kr(i,e,t){return e=CE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CE(i){var e=PE(i,"string");return typeof e=="symbol"?e:String(e)}function PE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Xa extends I{constructor(){super(),kr(this,"autoRemove",void 0),kr(this,"status",void 0),kr(this,"position",void 0),kr(this,"menus",void 0),kr(this,"tooltip",void 0),kr(this,"contextMenu",void 0),kr(this,"updating",void 0),kr(this,"_parents",void 0),kr(this,"_parentPropertyChangeListener",void 0),kr(this,"_parentHierarchyChangeListener",void 0),this.tooltip=null,this.contextMenu=null,this.status=null,this.updating=!1,this.autoRemove=!0,this.position=M.StatusPosition.DEFAULT,this._parents=[],this._parentPropertyChangeListener=this._onParentPropertyChange.bind(this),this._parentHierarchyChangeListener=this._onParentHierarchyChange.bind(this)}_render(){this.$container=this.$parent.appendSpan("status").on("mousedown",this._onStatusMouseDown.bind(this)),this.htmlComp=S.install(this.$container,this.session)}_remove(){super._remove(),this.tooltip&&(this.tooltip.destroy(),this.tooltip=null),this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null),this._removeParentListeners()}_renderProperties(){super._renderProperties(),this._renderPosition()}update(e,t,r,s){this.updating=!0,this.setStatus(e),this.setMenus(t),this.setAutoRemove(r),this.updating=!1,this._updatePopup(s)}clearStatus(){this.setStatus(null)}setStatus(e){this.setProperty("status",e)}_setStatus(e){e=E.ensure(e),this._setProperty("status",e)}_renderStatus(){this.updating||this._updatePopup()}setPosition(e){this.setProperty("position",e)}_renderPosition(){this.$container.toggleClass("top",this.position===M.StatusPosition.TOP),this.invalidateLayoutTree()}_renderVisible(){super._renderVisible(),this.visible||this.hidePopup()}setMenus(e){this.setProperty("menus",f.ensure(e))}_renderMenus(){this.updating||this._updatePopup()}setAutoRemove(e){this.setProperty("autoRemove",e)}_renderAutoRemove(){this.updating||this._updatePopup()}hideTooltip(){this.tooltip&&(this.trigger("hideTooltip").defaultPrevented||(this.tooltip.destroy(),this._removeParentListeners()))}_updatePopup(e){this._requiresTooltip()||this.hideTooltip(),f.empty(this.menus)&&this.hideContextMenu(),e===!0?this.showTooltip():e===!1&&this.hideTooltip()}_requiresTooltip(){return!(!this.status||!this.rendered||f.empty(this.menus)&&!y.hasText(this.status.message))}showTooltip(){!this._requiresTooltip()||this.trigger("showTooltip").defaultPrevented||(this._updateParentListeners(),this.hideContextMenu(),this.tooltip&&this.tooltip.autoRemove!==this.autoRemove&&this.hideTooltip(),this.tooltip?(this.tooltip.setText(this.status.message),this.tooltip.setSeverity(this.status.severity),this.tooltip.setMenus(this.menus)):(this.tooltip=u.create(lr,{parent:this,$anchor:this.$container,text:this.status.message,severity:this.status.severity,autoRemove:this.autoRemove,menus:this.menus}),this.tooltip.render(),this.$container.addClass("selected"),this.tooltip.one("destroy",()=>{this.tooltip=null,this.$container&&this.$container.removeClass("selected")})))}hideContextMenu(){this.contextMenu&&this.contextMenu.close()}showContextMenu(){f.empty(this.menus)||(this.hidePopup(),this.contextMenu&&this.contextMenu.isRemovalPending()&&this.contextMenu.removeImmediately(),this.contextMenu=u.create(mt,{parent:this,$anchor:this.$container,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1}),this.contextMenu.open(),this.$container.addClass("selected"),this.contextMenu.one("destroy",()=>{this.contextMenu=null,this.$container&&this.$container.removeClass("selected")}))}hidePopup(){this.hideTooltip(),this.hideContextMenu()}togglePopup(){if(this.status){this.hideContextMenu(),this.toggleTooltip();return}f.empty(this.menus)?this.hidePopup():(this.hideTooltip(),this.session.onRequestsDone(()=>{!this.rendered||this.toggleContextMenu()}))}toggleTooltip(){this.tooltip?this.hideTooltip():this.showTooltip()}toggleContextMenu(){this.contextMenu?this.hideContextMenu():this.showContextMenu()}_onStatusMouseDown(e){this.trigger("statusMouseDown",e).defaultPrevented||this.togglePopup()}_updateTooltipVisibility(e){this.isEveryParentVisible()?setTimeout(()=>{!this.rendered||!this.isEveryParentVisible()||this.tooltip&&!this.tooltip.rendered&&this.tooltip.render()}):this.tooltip&&this.tooltip.rendered&&this.tooltip.remove()}_onParentHierarchyChange(e){this._updateParentListeners()}_onParentPropertyChange(e){e.propertyName==="visible"&&this._updateTooltipVisibility(e.source)}_removeParentListeners(){this._parents.forEach(e=>{e.off("hierarchyChange",this._parentHierarchyChangeListener),e.off("propertyChange",this._parentPropertyChangeListener)}),this._parents=[]}_updateParentListeners(){this._removeParentListeners();let e=this.parent;for(;e;)e.on("hierarchyChange",this._parentHierarchyChangeListener),e.on("propertyChange",this._parentPropertyChangeListener),this._parents.push(e),e=e.parent}}function z(i,e,t){return e=xE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xE(i){var e=FE(i,"string");return typeof e=="symbol"?e:String(e)}function FE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class M extends I{constructor(){super(),z(this,"dropType",void 0),z(this,"dropMaximumSize",void 0),z(this,"empty",void 0),z(this,"errorStatus",void 0),z(this,"fieldStyle",void 0),z(this,"gridData",void 0),z(this,"gridDataHints",void 0),z(this,"mode",void 0),z(this,"fieldStatus",void 0),z(this,"keyStrokes",void 0),z(this,"displayText",void 0),z(this,"label",void 0),z(this,"labelVisible",void 0),z(this,"labelPosition",void 0),z(this,"labelWidthInPixel",void 0),z(this,"labelUseUiWidth",void 0),z(this,"labelHtmlEnabled",void 0),z(this,"mandatory",void 0),z(this,"statusMenuMappings",void 0),z(this,"menus",void 0),z(this,"menusVisible",void 0),z(this,"defaultMenuTypes",void 0),z(this,"preventInitialFocus",void 0),z(this,"requiresSave",void 0),z(this,"statusPosition",void 0),z(this,"statusVisible",void 0),z(this,"suppressStatus",void 0),z(this,"touched",void 0),z(this,"tooltipText",void 0),z(this,"font",void 0),z(this,"foregroundColor",void 0),z(this,"backgroundColor",void 0),z(this,"labelFont",void 0),z(this,"labelForegroundColor",void 0),z(this,"labelBackgroundColor",void 0),z(this,"tooltipAnchor",void 0),z(this,"onFieldTooltipOptionsCreator",void 0),z(this,"dragAndDropHandler",void 0),z(this,"disabledCopyOverlay",void 0),z(this,"$label",void 0),z(this,"$field",void 0),z(this,"$clearIcon",void 0),z(this,"$fieldContainer",void 0),z(this,"$icon",void 0),z(this,"$pseudoStatus",void 0),z(this,"$status",void 0),z(this,"$mandatory",void 0),z(this,"$disabledCopyOverlay",void 0),z(this,"_menuPropertyChangeHandler",void 0),this.dropType=0,this.dropMaximumSize=Ae.DEFAULT_DROP_MAXIMUM_SIZE,this.empty=!0,this.errorStatus=null,this.fieldStyle=M.DEFAULT_FIELD_STYLE,this.gridData=null,this.gridDataHints=new ze,this.mode=M.Mode.DEFAULT,this.keyStrokes=[],this.label=null,this.labelVisible=!0,this.labelPosition=M.LabelPosition.DEFAULT,this.labelWidthInPixel=0,this.labelUseUiWidth=!1,this.labelHtmlEnabled=!1,this.mandatory=!1,this.statusMenuMappings=[],this.menus=[],this.menusVisible=!0,this.defaultMenuTypes=[],this.preventInitialFocus=!1,this.requiresSave=!1,this.statusPosition=M.StatusPosition.DEFAULT,this.statusVisible=!0,this.suppressStatus=null,this.touched=!1,this.tooltipText=null,this.tooltipAnchor=M.TooltipAnchor.DEFAULT,this.onFieldTooltipOptionsCreator=null,this.$label=null,this.$field=null,this.$fieldContainer=null,this.$icon=null,this.$status=null,this.disabledCopyOverlay=!1,this.$disabledCopyOverlay=null,this._addWidgetProperties(["keyStrokes","menus","statusMenuMappings"]),this._addCloneProperties(["dropType","dropMaximumSize","errorStatus","fieldStyle","gridDataHints","gridData","label","labelVisible","labelPosition","labelWidthInPixel","labelUseUiWidth","mandatory","mode","preventInitialFocus","requiresSave","touched","statusVisible","statusPosition","statusMenuMappings","tooltipText","tooltipAnchor"]),this._menuPropertyChangeHandler=this._onMenuPropertyChange.bind(this)}_createKeyStrokeContext(){return new Oe}_createLoadingSupport(){return new rr({widget:this})}_init(e){super._init(e),this.resolveConsts([{property:"labelPosition",constType:M.LabelPosition}]),this.resolveTextKeys(["label","tooltipText"]),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setErrorStatus(this.errorStatus),this._setGridDataHints(this.gridDataHints),this._setGridData(this.gridData),this._updateEmpty()}_initProperty(e,t){e==="gridDataHints"?this._initGridDataHints(t):super._initProperty(e,t)}_initGridDataHints(e){e instanceof ze?this.gridDataHints=e:v.isPlainObject(e)?a().extend(this.gridDataHints,e):this.gridDataHints=e}_render(){this.addContainer(this.$parent),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addMandatoryIndicator(),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderMandatory(),this._renderTooltipText(),this._renderErrorStatus(),this._renderMenus(),this._renderLabel(),this._renderLabelVisible(),this._renderStatusVisible(),this._renderStatusPosition(),this._renderFont(),this._renderForegroundColor(),this._renderBackgroundColor(),this._renderLabelFont(),this._renderLabelForegroundColor(),this._renderLabelBackgroundColor(),this._renderGridData(),this._renderPreventInitialFocus(),this._renderFieldStyle()}_remove(){super._remove(),this._removeField(),this._removeStatus(),this._removeLabel(),this._removeIcon(),this.removeMandatoryIndicator(),this._removeDisabledCopyOverlay(),Ae.uninstallDragAndDropHandler(this)}setFieldStyle(e){this.setProperty("fieldStyle",e)}_renderFieldStyle(){if(this._renderFieldStyleInternal(this.$container),this._renderFieldStyleInternal(this.$fieldContainer),this._renderFieldStyleInternal(this.$field),this.rendered){let e=this.htmlComp.getParent();e&&e.invalidateLayoutTree(),this.invalidateLayoutTree()}}_renderFieldStyleInternal(e){!e||e.toggleClass("alternative",this.fieldStyle===M.FieldStyle.ALTERNATIVE)}setMandatory(e){this.setProperty("mandatory",e)}_renderMandatory(){this.$container.toggleClass("mandatory",this.mandatory)}_errorStatus(){return this.errorStatus}setErrorStatus(e){this.setProperty("errorStatus",e)}_setErrorStatus(e){e=E.ensure(e),this._setProperty("errorStatus",e)}addErrorStatus(e){if(typeof e=="string"&&(e=this._createErrorStatus(e)),!(e instanceof E))throw new Error("errorStatus is not a Status");let t=this._errorStatus();t?t=t.ensureChildren():t=E.ok("Root"),t.addStatus(e),this.setErrorStatus(t)}_createErrorStatus(e){return E.error(e)}containsStatus(e){return this.errorStatus?this.errorStatus.containsStatus(e):!1}setSuppressStatus(e){this.setProperty("suppressStatus",e)}_renderSuppressStatus(){this._renderErrorStatus()}_isSuppressStatusIcon(){return u.isOneOf(this.suppressStatus,M.SuppressStatus.ALL,M.SuppressStatus.ICON)}_isSuppressStatusField(){return u.isOneOf(this.suppressStatus,M.SuppressStatus.ALL,M.SuppressStatus.FIELD)}removeErrorStatus(e){this.removeErrorStatusByPredicate(t=>t instanceof e)}removeErrorStatusByPredicate(e){let t=this._errorStatus();if(!!t&&t.containsStatusByPredicate(e)){let r=t.clone();r.removeAllStatusByPredicate(e),r.hasChildren()?this.setErrorStatus(r):this.clearErrorStatus()}}clearErrorStatus(){this.setErrorStatus(null)}_renderErrorStatus(){let e=this._errorStatus(),t=!!e,r=t&&!this._isSuppressStatusField()?"has-"+e.cssClass():"";this._updateErrorStatusClasses(r,t),this._updateFieldStatus()}_updateErrorStatusClasses(e,t){this._updateErrorStatusClassesOnElement(this.$container,e,t),this._updateErrorStatusClassesOnElement(this.$field,e,t)}_updateErrorStatusClassesOnElement(e,t,r){!e||e.removeClass(M.SEVERITY_CSS_CLASSES).addClass(t)}setTooltipText(e){this.setProperty("tooltipText",e)}_renderTooltipText(){this._updateTooltip()}setTooltipAnchor(e){this.setProperty("tooltipAnchor",e)}_renderTooltipAnchor(){this._updateTooltip()}_updateTooltip(){let e=this.hasStatusTooltip();if(this.$container.toggleClass("has-tooltip",e),this.$field&&this.$field.toggleClass("has-tooltip",e),this._updateFieldStatus(),this.$fieldContainer)if(this.hasOnFieldTooltip()){let t=this.onFieldTooltipOptionsCreator||this._createOnFieldTooltipOptions;G.install(this.$fieldContainer,t.call(this))}else G.uninstall(this.$fieldContainer)}hasStatusTooltip(){return this.tooltipAnchor===M.TooltipAnchor.DEFAULT&&y.hasText(this.tooltipText)}hasOnFieldTooltip(){return this.tooltipAnchor===M.TooltipAnchor.ON_FIELD&&y.hasText(this.tooltipText)}setOnFieldTooltipOptionsCreator(e){this.onFieldTooltipOptionsCreator=e}_createOnFieldTooltipOptions(){return{parent:this,text:this.tooltipText,arrowPosition:50}}_renderVisible(){super._renderVisible(),this.rendered&&this._renderErrorStatus()}setLabel(e){this.setProperty("label",e)}_renderLabel(){let e=this.label;this.labelPosition===M.LabelPosition.ON_FIELD?(this._renderPlaceholder(),this.$label&&this.$label.text("")):this.$label&&(this._removePlaceholder(),this.$label.contentOrNbsp(this.labelHtmlEnabled,e,"empty").toggleClass("top",this.labelPosition===M.LabelPosition.TOP),(this.labelUseUiWidth||this.labelWidthInPixel===M.LabelWidth.UI)&&this.invalidateLayoutTree())}_renderEmptyLabel(){this.$label.html("&nbsp;").toggleClass("top",this.labelPosition===M.LabelPosition.TOP)}_renderPlaceholder(e){e=u.nvl(e,this.$field),e&&e.placeholder(this.label)}_removePlaceholder(e){e=u.nvl(e,this.$field),e&&e.placeholder("")}setLabelVisible(e){this.setProperty("labelVisible",e)}_renderLabelVisible(){let e=this.labelVisible;if(this._renderChildVisible(this.$label,e),this.$container.toggleClass("label-hidden",!e),this.rendered&&this.labelPosition===M.LabelPosition.TOP){let t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}setLabelWidthInPixel(e){this.setProperty("labelWidthInPixel",e)}_renderLabelWidthInPixel(){this.invalidateLayoutTree()}setLabelUseUiWidth(e){this.setProperty("labelUseUiWidth",e)}_renderLabelUseUiWidth(){this.invalidateLayoutTree()}setStatusVisible(e){this.setProperty("statusVisible",e)}_renderStatusVisible(){this._updateFieldStatus()}setStatusPosition(e){this.setProperty("statusPosition",e)}_renderStatusPosition(){this._updateFieldStatus()}tooltip(){return this.fieldStatus?this.fieldStatus.tooltip:null}_updateFieldStatus(){if(!this.fieldStatus)return;let e,t=this._errorStatus(),r=null,s=this._computeStatusVisible(),o=!0;if(this.fieldStatus.setPosition(this.statusPosition),this.fieldStatus.setVisible(s),!!s){if(t){if(this.mode===M.Mode.CELLEDITOR)return;r=t,o=!r.isError(),e=this._getMenusForStatus(t)}else this.hasStatusTooltip()?(r=u.create(E,{message:this.tooltipText,severity:E.Severity.INFO}),e=this.getContextMenuItems()):e=this.getContextMenuItems();this.fieldStatus.update(r,e,o,this._isInitialShowStatus())}}_isInitialShowStatus(){return!!this._errorStatus()}_computeStatusVisible(){let e=this._errorStatus(),t=this.statusVisible,r=!!e,s=this.hasStatusTooltip();return!this._isSuppressStatusIcon()&&this.visible&&(t||r||s||this._hasMenus()&&this.menusVisible)}_renderChildVisible(e,t){if(!!e&&e.isVisible()!==t)return e.setVisible(t),this.invalidateLayoutTree(),!0}setLabelPosition(e){this.setProperty("labelPosition",e)}_renderLabelPosition(){if(this._renderLabel(),this.rendered){let e=this.htmlComp.getParent();e&&e.invalidateLayoutTree(),this.invalidateLayoutTree()}}setLabelHtmlEnabled(e){this.setProperty("labelHtmlEnabled",e)}_renderLabelHtmlEnabled(){this._renderLabel()}_renderEnabled(){super._renderEnabled(),this.$field&&this.$field.setEnabled(this.enabledComputed),this._updateDisabledCopyOverlay(),this._installOrUninstallDragAndDropHandler()}_renderDisabledStyle(){this._renderDisabledStyleInternal(this.$container),this._renderDisabledStyleInternal(this.$fieldContainer),this._renderDisabledStyleInternal(this.$field),this._renderDisabledStyleInternal(this.$mandatory)}setFont(e){this.setProperty("font",e)}_renderFont(){L.legacyFont(this,this.$field)}setForegroundColor(e){this.setProperty("foregroundColor",e)}_renderForegroundColor(){L.legacyForegroundColor(this,this.$field)}setBackgroundColor(e){this.setProperty("backgroundColor",e)}_renderBackgroundColor(){L.legacyBackgroundColor(this,this.$field)}setLabelFont(e){this.setProperty("labelFont",e)}_renderLabelFont(){L.legacyFont(this,this.$label,"label")}setLabelForegroundColor(e){this.setProperty("labelForegroundColor",e)}_renderLabelForegroundColor(){L.legacyForegroundColor(this,this.$label,"label")}setLabelBackgroundColor(e){this.setProperty("labelBackgroundColor",e)}_renderLabelBackgroundColor(){L.legacyBackgroundColor(this,this.$label,"label")}setGridDataHints(e){this.setProperty("gridDataHints",e)}_setGridDataHints(e){e||(e=new ze),this._setProperty("gridDataHints",ze.ensure(e))}_renderGridDataHints(){this.parent.invalidateLogicalGrid()}_setGridData(e){e||(e=new ze),this._setProperty("gridData",ze.ensure(e))}_renderGridData(){if(this.rendered){let e=this.htmlComp.getParent();e&&e.invalidateLayoutTree()}}setMenus(e){this.setProperty("menus",e)}_setMenus(e){e=f.ensure(e),this.menus.forEach(t=>t.off("propertyChange",this._menuPropertyChangeHandler)),this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this.menus.forEach(t=>t.on("propertyChange",this._menuPropertyChangeHandler))}insertMenu(e){this.insertMenus([e])}insertMenus(e){if(e=f.ensure(e),e.length===0)return;let t=this.menus;this.setMenus(t.concat(e))}deleteMenu(e){this.deleteMenus([e])}deleteMenus(e){if(e=f.ensure(e),e.length===0)return;let t=this.menus.slice();f.removeAll(t,e),this.setMenus(t)}_onMenuPropertyChange(e){e.propertyName==="visible"&&this.rendered&&this._updateMenus()}getContextMenuItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this.getCurrentMenuTypes();return t.length?Ke.filter(this.menus,t,{onlyVisible:e,defaultMenuTypes:this.defaultMenuTypes}):e?this.menus.filter(r=>r.visible):this.menus}_getMenusForStatus(e){return this.statusMenuMappings.filter(t=>!t.menu||!t.menu.visible?!1:(t.codes.length===0||t.codes.indexOf(e.code)>-1)&&(t.severities.length===0||t.severities.indexOf(e.severity)>-1)).map(t=>t.menu)}_hasMenus(){return!!(this.menus&&this.getContextMenuItems().length>0)}_updateMenus(){!this.rendered&&!this.rendering||(this.$container.toggleClass("has-menus",this._hasMenus()&&this.menusVisible),this._updateFieldStatus())}_renderMenus(){this._updateMenus()}_renderStatusMenuMappings(){this._updateMenus()}setMenusVisible(e){this.setProperty("menusVisible",e)}_setMenusVisible(e){this._setProperty("menusVisible",e)}_renderMenusVisible(){this._updateMenus()}getCurrentMenuTypes(){return this._getCurrentMenuTypes()}_getCurrentMenuTypes(){return[]}_setKeyStrokes(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}_$tooltipParent(){}_hideStatusMessage(){this.fieldStatus&&this.fieldStatus.hideTooltip()}_renderPreventInitialFocus(){this.$container.toggleClass("prevent-initial-focus",!!this.preventInitialFocus)}focus(){if(!this.rendered)return this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1;if(!this.enabledComputed)return!1;let e=this.getFocusableElement();return e?this.session.focusManager.requestFocus(e):!1}getFocusableElement(){return this.rendered&&this.$field?this.$field[0]:null}_onFieldFocus(e){this.setFocused(!0)}_onFieldBlur(e){this.setFocused(!1)}activate(){if(!this.enabledComputed||!this.rendered)return;let e=this.getFocusableElement();e&&a().ensure(e).focus()}get$Scrollable(){return this.$field}getParentGroupBox(){let e=this.parent;for(;e&&!(e instanceof Fe);)e=e.parent;return e}getParentField(){return this.parent}addLabel(){this.$label=this.$container.appendElement("<label>"),G.installForEllipsis(this.$label,{parent:this}),this.$label.on("click",this._onLabelClick.bind(this))}_onLabelClick(e){!y.hasText(this.label)||this.activate()}_removeLabel(){!this.$label||(G.uninstall(this.$label),this.$label.remove(),this.$label=null)}_linkWithLabel(e){!this.$label||!e||ee.linkElementWithLabel(e,this.$label)}_removeIcon(){!this.$icon||(this.$icon.remove(),this.$icon=null)}addField(e){this.$fieldContainer||this.addFieldContainer(e),this.$field=e,this._linkWithLabel(e),this.$field.on("blur",this._onFieldBlur.bind(this)).on("focus",this._onFieldFocus.bind(this))}addFieldContainer(e){this.$fieldContainer=e.addClass("field"),(this.$container.has(e[0]).length===0||e.next().length>0)&&e.appendTo(this.$container)}_removeField(){this.$field&&(this.$field.remove(),this.$field=null),this.$fieldContainer&&(this.$fieldContainer.remove(),this.$fieldContainer=null)}addStatus(){this.fieldStatus||(this.fieldStatus=u.create(Xa,{parent:this,position:this.statusPosition,visible:this._computeStatusVisible()}),this.fieldStatus.render(),this.$status=this.fieldStatus.$container,this._updateFieldStatus())}_removeStatus(){!this.fieldStatus||(this.fieldStatus.destroy(),this.$status=null,this.fieldStatus=null)}addPseudoStatus(){this.$pseudoStatus=this.$container.appendSpan("status")}addMandatoryIndicator(){this.$mandatory=this.$container.appendSpan("mandatory-indicator")}removeMandatoryIndicator(){!this.$mandatory||(this.$mandatory.remove(),this.$mandatory=null)}addIcon(e){e||(e=this.$container),this.$icon=ee.appendIcon(e).on("mousedown",this._onIconMouseDown.bind(this))}_onIconMouseDown(e){!this.enabledComputed||this.$field.focus()}addContainer(e,t,r){this.$container=e.appendDiv("form-field"),t&&this.$container.addClass(t);let s=S.install(this.$container,this.session);s.setLayout(r||this._createLayout()),this.htmlComp=s}_createLayout(){return new li(this)}updateInnerAlignment(e){e=e||{};let t=e.$fieldContainer||this.$fieldContainer;this._updateElementInnerAlignment(e,t),t!==this.$container&&this._updateElementInnerAlignment(e,this.$container)}_updateElementInnerAlignment(e,t){e=e||{};let r=u.nvl(e.useHorizontalAlignment,!0),s=u.nvl(e.useVerticalAlignment,!0);if(!!t&&(t.removeClass("has-inner-alignment halign-left halign-center halign-right valign-top valign-middle valign-bottom"),r||s)){t.addClass("has-inner-alignment");let o=this.gridData;if(this.parent.logicalGrid&&(o=this.gridDataHints),r){let n=o.horizontalAlignment;t.addClass(n<0?"halign-left":n>0?"halign-right":"halign-center")}if(s){let n=o.verticalAlignment;t.addClass(n<0?"valign-top":n>0?"valign-bottom":"valign-middle")}this.invalidateLayout()}}addCellEditorFieldCssClasses(e,t){e.addClass("cell-editor-field").addClass(F.get().cssClassForEdge()),t.cssClass&&e.addClass(t.cssClass)}prepareForCellEdit(e){e=e||{},this.$mandatory&&this.removeMandatoryIndicator(),this.$status&&(this.$status.remove(),this.$status=null),this.$container&&this.$container.addClass("cell-editor-form-field"),this.$field&&this.addCellEditorFieldCssClasses(this.$field,e)}setDropType(e){this.setProperty("dropType",e)}_renderDropType(){this._installOrUninstallDragAndDropHandler()}setDropMaximumSize(e){this.setProperty("dropMaximumSize",e)}_installOrUninstallDragAndDropHandler(){Ae.installOrUninstallDragAndDropHandler(this._getDragAndDropHandlerOptions())}_getDragAndDropHandlerOptions(){return{target:this,doInstall:()=>this.dropType&&this.enabledComputed,container:()=>this.$field||this.$container,dropType:()=>this.dropType,onDrop:e=>this.trigger("drop",e)}}_updateDisabledCopyOverlay(){this.disabledCopyOverlay&&!F.get().supportsCopyFromDisabledInputFields()&&(this.enabledComputed?this._removeDisabledCopyOverlay():(this._renderDisabledCopyOverlay(),this.revalidateLayout()))}_renderDisabledCopyOverlay(){this.$disabledCopyOverlay||(this.$disabledCopyOverlay=this.$container.appendDiv("disabled-overlay").on("contextmenu",this._createCopyContextMenu.bind(this)))}_removeDisabledCopyOverlay(){this.$disabledCopyOverlay&&(this.$disabledCopyOverlay.remove(),this.$disabledCopyOverlay=null)}_createCopyContextMenu(e){if(!this.visible||y.empty(this.displayText))return;let t=u.create(le,{parent:this,text:this.session.text("ui.Copy"),inheritAccessibility:!1});t.on("action",s=>this.exportToClipboard()),u.create(mt,{parent:this,menuItems:[t],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}visitFields(e){return e(this)}visitParentFields(e){let t=this.parent;for(;t instanceof M;)e(t),t=t.parent}markAsSaved(){this.setProperty("touched",!1),this.updateRequiresSave()}touch(){this.setProperty("touched",!0),this.updateRequiresSave()}updateRequiresSave(){!this.initialized||(this.requiresSave=this.touched||this.computeRequiresSave())}computeRequiresSave(){return!1}getValidationResult(){let e=!this._errorStatus(),t=!this.mandatory||!this.empty;return{valid:e&&t,validByErrorStatus:e,validByMandatory:t,field:this,label:this.label,reveal:()=>{ee.selectAllParentTabsOf(this),this.focus()}}}_updateEmpty(){}requestInput(){this.enabledComputed&&this.rendered&&this.focus()}clone(e,t){let r=super.clone(e,t);return this._deepCloneProperties(r,"menus",t),r}exportToClipboard(){if(!this.displayText)return;let e=this.trigger("clipboardExport",{text:this.displayText});e.defaultPrevented||this._exportToClipboard(e.text)}_exportToClipboard(e){sr.copyText({parent:this,text:e})}}z(M,"FieldStyle",{CLASSIC:"classic",ALTERNATIVE:"alternative"}),z(M,"SuppressStatus",{ALL:"all",ICON:"icon",FIELD:"field"}),z(M,"DEFAULT_FIELD_STYLE",M.FieldStyle.ALTERNATIVE),z(M,"StatusPosition",{DEFAULT:"default",TOP:"top"}),z(M,"LabelPosition",{DEFAULT:0,LEFT:1,ON_FIELD:2,RIGHT:3,TOP:4,BOTTOM:5}),z(M,"TooltipAnchor",{DEFAULT:"default",ON_FIELD:"onField"}),z(M,"LabelWidth",{DEFAULT:0,UI:-1}),z(M,"FULL_WIDTH",0),z(M,"Mode",{DEFAULT:"default",CELLEDITOR:"celleditor"}),z(M,"SEVERITY_CSS_CLASSES","has-error has-warning has-info has-ok");function Eg(i,e,t){return e=EE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function EE(i){var e=AE(i,"string");return typeof e=="symbol"?e:String(e)}function AE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class dt extends He{constructor(){super(),Eg(this,"enabledWhenOffline",void 0),Eg(this,"_currentMenuTypes",void 0),this.enabledWhenOffline=!1,this._currentMenuTypes=[]}_initProperties(e){super._initProperties(e),this._currentMenuTypes=f.ensure(e.currentMenuTypes),delete e.currentMenuTypes}_syncCurrentMenuTypes(e){this._currentMenuTypes=f.ensure(e),this.widget._updateMenus()}_goOffline(){this.enabledWhenOffline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}_goOnline(){this.enabledWhenOffline||this.widget.setEnabled(this._enabledBeforeOffline)}_onWidgetEvent(e){e.type==="drop"&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e):super._onWidgetEvent(e)}static modifyFormFieldPrototype(){!ie.get().remote||v.replacePrototypeFunction(M,"getCurrentMenuTypes",dt.getCurrentMenuTypes,!0)}static getCurrentMenuTypes(){let e=this.modelAdapter;return e?e._currentMenuTypes:this.getCurrentMenuTypesOrig()}}ie.addListener("bootstrap",dt.modifyFormFieldPrototype);function ao(i,e,t){return e=DE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DE(i){var e=ME(i,"string");return typeof e=="symbol"?e:String(e)}function ME(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class li extends te{constructor(e){super(),ao(this,"formField",void 0),ao(this,"mandatoryIndicatorWidth",void 0),ao(this,"statusWidth",void 0),ao(this,"rowHeight",void 0),ao(this,"compactFieldWidth",void 0),ao(this,"htmlPropertyChangeHandler",void 0),this.formField=e,this._initDefaults(),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this.formField.one("remove",()=>{ue.get().off("propertyChange",this.htmlPropertyChangeHandler)})}_initDefaults(){this.mandatoryIndicatorWidth=ue.get().fieldMandatoryIndicatorWidth,this.statusWidth=ue.get().fieldStatusWidth,this.rowHeight=ue.get().formRowHeight,this.compactFieldWidth=li.COMPACT_FIELD_WIDTH}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this.formField.invalidateLayoutTree()}layout(e){let t,r,s=S.get(e),o=this.formField,n=o.tooltip(),l=this.labelWidth(),d=this.statusWidth,h=s.insets({includeBorder:!1}),p=h.top,m=h.right,g=h.bottom,b=h.left;if(this._isLabelVisible()){if((o.labelWidthInPixel===M.LabelWidth.UI||o.labelUseUiWidth)&&(o.$label.hasClass("empty")?l=0:l=w.prefSize(o.$label).width),u.isOneOf(o.labelPosition,M.LabelPosition.DEFAULT,M.LabelPosition.LEFT))w.setBounds(o.$label,b,p,l,this.rowHeight),b+=l+o.$label.cssMarginX();else if(o.labelPosition===M.LabelPosition.TOP){let C=w.prefSize(o.$label).height;o.$label.cssHeight(C),p+=C+o.$label.cssMarginY(),t=!0}}if(o.$mandatory&&o.$mandatory.isVisible()&&(o.$mandatory.cssTop(p).cssLeft(b).cssWidth(this.mandatoryIndicatorWidth),b+=o.$mandatory.outerWidth(!0)),this._isStatusVisible())if(o.$status.cssWidth(d),o.statusPosition===M.StatusPosition.TOP&&t){let C=w.prefSize(o.$status,{useCssSize:!0}).height,P=h.top+o.$label.cssPaddingTop()+o.$label.height()/2-C/2;o.$status.cssTop(P).cssRight(m+o.$label.cssMarginRight()).cssHeight(C);let R=w.size(o.$status,!0).width;o.$label.cssPaddingRight(R)}else o.$status.cssTop(p).cssRight(m).cssHeight(this.rowHeight),m+=d+o.$status.cssMarginX();if(o.$fieldContainer){let C=new qe(p-h.top,m-h.right,g-h.bottom,b-h.left),P=w.margins(o.$fieldContainer),R=s.availableSize({exact:!0}).subtract(s.insets()).subtract(C).subtract(P);r=new re(b,p,R.width,R.height),o.$fieldContainer.css("position")!=="absolute"&&(r.x=0,r.y=0);let k=S.optGet(o.$fieldContainer);if(k?k.setBounds(r):w.setBounds(o.$fieldContainer,r),this.compactFieldWidth>-1&&(o.$field.toggleClass("compact",r.width<=this.compactFieldWidth),o.$container.toggleClass("compact",r.width<=this.compactFieldWidth)),t){let N=R.add(P).width-o.$label.cssMarginX();o.$mandatory&&o.$mandatory.isVisible()&&(N+=o.$mandatory.outerWidth(!0)),o.$label.cssWidth(N)}}if(o.$fieldContainer){let C=this._$elementForIconLayout(),P=w.borders(C),R=w.offsetBounds(C);p+=P.top,m+=P.right,r.x+=P.left,r.y+=P.top,r.height=R.height-P.top-P.bottom,r.width=R.width-P.left-P.right,o.$icon&&this._layoutIcon(o,r,m,p),o.$clearIcon&&this._layoutClearIcon(o,r,m,p)}n&&n.rendered&&n.position(),o.$field&&x.update(o.$field,!0),this._layoutDisabledCopyOverlay()}_layoutDisabledCopyOverlay(){if(this.formField.$field&&this.formField.$disabledCopyOverlay){let e=this.formField.$disabledCopyOverlay,t=this.formField.$field,r=t.position(),s=w.insets(t,{includePadding:!0}),o=t[0],n=t.css("overflow-x"),l=t.css("overflow-y"),d=n==="scroll"||n==="auto"&&o.scrollWidth-o.clientWidth>0,h=l==="scroll"||l==="auto"&&o.scrollHeight-o.clientHeight>0,p=F.get().scrollbarWidth;e.css("top",r.top).css("left",r.left).width(t.width()+s.horizontal()-(h?p:0)).height(t.height()+s.vertical()-(d?p:0))}}_isLabelVisible(){return!!this.formField.$label&&this.formField.labelVisible}_isStatusVisible(){return!!this.formField.$status&&(this.formField.statusVisible||this.formField.$status.isVisible())}preferredLayoutSize(e,t){let r=S.get(this.formField.$container),s=this.formField,o=new A,n=new A,l=new A,d=new A,h=u.nvl(t.widthHint,0),p=u.nvl(t.heightHint,0),m=s.statusPosition===M.StatusPosition.TOP&&this._isLabelVisible()&&s.labelPosition===M.LabelPosition.TOP;if(s.$mandatory&&s.$mandatory.isVisible()&&(n.width=this.mandatoryIndicatorWidth+s.$mandatory.cssMarginX(),h-=n.width),this._isLabelVisible()&&(o.width=this.labelWidth()+s.$label.cssMarginX(),o.height=this.rowHeight,s.labelPosition===M.LabelPosition.TOP?(o.width=0,o.height=w.prefSize(s.$label,!0).height):(s.labelWidthInPixel===M.LabelWidth.UI||s.labelUseUiWidth)&&(s.$label.hasClass("empty")?o.width=0:o=w.prefSize(s.$label,!0)),u.isOneOf(s.labelPosition,M.LabelPosition.DEFAULT,M.LabelPosition.LEFT)?h-=o.width:s.labelPosition===M.LabelPosition.TOP&&(p-=o.height)),this._isStatusVisible()&&(l.width=this.statusWidth+s.$status.cssMarginX(),m||(l.height=this.rowHeight,h-=l.width)),s.$fieldContainer){let b=w.margins(s.$fieldContainer),C=S.optGet(s.$fieldContainer);C||(h-=b.horizontal(),p-=b.vertical()),t.widthHint&&(t.widthHint=h),t.heightHint&&(t.heightHint=p),C?d=C.prefSize(t).add(b):d=w.prefSize(s.$fieldContainer,t).add(b)}let g=new A;return g.width=d.width,g.height=d.height,g.width+=n.width,g.height=Math.max(g.height,n.height),u.isOneOf(s.labelPosition,M.LabelPosition.DEFAULT,M.LabelPosition.LEFT)?(g.width+=o.width,g.height=Math.max(g.height,o.height)):s.labelPosition===M.LabelPosition.TOP&&(g.width=Math.max(g.width,o.width),g.height+=o.height),m||(g.width+=l.width,g.height=Math.max(g.height,l.height)),g=g.add(r.insets()),g}_$elementForIconLayout(){return this.formField.$field}_layoutIcon(e,t,r,s){let o=this.rowHeight;t&&(o=t.height),e.$icon.cssRight(r).cssTop(t.y).cssHeight(o)}_layoutClearIcon(e,t,r,s){let o=this.rowHeight;t&&(o=t.height),e instanceof fl&&e.gridData.horizontalAlignment>0?e.$clearIcon.cssLeft(t.x).cssRight("").cssTop(t.y).cssHeight(o):e.$clearIcon.cssLeft("").cssRight(r).cssTop(t.y).cssHeight(o)}labelWidth(){return M.LabelWidth.DEFAULT===this.formField.labelWidthInPixel?ue.get().fieldLabelWidth:this.formField.labelWidthInPixel}}ao(li,"COMPACT_FIELD_WIDTH",61);function bc(i,e,t){return e=$E(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $E(i){var e=RE(i,"string");return typeof e=="symbol"?e:String(e)}function RE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ag extends I{constructor(){super(),bc(this,"codes",void 0),bc(this,"severities",void 0),bc(this,"menu",void 0),this.codes=[],this.severities=[],this.menu=null,this._addWidgetProperties(["menu"])}_createChild(e){if(typeof e=="string"){let t=this.parent.widget(e);if(!t)throw new Error("Referenced widget not found: "+e);return t}return super._createChild(e)}}class Dg extends He{}function gi(i,e,t){return e=LE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LE(i){var e=IE(i,"string");return typeof e=="symbol"?e:String(e)}function IE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ze{constructor(e){gi(this,"x",void 0),gi(this,"y",void 0),gi(this,"w",void 0),gi(this,"h",void 0),gi(this,"weightX",void 0),gi(this,"weightY",void 0),gi(this,"useUiWidth",void 0),gi(this,"useUiHeight",void 0),gi(this,"horizontalAlignment",void 0),gi(this,"verticalAlignment",void 0),gi(this,"fillHorizontal",void 0),gi(this,"fillVertical",void 0),gi(this,"widthInPixel",void 0),gi(this,"heightInPixel",void 0),e=e||{},this.x=-1,this.y=-1,this.w=1,this.h=1,this.weightX=-1,this.weightY=-1,this.useUiWidth=!1,this.useUiHeight=!1,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,this.widthInPixel=0,this.heightInPixel=0,a().extend(this,e)}static createFromHints(e,t){let r=new ze(e.gridDataHints);return r.w===M.FULL_WIDTH&&(r.w=t),r}static ensure(e){return!e||e instanceof ze?e:new ze(e)}}class xs extends M{visitFields(e){let t=super.visitFields(e);if(t===ye.TERMINATE)return ye.TERMINATE;if(t===ye.SKIP_SUBTREE)return ye.CONTINUE;let r=this.getFields();for(let s=0;s<r.length;s++)if(t=r[s].visitFields(e),t===ye.TERMINATE)return ye.TERMINATE}setFieldStyle(e){this.getFields().forEach(t=>t.setFieldStyle(e)),super.setFieldStyle(e)}activate(){ee.activateFirstField(this,this.getFields())}getFocusableElement(){let e=ke.findFirstFocusableWidget(this.getFields(),this);return e?e.getFocusableElement():null}}class un extends dt{constructor(){super(),this.enabledWhenOffline=!0}}function cr(i,e,t){return e=kE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kE(i){var e=BE(i,"string");return typeof e=="symbol"?e:String(e)}function BE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ge extends M{constructor(){super(),cr(this,"clearable",void 0),cr(this,"formatter",void 0),cr(this,"hasText",void 0),cr(this,"initialValue",void 0),cr(this,"invalidValueMessageKey",void 0),cr(this,"parser",void 0),cr(this,"value",void 0),cr(this,"validators",void 0),cr(this,"_updateDisplayTextPending",void 0),this.defaultMenuTypes=[...this.defaultMenuTypes,ge.MenuTypes.NotNull,ge.MenuTypes.Null],this.clearable=ge.Clearable.FOCUSED,this.displayText=null,this.formatter=this._formatValue.bind(this),this.hasText=!1,this.initialValue=null,this.invalidValueMessageKey="InvalidValueMessageX",this.parser=this._parseValue.bind(this),this.value=null,this.validators=[],this.validators.push(this._validateValue.bind(this)),this._updateDisplayTextPending=!1,this.$clearIcon=null,this._addCloneProperties(["value","displayText","clearable"])}_init(e){super._init(e),e.validator&&(this.setValidator(e.validator),delete e.validator),this._initValue(this.value)}_initValue(e){this.value=null,this._setValue(e),this._updateEmpty()}_renderProperties(){super._renderProperties(),this._renderDisplayText(),this._renderClearable(),this._renderHasText()}_remove(){super._remove(),this.$clearIcon=null}_renderDisplayText(){this._updateHasText()}_readDisplayText(){return""}_onClearIconMouseDown(e){this.clear(),e.preventDefault()}_onFieldBlur(e){super._onFieldBlur(e),this.acceptInput(!1)}acceptInput(e){e=!!e;let t=u.nvl(this._readDisplayText(),"");this._checkDisplayTextChanged(t,e)&&(this._setProperty("displayText",t),e||this.parseAndSetValue(t),this._triggerAcceptInput(e))}parseAndSetValue(e){this.removeErrorStatus(vi);try{if(!this.trigger("parse",{displayText:e}).defaultPrevented){let r=this.parseValue(e);this.setValue(r)}}catch(t){this._parsingFailed(e,t)}}_parsingFailed(e,t){a().log.isDebugEnabled()&&a().log.debug("Parsing failed for field with id "+this.id,t),this.trigger("parseError",{displayText:e,error:t}).defaultPrevented||this._addParsingFailedErrorStatus(e,t)}_addParsingFailedErrorStatus(e,t){let r=this._createParsingFailedStatus(e,t);this.addErrorStatus(r)}_createParsingFailedStatus(e,t){return this._createInvalidValueStatus("ParsingFailedStatus",e,t)}setParser(e){this.setProperty("parser",e),this.initialized&&this.parseAndSetValue(this.displayText)}_setParser(e){e||(e=this._parseValue.bind(this)),this._setProperty("parser",e)}parseValue(e){let t=this._parseValue.bind(this);return this.parser(e,t)}_parseValue(e){return e}_checkDisplayTextChanged(e,t){let r=u.nvl(this.displayText,"");return e!==r}aboutToBlurByMouseDown(e){this.isFocusOnField(e)||this.acceptInput()}isFocused(){return this.rendered&&Yi.isActiveElement(this.$field)}isFocusOnField(e){return this.$field.isOrHas(e)||this.$clearIcon&&this.$clearIcon.isOrHas(e)}_triggerAcceptInput(e){let t={displayText:this.displayText,whileTyping:!!e};this.trigger("acceptInput",t)}setDisplayText(e){this.setProperty("displayText",e)}_updateHasText(){this.setHasText(y.hasText(this._readDisplayText()))}setHasText(e){this.setProperty("hasText",e)}_renderHasText(){this.$field&&this.$field.toggleClass("has-text",this.hasText),this.$container.toggleClass("has-text",this.hasText)}setClearable(e){this.setProperty("clearable",e)}_renderClearable(){this.isClearable()?this.$clearIcon||this.addClearIcon():this.$clearIcon&&(this.$clearIcon.remove(),this.$clearIcon=null),this.invalidateLayoutTree(!1),this._updateClearableStyles()}_updateClearableStyles(){this.$container.removeClass("clearable-always clearable-focused"),this.isClearable()&&(this.clearable===ge.Clearable.ALWAYS?this.$container.addClass("clearable-always"):this.clearable===ge.Clearable.FOCUSED&&this.$container.addClass("clearable-focused"))}isClearable(){return this.clearable===ge.Clearable.ALWAYS||this.clearable===ge.Clearable.FOCUSED}clear(){this._clear(),this._updateHasText(),this.acceptInput(),this._triggerClear()}_clear(){}_triggerClear(){this.trigger("clear")}setValue(e){e=this._prepareProperty("value",e),this.rendered&&this._callRemoveProperty("value"),this._callSetProperty("value",e),this.rendered&&this._callRenderProperty("value")}resetValue(){this.setValue(this.initialValue)}_ensureValue(e){return e}_setValue(e){this.initialized&&(this.removeErrorStatus(vi),this.removeErrorStatus(Wn));let t=this.value,r=null;try{r=this._ensureValue(e)}catch(s){this._ensureValueFailed(e,s);return}try{this.value=this.validateValue(r)}catch(s){this._validationFailed(r,s);return}this._updateDisplayText(),!this._valueEquals(t,this.value)&&(this._valueChanged(),this._updateMenus(),this._updateTouched(),this._updateEmpty(),this.triggerPropertyChange("value",t,this.value))}_valueEquals(e,t){return v.equals(e,t)}_valueChanged(){}_getCurrentMenuTypes(){return v.isNullOrUndefined(this.value)?[...super._getCurrentMenuTypes(),ge.MenuTypes.Null]:[...super._getCurrentMenuTypes(),ge.MenuTypes.NotNull]}validate(){this._setValue(this.value)}addValidator(e,t){let r=this.validators.slice();r.push(e),this.setValidators(r,t)}removeValidator(e,t){let r=this.validators.slice();f.remove(r,e),this.setValidators(r,t)}setValidator(e,t){e||(e=this._validateValue.bind(this));let r=[];e&&(r=[e]),this.setValidators(r,t)}setValidators(e,t){this.setProperty("validators",e),this.initialized&&u.nvl(t,!0)&&this.validate()}validateValue(e){let t=this._validateValue.bind(this);return this.validators.forEach(r=>{e=r(e,t)}),e=u.nvl(e,null),e}_validateValue(e){return typeof e=="string"&&e===""&&(e=null),e}_validationFailed(e,t){a().log.isDebugEnabled()&&a().log.debug("Validation failed for field with id "+this.id,t);let r=this._createValidationFailedStatus(e,t);this.addErrorStatus(r),this._updateDisplayText(e)}_ensureValueFailed(e,t){a().log.isDebugEnabled()&&a().log.debug("EnsureValue failed for field with id "+this.id,t);let r=this._createValidationFailedStatus(e,t);this.addErrorStatus(r),this.setDisplayText(this._formatRawValue(e))}_formatRawValue(e){return e+""}_createValidationFailedStatus(e,t){return this._createInvalidValueStatus("ValidationFailedStatus",e,t)}_createInvalidValueStatus(e,t,r){let s=E.classForName(e);if(r instanceof s)return r;let o,n=E.Severity.ERROR;return r instanceof E?(o=r.message,n=r.severity):typeof r=="string"?o=r:o=this.session.text(this.invalidValueMessageKey,t),u.create(e,{message:o,severity:n})}_updateDisplayText(e){if(!this.initialized&&!v.isNullOrUndefined(this.displayText))return;e=u.nvl(e,this.value);let t=this.formatValue(e);v.isPromise(t)?(this._updateDisplayTextPending=!0,t.done(this.setDisplayText.bind(this)).fail(()=>{this._updateDisplayTextPending&&this.setDisplayText(""),a().log.isInfoEnabled()&&a().log.info("Could not resolve display text for value: "+e)}).always(()=>{this._updateDisplayTextPending=!1})):(this.setDisplayText(t),this._updateDisplayTextPending=!1)}setFormatter(e){this.setProperty("formatter",e),this.initialized&&this.validate()}_setFormatter(e){e||(e=this._formatValue.bind(this)),this._setProperty("formatter",e)}formatValue(e){let t=this._formatValue.bind(this);return this.formatter(e,t)}_formatValue(e){return u.nvl(e,"")+""}_updateTouched(){this.touched=!this._valueEquals(this.value,this.initialValue)}addClearIcon(e){e||(e=this.$container),this.$clearIcon=e.appendSpan("clear-icon unfocusable text-field-icon action").on("mousedown",this._onClearIconMouseDown.bind(this))}addContainer(e,t,r){super.addContainer(e,t,r),this.$container.addClass("value-field")}addField(e){super.addField(e),this.$field.data("valuefield",this)}markAsSaved(){super.markAsSaved(),this.initialValue=this.value}_updateEmpty(){this.empty=this.value===null||this.value===void 0}static invokeValueFieldAboutToBlurByMouseDown(e){let t=this._getActiveValueField(e);t&&t.aboutToBlurByMouseDown(e)}static invokeValueFieldAcceptInput(e){let t=this._getActiveValueField(e);t&&t.acceptInput()}static _getActiveValueField(e){let t=a()(e).activeElement(),r=u.widget(t);return r instanceof ge&&r.enabledComputed?r:null}}cr(ge,"Clearable",{ALWAYS:"always",FOCUSED:"focused",NEVER:"never"}),cr(ge,"MenuTypes",{Null:"ValueField.Null",NotNull:"ValueField.NotNull"});class Ot extends dt{_onWidgetAcceptInput(e){this._send("acceptInput",{displayText:e.displayText,whileTyping:e.whileTyping},{showBusyIndicator:!e.whileTyping,coalesce:function(t){return this.target===t.target&&this.type===t.type&&this.whileTyping===t.whileTyping}})}_onWidgetEvent(e){e.type==="acceptInput"?this._onWidgetAcceptInput(e):super._onWidgetEvent(e)}exportAdapterData(e){return e=super.exportAdapterData(e),delete e.displayText,e}_syncDisplayText(e){this.widget.setDisplayText(e),this.widget.parseAndSetValue(e)}}function Ja(i,e,t){return e=OE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function OE(i){var e=HE(i,"string");return typeof e=="symbol"?e:String(e)}function HE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fl extends ge{constructor(){super(),Ja(this,"updateDisplayTextOnModify",void 0),Ja(this,"updateDisplayTextOnModifyDelay",void 0),Ja(this,"_displayTextModifiedTimeoutId",void 0),Ja(this,"_displayTextChangedWhileTyping",void 0),this.disabledCopyOverlay=!0,this._displayTextModifiedTimeoutId=null,this.updateDisplayTextOnModify=!1,this.updateDisplayTextOnModifyDelay=250}addField(e){super.addField(e),e&&e.on("input",this._onFieldInput.bind(this))}setUpdateDisplayTextOnModify(e){this._displayTextModifiedTimeoutId!==null&&(clearTimeout(this._displayTextModifiedTimeoutId),this._acceptInputWhileTyping()),this.setProperty("updateDisplayTextOnModify",e)}setUpdateDisplayTextOnModifyDelay(e){this.setProperty("updateDisplayTextOnModifyDelay",e)}_clear(){this.$field&&this.$field.val("")}_onFieldInput(){this._updateHasText(),this.updateDisplayTextOnModify&&this._onDisplayTextModified()}_onDisplayTextModified(){clearTimeout(this._displayTextModifiedTimeoutId),this.updateDisplayTextOnModifyDelay?this._displayTextModifiedTimeoutId=setTimeout(this._acceptInputWhileTyping.bind(this),this.updateDisplayTextOnModifyDelay):this._acceptInputWhileTyping()}_acceptInputWhileTyping(){this._displayTextModifiedTimeoutId=null,this.rendered&&this.acceptInput(!0)}acceptInput(e){this._displayTextModifiedTimeoutId!==null&&(clearTimeout(this._displayTextModifiedTimeoutId),this._displayTextModifiedTimeoutId=null),super.acceptInput(e)}_renderDisplayText(){this.$field.val(this.displayText),super._renderDisplayText()}_readDisplayText(){return this.$field?this.$field.val():""}_checkDisplayTextChanged(e,t){let r=super._checkDisplayTextChanged(e,t);return t?this.updateDisplayTextOnModify&&r&&(this._displayTextChangedWhileTyping=!0):(this._displayTextChangedWhileTyping&&(r=!0),this._displayTextChangedWhileTyping=!1),r}}class Qa extends Ot{constructor(){super(),this.enabledWhenOffline=!0}}function Mg(i,e,t){return e=NE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NE(i){var e=VE(i,"string");return typeof e=="symbol"?e:String(e)}function VE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class $g extends M{constructor(){super(),Mg(this,"scrollable",void 0),Mg(this,"fieldWidget",void 0),this.scrollable=!0,this.fieldWidget=null,this._addWidgetProperties(["fieldWidget"])}_init(e){super._init(e)}_render(){this.addContainer(this.$parent,"widget-field",new yc(this)),this.addLabel(),this.addMandatoryIndicator(),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderFieldWidget(),this._renderScrollable()}setFieldWidget(e){this.setProperty("fieldWidget",e)}_renderFieldWidget(){!this.fieldWidget||(this.fieldWidget.render(),this.addField(this.fieldWidget.$container),this.invalidateLayoutTree())}_removeFieldWidget(){!this.fieldWidget||(this.fieldWidget.remove(),this._removeField(),this.invalidateLayoutTree())}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this._uninstallScrollbars(),this.scrollable&&this._installScrollbars()}get$Scrollable(){return this.$fieldContainer}}class Rg extends dt{}class yc extends li{constructor(e){super(e)}layout(e){super.layout(e),x.update(this.formField.$fieldContainer)}}function ho(i,e,t){return e=WE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WE(i){var e=KE(i,"string");return typeof e=="symbol"?e:String(e)}function KE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Po extends ge{constructor(){super(),ho(this,"filterBox",void 0),ho(this,"lookupCall",void 0),ho(this,"lookupStatus",void 0),ho(this,"_currentLookupCall",void 0),ho(this,"_lookupExecuted",void 0),ho(this,"_valueSyncing",void 0),this.filterBox=null,this.gridDataHints.weightY=1,this.gridDataHints.h=2,this.value=[],this.clearable=ge.Clearable.NEVER,this.lookupCall=null,this._currentLookupCall=null,this._lookupExecuted=!1,this._valueSyncing=!1,this._addCloneProperties(["lookupCall"])}_init(e){super._init(e),this.filterBox&&(this.filterBox.enabledComputed=!0,this.filterBox.recomputeEnabled(!0),this.filterBox.on("propertyChange",this._onFilterBoxPropertyChange.bind(this)))}_initValue(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._initStructure(e),super._initValue(e)}_render(){this.addContainer(this.$parent,"lookup-box"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.addFieldContainer(this.$parent.makeDiv()),S.install(this.$fieldContainer,this.session).setLayout(this._createFieldContainerLayout()),this._ensureLookupCallExecuted(),this._renderStructure(),this.$field.addDeviceClass(),this.$field.addClass("structure"),this._renderFilterBox(),this.$container.css("--inactive-lookup-row-suffix-text","'".concat(this.session.text("InactiveState"),"'"))}_renderFilterBox(){!this.filterBox||!this.filterBox.visible||this.filterBox.render(this.$fieldContainer)}_ensureValue(e){return f.ensure(e)}_updateEmpty(){this.empty=f.empty(this.value)}_lookupByAll(){if(!this.lookupCall)return;let e=a().Deferred();return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t=>{this._lookupByAllDone(t),e.resolve(t)}),e.promise()}_executeLookup(e,t){return this.setLoading(!0),t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(()=>{this._currentLookupCall=null,this._lookupExecuted=!0,this.setLoading(!1),this._clearLookupStatus()})}_lookupByAllDone(e){try{return e.exception?(this.setErrorStatus(E.error({message:e.exception})),!1):e.lookupRows.length===0?(this.setLookupStatus(E.warning({message:this.session.text("SmartFieldNoDataFound"),code:Po.ErrorCode.NO_DATA})),!1):!0}finally{this.trigger("lookupCallDone",{result:e})}}_errorStatus(){return this.lookupStatus||this.errorStatus}setLookupStatus(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}clearErrorStatus(){this.setErrorStatus(null),this._clearLookupStatus()}_clearLookupStatus(){this.setLookupStatus(null)}setLookupCall(e){this.setProperty("lookupCall",e)}_setLookupCall(e){this._setProperty("lookupCall",ei.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}refreshLookup(){this._lookupExecuted=!1,this._ensureLookupCallExecuted()}_ensureLookupCallExecuted(){return this._lookupExecuted?!1:(this._lookupByAll(),!0)}_formatValue(e){return v.isNullOrUndefined(e)?"":this._formatLookupRows(this.getCheckedLookupRows())}_formatLookupRows(e){if(e=f.ensure(e),e.length===0)return"";let t=[];return e.forEach(r=>t.push(r.text)),y.join(", ",...t)}_readDisplayText(){return this.displayText}_clear(){this.setValue(null)}_onFilterBoxPropertyChange(e){if(e.propertyName==="visible"){if(!this.rendered)return;this.filterBox.visible?this._renderFilterBox():this.filterBox.remove()}}}ho(Po,"ErrorCode",{NO_DATA:1});function vc(i,e,t){return e=zE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zE(i){var e=GE(i,"string");return typeof e=="symbol"?e:String(e)}function GE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Za extends te{constructor(e,t,r){super(),vc(this,"box",void 0),vc(this,"structure",void 0),vc(this,"filterBox",void 0),this.box=e,this.structure=t,this.filterBox=r}layout(e){let t=S.get(e),r=t.size(),s=r.height,o;this.filterBox&&this.filterBox.rendered&&(o=S.get(this.filterBox.$container).prefSize().height,s-=o),s=Math.max(s,20),S.get(this.structure.$container).setSize(new A(r.width,s)),this.filterBox&&this.filterBox.rendered&&S.get(this.filterBox.$container).setSize(new A(r.width,o))}preferredLayoutSize(e,t){t=t||{};let r,s=0,o=S.get(e),n=ue.get().formRowHeight,l=this.box;t.heightHint=null,l.$label&&l.labelVisible&&(s+=ue.get().fieldLabelWidth),l.$mandatory&&l.$mandatory.isVisible()&&(s+=l.$mandatory.outerWidth(!0)),l.$status&&l.statusVisible&&(s+=l.$status.outerWidth(!0));let d=S.optGet(this.structure.$container);d?r=d.prefSize(t).add(o.insets()).add(d.margins()):r=this.naturalSize(l);let h=new A(0,0);if(this.filterBox){let p=S.optGet(this.filterBox.$container);p&&(h=p.prefSize(t).add(o.insets()).add(p.margins()))}return s+=Math.max(r.width,h.width),n=Math.max(n,r.height+h.height),new A(s,n)}naturalSize(e){return new A(e.$fieldContainer.width(),e.$fieldContainer.height())}}function wc(i,e,t){return e=UE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UE(i){var e=qE(i,"string");return typeof e=="symbol"?e:String(e)}function qE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ml{constructor(e){wc(this,"objectType",void 0),wc(this,"displayParent",void 0),wc(this,"session",void 0),this.displayParent=e.displayParent,this.session=e.session}registerAndRender(e,t,r){u.assertProperty(e,"displayParent"),e.isPopupWindow()?this._renderPopupWindow(e):e.isView()?this._renderView(e,!0,t,r):this._renderDialog(e,!0)}isFormShown(e){return e.isView()?this.displayParent.views.indexOf(e)>-1:this.displayParent.dialogs.indexOf(e)>-1}_renderPopupWindow(e,t){throw new Error("popup window only supported by DesktopFormController")}unregisterAndRemove(e){!e||(e.isPopupWindow()?this._removePopupWindow(e):e.isView()?this._removeView(e):this._removeDialog(e))}_removePopupWindow(e){throw new Error("popup window only supported by DesktopFormController")}render(){this._renderViews(),this._renderDialogs()}_renderViews(){this.displayParent.views.forEach((e,t)=>{e.setDisplayParent(this.displayParent),this._renderView(e,!1,t,!1)})}_renderDialogs(){this.displayParent.dialogs.forEach(e=>{e.setDisplayParent(this.displayParent),this._renderDialog(e,!1)})}remove(){this.displayParent.dialogs.forEach(e=>{this._removeDialog(e,!1)}),this.displayParent.views.forEach((e,t)=>{this._removeView(e,!1)})}activateForm(e){let t=this.displayParent;for(;t;){if(t instanceof fr){this.session.desktop.setOutline(t);break}t=t instanceof Y?t.displayParent:null}e.displayHint===Y.DisplayHint.VIEW?this._activateView(e):this._activateDialog(e)}acceptView(e,t,r,s){return this.displayParent.rendered}_renderView(e,t,r,s){if(t&&(r!==void 0?f.insert(this.displayParent.views,e,r):this.displayParent.views.push(e)),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;if(e.rendered)return;let o=this.session.desktop;if(o.displayStyle===Ie.DisplayStyle.COMPACT&&!o.bench)o.sendOutlineToBack(),o.switchToBench(!e.headerVisible);else if(o.bench.removalPending){setTimeout(this._renderView.bind(this,e,t,r,s));return}o.bench.addView(e,s)}acceptDialog(e){return this.displayParent.rendered}_renderDialog(e,t){let r=this.session.desktop;if(t&&this.displayParent.dialogs.push(e),this.displayParent.acceptDialog){if(!this.displayParent.acceptDialog(e))return}else if(!this.acceptDialog(e))return;e.rendered||(e.on("remove",()=>{let s=this._findFormToActivateAfterDialogRemove();s?r._setFormActivated(s):r._setOutlineActivated()}),e.isPopupWindow()?this._renderPopupWindow(e):(e.setTrackFocus(!0),e.render(r.$container),this._layoutDialog(e),r._setFormActivated(e),this.displayParent.inFront()||e.detach()))}_findFormToActivateAfterDialogRemove(){if(this.displayParent.dialogs.length>0)return this.displayParent.dialogs[this.displayParent.dialogs.length-1];if(this.displayParent instanceof Y&&!this.displayParent.detailForm)return this.displayParent;let e=this.session.desktop;if(e.bench){let t=e.bench.activeViews()[0];if(t instanceof Y&&!t.detailForm)return t}}_removeView(e,t){t=u.nvl(t,!0),t&&f.remove(this.displayParent.views,e),this.session.desktop.bench&&this.session.desktop.bench.removeView(e)}_removeDialog(e,t){t=u.nvl(t,!0),t&&f.remove(this.displayParent.dialogs,e),e.rendered&&e.remove()}_activateView(e){let t=this.session.desktop.bench;t&&t.activateView(e)}_activateDialog(e){if(e.displayParent instanceof Y&&(e.displayParent.displayHint===Y.DisplayHint.VIEW||e.displayParent.displayHint===Y.DisplayHint.DIALOG&&e.modal)&&this.activateForm(e.displayParent),!e.rendered)return;let t=e.$container.nextAll().toArray(),r=t.filter(function(o){let n=u.widget(o);return n instanceof Y&&(!n.modal||!e.has(n)&&n.displayParent!==this.session.desktop)},this),s=t.filter(o=>f.find(r,n=>{let l=u.widget(o);return!(l instanceof Y)&&u.widget(n).has(l)}));r=r.concat(s),this.session.desktop.moveOverlaysBehindAndFocus(r,e.$container)}attachDialogs(){this.displayParent.dialogs.forEach(e=>{e.attach()},this)}detachDialogs(){this.displayParent.dialogs.forEach(e=>{e.detach()},this)}_layoutDialog(e){e.htmlComp.validateLayout(),e.position(),this.session.focusManager.validateFocus(),e.animateOpening&&e.$container.addClassForAnimation("animate-open")}}function it(i,e,t){return e=YE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function YE(i){var e=jE(i,"string");return typeof e=="symbol"?e:String(e)}function jE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ti extends I{constructor(){super(),it(this,"severity",void 0),it(this,"body",void 0),it(this,"iconId",void 0),it(this,"header",void 0),it(this,"hiddenText",void 0),it(this,"html",void 0),it(this,"yesButtonText",void 0),it(this,"noButtonText",void 0),it(this,"cancelButtonText",void 0),it(this,"buttons",void 0),it(this,"boxButtons",void 0),it(this,"yesButton",void 0),it(this,"noButton",void 0),it(this,"cancelButton",void 0),it(this,"displayParent",void 0),it(this,"abortButton",void 0),it(this,"$content",void 0),it(this,"$header",void 0),it(this,"$body",void 0),it(this,"$html",void 0),it(this,"$hiddenText",void 0),it(this,"$buttons",void 0),it(this,"_icon",void 0),it(this,"_glassPaneRenderer",void 0),this.severity=E.Severity.INFO,this.body=null,this.iconId=null,this.header=null,this.hiddenText=null,this.html=null,this.yesButtonText=null,this.noButtonText=null,this.cancelButtonText=null,this.displayParent=null,this.buttons=[],this.boxButtons=null,this.yesButton=null,this.noButton=null,this.cancelButton=null,this.abortButton=null,this.inheritAccessibility=!1,this.$content=null,this.$header=null,this.$body=null,this.$hiddenText=null,this.$buttons=null,this.$html=null,this._icon=null,this._addWidgetProperties(["buttons","boxButtons","yesButton","noButton","cancelButton","abortButton"])}_init(e){super._init(e),this._setDisplayParent(this.displayParent),this._setIconId(this.iconId),this.boxButtons=u.create(Xn,{parent:this}),this.yesButton=this._createMessageBoxButton(this.yesButtonText,Ti.Buttons.YES),this.noButton=this._createMessageBoxButton(this.noButtonText,Ti.Buttons.NO),this.cancelButton=this._createMessageBoxButton(this.cancelButtonText,Ti.Buttons.CANCEL)}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new Sc(this),new oa(this.session,this),new jn(this,[_.SPACE,_.ENTER]),new na(this,()=>this.abortButton?this.abortButton.$container:null)])}_createMessageBoxButton(e,t){if(!e)return null;let r=this.boxButtons.addButton({text:e});return r.one("action",s=>this._onButtonClick(s,t)),this.buttons.push(r),this.abortButton=r,r}_render(){this.$container=this.$parent.appendDiv("messagebox").on("mousedown",this._onMouseDown.bind(this)).on("copy",this._onCopy.bind(this));let e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$content=this.$container.appendDiv("messagebox-content"),this.$header=this.$content.appendDiv("messagebox-label messagebox-header"),this.$body=this.$content.appendDiv("messagebox-label messagebox-body"),this.$html=this.$content.appendDiv("messagebox-label messagebox-html prevent-initial-focus"),this.boxButtons.render(),this.$buttons=this.boxButtons.$container,this.$buttons.addClass("messagebox-buttons"),this.$buttons.on("copy",this._onCopy.bind(this)),this._installScrollbars({axis:"y",scrollShadow:"none"}),this._renderSeverity(),this._renderHeader(),this._renderIconId(),this._renderBody(),this._renderHtml(),this._renderHiddenText(),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Tc(this)),this.htmlComp.validateLayout(),this.$container.addClassForAnimation("animate-open"),this._glassPaneRenderer=new js(this),this._glassPaneRenderer.renderGlassPanes()}get$Scrollable(){return this.$content}_postRender(){super._postRender(),this._installFocusContext()}_remove(){this._glassPaneRenderer.removeGlassPanes(),this._uninstallFocusContext(),super._remove()}_installFocusContext(){this.session.focusManager.installFocusContext(this.$container,It.AUTO)}_uninstallFocusContext(){this.session.focusManager.uninstallFocusContext(this.$container)}_renderIconId(){let e=!!this._icon;this.$container.toggleClass("has-icon",e),this.$container.toggleClass("no-icon",!e),e&&(this._icon.render(this.$header),this._icon.$container.addClass("messagebox-icon"))}_renderSeverity(){this.$container.removeClass(E.SEVERITY_CSS_CLASSES),this.$container.addClass(E.cssClassForSeverity(this.severity))}_renderHeader(){this.$header.html(y.nl2br(this.header)),this.$header.setVisible(!!this.header||!!this.iconId),this.$header.toggleClass("has-text",y.hasText(this.header))}_renderBody(){this.$body.html(y.nl2br(this.body)),this.$body.setVisible(!!this.body),this.$content.toggleClass("has-body",!!this.body)}_renderHtml(){this.$html.html(this.html),this.$html.setVisible(!!this.html),this.$html.find("a, .app-link").attr("tabindex","0").unfocusable()}_renderHiddenText(){this.$hiddenText&&this.$hiddenText.remove(),this.hiddenText&&(this.$hiddenText=this.$content.appendElement(`<!-- 
`+this.hiddenText.replace(/<!--|-->/g,"")+`
 -->`))}_onMouseDown(){let e=this.findParent(t=>t instanceof Y&&t.isDialog());e&&e.activate()}_setCopyable(e){this.$header.toggleClass("copyable",e),this.$body.toggleClass("copyable",e),this.$html.toggleClass("copyable",e)}copy(){this._setCopyable(!0);let e=this.$container.document(!0),t=e.createRange();t.selectNodeContents(this.$content[0]);let r=this.$container.window(!0).getSelection();r.removeAllRanges(),r.addRange(t),e.execCommand("copy")}_onCopy(e){let t=v.optProperty(e,"originalEvent","clipboardData");if(t){let r=y.join("<br/>",this.$header[0].outerHTML,this.$body[0].outerHTML,this.$html[0].outerHTML,this.hiddenText);t.setData("text/html",r);let s=y.join(`

`,this.header,this.body,y.plainText(this.$html[0].outerHTML,{compact:!0,trim:!0}),this.hiddenText);t.setData("text/plain",s),this.$container.window(!0).getSelection().removeAllRanges(),this._setCopyable(!1),sr.showNotification(this),e.preventDefault()}}_onButtonClick(e,t){this.trigger("action",{option:t})}setDisplayParent(e){this.setProperty("displayParent",e)}_setDisplayParent(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}setIconId(e){this.setProperty("iconId",e)}_setIconId(e){this._setProperty("iconId",e),e?this._icon?this._icon.setIconDesc(e):(this._icon=u.create(Qr,{parent:this,iconDesc:e,prepend:!0}),this._icon.one("destroy",()=>{this._icon=null})):this._icon&&this._icon.destroy()}open(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.messageBoxController.registerAndRender(this)}close(){this.displayParent&&this.displayParent.messageBoxController.unregisterAndRemove(this),this.destroy()}abort(){this.abortButton&&this.abortButton.$container&&this.session.focusManager.requestFocus(this.abortButton.$container)&&this.abortButton.doAction()}_attach(){this.$parent.append(this.$container),super._attach()}_detach(){this.$container.detach(),super._detach()}}it(Ti,"Buttons",{YES:"yes",NO:"no",CANCEL:"cancel"});class Lg extends He{_onWidgetAction(e){this._send("action",{option:e.option})}_onWidgetEvent(e){e.type==="action"?this._onWidgetAction(e):super._onWidgetEvent(e)}}function Ig(i,e,t){return e=XE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XE(i){var e=JE(i,"string");return typeof e=="symbol"?e:String(e)}function JE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class gl{constructor(e,t){Ig(this,"displayParent",void 0),Ig(this,"session",void 0),this.displayParent=e,this.session=t}registerAndRender(e){u.assertProperty(e,"displayParent"),this.displayParent.messageBoxes.push(e),this._render(e)}unregisterAndRemove(e){e&&(f.remove(this.displayParent.messageBoxes,e),this._remove(e))}remove(){this.displayParent.messageBoxes.forEach(this._remove.bind(this))}render(){this.displayParent.messageBoxes.forEach(e=>{e.setDisplayParent(this.displayParent),this._render(e)})}_render(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;if(e.rendered)return;let t;this.displayParent instanceof Y&&this.displayParent.isPopupWindow()?t=this.displayParent.popupWindow.$container:t=this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach()}_remove(e){e.remove()}attach(){this.displayParent.messageBoxes.forEach(e=>e.attach())}detach(){this.displayParent.messageBoxes.forEach(e=>e.detach())}acceptView(e){return this.displayParent.rendered}}function pr(i,e,t){return e=QE(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QE(i){var e=ZE(i,"string");return typeof e=="symbol"?e:String(e)}function ZE(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class as{constructor(){pr(this,"objectType",void 0),pr(this,"parent",void 0),pr(this,"yesText",void 0),pr(this,"noText",void 0),pr(this,"cancelText",void 0),pr(this,"bodyText",void 0),pr(this,"severity",void 0),pr(this,"headerText",void 0),pr(this,"iconId",void 0),pr(this,"closeOnClick",void 0),pr(this,"html",void 0),this.parent=null,this.yesText=null,this.noText=null,this.cancelText=null,this.bodyText=null,this.severity=E.Severity.INFO,this.headerText=null,this.iconId=null,this.closeOnClick=!0,this.html=!1}init(e){u.assertParameter("parent",e.parent),a().extend(this,e)}withHeader(e){return this.headerText=e,this}withBody(e,t){return this.bodyText=e,this.html=u.nvl(t,!1),this}withIconId(e){return this.iconId=e,this}withSeverity(e){return this.severity=u.nvl(e,E.Severity.INFO),this}withYes(e){return this.yesText=u.nvl(e,this.parent.session.text("Yes")),this}withNo(e){return this.noText=u.nvl(e,this.parent.session.text("No")),this}withCancel(e){return this.cancelText=u.nvl(e,this.parent.session.text("Cancel")),this}build(){let e={parent:this.parent,header:this.headerText,body:this.bodyText,severity:this.severity};return y.hasText(this.iconId)&&(e.iconId=this.iconId),y.hasText(this.yesText)&&(e.yesButtonText=this.yesText),y.hasText(this.noText)&&(e.noButtonText=this.noText),y.hasText(this.cancelText)&&(e.cancelButtonText=this.cancelText),this.html&&(e.html=e.body,delete e.body),u.create(Ti,e)}buildAndOpen(){let e=a().Deferred(),t=this.build();return t.on("action",r=>{this.closeOnClick&&t.close(),e.resolve(r.option)}),t.open(),e.promise()}static create(e){return u.create(as,{parent:e})}static createOk(e){return this.create(e).withYes(e.session.text("Ok"))}static createYesNo(e){return this.create(e).withYes().withNo()}static createYesNoCancel(e){return this.create(e).withYes().withNo().withCancel()}static openOk(e,t,r){return this.createOk(e).withBody(t).withSeverity(r).buildAndOpen()}static openYesNo(e,t,r){return this.createYesNo(e).withBody(t).withSeverity(r).buildAndOpen()}}function eA(i,e,t){return e=tA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tA(i){var e=iA(i,"string");return typeof e=="symbol"?e:String(e)}function iA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tc extends te{constructor(e){super(),eA(this,"messageBox",void 0),this.messageBox=e}layout(e){let t=S.get(e),r=e.windowSize(),s=t.offsetBounds(!0),o=t.size(),n=t.margins();o=br.fitContainerInWindow(r,s.point(),o,n),e.toggleClass("full-width",s.x===0&&n.horizontal()===0&&r.width===o.width).toggleClass("full-height",s.y===0&&n.vertical()===0&&r.height===o.height),w.setSize(e,o);let l=w.size(this.messageBox.$buttons,{exact:!0});this.messageBox.$content.css("height","calc(100% - "+l.height+"px)"),x.update(this.messageBox.$content),e.cssPosition(br.positionContainerInWindow(e))}}class Sc extends B{constructor(e){super(),this.field=e,this.which=[_.C],this.ctrl=!0,this.preventDefault=!1,this.renderingHints.render=!0,this.renderingHints.$drawingArea=(t,r)=>e.$container}handle(e){this.field.copy()}}function kg(i,e,t){return e=rA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function rA(i){var e=sA(i,"string");return typeof e=="symbol"?e:String(e)}function sA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bg extends M{constructor(){super(),kg(this,"accordion",void 0),kg(this,"eventDelegator",void 0),this.accordion=null,this.eventDelegator=null,this._addWidgetProperties(["accordion"])}_init(e){super._init(e),this._setAccordion(this.accordion)}_createLoadingSupport(){return null}_render(){this.addContainer(this.$parent,"accordion-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.accordion&&this._renderAccordion()}_renderProperties(){super._renderProperties(),this._renderDropType()}setAccordion(e){this.setProperty("accordion",e)}_setAccordion(e){this.accordion&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("accordion",e),e&&(this.eventDelegator=gr.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}_renderAccordion(){!this.accordion||(this.accordion.render(),this.addField(this.accordion.$container),this.invalidateLayoutTree())}_removeAccordion(){!this.accordion||(this.accordion.remove(),this._removeField(),this.invalidateLayoutTree())}getFocusableElement(){return this.accordion?this.accordion.getFocusableElement():null}getDelegateScrollable(){return this.accordion}}class Og extends dt{}class Hg extends ge{constructor(){super(),this.preventInitialFocus=!0}_render(){this.addContainer(this.$parent,"bean-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderValue()}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new hn(this,this._onAppLinkAction))}_formatValue(e){return this.displayText}_parseValue(e){return this.value}_readDisplayText(){return this.displayText}_renderDisplayText(){}_renderValue(){}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}}class Ng extends Ot{_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function Ht(i,e,t){return e=oA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function oA(i){var e=nA(i,"string");return typeof e=="symbol"?e:String(e)}function nA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ao extends M{constructor(){super(),Ht(this,"autoCloseExternalWindow",void 0),Ht(this,"externalWindowButtonText",void 0),Ht(this,"externalWindowFieldText",void 0),Ht(this,"location",void 0),Ht(this,"trackLocation",void 0),Ht(this,"sandboxEnabled",void 0),Ht(this,"sandboxPermissions",void 0),Ht(this,"trustedMessageOrigins",void 0),Ht(this,"scrollBarEnabled",void 0),Ht(this,"showInExternalWindow",void 0),Ht(this,"iframe",void 0),Ht(this,"myWindow",void 0),Ht(this,"_messageListener",void 0),Ht(this,"_popupWindow",void 0),Ht(this,"_externalWindowTextField",void 0),Ht(this,"_externalWindowButton",void 0),this.autoCloseExternalWindow=!1,this.externalWindowButtonText=null,this.externalWindowFieldText=null,this.location=null,this.trackLocation=!1,this.sandboxEnabled=!0,this.sandboxPermissions=null,this.trustedMessageOrigins=[],this.scrollBarEnabled=!0,this.showInExternalWindow=!1,this._messageListener=null,this._popupWindow=null,this._externalWindowTextField=null,this._externalWindowButton=null}_init(e){super._init(e),this.iframe=u.create(wh,{parent:this,location:this.location,sandboxEnabled:this.sandboxEnabled,sandboxPermissions:this.sandboxPermissions,scrollBarEnabled:this.scrollBarEnabled,trackLocation:this.trackLocation}),this.iframe.on("propertyChange",this._onIFramePropertyChange.bind(this))}_render(){this.addContainer(this.$parent,"browser-field",new Cc(this)),this.addLabel(),this.addStatus(),this.showInExternalWindow?(this.addField(this.$parent.makeDiv()),this._externalWindowTextField=this.$field.appendDiv().addClass("alt"),this._externalWindowButton=this.$field.appendDiv().addClass("button").on("click",e=>this._openPopupWindow(!0))):(this.iframe.render(),this.addFieldContainer(this.iframe.$container),this.addField(this.iframe.$iframe),this.$field.on("load",this._onLoad.bind(this))),this.myWindow=this.$parent.window(!0),this._messageListener=this._onMessage.bind(this),this.myWindow.addEventListener("message",this._messageListener),this.enabledComputed&&setTimeout(this._openPopupWindow.bind(this,!0),20)}_renderProperties(){super._renderProperties(),this._renderExternalWindowButtonText(),this._renderExternalWindowFieldText()}_remove(){super._remove(),this.myWindow.removeEventListener("message",this._messageListener),this._messageListener=null,this.showInExternalWindow&&this.autoCloseExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&this._popupWindow.close()}setLocation(e){this.setProperty("location",e),this.iframe.setLocation(e)}_renderLocation(){let e=this.location||"about:blank";this.showInExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&(this._popupWindow.location=e)}setAutoCloseExternalWindow(e){this.setProperty("autoCloseExternalWindow",e)}setExternalWindowButtonText(e){this.setProperty("externalWindowButtonText",e)}_renderExternalWindowButtonText(){this.showInExternalWindow&&this._externalWindowButton.text(this.externalWindowButtonText||"")}setExternalWindowFieldText(e){this.setProperty("externalWindowFieldText",e)}_renderExternalWindowFieldText(){this.showInExternalWindow&&this._externalWindowTextField.text(this.externalWindowFieldText||"")}_calcPopupBounds(){let e=this.$container.window(!0),s=30+8,o=55,n=new re(e.screenX,e.screenY,a()(e).width(),a()(e).height()+o),l=new re(this.$field.offset().left,this.$field.offset().top,this.$field.width(),this.$field.height()),d=n.x+l.x,h=n.y+l.y+o,p=l.width,m=l.height+s,g=h+m,b=n.y+n.height;return g>b&&(m-=g-b+s),new re(Ge.round(d),Ge.round(h),Ge.round(p),Ge.round(m))}_openPopupWindow(e){if(e=u.nvl(e,!0),!!this.showInExternalWindow)if(!this._popupWindow||e&&this._popupWindow.closed){let t=u.create(Pn,{session:this.session}),r=this._calcPopupBounds(),s=y.join(",","directories=no","location=no","menubar=no","resizable=yes","status=no","scrollbars="+(this.scrollBarEnabled?"yes":"no"),"toolbar=no","dependent=yes","left="+r.x,"top="+r.y,"width="+r.width,"height="+r.height),o=this.location||"about:blank";t.openWindow(o,void 0,s,this._popupWindowOpen.bind(this))}else e&&this._popupWindow.focus()}_popupWindowOpen(e){if(this._popupWindow=e,this._popupWindow&&!this._popupWindow.closed){this.trigger("externalWindowStateChange",{windowState:Ao.WindowStates.WINDOW_OPEN});let t=window.setInterval(()=>{let r=!1;try{r=this._popupWindow===null||this._popupWindow.closed}catch{a().log.isInfoEnabled()&&a().log.info("Reading the property popupWindow.closed threw an error (Retry in 500ms)");return}r&&(window.clearInterval(t),this.trigger("externalWindowStateChange",{windowState:Ao.WindowStates.WINDOW_CLOSED}))},500)}}_onMessage(e){if(!!this._isValidMessageSource(e.source)){if(this.trustedMessageOrigins&&this.trustedMessageOrigins.length&&!this.trustedMessageOrigins.some(t=>t===e.origin)){a().log.warn("blocked message from untrusted origin "+e.origin);return}a().log.isDebugEnabled()&&a().log.debug("received post-message: data="+e.data+", origin="+e.origin),this.trigger("message",{data:e.data,origin:e.origin})}}_isValidMessageSource(e){let t=this.$field[0].contentWindow;if(e===t)return!0;let r=e;for(;r&&r!==r.parent;)if(r=r.parent,r===t)return!0;return!1}postMessage(e,t){a().log.isDebugEnabled()&&a().log.debug("send post-message: message="+e+", targetOrigin="+t),this.iframe&&this.iframe.postMessage(e,t)}setTrackLocation(e){this.setProperty("trackLocation",e),this.iframe.setTrackLocation(e)}_onIFramePropertyChange(e){!this.trackLocation||e.propertyName==="location"&&this._setProperty("location",e.newValue)}_onLoad(e){!this.rendered||this.invalidateLayoutTree()}setSandboxEnabled(e){this.setProperty("sandboxEnabled",e),this.iframe.setSandboxEnabled(e)}setSandboxPermissions(e){this.setProperty("sandboxPermissions",e),this.iframe.setSandboxPermissions(e)}setScrollBarEnabled(e){this.setProperty("scrollBarEnabled",e),this.iframe.setScrollBarEnabled(e)}}Ht(Ao,"WindowStates",{WINDOW_OPEN:"true",WINDOW_CLOSED:"false"});class Vg extends dt{constructor(){super(),this._addRemoteProperties(["location"])}_onWidgetMessage(e){this._send("postMessage",{data:e.data,origin:e.origin})}_onWidgetExternalWindowStateChange(e){this._send("externalWindowStateChange",{windowState:e.windowState})}_onWidgetEvent(e){e.type==="message"?this._onWidgetMessage(e):e.type==="externalWindowStateChange"?this._onWidgetExternalWindowStateChange(e):super._onWidgetEvent(e)}_onModelPostMessage(e){this.widget.postMessage(e.message,e.targetOrigin)}onModelAction(e){e.type==="postMessage"?this._onModelPostMessage(e):super.onModelAction(e)}_orderPropertyNamesOnSync(e){return Object.keys(e).sort(this._createPropertySortFunc(["scrollBarEnabled","location"]))}}function lA(i,e,t){return e=aA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aA(i){var e=dA(i,"string");return typeof e=="symbol"?e:String(e)}function dA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cc extends li{constructor(e){super(e),lA(this,"browserField",void 0),this.browserField=e}preferredLayoutSize(e,t){let r=super.preferredLayoutSize(e,t);return this._isIFrameReadable()&&(r.height=this.browserField.$field.contents().height()+this.browserField.iframe.htmlComp.insets().vertical()+this.browserField.htmlComp.insets().vertical()),r}_isIFrameReadable(){let e=this.browserField,t=e.sandboxPermissions;if(e.sandboxEnabled&&t&&t.indexOf("allow-same-origin")===-1)return a().log.isWarnEnabled()&&a().log.warn('Access to IFrame denied, cannot read height. Reason: sandbox is enabled or "allow-same-origin" is not set'),!1;try{e.$field[0].contentWindow.document}catch{return a().log.isWarnEnabled()&&a().log.warn("Access to IFrame denied, cannot read height. Reason: denied by browser"),!1}return e.$field.contents().attr("readyState")==="loading"?(a().log.isWarnEnabled()&&a().log.warn('Access to IFrame denied, cannot read height. Reason: readyState == "loading"'),!1):!0}}function ct(i,e,t){return e=hA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hA(i){var e=uA(i,"string");return typeof e=="symbol"?e:String(e)}function uA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Le extends M{constructor(){super(),ct(this,"defaultButton",void 0),ct(this,"displayStyle",void 0),ct(this,"iconId",void 0),ct(this,"keyStroke",void 0),ct(this,"keyStrokeScope",void 0),ct(this,"processButton",void 0),ct(this,"selected",void 0),ct(this,"systemType",void 0),ct(this,"preventDoubleClick",void 0),ct(this,"stackable",void 0),ct(this,"shrinkable",void 0),ct(this,"adaptedBy",void 0),ct(this,"buttonKeyStroke",void 0),ct(this,"formKeyStrokeContext",void 0),ct(this,"popup",void 0),ct(this,"$buttonLabel",void 0),ct(this,"$submenuIcon",void 0),ct(this,"_doubleClickSupport",void 0),this.adaptedBy=null,this.defaultButton=!1,this.displayStyle=Le.DisplayStyle.DEFAULT,this.gridDataHints.fillHorizontal=!1,this.iconId=null,this.keyStroke=null,this.keyStrokeScope=null,this.processButton=!0,this.selected=!1,this.statusVisible=!1,this.systemType=Le.SystemType.NONE,this.preventDoubleClick=!1,this.stackable=!0,this.shrinkable=!1,this.$buttonLabel=null,this.buttonKeyStroke=new cn(this,null),this._doubleClickSupport=new Vs,this._addCloneProperties(["defaultButton","displayStyle","iconId","keyStroke","processButton","selected","systemType","preventDoubleClick","stackable","shrinkable"])}_init(e){super._init(e),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke),this._setKeyStrokeScope(this.keyStrokeScope),this._setInheritAccessibility(this.inheritAccessibility&&!this._isIgnoreAccessibilityFlags())}getContextMenuItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return[]}_initKeyStrokeContext(){super._initKeyStrokeContext(),this._initDefaultKeyStrokes(),this.formKeyStrokeContext=new Oe,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.buttonKeyStroke),this.formKeyStrokeContext.$bindTarget=()=>{if(this.keyStrokeScope)return this.keyStrokeScope.$container;let e=this.getForm();return e?e.$container:this.session.desktop.$container}}_isIgnoreAccessibilityFlags(){return this.systemType===Le.SystemType.CANCEL||this.systemType===Le.SystemType.CLOSE}_initDefaultKeyStrokes(){this.keyStrokeContext.registerKeyStrokes([new cn(this,"ENTER"),new cn(this,"SPACE")])}_createLoadingSupport(){return new rr({widget:this,$container:()=>this.$field})}_render(){let e;if(this.displayStyle===Le.DisplayStyle.LINK?(e=this.$parent.makeDiv("link-button menu-item"),this.$buttonLabel=e.appendSpan("button-label text")):(e=this.$parent.makeElement("<button>").addClass("button"),this.displayStyle===Le.DisplayStyle.BORDERLESS&&e.addClass("borderless"),this.$buttonLabel=e.appendSpan("button-label text"),F.get().supportsOnlyTouch()&&e.setTabbable(!1)),this.addContainer(this.$parent,"button-field",new ed(this)),this.addField(e),this.addStatus(),e.on("mousedown",t=>this._doubleClickSupport.mousedown(t)).on("click",this._onClick.bind(this)).unfocusable(),this.menus&&this.menus.length>0&&(this.menus.forEach(t=>this.keyStrokeContext.registerKeyStroke(t)),this.label||!this.iconId)){let t=ve.parseIconId(Le.SUBMENU_ICON);this.$submenuIcon=e.appendSpan("submenu-icon").text(t.iconCharacter)}this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext),G.installForEllipsis(this.$buttonLabel,{parent:this})}_remove(){super._remove(),G.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),this.$submenuIcon=null}_renderProperties(){super._renderProperties(),this._renderIconId(),this._renderSelected(),this._renderDefaultButton()}_renderForegroundColor(){super._renderForegroundColor(),L.legacyForegroundColor(this,this.$buttonLabel),L.legacyForegroundColor(this,this.get$Icon()),L.legacyForegroundColor(this,this.$submenuIcon)}_renderBackgroundColor(){super._renderBackgroundColor(),L.legacyBackgroundColor(this,this.$fieldContainer)}_renderFont(){super._renderFont(),L.legacyFont(this,this.$buttonLabel),this.invalidateLayoutTree()}doAction(){return!this.enabledComputed||!this.visible?!1:(this.displayStyle===Le.DisplayStyle.TOGGLE?this.setSelected(!this.selected):this.menus.length>0&&this.togglePopup(),this._doAction(),!0)}_doAction(){this.trigger("click")}togglePopup(){this.popup?this.popup.close():(this.popup=this._openPopup(),this.popup.one("destroy",e=>{this.popup=null}))}_openPopup(){let e=u.create(mt,{parent:this,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1,$anchor:this.$field});return e.open(),e}_doActionTogglesSubMenu(){return!1}setDefaultButton(e){this.setProperty("defaultButton",e)}_renderDefaultButton(){this.$field.toggleClass("default",this.defaultButton)}_renderEnabled(){super._renderEnabled(),this.displayStyle===Le.DisplayStyle.LINK&&this.$field.setTabbable(this.enabledComputed&&!F.get().supportsOnlyTouch())}setSelected(e){this.setProperty("selected",e)}_renderSelected(){this.displayStyle===Le.DisplayStyle.TOGGLE&&this.$field.toggleClass("selected",this.selected)}_renderLabel(){this.$buttonLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}setIconId(e){this.setProperty("iconId",e)}_renderIconId(){let e=this.$fieldContainer;e.icon(this.iconId);let t=e.data("$icon");t&&(t.removeClass("loading broken"),t.is("img")&&(t.addClass("loading"),t.off("load error").on("load",r.bind(this,!0)).on("error",r.bind(this,!1))),this.rendered||L.legacyForegroundColor(this,t)),this._updateLabelAndIconStyle(),this.invalidateLayoutTree();function r(s){t.removeClass("loading"),t.toggleClass("broken",!s),this.invalidateLayoutTree()}}get$Icon(){return this.$fieldContainer.children(".icon")}_updateLabelAndIconStyle(){let e=!!this.label;this.$buttonLabel.setVisible(e||!this.iconId),this.get$Icon().toggleClass("with-label",e)}setKeyStroke(e){this.setProperty("keyStroke",e)}_setKeyStroke(e){this._setProperty("keyStroke",e),this.buttonKeyStroke.parseAndSetKeyStroke(this.keyStroke)}_setKeyStrokeScope(e){typeof e=="string"&&(e=this._resolveKeyStrokeScope(e),!e)||this._setProperty("keyStrokeScope",e)}_resolveKeyStrokeScope(e){let t=this.findNonWrappedForm();if(!t)throw new Error("Could not resolve keyStrokeScope "+e+" because no form has been found.");if(!t.initialized){t.one("init",this._setKeyStrokeScope.bind(this,e));return}let r=t.widget(e);if(!r)throw new Error("Could not resolve keyStrokeScope "+e+" using form "+t);return r}_onClick(e){e.which===1&&(this.preventDoubleClick&&this._doubleClickSupport.doubleClicked()||(G.cancel(this.$buttonLabel),G.cancel(this.$fieldContainer),this.enabledComputed&&this.doAction()))}setStackable(e){this.setProperty("stackable",e)}setShrinkable(e){this.setProperty("shrinkable",e)}setPreventDoubleClick(e){this.setProperty("preventDoubleClick",e)}getFocusableElement(){return this.adaptedBy?this.adaptedBy.getFocusableElement():super.getFocusableElement()}isFocusable(e){return this.adaptedBy?this.adaptedBy.isFocusable():super.isFocusable()}focus(){return this.adaptedBy?this.adaptedBy.focus():super.focus()}}ct(Le,"SystemType",{NONE:0,CANCEL:1,CLOSE:2,OK:3,RESET:4,SAVE:5,SAVE_WITHOUT_MARKER_CHANGE:6}),ct(Le,"DisplayStyle",{DEFAULT:0,TOGGLE:1,RADIO:2,LINK:3,BORDERLESS:4}),ct(Le,"SUBMENU_ICON",ve.ANGLE_DOWN_BOLD);class ed extends li{constructor(e){super(e)}layout(e){super.layout(e);let t=this.formField.get$Icon(),r=this.formField.$submenuIcon,s=this.formField.$buttonLabel,o=this.formField.$fieldContainer;s.css("max-width","");let n=r?w.size(r,{includeMargin:!0,exact:!0}).width:0,l=t.length?w.size(t,{includeMargin:!0,exact:!0}).width:0,d=Math.ceil(o.width()-(n+l));s.css("max-width",d)}preferredLayoutSize(e,t){let r=this.formField.$buttonLabel,s=r.css("max-width");r.css("max-width","");let o=super.preferredLayoutSize(e,t);return r.css("max-width",s),o}}class Pc extends dt{constructor(){super(),this._addRemoteProperties(["selected"])}_onWidgetClick(e){this.widget.displayStyle===Le.DisplayStyle.TOGGLE||this.widget.menus.length>0||this._send("click")}_onWidgetEvent(e){e.type==="click"?this._onWidgetClick(e):super._onWidgetEvent(e)}}class cn extends B{constructor(e,t){super(),this.field=e,this.parseAndSetKeyStroke(t),this.stopPropagation=!0,this.stopImmediatePropagation=!0,this.renderingHints.hAlign=ht.RIGHT}_accept(e){return super._accept(e)&&this.field.$field.isAttached()}handle(e){this.field.doAction()}}function cA(i,e,t){return e=pA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pA(i){var e=fA(i,"string");return typeof e=="symbol"?e:String(e)}function fA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wg extends M{constructor(){super(),cA(this,"calendar",void 0),this.gridDataHints.weightY=1,this._addWidgetProperties(["calendar"])}_render(){this.addContainer(this.$parent,"calendar-field"),this.$container.toggleClass("mobile",F.get().type===F.Type.MOBILE),this.addLabel(),this.addStatus(),this.calendar&&(this.calendar.render(),this.addField(this.calendar.$container))}}class Kg extends dt{}function mA(i,e,t){return e=gA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gA(i){var e=_A(i,"string");return typeof e=="symbol"?e:String(e)}function _A(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zg extends M{constructor(){super(),mA(this,"carousel",void 0),this.gridDataHints.weightY=1,this._addWidgetProperties(["carousel"])}_render(){this.addContainer(this.$parent,"carousel-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.carousel&&this._renderCarousel()}_renderCarousel(){this.carousel.render(),this.addField(this.carousel.$container)}_removeCarousel(){this.carousel&&this.carousel.remove(),this._removeField()}}function uo(i,e,t){return e=bA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bA(i){var e=yA(i,"string");return typeof e=="symbol"?e:String(e)}function yA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fs extends ge{constructor(){super(),uo(this,"triStateEnabled",void 0),uo(this,"wrapText",void 0),uo(this,"keyStroke",void 0),uo(this,"checkBoxKeyStroke",void 0),uo(this,"formKeyStrokeContext",void 0),uo(this,"$checkBox",void 0),uo(this,"$checkBoxLabel",void 0),this.triStateEnabled=!1,this.wrapText=!1,this.keyStroke=null,this.checkBoxKeyStroke=new td(this),this.$checkBox=null,this.$checkBoxLabel=null}_init(e){super._init(e),this._setKeyStroke(this.keyStroke)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new td(this)),this.formKeyStrokeContext=new Oe,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.checkBoxKeyStroke),this.formKeyStrokeContext.$bindTarget=()=>{let e=this.getForm();return e?e.$container:this.session.desktop.$container}}_render(){this.addContainer(this.$parent,"check-box-field"),this.addLabel(),this.addMandatoryIndicator(),this.addFieldContainer(this.$parent.makeDiv()),this.$checkBox=this.$fieldContainer.appendDiv("check-box").on("mousedown",this._onMouseDown.bind(this)).data("valuefield",this),this.addField(this.$checkBox),this.$checkBoxLabel=this.$fieldContainer.appendDiv("label").on("mousedown",this._onMouseDown.bind(this)),ee.linkElementWithLabel(this.$checkBox,this.$checkBoxLabel),G.installForEllipsis(this.$checkBoxLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}_renderProperties(){super._renderProperties(),this._renderValue(),this._renderWrapText()}_remove(){G.uninstall(this.$checkBoxLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),super._remove()}_renderDisplayText(){}setValue(e){this.setProperty("value",e)}_renderValue(){this.$fieldContainer.toggleClass("checked",this.value===!0),this.$checkBox.toggleClass("checked",this.value===!0),this.$checkBox.toggleClass("undefined",this.triStateEnabled&&this.value!==!0&&this.value!==!1)}_renderEnabled(){super._renderEnabled(),this.$checkBox.setTabbable(this.enabledComputed&&!F.get().supportsOnlyTouch()).setEnabled(this.enabledComputed)}setTriStateEnabled(e){this.setProperty("triStateEnabled",e),this.rendered&&this._renderValue()}_renderLabel(){this.$checkBoxLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._renderEmptyLabel()}_renderFont(){L.legacyFont(this,this.$fieldContainer),this.invalidateLayoutTree()}_renderForegroundColor(){L.legacyForegroundColor(this,this.$fieldContainer)}_renderBackgroundColor(){L.legacyBackgroundColor(this,this.$fieldContainer)}_renderGridData(){super._renderGridData(),this.updateInnerAlignment({useHorizontalAlignment:!0})}_renderGridDataHints(){super._renderGridDataHints(),this.updateInnerAlignment({useHorizontalAlignment:!0})}setKeyStroke(e){this.setProperty("keyStroke",e)}_setKeyStroke(e){this._setProperty("keyStroke",e),this.checkBoxKeyStroke.parseAndSetKeyStroke(this.keyStroke)}setWrapText(e){this.setProperty("wrapText",e)}_renderWrapText(){this.$checkBoxLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}acceptInput(e){}toggleChecked(){!this.enabledComputed||(this.triStateEnabled?this.value===!1?this.setValue(!0):this.value===!0?this.setValue(null):this.setValue(!1):this.setValue(!this.value))}prepareForCellEdit(e){super.prepareForCellEdit(e),this.$checkBoxLabel.hide()}_onMouseDown(e){if(!this.enabledComputed)return;this.toggleChecked();let t=this.$checkBox.is(e.currentTarget),r=this.$checkBoxLabel.isOrHas(e.currentTarget);(t||r)&&this.focusAndPreventDefault(e)}}class Gg extends Ot{constructor(){super(),this._addRemoteProperties(["value"])}}class td extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE],this.stopPropagation=!0,this.stopImmediatePropagation=!0,this.renderingHints.hAlign=ht.LEFT,this.renderingHints.$drawingArea=(t,r)=>this.field.$fieldContainer}handle(e){this.field.toggleChecked()}}function co(i,e,t){return e=vA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vA(i){var e=wA(i,"string");return typeof e=="symbol"?e:String(e)}function wA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Do extends ge{constructor(){super(),co(this,"allowedMimeTypes",void 0),co(this,"maximumSize",void 0),co(this,"readOnly",void 0),co(this,"_fileUploadWaitRetryCountTimeout",void 0),co(this,"_fullSelectionLength",void 0),this.allowedMimeTypes=null,this.maximumSize=null,this._fileUploadWaitRetryCountTimeout=99,this._fullSelectionLength=0}_createKeyStrokeContext(){return new Fr}_render(){this.addContainer(this.$parent,"clipboard-field"),this.addLabel(),this.addField(this.$parent.makeElement("<div>").addClass("input-field")),this.addStatus(),this.$field.disableSpellcheck().attr("contenteditable","true").attr("tabindex","0").on("keydown",this._onKeyDown.bind(this)).on("input",this._onInput.bind(this)).on("paste",this._onPaste.bind(this)).on("copy",this._onCopy.bind(this)).on("cut",this._onCopy.bind(this))}_getDragAndDropHandlerOptions(){let e=super._getDragAndDropHandlerOptions();return e.allowedTypes=()=>this.allowedMimeTypes,e.dropMaximumSize=()=>Math.min(u.nvl(this.dropMaximumSize,Number.MAX_VALUE),u.nvl(this.maximumSize,Number.MAX_VALUE)),e}_renderDisplayText(){let e=this.displayText,t;this.$field.children().each((r,s)=>{!t&&s.nodeName==="IMG"&&(t=s)}),y.hasText(e)?(this.$field.html(y.nl2br(e,!0)),this._installScrollbars(),setTimeout(()=>{this.$field.selectAllText();let r=this._getSelection();this._fullSelectionLength=r?r.toString().length:0})):this.$field.empty(),t&&this.$field.prepend(t)}_readDisplayText(){return this.displayText}_getSelection(){let e,t=this.$container.window(!0);return t.getSelection?e=t.getSelection():document.getSelection&&(e=document.getSelection()),!e||e.toString().length===0?null:e}_onKeyDown(e){if(u.isOneOf(e.which,Do.ALWAYS_DESTRUCTIVE_KEYS))return!1;if(!(e.ctrlKey||e.altKey||e.metaKey||u.isOneOf(e.which,Do.NON_DESTRUCTIVE_KEYS)))return!1}_onInput(e){return this._renderDisplayText(),!1}_onCopy(e){if(F.get().isIos()&&this._onIosCopy(e)===!1)return;let t,r,s=this.$container.window(!0);try{let n=e.originalEvent;n.clipboardData?r=n.clipboardData:s.clipboardData&&(r=s.clipboardData)}catch(n){a().log.error('Error while reading "clipboardData"',n)}if(!r)return a().log.error("Unable to access clipboard data."),!1;this._uninstallScrollbars();let o=this._getSelection();if(!!o){o.toString().length===this._fullSelectionLength?t=this.displayText:t=o.toString();try{r.setData("text/plain",t)}catch{r.setData("Text",t)}return this._installScrollbars(),!1}}_onIosCopy(e){let t=this.$field.attr("style");return this.$field.css({color:"#000","background-color":"transparent"}),setTimeout(()=>{this.$field.attrOrRemove("style",t)}),!1}_onPaste(e){if(this.readOnly)return!1;let t=Date.now(),r,s=this.$container.window(!0);this.$field.selectAllText();let o=e.originalEvent;if(o.clipboardData)r=o.clipboardData;else if(s.clipboardData)r=s.clipboardData;else throw new Error("Unable to access clipboard data.");let n=[],l={},d=0,h=0,p=r.getData("Text");p&&(window.Blob?(n.push(new Blob([p],{type:at.TEXT_PLAIN})),h++):(l["textTransferObject"+d++]=p,h++)),h===0&&r.items&&(Array.prototype.forEach.call(r.items,P=>{if(P.type===at.TEXT_PLAIN)P.getAsString(R=>{n.push(new Blob([R],{type:at.TEXT_PLAIN})),h++});else if(u.isOneOf(P.type,[at.IMAGE_PNG,at.IMAGE_JPG,at.IMAGE_JPEG,at.IMAGE_GIF])){let R=P.getAsFile();R&&(t-R.lastModified<1e3&&(R.scoutName=ci.EMPTY_UPLOAD_FILENAME),n.push(R),h++)}}),this._cleanupFiles(n));let m=0;h===0&&r.files&&Array.prototype.forEach.call(r.files,P=>{let R=new FileReader;R.onload=k=>{let N=new Blob([k.target.result],{type:P.type});N.name=P.name,n.push(N),m--},R.onerror=k=>{m--,a().log.error("Error while reading file "+P.name+" / "+k.target.error.code)},m++,h++,R.readAsArrayBuffer(P)});let g=0,b=()=>{if(m!==0&&g++!==this._fileUploadWaitRetryCountTimeout){setTimeout(b,150);return}if(g>=this._fileUploadWaitRetryCountTimeout){let P={entryPoint:this.$container.entryPoint(),header:this.session.text("ui.ClipboardTimeoutTitle"),body:this.session.text("ui.ClipboardTimeout"),yesButtonText:this.session.text("Ok")};this.session.showFatalMessage(P);return}(n.length>0||Object.keys(l).length>0)&&this.session.uploadFiles(this,n,l,this.maximumSize,this.allowedMimeTypes)},C=()=>{this._uninstallScrollbars();let P=this.$field.html();this.$field.html("");let R=()=>{this.$field.html(P),this._installScrollbars()};setTimeout(()=>{let k=!1;if(this.$field.children().each((N,be)=>{if(be.nodeName==="IMG"){let st=a()(be).attr("src"),Ye=/^data:(.*);base64,(.*)/.exec(st),ri=Ye&&Ye[1];if(u.isOneOf(ri,at.IMAGE_PNG,at.IMAGE_JPG,at.IMAGE_JPEG,at.IMAGE_GIF)){let Dt=window.atob(Ye[2]),si=[];for(let $l=0;$l<Dt.length;$l++)si[$l]=Dt.charCodeAt($l);let ko=new Uint8Array(si),Bo=new Blob([ko],{type:ri});Bo.name="",n.push(Bo),k=!0}}}),k)R();else{let N=this.$field.text();y.hasText(N)?(this.setDisplayText(N),n.push(new Blob([N],{type:at.TEXT_PLAIN}))):R()}b()},0)};return h>0?(b(),!1):(C(),!0)}_cleanupFiles(e){if(e.length!==2)return;let t,r;e.forEach(s=>{s.name==="image.png"&&s.scoutName?t=s:s.name==="image.jpeg"&&s.scoutName&&(r=s)}),t&&r&&f.remove(e,r)}}co(Do,"NON_DESTRUCTIVE_KEYS",[_.ESC,_.ENTER,_.TAB,_.PAGE_UP,_.PAGE_DOWN,_.END,_.HOME,_.LEFT,_.UP,_.RIGHT,_.DOWN,_.F1,_.F2,_.F3,_.F4,_.F5,_.F6,_.F7,_.F8,_.F9,_.F10,_.F11,_.F12]),co(Do,"ALWAYS_DESTRUCTIVE_KEYS",[_.BACKSPACE,_.DELETE]);class Ug extends Ot{}class qg extends ge{_render(){this.addContainer(this.$parent,"color-field"),this.addLabel(),this.addField(this.$parent.makeDiv("not-implemented").text("not implemented yet")),this.addMandatoryIndicator(),this.addStatus()}}class Yg extends Ot{}class id extends E{}function Be(i,e,t){return e=TA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function TA(i){var e=SA(i,"string");return typeof e=="symbol"?e:String(e)}function SA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Kt extends ge{constructor(){super(),Be(this,"popup",void 0),Be(this,"autoDate",void 0),Be(this,"dateDisplayText",void 0),Be(this,"dateHasText",void 0),Be(this,"dateFocused",void 0),Be(this,"dateFormatPattern",void 0),Be(this,"hasDate",void 0),Be(this,"touchMode",void 0),Be(this,"embedded",void 0),Be(this,"hasTime",void 0),Be(this,"hasTimePopup",void 0),Be(this,"timeDisplayText",void 0),Be(this,"timeHasText",void 0),Be(this,"timePickerResolution",void 0),Be(this,"timeFormatPattern",void 0),Be(this,"timeFocused",void 0),Be(this,"isolatedDateFormat",void 0),Be(this,"isolatedTimeFormat",void 0),Be(this,"allowedDates",void 0),Be(this,"htmlDateTimeComposite",void 0),Be(this,"$dateField",void 0),Be(this,"$timeField",void 0),Be(this,"$dateFieldIcon",void 0),Be(this,"$timeFieldIcon",void 0),Be(this,"$dateClearIcon",void 0),Be(this,"$timeClearIcon",void 0),Be(this,"_$predictDateField",void 0),Be(this,"_$predictTimeField",void 0),Be(this,"_tempTimeDate",void 0),Be(this,"_cellEditorPopup",void 0),this.allowedDates=[],this.popup=null,this.autoDate=null,this.dateDisplayText=null,this.dateHasText=!1,this.dateFocused=!1,this.dateFormatPattern=null,this.disabledCopyOverlay=!0,this.hasDate=!0,this.touchMode=!1,this.embedded=!1,this.hasTime=!1,this.hasTimePopup=!0,this.timeDisplayText=null,this.timeHasText=!1,this.timeDisplayText=null,this.timePickerResolution=30,this.timeFormatPattern=null,this.timeFocused=!1,this.$dateField=null,this.$timeField=null,this.$dateFieldIcon=null,this.$timeFieldIcon=null,this.$dateClearIcon=null,this.$timeClearIcon=null,this._$predictDateField=null,this._$predictTimeField=null,this._tempTimeDate=null,this.invalidValueMessageKey="ui.InvalidDate",this._addCloneProperties(["hasDate","hasTime","dateFormatPattern","timeFormatPattern","allowedDates","autoDate"])}_createKeyStrokeContext(){return new Fr}_init(e){super._init(e),ee.initTouch(this,e),this.popup=e.popup,this._setAutoDate(this.autoDate),this._setDisplayText(this.displayText),this._setAllowedDates(this.allowedDates),this._setTimePickerResolution(this.timePickerResolution)}_initValue(e){this._setDateFormatPattern(this.dateFormatPattern),this._setTimeFormatPattern(this.timeFormatPattern),super._initValue(e)}createDatePopup(){let e=this.touchMode?$h:ma;return u.create(e,{parent:this,$anchor:this.$field,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,allowedDates:this.allowedDates,dateFormat:this.isolatedDateFormat})}createTimePopup(){let e=this.touchMode?za:Ka;return u.create(e,{parent:this,$anchor:this.$timeField,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,timeResolution:this.timePickerResolution})}_render(){this.addContainer(this.$parent,"date-field"),this.addLabel(),this.addField(this.$parent.makeDiv("date-time-composite")),this.addStatus(),this.embedded||this.addMandatoryIndicator(),this.htmlDateTimeComposite=S.install(this.$field,this.session),this.htmlDateTimeComposite.setLayout(new xc(this))}_renderProperties(){this._renderHasDate(),this._renderHasTime(),super._renderProperties(),this._renderDateHasText(),this._renderTimeHasText()}_remove(){super._remove(),this.$dateField=null,this.$timeField=null,this.$dateFieldIcon=null,this.$timeFieldIcon=null,this.$dateClearIcon=null,this.$timeClearIcon=null,this._$predictDateField=null,this._$predictTimeField=null,this.popup=null}setHasDate(e){this.setProperty("hasDate",e)}_setHasDate(e){this._setProperty("hasDate",e),this.initialized&&this._updateDisplayTextProperty()}_renderHasDate(){this.hasDate&&!this.$dateField?(this.$dateField=ee.makeInputOrDiv(this,"date").on("mousedown",this._onDateFieldMouseDown.bind(this)).appendTo(this.$field),this.$timeField&&this.$dateField.insertBefore(this.$timeField),this.touchMode||this.$dateField.on("keydown",this._onDateFieldKeyDown.bind(this)).on("input",this._onDateFieldInput.bind(this)).on("blur",this._onDateFieldBlur.bind(this)).on("focus",this._onDateFieldFocus.bind(this)),this._linkWithLabel(this.$dateField),S.install(this.$dateField,this.session),this.$dateFieldIcon=ee.appendIcon(this.$field,"date").on("mousedown",this._onDateIconMouseDown.bind(this))):!this.hasDate&&this.$dateField&&(this.$dateField.remove(),this.$dateField=null,this.$dateFieldIcon.remove(),this.$dateFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderDateClearable(),this.$container.toggleClass("has-date",this.hasDate)}setHasTime(e){this.setProperty("hasTime",e)}_setHasTime(e){this._setProperty("hasTime",e),this.initialized&&this._updateDisplayTextProperty()}_renderHasTime(){this.hasTime&&!this.$timeField?(this.$timeField=ee.makeInputOrDiv(this,"time").on("mousedown",this._onTimeFieldMouseDown.bind(this)).appendTo(this.$field),this.$dateField&&this.$timeField.insertAfter(this.$dateField),(!this.touchMode||!this.hasTimePopup)&&this.$timeField.on("keydown",this._onTimeFieldKeyDown.bind(this)).on("input",this._onTimeFieldInput.bind(this)).on("blur",this._onTimeFieldBlur.bind(this)).on("focus",this._onTimeFieldFocus.bind(this)),this._linkWithLabel(this.$timeField),S.install(this.$timeField,this.session),this.$timeFieldIcon=ee.appendIcon(this.$field,"time").on("mousedown",this._onTimeIconMouseDown.bind(this))):!this.hasTime&&this.$timeField&&(this.$timeField.remove(),this.$timeField=null,this.$timeFieldIcon.remove(),this.$timeFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderTimeClearable(),this.$container.toggleClass("has-time",this.hasTime)}setTimePickerResolution(e){this.setProperty("timePickerResolution",e)}_setTimePickerResolution(e){e<1?(e=10,this.hasTimePopup=!1):this.hasTimePopup=!0,this._setProperty("timePickerResolution",e)}_renderPlaceholder(e){super._renderPlaceholder(this._fieldForPlaceholder())}_removePlaceholder(e){super._removePlaceholder(this._fieldForPlaceholder())}_fieldForPlaceholder(){return this.hasDate?this.$dateField:this.hasTime?this.$timeField:null}setDateFormatPattern(e){this.setProperty("dateFormatPattern",e)}_setDateFormatPattern(e){e||(e=this.session.locale.dateFormatPatternDefault),this._setProperty("dateFormatPattern",e),this.isolatedDateFormat=new Ft(this.session.locale,this.dateFormatPattern),this.initialized&&this._updateDisplayText()}setTimeFormatPattern(e){this.setProperty("timeFormatPattern",e)}_setTimeFormatPattern(e){e||(e=this.session.locale.timeFormatPatternDefault),this._setProperty("timeFormatPattern",e),this.isolatedTimeFormat=new Ft(this.session.locale,this.timeFormatPattern),this.initialized&&this._updateDisplayText()}_renderEnabled(){super._renderEnabled(),this.$container.setEnabled(this.enabledComputed),this.$dateField&&this.$dateField.setEnabled(this.enabledComputed),this.$timeField&&this.$timeField.setEnabled(this.enabledComputed)}_renderDisplayText(){this.hasDate&&this._renderDateDisplayText(),this.hasTime&&this._renderTimeDisplayText(),this._removePredictionFields()}_readDisplayText(){let e,t;return this.hasDate&&(e=this._readDateDisplayText()),this.hasTime&&(t=this._readTimeDisplayText()),this._computeDisplayText(e,t)}_renderDateDisplayText(){ee.valOrText(this.$dateField,this.dateDisplayText),this._updateDateHasText()}_readDateDisplayText(){return this._$predictDateField?ee.valOrText(this._$predictDateField):ee.valOrText(this.$dateField)}_renderTimeDisplayText(){ee.valOrText(this.$timeField,this.timeDisplayText),this._updateTimeHasText()}_readTimeDisplayText(){return this._$predictTimeField?ee.valOrText(this._$predictTimeField):ee.valOrText(this.$timeField)}setDisplayText(e){this._setDisplayText(e),this.rendered&&this._renderDisplayText()}_setDisplayText(e){this._setProperty("displayText",e);let t=this._splitDisplayText(e);this.hasDate&&(this.dateDisplayText=t.dateText),this.hasTime&&(this.timeDisplayText=t.timeText)}_ensureValue(e){return T.ensure(e)}_validateValue(e){if(v.isNullOrUndefined(e))return e;if(!(e instanceof Date))throw this.session.text(this.invalidValueMessageKey);if(!this.isDateAllowed(e))throw this.session.text("DateIsNotAllowed");return!this.hasDate&&!this.value&&(e=T.combineDateTime(null,e)),e}isDateAllowed(e){if(!e||this.allowedDates.length===0||this.embedded)return!0;let t=T.trunc(e).getTime();return this.allowedDates.some(r=>r.getTime()===t)}_valueEquals(e,t){return T.equals(e,t)}setAutoDate(e){this.setProperty("autoDate",e)}_setAutoDate(e){e=T.ensure(e),this._setProperty("autoDate",e)}setAllowedDates(e){this.setProperty("allowedDates",e)}_setAllowedDates(e){let t=[];f.ensure(e).forEach(r=>{r&&t.push(T.trunc(T.ensure(r)))}),t=t.sort(T.compare),this._setProperty("allowedDates",t)}_renderErrorStatus(){super._renderErrorStatus();let e=!!this.errorStatus,t=this._errorStatusClass();this.$dateField&&(this._updateErrorStatusClassesOnElement(this.$dateField,t,e),this._updateErrorStatusClassesOnElement(this._$predictDateField,t,e)),this.$timeField&&(this._updateErrorStatusClassesOnElement(this.$timeField,t,e),this._updateErrorStatusClassesOnElement(this._$predictTimeField,t,e)),this.popup&&this._updateErrorStatusClassesOnElement(this.popup.$container,t,e)}_errorStatusClass(){return this.errorStatus&&!this._isSuppressStatusField()?"has-"+this.errorStatus.cssClass():""}_renderFont(){this.$dateField&&L.legacyFont(this,this.$dateField),this.$timeField&&L.legacyFont(this,this.$timeField)}_renderForegroundColor(){this.$dateField&&L.legacyForegroundColor(this,this.$dateField),this.$timeField&&L.legacyForegroundColor(this,this.$timeField)}_renderBackgroundColor(){this.$dateField&&L.legacyBackgroundColor(this,this.$dateField),this.$timeField&&L.legacyBackgroundColor(this,this.$timeField)}activate(){!this.enabledComputed||!this.rendered||(this.$dateField?(this.$dateField.focus(),this._onDateFieldMouseDown()):this.$timeField&&(this.$timeField.focus(),this._onTimeFieldMouseDown()))}getFocusableElement(){return this.$dateField?this.$dateField:this.$timeField?this.$timeField:null}_onDateFieldMouseDown(){ee.handleOnClick(this)&&this.openDatePopupAndSelect(this.value)}_onTimeFieldMouseDown(){ee.handleOnClick(this)&&this.openTimePopupAndSelect(this.value)}setDateFocused(e){this.setProperty("dateFocused",e)}_renderDateFocused(){this.$container.toggleClass("date-focused",this.dateFocused)}_updateTimeHasText(){this.setTimeHasText(y.hasText(this._readTimeDisplayText()))}setTimeHasText(e){this.setProperty("timeHasText",e)}_renderTimeHasText(){this.$timeField&&this.$timeField.toggleClass("has-text",this.timeHasText),this.$container.toggleClass("time-has-text",this.timeHasText)}_updateDateHasText(){this.setDateHasText(y.hasText(this._readDateDisplayText()))}setDateHasText(e){this.setProperty("dateHasText",e)}_renderDateHasText(){this.$dateField&&this.$dateField.toggleClass("has-text",this.dateHasText),this.$container.toggleClass("date-has-text",this.dateHasText)}clear(){if(!(this.hasDate&&this.hasTime)){super.clear();return}this._clear(),!this.dateFocused&&!this.timeFocused&&this.acceptInput(),this._triggerClear()}_clear(){this._removePredictionFields(),this.hasDate&&!this.timeFocused&&(ee.valOrText(this.$dateField,""),this._setDateValid(!0),this._updateDateHasText()),this.hasTime&&!this.dateFocused&&(ee.valOrText(this.$timeField,""),this._setTimeValid(!0),this._updateTimeHasText())}_onDateClearIconMouseDown(e){!this.enabledComputed||(this.$dateField.focus(),this.clear(),this.value?this.selectDate(this.value,!1):this.preselectDate(this._referenceDate(),!1),e.preventDefault())}_onDateIconMouseDown(e){!this.enabledComputed||(this.$dateField.focus(),this.embedded||this.openDatePopupAndSelect(this.value))}setTimeFocused(e){this.setProperty("timeFocused",e)}_renderTimeFocused(){this.$container.toggleClass("time-focused",this.timeFocused)}_renderClearable(){this._renderDateClearable(),this._renderTimeClearable(),this._updateClearableStyles()}_renderDateClearable(){this.hasDate&&this.isClearable()?this.$dateClearIcon||(this.$dateClearIcon=this.$field.appendSpan("icon date-clear unfocusable text-field-icon action").on("mousedown",this._onDateClearIconMouseDown.bind(this))):this.$dateClearIcon&&(this.$dateClearIcon.remove(),this.$dateClearIcon=null)}_renderTimeClearable(){this.hasTime&&this.isClearable()?this.$timeClearIcon||(this.$timeClearIcon=this.$field.appendSpan("icon time-clear unfocusable text-field-icon action").on("mousedown",this._onTimeClearIconMouseDown.bind(this))):this.$timeClearIcon&&(this.$timeClearIcon.remove(),this.$timeClearIcon=null)}_onTimeClearIconMouseDown(e){!this.enabledComputed||(this.$timeField.focus(),this.clear(),this.value?this.selectTime(this.value):this.preselectTime(this._referenceDate()),e.preventDefault())}_onTimeIconMouseDown(e){!this.enabledComputed||(this.$timeField.focus(),this.embedded||this.openTimePopupAndSelect(this.value))}_onDateFieldBlur(e){this.setFocused(!1),this.setDateFocused(!1),!this.embedded&&(this.popup instanceof ma&&this.closePopup(),this.setDateFocused(!1),this.acceptDate(),this._removePredictionFields())}_onDateFieldFocus(e){this.setFocused(!0),this.setDateFocused(!0)}_onTimeFieldBlur(e){this._tempTimeDate=null,this.setFocused(!1),this.setTimeFocused(!1),!this.embedded&&(this.popup instanceof Ka&&this.closePopup(),this._tempTimeDate=null,this.setTimeFocused(!1),this.acceptTime(),this._removePredictionFields())}_onTimeFieldFocus(){this.setFocused(!0),this.setTimeFocused(!0)}_onDateFieldKeyDown(e){let t=0,r=0,s=0,o=0,n=this.$dateField[0].selectionStart,l=ee.valOrText(this.$dateField),d=this._$predictDateField&&ee.valOrText(this._$predictDateField),h=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),p=this.value||this._referenceDate(),m=!0,g=e.which;if(this.hasTime&&this.mode===M.Mode.CELLEDITOR&&g===_.TAB&&h===0){e.stopPropagation();return}if(!(g===_.TAB||g===_.SHIFT||g===_.HOME||g===_.END||g===_.CTRL||g===_.ALT)){if(g===_.ENTER){(this.popup||this._$predictDateField)&&(this.acceptDate(),this.closePopup(),a().suppressEvent(e));return}if(g===_.ESC){this.popup&&(this.closePopup(),a().suppressEvent(e));return}if(g===_.RIGHT&&n===l.length){d&&this._setDateDisplayText(d.substring(0,l.length+1));return}if((g===_.UP||g===_.DOWN||g===_.PAGE_UP||g===_.PAGE_DOWN)&&l&&!this._isDateValid()){let b=this.isolatedDateFormat.parse(l,p);b&&(p=b,this._setDateValid(!0))}if(g===_.PAGE_UP||g===_.PAGE_DOWN){!l||!this._isDateValid()?(p=this._referenceDate(),this.hasTime&&(p=T.combineDateTime(p,this.value||this._referenceDate())),this.openDatePopupAndSelect(p),this._updateDisplayText(p),this._setDateValid(!0),m=!1):this.popup||this.openDatePopupAndSelect(p),m&&(s=g===_.PAGE_UP?-1:1,this.shiftSelectedDate(0,s,0),this._updateDisplayText(this.getDatePicker().selectedDate)),a().suppressEvent(e);return}if(g===_.UP||g===_.DOWN){if(t=g===_.UP?-1:1,(e.ctrlKey||e.metaKey)&&h===1)r=t;else if(e.shiftKey&&h===1)s=t;else if(h===0)o=t;else{a().suppressEvent(e);return}!l||!this._isDateValid()?(p=this._referenceDate(),this.hasTime&&(p=T.combineDateTime(p,this.value||this._referenceDate())),this.openDatePopupAndSelect(p),this._updateDisplayText(p),this._setDateValid(!0),m=!1):this.popup||this.openDatePopupAndSelect(p),m&&(this.shiftSelectedDate(r,s,o),this._updateDisplayText(this.getDatePicker().selectedDate)),a().suppressEvent(e)}}}_onDateFieldInput(e){let t=ee.valOrText(this.$dateField);if(this.$dateField[0]!==this.$dateField.activeElement(!0))return;this._$predictDateField||(this._$predictDateField=this._createPredictionField(this.$dateField)),this._removePredictErrorStatus();let r=this._predictDate(t);r?(ee.valOrText(this._$predictDateField,r.text),this.openDatePopupAndSelect(r.date)):this._removePredictionFields(),this._updateDateHasText(),setTimeout(()=>{this._$predictDateField&&this._$predictDateField.setVisible(this.$dateField.scrollLeft()===0)},50)}acceptInput(e){let t=u.nvl(this._readDisplayText(),""),r=this._checkDisplayTextChanged(t);if(r)this.parseAndSetValue(t);else{let s=this.value;this.parseAndSetValue(t),T.equals(this.value,s)||(r=!0)}r&&this._triggerAcceptInput(e)}acceptDate(){let e=this.containsStatus(vi);this.hasTime&&!e&&y.empty(this.$dateField.val())&&this.$timeField.val(""),this.acceptInput()}acceptTime(){let e=this.containsStatus(vi);this.hasDate&&!e&&y.empty(this.$timeField.val())&&this.$dateField.val(""),this.acceptInput()}acceptDateTime(e,t){e?this.acceptDate():t&&this.acceptTime()}_onTimeFieldKeyDown(e){let t=0,r=0,s=0,o=0,n=this.$timeField[0].selectionStart,l=this.$timeField.val(),d=this._$predictTimeField&&this._$predictTimeField.val(),h=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),p=this.value||this._referenceDate(),m=!0,g=e.which;if(this.hasDate&&this.mode===M.Mode.CELLEDITOR&&g===_.TAB&&e.shiftKey&&h===1){e.stopPropagation();return}if(!(g===_.TAB||g===_.SHIFT||g===_.HOME||g===_.END||g===_.CTRL||g===_.ALT)){if(g===_.ENTER){(this.popup||this._$predictDateField)&&(this._tempTimeDate=null,this.acceptTime(),this.closePopup(),a().suppressEvent(e));return}if(g===_.ESC){this.popup&&(this.closePopup(),a().suppressEvent(e));return}if(g===_.RIGHT&&n===l.length){d&&this._setTimeDisplayText(d.substring(0,l.length+1));return}if(g===_.UP||g===_.DOWN){if(t=g===_.UP?-1:1,e.ctrlKey&&h===1)o=t;else if(e.shiftKey&&h===1)r=t;else if(h===0)s=t;else{a().suppressEvent(e);return}if(this.hasTimePopup)!l||!this._isTimeValid()?(p=this._referenceDate(),this.openTimePopupAndSelect(p),this._updateDisplayText(p),this._setTimeValid(!0),m=!1):this.popup||this.openTimePopupAndSelect(p),m&&(this.shiftSelectedTime(r,s,o),this._updateDisplayText(this.getTimePicker().selectedTime)),a().suppressEvent(e);else{if(!this._tempTimeDate){let b=this._predictTime(l);b&&b.date?this._tempTimeDate=b.date:(this._tempTimeDate=this._referenceDate(),m=!1)}m&&(this._tempTimeDate=T.shiftTime(this._tempTimeDate,r,s,o)),this.hasDate&&(this._tempTimeDate=T.combineDateTime(this.value||this._referenceDate(),this._tempTimeDate)),this._updateDisplayText(this._tempTimeDate),this._setTimeValid(!0),a().suppressEvent(e)}}}}_onTimeFieldInput(e){let t=this.$timeField.val();if(this.$timeField[0]!==this.$timeField.activeElement(!0))return;this._$predictTimeField||(this._$predictTimeField=this._createPredictionField(this.$timeField));let r=this._predictTime(t);r?(this._$predictTimeField.val(r.text),this.openTimePopupAndSelect(r.date)):(this._tempTimeDate=null,this._removePredictionFields()),this._updateTimeHasText(),setTimeout(()=>{this._$predictTimeField&&this._$predictTimeField.setVisible(this.$timeField.scrollLeft()===0)},50)}_onDatePickerDateSelect(e){this._setNewDateTimeValue(this._newTimestampAsDate(e.date,this.value))}_onTimePickerTimeSelect(e){this._setNewDateTimeValue(this._newTimestampAsDate(this.value,e.time))}_setNewDateTimeValue(e){this._setDateValid(!0),this._setTimeValid(!0),this.setValue(e),this._triggerAcceptInput(!1),this.closePopup()}_createPredictionField(e){this.setSuppressStatus(M.SuppressStatus.ALL);let t=e.clone().addClass("predict").attr("tabIndex","-1").insertBefore(e);return e.hasClass("has-error")&&t.addClass("has-error"),t}_removePredictionFields(){this.setSuppressStatus(null),this._$predictDateField&&(this._$predictDateField.remove(),this._$predictDateField=null),this._$predictTimeField&&(this._$predictTimeField.remove(),this._$predictTimeField=null)}_setDateDisplayText(e){this.dateDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderDateDisplayText()}_setTimeDisplayText(e){this.timeDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderTimeDisplayText()}_computeDisplayText(e,t){let r=e||"",s=t||"",o=(this.hasDate?r:"")+(this.hasDate&&this.hasTime?`
`:"")+(this.hasTime?s:"");return o===`
`&&(o=""),o}_splitDisplayText(e){let t="",r="";if(y.hasText(e)){let s=e.split(`
`);t=this.hasDate?s[0]:"",r=this.hasTime?this.hasDate?s[1]:s[0]:""}return{dateText:t,timeText:r}}_updateDisplayTextProperty(){this._setProperty("displayText",this._computeDisplayText(this.dateDisplayText,this.timeDisplayText))}aboutToBlurByMouseDown(e){let t=this.$dateField?this.$dateField.isOrHas(e)||this.$dateFieldIcon.isOrHas(e)||this.$dateClearIcon&&this.$dateClearIcon.isOrHas(e):!1,r=this.$timeField?this.$timeField.isOrHas(e)||this.$timeFieldIcon.isOrHas(e)||this.$timeClearIcon&&this.$timeClearIcon.isOrHas(e):!1,s=this.popup&&this.popup.$container.isOrHas(e),o=this.fieldStatus&&this.fieldStatus.$container.isOrHas(e),n=this.getDatePicker(),l=this.getTimePicker();if(!t&&!r&&!s&&!o){let d=Yi.isActiveElement(this.$dateField),h=Yi.isActiveElement(this.$timeField);this.acceptDateTime(d,h);return}if(this.embedded){let d=n&&n.$container.isOrHas(e),h=l&&l.$container.isOrHas(e);d&&h&&this.acceptTime()}}_newTimestampAsDate(e,t){let r=null;return(e||t)&&(r=this.value||this._referenceDate(),e&&(r=T.combineDateTime(e,r)),t&&(r=T.combineDateTime(r,t))),r}_referenceDate(){let e=this.autoDate||T.ceil(T.newDate(),this.timePickerResolution);return this.autoDate?e=this.autoDate:this.hasTime?e=T.ceil(T.newDate(),this.timePickerResolution):e=T.trunc(T.newDate()),this.allowedDates&&(e=this._findAllowedReferenceDate(e)),e}_findAllowedReferenceDate(e){for(let t=0;t<this.allowedDates.length;t++){let r=this.allowedDates[t];if(T.compare(r,e)>=0)return r}for(let t=this.allowedDates.length-1;t>=0;t--){let r=this.allowedDates[t];if(T.compare(r,e)<=0)return r}return e}openDatePopup(){this.popup||(this.popup=this.createDatePopup(),this.popup.open(),this.$dateField.addClass("focused"),this.popup.one("destroy",e=>{this.$dateField.removeClass("focused"),this._onPopupDestroy(e),this.popup=null}),this.getDatePicker().on("dateSelect",this._onDatePickerDateSelect.bind(this)))}closePopup(){this.popup&&this.popup.close()}toggleDatePopup(){a().log.isInfoEnabled()&&a().log.info("(DateField#toggleDatePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openDatePopupAndSelect(this.value)}openTimePopup(){!this.hasTimePopup||this.popup||(this.popup=this.createTimePopup(),this.popup.open(),this.$timeField.addClass("focused"),this.popup.one("destroy",e=>{this.$timeField.removeClass("focused"),this._onPopupDestroy(e),this.popup=null}),this.getTimePicker().on("timeSelect",this._onTimePickerTimeSelect.bind(this)))}toggleTimePopup(){a().log.isInfoEnabled()&&a().log.info("(DateField#toggleTimePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openTimePopupAndSelect(this.value)}_parseValue(e){let t=this._splitDisplayText(e),r=t.dateText,s={},o=t.timeText,n={},l=!0;if(this._removePredictErrorStatus(),this.hasDate&&(s=this._predictDate(r),s||(l=!1),this._setDateDisplayText(r)),this.hasTime&&(n=this._predictTime(o),n||(l=!1),this._setTimeDisplayText(o)),!l)throw new id;return s.date||n.date?this._newTimestampAsDate(s.date,n.date):null}_addParsingFailedErrorStatus(e,t){t instanceof id||super._addParsingFailedErrorStatus(e,t)}_predictDate(e){e=e||"";let t=e.match(/^([+-])(\d*)$/);if(t){let l=T.newDate(),d=Number(t[1]+(t[2]||"0"));return l.setDate(l.getDate()+d),isNaN(l.valueOf())||l.getDate()<0?(this._setDateValid(!1),null):(this._setDateValid(!0),{date:l,text:e})}let r=this._analyzeInputAsDate(e,this.value||this._referenceDate());if(r.error)return this._setDateValid(!1),null;if(!r.predictedDate)return this._setDateValid(!0),{date:null,text:""};let s=r.predictedDate,n=new Ft(this.isolatedDateFormat.locale,r.parsedPattern).format(s,!0);return t=n.match(new RegExp("^"+y.quote(e)+"(.*)$","i")),t&&(n=e+t[1]),this._setDateValid(!0),{date:s,text:n}}_predictTime(e){e=e||"";let t=this._analyzeInputAsTime(e,this.value||this._referenceDate());if(t.error)return this._setTimeValid(!1),null;if(!t.predictedDate)return this._setTimeValid(!0),{date:null,text:""};let r=t.predictedDate,o=new Ft(this.isolatedTimeFormat.locale,t.parsedPattern).format(r,!0),n=o.match(new RegExp("^"+y.quote(e)+"(.*)$","i"));return n&&(o=e+n[1]),this._setTimeValid(!0),{date:r,text:o}}_analyzeInputAsDate(e,t){return this.isolatedDateFormat.analyze(e,t)}_analyzeInputAsTime(e,t){return this.isolatedTimeFormat.analyze(e,t)}_setErrorStatusPart(e,t){let r=null,s=null;this.errorStatus&&(s=f.find(this.errorStatus.asFlatList(),Kt.PARSE_ERROR_PREDICATE)),s?r=s:r=new vi({message:this.session.text("ui.InvalidDate"),severity:E.Severity.ERROR,code:Kt.ErrorCode.PARSE_ERROR}),t?delete r[e]:r[e]=!0,!r.hasOwnProperty("invalidDate")&&!r.hasOwnProperty("invalidTime")&&(r=null),r&&!s?this.addErrorStatus(r):!r&&s&&this._removePredictErrorStatus()}_removePredictErrorStatus(){this.removeErrorStatusByPredicate(Kt.PARSE_ERROR_PREDICATE)}_createInvalidValueStatus(e,t,r){let s=super._createInvalidValueStatus(e,t,r);return s.invalidDate=!0,s.invalidTime=!0,s.code=Kt.ErrorCode.PARSE_ERROR,s}_setDateValid(e){this._setErrorStatusPart("invalidDate",e)}_setTimeValid(e){this._setErrorStatusPart("invalidTime",e)}_isErrorStatusPartValid(e){return this.errorStatus?!this.errorStatus.asFlatList().some(t=>!!t[e]):!0}_isDateValid(){return this._isErrorStatusPartValid("invalidDate")}_isTimeValid(){return this._isErrorStatusPartValid("invalidTime")}onCellEditorRendered(e){e.openFieldPopup&&(this.hasDate&&!this.hasTime?this.openDatePopupAndSelect(this.value):!this.hasDate&&this.hasTime?this.openTimePopupAndSelect(this.value):F.get().supportsOnlyTouch()||this.openDatePopupAndSelect(this.value)),this.touchMode&&(this._cellEditorPopup=e.cellEditorPopup)}_onPopupDestroy(e){!this.touchMode||!this._cellEditorPopup||this.hasDate&&this.hasTime||(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null)}prepareForCellEdit(e){e=e||{},super.prepareForCellEdit(e),this.$field.removeClass("cell-editor-field first last"),this.$dateField&&this.addCellEditorFieldCssClasses(this.$dateField,e),this.$timeField&&(this.$dateField||(e.cssClass=""),this.addCellEditorFieldCssClasses(this.$timeField,e))}getDatePicker(){if(this.popup&&this.popup.getDatePicker)return this.popup.getDatePicker()}openDatePopupAndSelect(e){this.openDatePopup(),e?this.selectDate(e,!1):this.preselectDate(this._referenceDate(),!1)}preselectDate(e,t){let r=this.getDatePicker();r&&r.preselectDate(e,t)}selectDate(e,t){let r=this.getDatePicker();r&&r.selectDate(e,t)}getTimePicker(){if(this.popup&&this.popup.getTimePicker)return this.popup.getTimePicker()}openTimePopupAndSelect(e){!this.hasTimePopup||(this.openTimePopup(),e?this.selectTime(e):this.preselectTime(this._referenceDate()))}preselectTime(e){let t=this.getTimePicker();t&&t.preselectTime(e)}selectTime(e){let t=this.getTimePicker();t&&t.selectTime(e)}shiftSelectedDate(e,t,r){this.openDatePopup(),this.getDatePicker().shiftSelectedDate(e,t,r)}shiftSelectedTime(e,t,r){this.openTimePopup(),this.getTimePicker().shiftSelectedTime(e,t,r)}_formatValue(e){let t="",r="";return this.hasDate&&(e&&(t=this.isolatedDateFormat.format(e)),this.dateDisplayText=t),this.hasTime&&(e&&(r=this.isolatedTimeFormat.format(e)),this.timeDisplayText=r),this._computeDisplayText(this.dateDisplayText,this.timeDisplayText)}_renderFieldStyle(){super._renderFieldStyle(),this._renderFieldStyleInternal(this.$dateField),this._renderFieldStyleInternal(this.$timeField)}_renderDisabledStyle(){super._renderDisabledStyle(),this._renderDisabledStyleInternal(this.$dateField),this._renderDisabledStyleInternal(this.$timeField)}_triggerAcceptInput(e){let t={displayText:this.displayText,errorStatus:this.errorStatus,value:this.value,whileTyping:!!e};this.trigger("acceptInput",t)}}Be(Kt,"ErrorCode",{PARSE_ERROR:-1}),Be(Kt,"PARSE_ERROR_PREDICATE",i=>i.code===Kt.ErrorCode.PARSE_ERROR);function CA(i,e,t){return e=PA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function PA(i){var e=xA(i,"string");return typeof e=="symbol"?e:String(e)}function xA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Mo extends Ot{_onWidgetAcceptInput(e){let t=null,r=this.widget.errorStatus;r&&r.hasChildren()&&(t=f.find(r.asFlatList(),o=>o instanceof vi));let s={displayText:this.widget.displayText,errorStatus:t};t||(s.value=T.toJsonDate(this.widget.value)),this._send("acceptInput",s,{showBusyIndicator:!e.whileTyping,coalesce:function(o){return this.target===o.target&&this.type===o.type}})}_orderPropertyNamesOnSync(e){return Object.keys(e).sort(this._createPropertySortFunc(Mo.PROPERTIES_ORDER))}static isDateAllowedRemote(e){return this.modelAdapter?!0:this.isDateAllowedOrig(e)}static modifyPrototype(){!ie.get().remote||v.replacePrototypeFunction(Kt,"isDateAllowed",Mo.isDateAllowedRemote,!0)}}CA(Mo,"PROPERTIES_ORDER",["hasTime","hasDate"]),ie.addListener("bootstrap",Mo.modifyPrototype);function po(i,e,t){return e=FA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FA(i){var e=EA(i,"string");return typeof e=="symbol"?e:String(e)}function EA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class xc extends te{constructor(e){super(),po(this,"MIN_DATE_FIELD_WIDTH",void 0),po(this,"PREF_DATE_FIELD_WIDTH",void 0),po(this,"MIN_TIME_FIELD_WIDTH",void 0),po(this,"PREF_TIME_FIELD_WIDTH",void 0),po(this,"htmlPropertyChangeHandler",void 0),po(this,"hgap",void 0),po(this,"_dateField",void 0),this._dateField=e,this.MIN_DATE_FIELD_WIDTH=90,this.PREF_DATE_FIELD_WIDTH=110,this.MIN_TIME_FIELD_WIDTH=60,this.PREF_TIME_FIELD_WIDTH=90,this._initDefaults(),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this._dateField.one("remove",()=>ue.get().off("propertyChange",this.htmlPropertyChangeHandler))}_initDefaults(){this.hgap=ue.get().smallColumnGap}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this._dateField.invalidateLayoutTree()}layout(e){let t=S.get(e),r=this._dateField.$dateField,s=this._dateField.$timeField,o=this._dateField.$dateFieldIcon,n=this._dateField.$timeFieldIcon,l=this._dateField.$dateClearIcon,d=this._dateField.$timeClearIcon,h=this._dateField._$predictDateField,p=this._dateField._$predictTimeField,m=r?S.get(r):null,g=s?S.get(s):null,b=r?!r.isDisplayNone():!1,C=s?!s.isDisplayNone():!1,P=t.availableSize({exact:!0}).subtract(t.insets()),R,k;if(b&&C){let be=m.margins(),st=g.margins(),Ye=new qe(Math.max(be.top,st.top),Math.max(be.right,st.right),Math.max(be.bottom,st.bottom),Math.max(be.left,st.left)),ri=P.subtract(Ye),Dt=this._hgap(),si=ri.width-Dt,ko=si*.6,Bo=si-ko;R=new A(ko,ri.height),k=new A(Bo,ri.height),m.setSize(R),g.setSize(k),s.cssRight(0),o.cssTop(r.cssBorderTopWidth()).cssRight(Bo+Dt).cssHeight(R.height-r.cssBorderWidthY()),l&&l.cssTop(r.cssBorderTopWidth()).cssRight(Bo+Dt+r.cssBorderRightWidth()).cssHeight(R.height-r.cssBorderWidthY()),n.cssTop(s.cssBorderTopWidth()).cssRight(0).cssHeight(k.height-s.cssBorderWidthY()),d&&d.cssTop(s.cssBorderTopWidth()).cssRight(s.cssBorderRightWidth()).cssHeight(k.height-s.cssBorderWidthY()),r.toggleClass("compact",R.width<this.MIN_DATE_FIELD_WIDTH),s.toggleClass("compact",k.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",R.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",k.width<this.MIN_TIME_FIELD_WIDTH),h&&w.setSize(h,R),p&&(w.setSize(p,k),p.cssRight(0))}else b?(R=P.subtract(m.margins()),m.setSize(R),o.cssTop(r.cssBorderTopWidth()).cssRight(0).cssHeight(R.height-r.cssBorderWidthY()),l&&l.cssTop(r.cssBorderTopWidth()).cssRight(r.cssBorderRightWidth()).cssHeight(R.height-r.cssBorderWidthY()),r.toggleClass("compact",R.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",R.width<this.MIN_DATE_FIELD_WIDTH),h&&w.setSize(h,R)):C&&(k=P.subtract(g.margins()),g.setSize(k),n.cssTop(s.cssBorderTopWidth()).cssRight(0).cssHeight(k.height-s.cssBorderWidthY()),d&&d.cssTop(s.cssBorderTopWidth()).cssRight(s.cssBorderRightWidth()).cssHeight(k.height-s.cssBorderWidthY()),s.toggleClass("compact",k.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",k.width<this.MIN_TIME_FIELD_WIDTH),p&&w.setSize(p,k));let N=this._dateField.popup;N&&N.rendered&&N.position()}_hgap(){return this.hgap}preferredLayoutSize(e,t){let r=new A,s=this._dateField.$dateField,o=this._dateField.$timeField,n=s?!s.isDisplayNone():!1,l=o?!o.isDisplayNone():!1;return n&&l?(r=w.prefSize(this._dateField.$dateField),r.width=this.PREF_DATE_FIELD_WIDTH+this._hgap()+this.PREF_TIME_FIELD_WIDTH):n?(r=w.prefSize(this._dateField.$dateField),r.width=this.PREF_DATE_FIELD_WIDTH):l&&(r=w.prefSize(this._dateField.$timeField),r.width=this.PREF_TIME_FIELD_WIDTH),r}}function pn(i,e,t){return e=AA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function AA(i){var e=DA(i,"string");return typeof e=="symbol"?e:String(e)}function DA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class jg extends ge{constructor(){super(),pn(this,"button",void 0),pn(this,"fileInput",void 0),pn(this,"acceptTypes",void 0),pn(this,"maximumUploadSize",void 0),pn(this,"iconId",void 0),pn(this,"fileExtensions",void 0),this.button=null,this.fileInput=null,this.acceptTypes=null,this.maximumUploadSize=wi.DEFAULT_MAXIMUM_UPLOAD_SIZE}_init(e){super._init(e),this.button=u.create(Le,{parent:this,label:this._buttonLabel(),iconId:this.iconId,labelHtmlEnabled:this.labelHtmlEnabled}),this.button.on("click",this._onButtonClick.bind(this)),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",t=>{t.propertyName==="enabledComputed"&&(this.button.setEnabled(t.newValue),this.fileInput.setEnabled(t.newValue))})}_initValue(e){this.fileInput=u.create(wi,{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!F.get().supportsFile()}),super._initValue(e)}_buttonLabel(){return this.label}_render(){this.addContainer(this.$parent,"file-chooser-button has-icon"),this.addLabel();let e=this.$parent.makeDiv(),t=S.install(e,this.session);this.button.render(e),t.setLayout(new Cr(this.button.htmlComp)),this.fileInput.render(e),this.addField(e),e.setTabbable(!1),this.addStatus()}setDisplayText(e){super.setDisplayText(e),this.fileInput.setText(e),e||this.fileInput.clear()}_readDisplayText(){return this.fileInput.text}_renderLabel(){this._renderEmptyLabel()}_onButtonClick(e){this.fileInput.browse()}setLabel(e){super.setLabel(e),this.button.setLabel(this._buttonLabel())}setIconId(e){this.setProperty("iconId",e),this.button.setIconId(e)}setAcceptTypes(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}setFileExtensions(e){this.setProperty("fileExtensions",e);let t=f.ensure(e);t=t.map(r=>r.indexOf(".")===0?r:"."+r),this.setAcceptTypes(y.join(",",...t)),this.fileInput.acceptTypes=this.acceptTypes}setMaximumUploadSize(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}_onFileChange(e){this.setValue(f.first(e.files))}_validateValue(e){return this.fileInput.validateMaximumUploadSize(e),e}_formatValue(e){return e?e.name:""}getFocusableElement(){return this.button.getFocusableElement()}}class Xg extends Ot{_onWidgetPropertyChange(e){super._onWidgetPropertyChange(e),e.propertyName==="value"&&this._onValueChange(e)}_onValueChange(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}_syncDisplayText(e){this.widget.setDisplayText(e)}}function Fc(i,e,t){return e=MA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function MA(i){var e=$A(i,"string");return typeof e=="symbol"?e:String(e)}function $A(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Jg extends ge{constructor(){super(),Fc(this,"fileInput",void 0),Fc(this,"acceptTypes",void 0),Fc(this,"maximumUploadSize",void 0),this.fileInput=null,this.acceptTypes=null,this.maximumUploadSize=wi.DEFAULT_MAXIMUM_UPLOAD_SIZE}_init(e){super._init(e),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",t=>{t.propertyName==="enabledComputed"&&this.fileInput.setEnabled(t.newValue)})}_initValue(e){this.fileInput=u.create(wi,{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize}),super._initValue(e)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new Ec(this)),this.keyStrokeContext.registerKeyStroke(new Ac(this))}_render(){this.addContainer(this.$parent,"file-chooser-field has-icon"),this.addLabel(),this.addMandatoryIndicator(),this._renderFileInput(),this.addIcon(),this.addStatus()}_renderFileInput(){this.fileInput.render(),this.addField(this.fileInput.$container)}setDisplayText(e){super.setDisplayText(e),this.fileInput.setText(e),e||this.fileInput.clear()}_readDisplayText(){return this.fileInput.text}setAcceptTypes(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}_renderEnabled(){super._renderEnabled(),this.$field.setTabbable(this.enabledComputed)}_renderPlaceholder(){let e=this.fileInput.$text;e&&e.placeholder(this.label)}_removePlaceholder(){let e=this.fileInput.$text;e&&e.placeholder("")}setMaximumUploadSize(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}_clear(){this.fileInput.clear()}_onIconMouseDown(e){super._onIconMouseDown(e),this.activate()}_onFileChange(e){let t=f.first(e.files);v.isNullOrUndefined(t)&&this.acceptInput(!1),this.setValue(t)}activate(){!this.enabledComputed||!this.rendered||(this.$field.focus(),this.fileInput.browse())}_validateValue(e){return this.fileInput.validateMaximumUploadSize(e),e}_formatValue(e){return e?e.name:""}_parseValue(e){if(!e)return null;let t=this.fileInput.files;return t&&t.length?t[0]:null}}function RA(i,e,t){return e=LA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LA(i){var e=IA(i,"string");return typeof e=="symbol"?e:String(e)}function IA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class El extends Ot{_onWidgetPropertyChange(e){super._onWidgetPropertyChange(e),e.propertyName==="value"&&this._onValueChange(e)}_onValueChange(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}_syncDisplayText(e){this.widget.setDisplayText(e)}_orderPropertyNamesOnSync(e){return Object.keys(e).sort(this._createPropertySortFunc(El.PROPERTIES_ORDER))}}RA(El,"PROPERTIES_ORDER",["value","displayText"]);class Ec extends B{constructor(e){super(),this.field=e,this.which=[_.SPACE],this.stopPropagation=!0,this.renderingHints.hAlign=ht.LEFT,this.renderingHints.$drawingArea=(t,r)=>this.field.$fieldContainer}handle(e){this.field.fileInput.browse()}}class Ac extends B{constructor(e){super(),this.field=e,this.which=[_.DELETE],this.stopPropagation=!0,this.renderingHints.offset=25,this.renderingHints.hAlign=ht.RIGHT,this.renderingHints.$drawingArea=(t,r)=>this.field.$fieldContainer}handle(e){this.field.clear()}}function Re(i,e,t){return e=kA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kA(i){var e=BA(i,"string");return typeof e=="symbol"?e:String(e)}function BA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fe extends xs{constructor(){super(),Re(this,"fields",void 0),Re(this,"menuBarVisible",void 0),Re(this,"menuBarPosition",void 0),Re(this,"menuBarEllipsisPosition",void 0),Re(this,"notification",void 0),Re(this,"bodyLayoutConfig",void 0),Re(this,"borderDecoration",void 0),Re(this,"borderVisible",void 0),Re(this,"mainBox",void 0),Re(this,"menuBar",void 0),Re(this,"subLabel",void 0),Re(this,"scrollable",void 0),Re(this,"expandable",void 0),Re(this,"expanded",void 0),Re(this,"gridColumnCount",void 0),Re(this,"controls",void 0),Re(this,"systemButtons",void 0),Re(this,"customButtons",void 0),Re(this,"processButtons",void 0),Re(this,"processMenus",void 0),Re(this,"staticMenus",void 0),Re(this,"responsive",void 0),Re(this,"responsiveHandler",void 0),Re(this,"htmlBody",void 0),Re(this,"$header",void 0),Re(this,"$body",void 0),Re(this,"$title",void 0),Re(this,"$borderBottom",void 0),Re(this,"$subLabel",void 0),Re(this,"_statusPositionOrig",void 0),Re(this,"_collapsedWeightY",void 0),this._addWidgetProperties(["fields","notification","staticMenus"]),this._addCloneProperties(["menuBarVisible","bodyLayoutConfig","borderDecoration","borderVisible","expandable","expanded","gridColumnCount","scrollable","subLabel"]),this.fields=[],this.menuBarVisible=!0,this.menuBarPosition=Fe.MenuBarPosition.AUTO,this.menuBarEllipsisPosition=ce.EllipsisPosition.RIGHT,this.notification=null,this.bodyLayoutConfig=null,this.borderDecoration=Fe.BorderDecoration.AUTO,this.borderVisible=!0,this.mainBox=!1,this.scrollable=null,this.expandable=!1,this.expanded=!0,this.logicalGrid=u.create(dh),this.gridColumnCount=2,this.gridDataHints.useUiHeight=!0,this.gridDataHints.w=M.FULL_WIDTH,this.controls=[],this.systemButtons=[],this.customButtons=[],this.processButtons=[],this.processMenus=[],this.staticMenus=[],this.responsive=null,this.$header=null,this.$body=null,this.$title=null,this.$subLabel=null,this._statusPositionOrig=null}_init(e){super._init(e),this.resolveConsts([{property:"menuBarPosition",constType:Fe.MenuBarPosition}]),this._setBodyLayoutConfig(this.bodyLayoutConfig),this.menuBar=u.create(ce,{parent:this,menuOrder:new rs,ellipsisPosition:this.menuBarEllipsisPosition}),this.menuBar.on("propertyChange:visible",()=>this._updateMenuBarStyle()),this._setFields(this.fields),this._setMainBox(this.mainBox),this._updateMenuBar(),ne.get().registerHandler(this,u.create($n,{widget:this})),this._setResponsive(this.responsive)}_destroy(){ne.get().unregisterHandler(this),super._destroy()}getFields(){return this.fields}insertField(e,t){let r=this.fields.slice();t=u.nvl(t,this.fields.length),r.splice(t,0,e),this.setFields(r)}insertFieldBefore(e,t){u.assertParameter("sibling",t);let r=this.fields.indexOf(t);this.insertField(e,r)}insertFieldAfter(e,t){u.assertParameter("sibling",t);let r=this.fields.indexOf(t)+1;this.insertField(e,r)}deleteField(e){let t=this.fields.indexOf(e);if(t<0)return;let r=this.fields.slice();r.splice(t,1),this.setFields(r)}setFields(e){this.setProperty("fields",e)}_setFields(e){this._setProperty("fields",e),this._prepareFields()}_renderFields(e){this._renderExpanded(),this.invalidateLogicalGrid(!0)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.$bindTarget=this._keyStrokeBindTarget.bind(this)}_setKeyStrokes(e){e=f.ensure(e);let t={render:()=>!0,offset:0,hAlign:ht.RIGHT,$drawingArea:(r,s)=>this.$header&&this.$header.isVisible()?this.$header:this.$body};e.forEach(r=>{r.actionKeyStroke.renderingHints=a().extend({},r.actionKeyStroke.renderingHints,t)}),super._setKeyStrokes(e)}_keyStrokeBindTarget(){let e=this.getForm();return e?e.$container:this.$container}_render(){this.addContainer(this.$parent,this.mainBox?"root-group-box":"group-box"),this.$header=this.$container.appendDiv("group-box-header"),S.install(this.$header,this.session),this.$title=this.$header.appendDiv("title"),this.$borderBottom=this.$header.appendDiv("bottom-border"),this.addLabel(),this.addSubLabel(),this.addStatus(),this.$body=this.$container.appendDiv("group-box-body"),this.htmlBody=S.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout())}_remove(){this._removeSubLabel(),super._remove()}_renderProperties(){this._renderScrollable(),this._renderExpanded(),super._renderProperties(),this._renderBodyLayoutConfig(),this._renderNotification(),this._renderBorderVisible(),this._renderExpandable(),this._renderMenuBarPosition(),this._renderMenuBarEllipsisPosition(),this._renderMenuBarVisible(),this._renderSubLabel()}_createLayout(){return new rd(this)}_createBodyLayout(){return new Uo(this,this.bodyLayoutConfig)}setBodyLayoutConfig(e){this.setProperty("bodyLayoutConfig",e)}_setBodyLayoutConfig(e){e||(e=new di),this._setProperty("bodyLayoutConfig",di.ensure(e))}_renderBodyLayoutConfig(){let e=this.htmlBody.layout,t=e.minWidth;this.bodyLayoutConfig.applyToLayout(e),t!==this.bodyLayoutConfig.minWidth&&this._renderScrollable(),this.rendered&&this.htmlBody.invalidateLayoutTree()}rerenderControls(){this._removeControls(),this._renderControls(),this.htmlBody.invalidateLayoutTree()}_removeControls(){this.controls.forEach(e=>e.remove())}_renderControls(){this.controls.forEach(e=>{e.rendered||(e.render(this.$body),e.setLayoutData(new Nr(e)))})}addSubLabel(){this.$subLabel||(this.$subLabel=this.$title.appendDiv("sub-label"),G.installForEllipsis(this.$subLabel,{parent:this}))}_removeSubLabel(){!this.$subLabel||(G.uninstall(this.$subLabel),this.$subLabel.remove(),this.$subLabel=null)}setSubLabel(e){this.setProperty("subLabel",e)}_renderSubLabel(){this.$subLabel.setVisible(y.hasText(this.subLabel)),this.$subLabel.textOrNbsp(this.subLabel),this.$container.toggleClass("has-sub-label",this.$subLabel.isVisible()),this.invalidateLayoutTree()}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.bodyLayoutConfig.minWidth>0?"both":"y"}):this.bodyLayoutConfig.minWidth>0&&this._installScrollbars({axis:"x"})}get$Scrollable(){return this.$body}_onScroll(e){super._onScroll(e),this._updateScrollShadow()}_updateScrollShadow(){if(this.mainBox||!this.rendered)return;let e=this.hasScrollShadow("top"),t=this.hasScrollShadow("bottom"),r=this.$container.hasClass("has-scroll-shadow-top"),s=this.$container.hasClass("has-scroll-shadow-bottom"),o=this.$container.hasClass("menubar-position-top"),n=this.$container.hasClass("menubar-position-bottom"),l=this.$header.isVisible();this.$container.toggleClass("has-scroll-shadow-top",e),this.$container.toggleClass("has-scroll-shadow-bottom",t),((l||o)&&r!==e||n&&s!==t)&&this.invalidateLayoutTree(!1),ee.adjustStatusPositionForScrollShadow(this,()=>e&&l&&!o)}setMainBox(e){this.setProperty("mainBox",e)}_setMainBox(e){this._setProperty("mainBox",e),this.mainBox&&(this.menuBar.setCssClass("main-menubar"),this.scrollable===null&&this.setScrollable(!0),this.responsive===null&&this.setResponsive(!0))}addLabel(){this.$label||(this.$label=this.$title.appendDiv("label"),G.installForEllipsis(this.$label,{parent:this}))}_renderLabel(){this.$label.textOrNbsp(this.label),this.rendered&&this._renderLabelVisible()}addStatus(){super.addStatus(),this._updateStatusPosition()}_renderStatusPosition(){this._updateStatusPosition()}_updateStatusPosition(){!this.fieldStatus||(this.statusPosition===M.StatusPosition.TOP?this.$status.appendTo(this.$header):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}setNotification(e){this.setProperty("notification",e)}_renderNotification(){if(!this.notification){this.invalidateLayoutTree();return}this.notification.render(),this.notification.$container.insertBefore(this.$body),this.invalidateLayoutTree()}_prepareFields(){this.processButtons.forEach(this._unregisterButtonKeyStrokes.bind(this)),this.controls=[],this.systemButtons=[],this.customButtons=[],this.processButtons=[],this.processMenus=[];for(let e=0;e<this.fields.length;e++){let t=this.fields[e];if(t instanceof Le)t.processButton?(this.processButtons.push(t),t.systemType!==Le.SystemType.NONE?this.systemButtons.push(t):this.customButtons.push(t)):(this.controls.push(t),this._registerButtonKeyStrokes(t));else if(t instanceof mn){this.controls.push(t);for(let r=0;r<t.tabItems.length;r++)t.tabItems[r].selectionKeystroke&&this.keyStrokeContext.registerKeyStroke(new gh(t.tabItems[r].selectionKeystroke,t.tabItems[r]))}else this.controls.push(t)}this.processMenus=this.processButtons.map(e=>{let t=Dn.adaptButtonProperties(e,{parent:this,menubar:this.menuBar,button:e,defaultMenu:e.defaultButton?!0:null});return u.create(Dn,t)}),this.registerKeyStrokes(this.processMenus)}_unregisterButtonKeyStrokes(e){e.keyStrokes&&e.keyStrokes.forEach(t=>this.keyStrokeContext.unregisterKeyStroke(t))}_registerButtonKeyStrokes(e){e.keyStrokes&&e.keyStrokes.forEach(t=>this.keyStrokeContext.registerKeyStroke(t))}setBorderVisible(e){this.setProperty("borderVisible",e)}_renderBorderVisible(){let e=this.borderVisible;this.borderDecoration===Fe.BorderDecoration.AUTO&&(e=this._computeBorderVisible(e)),this.$body.toggleClass("y-padding-invisible",!e),this.invalidateLayoutTree()}setBorderDecoration(e){this.setProperty("borderDecoration",e)}_renderBorderDecoration(){this._renderBorderVisible()}getContextMenuItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this.menuBarVisible?[]:super.getContextMenuItems(e)}setMenuBarVisible(e){this.setProperty("menuBarVisible",e)}_setMenuBarVisible(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}_renderMenuBarVisible(){this.menuBarVisible?this._renderMenuBar():this.menuBar.remove(),this._updateMenus(),this.invalidateLayoutTree()}_renderMenuBar(){if(this.menuBar.render(),this.menuBarPosition===Fe.MenuBarPosition.TITLE){let e=this.$header.children(".group-box-control");e.length>0?this.menuBar.$container.insertAfter(e):this.menuBar.$container.insertAfter(this.$title)}else this.menuBar.position===ce.Position.TOP&&this.menuBar.$container.insertAfter(this.$header)}setMenuBarPosition(e){this.setProperty("menuBarPosition",e)}_renderMenuBarPosition(){let e=this.menuBarPosition;if(e===Fe.MenuBarPosition.AUTO&&(e=Fe.MenuBarPosition.TOP,this.mainBox)){let t=this.getForm();t&&t.isDialog()&&(e=Fe.MenuBarPosition.BOTTOM)}e===Fe.MenuBarPosition.BOTTOM?this.menuBar.setPosition(ce.Position.BOTTOM):this.menuBar.setPosition(ce.Position.TOP),this._renderMenuBarStyle(),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}setMenuBarEllipsisPosition(e){this.setProperty("menuBarEllipsisPosition",e),this.menuBar.setEllipsisPosition(e)}_renderMenuBarEllipsisPosition(){this.menuBar.reorderMenus(),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}_updateMenuBarStyle(){this.rendered&&this._renderMenuBarStyle()}_renderMenuBarStyle(){let e=this.menuBar.visible,t=this.menuBarPosition===Fe.MenuBarPosition.TITLE;this.$header.toggleClass("has-menubar",e&&t),this.$container.toggleClass("menubar-position-top",e&&!t&&this.menuBar.position===ce.Position.TOP),this.$container.toggleClass("menubar-position-bottom",e&&!t&&this.menuBar.position===ce.Position.BOTTOM)}_computeBorderVisible(e){return(this.mainBox||this.parent instanceof Fe&&this.parent.parent instanceof Y&&this.parent.parent.parent instanceof _n&&this.parent.parent.parent.parent instanceof _e&&this.parent.getFields().length===1)&&(e=!1),e}setExpandable(e){this.setProperty("expandable",e)}_renderExpandable(){let e=this.expandable,t=this.$header.children(".group-box-control");e?(t.length===0&&this.$container.makeDiv("group-box-control").on("click",this._onControlClick.bind(this)).insertAfter(this.$title),this.$header.addClass("expandable").on("click.group-box-control",this._onControlClick.bind(this))):(t.remove(),this.$header.removeClass("expandable").off(".group-box-control")),this.invalidateLayoutTree()}setExpanded(e){this.setProperty("expanded",e)}_renderExpanded(){this.$container.toggleClass("collapsed",!this.expanded),this.expanded?(this._collapsedWeightY!==void 0&&(this.gridData.weightY=this._collapsedWeightY,delete this._collapsedWeightY),this.invalidateLayout(),this._renderControls()):this.gridData.weightY!==0&&(this._collapsedWeightY=this.gridData.weightY,this.gridData.weightY=0),this.invalidateLayoutTree()}setGridColumnCount(e){this.setProperty("gridColumnCount",e),this.invalidateLogicalGrid()}invalidateLogicalGrid(e){super.invalidateLogicalGrid(!1),u.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}_setLogicalGrid(e){super._setLogicalGrid(e),this.logicalGrid&&this.logicalGrid.setGridConfig(new Dc)}_renderLabelVisible(){this.$header.setVisible(this._computeTitleVisible()),this._updateFieldStatus(),this.menuBarPosition===Fe.MenuBarPosition.TITLE&&this.invalidateLayoutTree()}_computeTitleVisible(e){return e=u.nvl(e,this.labelVisible),!!(e&&this.label&&!this.mainBox)}_computeStatusVisible(){return super._computeStatusVisible()&&this._computeTitleVisible()}_setMenus(e){super._setMenus(e),this.menuBar&&this._updateMenuBar()}_updateMenuBar(){if(!this.menuBarVisible){this.menuBar.setMenuItems([]);return}let e=this.staticMenus.concat(this.processMenus).concat(this.menus);this.menuBar.setMenuItems(e)}_removeMenus(){}setStaticMenus(e){this.setProperty("staticMenus",e),this._updateMenuBar()}_onControlClick(e){if(!this.expandable)return;const t=u.widget(e.target);this.menuBarPosition===Fe.MenuBarPosition.TITLE&&this.menuBar.has(t)||(this.setExpanded(!this.expanded),a().suppressEvent(e))}setResponsive(e){this.setProperty("responsive",e)}_setResponsive(e){if(this._setProperty("responsive",e),!!this.initialized){if(this.responsive)ne.get().reset(this,!0);else if(ne.get().reset(this,!0),this.responsive===null){let t=this.findParent(r=>r instanceof Fe&&r.responsive);ne.get().reset(t,!0)}this.invalidateLayoutTree()}}clone(e,t){let r=super.clone(e);return this._deepCloneProperties(r,["fields"],t),r._prepareFields(),r}}Re(Fe,"BorderDecoration",{AUTO:"auto",EMPTY:"empty",LINE:"line"}),Re(Fe,"MenuBarPosition",{AUTO:"auto",TOP:"top",BOTTOM:"bottom",TITLE:"title"});class Dc extends gs{getGridWidgets(){return this.widget.controls}getGridColumnCount(){let e=-1,t=this.widget;do e=u.nvl(t.gridColumnCount,e);while(e<0&&t.getParentGroupBox&&(t=t.getParentGroupBox()));return e<0?2:e}}class Mc extends un{constructor(){super(),this._addRemoteProperties(["expanded"])}_initModel(e,t){let r=super._initModel(e,t);return r.logicalGrid=null,r}_postCreateWidget(){super._postCreateWidget(),this.widget.responsiveHandler&&(this.widget.responsiveHandler.setAllowedStates([ne.ResponsiveState.NORMAL,ne.ResponsiveState.CONDENSED]),this.widget.responsiveHandler.getGridData=this._getGridData,this.widget.responsiveHandler.setGridData=this._setGridData)}_getGridData(e){return new ze(e.gridData)}_setGridData(e,t){e._setGridData(t)}}function $c(i,e,t){return e=OA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function OA(i){var e=HA(i,"string");return typeof e=="symbol"?e:String(e)}function HA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class rd extends te{constructor(e){super(),$c(this,"groupBox",void 0),$c(this,"_htmlPropertyChangeHandler",void 0),$c(this,"_statusWidth",void 0),this.groupBox=e,this._initDefaults(),this._htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this._htmlPropertyChangeHandler),this.groupBox.one("remove",()=>{ue.get().off("propertyChange",this._htmlPropertyChangeHandler)})}_initDefaults(){this._statusWidth=ue.get().fieldStatusWidth}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this.groupBox.invalidateLayoutTree()}layout(e){let t,r=0,s=0,o=this.groupBox.statusPosition,n=this.groupBox.htmlComp,l=this._htmlGbBody(),d=this._htmlMenuBar(),h=this.groupBox.tooltip(),p=this.groupBox.$header,m=this.groupBox.$title,g=n.availableSize().subtract(n.insets());this.groupBox.responsive&&ne.get().handleResponsive(this.groupBox,g.width);let b=this._$status();b&&b.isVisible()&&(this._layoutStatus(),s=b.outerWidth(!0)),d?(this.groupBox.menuBarPosition===Fe.MenuBarPosition.TITLE?t=this._updateHeaderMenuBar(d,p,m,s):(t=this._updateMenuBar(d,g,s),r=t.height,P(m)),d.setSize(t)):P(m),o!==M.StatusPosition.TOP?P(p,s):P(p),this.groupBox.notification&&P(this.groupBox.notification.$container,s);let C=g.subtract(l.margins());C.height-=this._headerHeight(),C.height-=this._notificationHeight(),C.height-=r,a().log.isTraceEnabled()&&a().log.trace("(GroupBoxLayout#layout) gbBodySize="+C),l.setSize(C),h&&h.rendered&&h.position(),(l.scrollable||this.groupBox.bodyLayoutConfig.minWidth>0)&&x.update(l.$comp);function P(R,k){if(k){let N=R.cssMarginX()+k;R.cssWidth("calc(100% - "+N+"px)")}else R.cssWidth("")}}_updateMenuBar(e,t,r){let s=this.groupBox.$container,o=e.$comp;if(!this.groupBox.mainBox&&s.hasClass("menubar-position-top")&&s.hasClass("has-scroll-shadow-top")||s.hasClass("menubar-position-bottom")&&s.hasClass("has-scroll-shadow-bottom")){let n=w.margins(o);n.left>0&&(o.cssPaddingLeft(n.left),o.cssMarginLeft(0)),r>0&&(o.cssPaddingRight(r),r=0)}else o.cssPaddingLeft(""),o.cssMarginLeft(""),o.cssPaddingRight("");return this._menuBarSize(e,t,r)}_menuBarSize(e,t,r){let s=Zr.size(e,t);return this.groupBox.mainBox||(s.width-=r),s}_updateHeaderMenuBar(e,t,r,s){let o=e.prefSize({exact:!0}),l=w.prefSize(t).subtract(w.insets(t)).width-s,d=t.children(".group-box-control");d.length>0&&(l-=w.size(d,!0).width);let h=Math.ceil(w.prefSize(r,!0).width)+1,p=o.width;if(h+p<l)p=Math.floor(l-h),o.width=p,r.cssWidth("");else{let m=(h+p)/l,g=h/l/m,b=p/l/m;g<b?(g=Math.max(.33,g),b=1-g):(b=Math.max(.33,b),g=1-b),h=g*l,p=b*l,o.width=Math.floor(p),r.cssWidth(Math.floor(h))}return o}_$status(){return this.groupBox.$status}_layoutStatus(){let e=this.groupBox.htmlComp,t=e.insets({includeBorder:!1}),r=t.top,s=t.right,o=this.groupBox.$header,n=o.innerHeight(),l=this._$status(),d=w.margins(l),h=this.groupBox.statusPosition;l.cssWidth(this._statusWidth),h===M.StatusPosition.DEFAULT&&(r+=o.cssMarginTop()),l.cssTop(r).cssRight(s).cssHeight(n-d.vertical())}preferredLayoutSize(e,t){t=t||{};let r=this.groupBox.htmlComp,s=this._htmlGbBody(),o,n=0,l=0,d=this.groupBox.gridData,h=!1;if(this.groupBox.responsive&&t.widthHint&&(h=ne.get().handleResponsive(this.groupBox,t.widthHint)),d&&(n=d.widthInPixel,l=d.heightInPixel),n&&l)return o=new A(n,l).add(r.insets()),o;if(!t.widthHint&&n&&(t.widthHint=n),t.heightHint=null,this.groupBox.expanded){o=s.prefSize(t).add(s.margins());let p=this._htmlMenuBar();p&&this.groupBox.menuBarPosition!==Fe.MenuBarPosition.TITLE&&(o.height+=p.prefSize(t).height)}else o=new A(0,0);return o=o.add(r.insets()),o.height+=this._headerHeight(),o.height+=this._notificationHeight(t),n&&(o.width=n),l&&(o.height=l),h&&ne.get().reset(this.groupBox),o}_headerHeight(){return w.prefSize(this.groupBox.$header,!0).height}_notificationHeight(e){return e=e||{},this.groupBox.notification?(e.includeMargin=!0,this.groupBox.notification.htmlComp.prefSize(e).height):0}_htmlMenuBar(){if(this.groupBox.menuBar&&this.groupBox.menuBarVisible){let e=S.optGet(this.groupBox.menuBar.$container);if(e&&e.isVisible())return e}return null}_htmlGbBody(){return S.get(this.groupBox.$body)}}class rs{order(e){let t=[],r=[],s=[],o=[];return e.forEach(n=>{n.isButton()?n.horizontalAlignment===1?s.push(n):t.push(n):n.horizontalAlignment===1?o.push(n):r.push(n)}),{left:t.concat(r),right:o.concat(s),all:t.concat(r).concat(o).concat(s)}}}function Rc(i,e,t){return e=NA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NA(i){var e=VA(i,"string");return typeof e=="symbol"?e:String(e)}function VA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Lc extends ge{constructor(){super(),Rc(this,"scrollBarEnabled",void 0),Rc(this,"selectable",void 0),Rc(this,"scrollToAnchor",void 0),this.scrollBarEnabled=!1,this.scrollToAnchor=null,this.preventInitialFocus=!0,this.selectable=!0}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new hn(this,this._onAppLinkAction))}_render(){this.addContainer(this.$parent,"html-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderScrollBarEnabled(),this._renderScrollToAnchor(),this._renderSelectable()}_readDisplayText(){return this.displayText}_renderDisplayText(){if(!this.displayText){this.$field.empty();return}this.$field.html(this.displayText),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$field.find("a, .app-link").attr("tabindex","0").unfocusable(),this.$field.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollBarEnabled()),this.invalidateLayoutTree()}_renderFocused(){}setScrollBarEnabled(e){this.setProperty("scrollBarEnabled",e)}_renderScrollBarEnabled(){this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}_renderScrollToAnchor(){if(!this.rendered){this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollToAnchor.bind(this));return}if(this.scrollBarEnabled&&this.scrollToAnchor){let e=this.$field.find("#".concat(this.scrollToAnchor));e&&e.length>0&&x.scrollTo(this.$field,e)}}setSelectable(e){this.setProperty("selectable",e)}_renderSelectable(){this.$container.toggleClass("selectable",!!this.selectable),this.$field.toggleAttr("tabindex",!!this.selectable,"-1")}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}_onImageLoad(e){this.invalidateLayoutTree()}_onImageError(e){this.invalidateLayoutTree()}}class Qg extends Ot{_initProperties(e){e.scrollToEnd!==void 0&&delete e.scrollToEnd}_syncScrollToEnd(){this.widget.scrollToBottom()}_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function Br(i,e,t){return e=WA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WA(i){var e=KA(i,"string");return typeof e=="symbol"?e:String(e)}function KA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Hs extends M{constructor(){super(),Br(this,"autoFit",void 0),Br(this,"imageUrl",void 0),Br(this,"scrollBarEnabled",void 0),Br(this,"uploadEnabled",void 0),Br(this,"acceptTypes",void 0),Br(this,"maximumUploadSize",void 0),Br(this,"icon",void 0),Br(this,"fileInput",void 0),Br(this,"_clickHandler",void 0),this.defaultMenuTypes=[...this.defaultMenuTypes,Hs.MenuTypes.ImageUrl,Hs.MenuTypes.Null],this.autoFit=!1,this.imageUrl=null,this.scrollBarEnabled=!1,this.uploadEnabled=!1,this.acceptTypes=null,this.maximumUploadSize=wi.DEFAULT_MAXIMUM_UPLOAD_SIZE,this._clickHandler=null}_init(e){super._init(e),this.resolveIconIds(["imageUrl"]),this.icon=u.create(Qr,{parent:this,iconDesc:this.imageUrl,autoFit:this.autoFit,prepend:!0}),this.icon.on("load",this._onImageLoad.bind(this)),this.icon.on("error",this._onImageError.bind(this))}_render(){this.addContainer(this.$parent,"image-field",new Ic(this)),this.addFieldContainer(this.$parent.makeDiv()),S.install(this.$fieldContainer,this.session).setLayout(new Cr),this.icon.render(this.$fieldContainer),this.addLabel(),this.addField(this.icon.$container),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderScrollBarEnabled(),this._renderImageUrl(),this._renderUploadEnabled()}_remove(){super._remove(),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null)}_getDragAndDropHandlerOptions(){let e=super._getDragAndDropHandlerOptions();return e.container=()=>this.$fieldContainer,e}setImageUrl(e){this.setProperty("imageUrl",e)}_setImageUrl(e){this._setProperty("imageUrl",e),this.icon.setIconDesc(e),this._updateMenus()}_renderImageUrl(){let e=!!this.imageUrl;this.$fieldContainer.toggleClass("has-image",e),this.$container.toggleClass("has-image",e),x.update(this.$fieldContainer)}setAutoFit(e){this.setProperty("autoFit",e)}_setAutoFit(e){this._setProperty("autoFit",e),this.icon.setAutoFit(e)}_renderAutoFit(){x.update(this.$fieldContainer)}setScrollBarEnabled(e){this.setProperty("scrollBarEnabled",e)}_renderScrollBarEnabled(){this._updateInnerAlignment(),this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}get$Scrollable(){return this.$fieldContainer}_renderGridData(){super._renderGridData(),this._updateInnerAlignment()}_renderGridDataHints(){super._renderGridDataHints(),this._updateInnerAlignment()}_updateInnerAlignment(){this.updateInnerAlignment({useHorizontalAlignment:!this.scrollBarEnabled,useVerticalAlignment:!this.scrollBarEnabled})}_renderEnabled(){super._renderEnabled(),this._updateUploadEnabled()}setUploadEnabled(e){this.setProperty("uploadEnabled",e)}_renderUploadEnabled(){this._updateUploadEnabled()}_updateUploadEnabled(){let e=this.enabledComputed&&this.uploadEnabled;this.$fieldContainer.toggleClass("clickable",e),e?(this._clickHandler||(this._clickHandler=this._onClickUpload.bind(this),this.$fieldContainer.on("click",this._clickHandler)),this.fileInput||(this.fileInput=u.create(wi,{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!F.get().supportsFile()}),this.fileInput.render(this.$fieldContainer),this.fileInput.on("change",this._onFileChange.bind(this)))):(this.$fieldContainer.off("click",this._clickHandler),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null))}_getCurrentMenuTypes(){return this.imageUrl?[...super._getCurrentMenuTypes(),Hs.MenuTypes.ImageUrl]:[...super._getCurrentMenuTypes(),Hs.MenuTypes.Null]}_onClickUpload(e){a()(e.target).isOrHas(this.$field)&&this.fileInput.browse()}_onFileChange(e){this.trigger("fileUpload",{file:f.first(e.files)})}_onImageLoad(e){this._onIconUpdated()}_onImageError(e){this._onIconUpdated()}_onIconUpdated(){x.update(this.$fieldContainer),this.$field=this.icon.$container}}Br(Hs,"MenuTypes",{Null:"ImageField.Null",ImageUrl:"ImageField.ImageUrl"});class Zg extends dt{_onWidgetEvent(e){e.type==="fileUpload"?this._onFileUpload(e):super._onWidgetEvent(e)}_onFileUpload(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}}class Ic extends li{constructor(e){super(e)}layout(e){super.layout(e),x.update(this.formField.$fieldContainer)}}function kc(i,e,t){return e=zA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zA(i){var e=GA(i,"string");return typeof e=="symbol"?e:String(e)}function GA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class sd extends ge{constructor(){super(),kc(this,"htmlEnabled",void 0),kc(this,"selectable",void 0),kc(this,"wrapText",void 0),this.htmlEnabled=!1,this.selectable=!0,this.wrapText=!1,this.preventInitialFocus=!0}_initValue(e){e=Ce.resolveText(e,this.session.locale.languageTag),super._initValue(e)}_render(){this.addContainer(this.$parent,"label-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderWrapText(),this._renderSelectable()}_renderFocused(){}acceptInput(e){}setHtmlEnabled(e){this.setProperty("htmlEnabled",e)}_renderHtmlEnabled(){this._renderDisplayText()}_renderDisplayText(){let e=this.displayText||"";this.htmlEnabled?(this.$field.html(e),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$field.html(y.nl2br(e)),this.invalidateLayoutTree()}setWrapText(e){this.setProperty("wrapText",e)}_renderWrapText(){this.$field.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}setSelectable(e){this.setProperty("selectable",e)}_renderSelectable(){this.$container.toggleClass("selectable",!!this.selectable),this.$field.toggleAttr("tabindex",!!this.selectable,"-1")}_renderGridData(){super._renderGridData(),this.updateInnerAlignment({useHorizontalAlignment:!0})}_renderGridDataHints(){super._renderGridDataHints(),this.updateInnerAlignment({useHorizontalAlignment:!0})}_onAppLinkAction(e){let r=$(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}addField(e){super.addField(e),this.$field.off("blur").off("focus")}}class e_ extends Ot{_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function UA(i,e,t){return e=qA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qA(i){var e=YA(i,"string");return typeof e=="symbol"?e:String(e)}function YA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class od extends Po{constructor(){super(),UA(this,"table",void 0),this.table=null,this.lookupStatus=null,this._addWidgetProperties(["table","filterBox"])}_init(e){super._init(e),this.table.on("rowsChecked",this._onTableRowsChecked.bind(this)),this.table.setScrollTop(this.scrollTop)}_initStructure(e){this.table||(this.table=this._createDefaultListBoxTable()),this.table.checkableColumn&&(this.table.checkableColumn.minWidth=28,this.table.checkableColumn.width=this.table.checkableColumn.minWidth)}_render(){super._render(),this.$container.addClass("list-box")}_createFieldContainerLayout(){return new Bc(this,this.table,this.filterBox)}_renderStructure(){this.table.render(this.$fieldContainer),this.addField(this.table.$container)}_onTableRowsChecked(e){this._syncTableToValue()}_syncTableToValue(){if(!this.lookupCall||this._valueSyncing)return;this._valueSyncing=!0;let e=[];this.table.rows.forEach(t=>{t.checked&&e.push(t.lookupRow.key)},this),this.setValue(e),this._valueSyncing=!1}_valueChanged(){super._valueChanged(),this._syncValueToTable(this.value)}_syncValueToTable(e){if(!this.lookupCall||this._valueSyncing||!this.initialized)return;this._valueSyncing=!0;let t={checkOnlyEnabled:!1};try{if(f.empty(e))this.table.uncheckRows(this.table.rows,t);else{if(this._ensureLookupCallExecuted())return;let s=[];this.table.uncheckRows(this.table.rows,t),this.table.rows.forEach(o=>{f.containsAny(e,o.lookupRow.key)&&s.push(o)},this),this.table.checkRows(s,t)}this._updateDisplayText()}finally{this._valueSyncing=!1}}_lookupByAllDone(e){return super._lookupByAllDone(e)?(this._populateTable(e),!0):!1}_populateTable(e){let t=[];e.lookupRows.forEach(function(s){t.push(this._createTableRow(s))},this),this.table.deleteAllRows(),this.table.insertRows(t),this._syncValueToTable(this.value)}getCheckedLookupRows(){return this.value===null||f.empty(this.value)||this.table.rows.length===0?[]:this.table.rows.filter(e=>e.checked).map(e=>e.lookupRow)}_createTableRow(e){let t=u.create(Pt,{text:e.text}),r=[t],s={cells:r,lookupRow:e};return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),e.enabled===!1&&(s.enabled=!1),e.cssClass&&(s.cssClass=e.cssClass),e.active===!1&&(s.active=!1,s.cssClass=(s.cssClass?s.cssClass+" ":"")+"inactive"),s}_createDefaultListBoxTable(){return u.create(W,{parent:this,autoResizeColumns:!0,checkable:!0,checkableStyle:W.CheckableStyle.CHECKBOX_TABLE_ROW,headerVisible:!1,footerVisible:!1,columns:[{objectType:Me}]})}getDelegateScrollable(){return this.table}}class t_ extends Ot{}class Bc extends Za{constructor(e,t,r){super(e,t,r)}}const fn={createTableRow(i,e){e=u.nvl(e,!1);let t=[],r={cells:t,lookupRow:i};return i.enabled===!1&&(r.enabled=!1),i.cssClass&&(r.cssClass=i.cssClass),i.active===!1&&(r.cssClass=(r.cssClass?r.cssClass+" ":"")+"inactive"),e||t.push(fn.createTableCell(i,null,null)),r},createTableCell(i,e,t){let r=u.create(Pt);return e&&e.propertyName?r.text=t[e.propertyName]:(r.text=i.text,i.iconId&&(r.iconId=i.iconId),i.tooltipText&&(r.tooltipText=i.tooltipText),i.backgroundColor&&(r.backgroundColor=i.backgroundColor),i.foregroundColor&&(r.foregroundColor=i.foregroundColor),i.font&&(r.font=i.font)),r}};class nd extends Ot{sendLookup(e,t){let r=e.toLowerCase(),s="lookupBy"+y.toUpperCaseFirstLetter(r),o={showBusyIndicator:!1};v.isNullOrUndefined(t)||(o[r]=t),this._send(s,o)}}function Oc(i,e,t){return e=jA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jA(i){var e=XA(i,"string");return typeof e=="symbol"?e:String(e)}function XA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class i_ extends ge{constructor(){super(),Oc(this,"modeSelector",void 0),Oc(this,"modes",void 0),Oc(this,"_selectedModeChangeHandler",void 0),this._addWidgetProperties(["modeSelector","modes"]),this._selectedModeChangeHandler=this._onSelectedModeChange.bind(this)}_render(){this.addContainer(this.$parent,"mode-selector-field"),this.addLabel(),this.addStatus(),this.modeSelector&&(this._renderModeSelector(),this.modeSelector.on("propertyChange:selectedMode",this._selectedModeChangeHandler))}_renderModeSelector(){this.modeSelector.render(),this.addField(this.modeSelector.$container)}_removeModeSelector(){this.modeSelector.remove(),this._removeField()}_onSelectedModeChange(e){e.newValue?this.setValue(e.newValue.ref):this.modeSelector.selectedMode&&this.modeSelector.selectedMode.id?this.setValue(this.modeSelector.selectedMode.id):this.setValue(null)}}class r_ extends Ot{_createWidget(e){return this._addModeSelector(e),super._createWidget(e)}_addModeSelector(e){e.modeSelector={objectType:uu}}_postCreateWidget(){this.widget.modeSelector.setModes(this.widget.modes),delete this.widget.modes}}function ld(i,e,t){return e=JA(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function JA(i){var e=QA(i,"string");return typeof e=="symbol"?e:String(e)}function QA(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fo extends fl{constructor(){super(),ld(this,"calc",void 0),ld(this,"minValue",void 0),ld(this,"maxValue",void 0),ld(this,"decimalFormat",void 0),this.calc=new Nc,this.minValue=null,this.maxValue=null,this.decimalFormat=null,this.invalidValueMessageKey="InvalidNumberMessageX",this.gridDataHints.horizontalAlignment=1}_init(e){super._init(e),this._setMinValue(this.minValue),this._setMaxValue(this.maxValue),this._setDecimalFormat(this.decimalFormat)}_initValue(e){this._setDecimalFormat(this.decimalFormat),super._initValue(e)}_createKeyStrokeContext(){return new Fr}_render(){this.addContainer(this.$parent,"number-field"),this.addLabel(),this.addMandatoryIndicator();let e=ee.makeTextField(this.$parent);this.addField(e),this.addStatus()}_renderGridData(){super._renderGridData(),this.updateInnerAlignment({useHorizontalAlignment:!0})}_renderGridDataHints(){super._renderGridDataHints(),this.updateInnerAlignment({useHorizontalAlignment:!0})}_getDefaultFormat(e){return e.decimalFormatPatternDefault}setDecimalFormat(e){this.setProperty("decimalFormat",e)}_setDecimalFormat(e){e||(e=this._getDefaultFormat(this.session.locale)),e=Ur.ensure(this.session.locale,e),this._setProperty("decimalFormat",e),this.initialized&&this._updateDisplayText()}_parseValue(e){return e?this.decimalFormat.parse(e,this._evaluateNumber.bind(this)):null}_evaluateNumber(e){if(this.calc.isFormula(e)){let t=this.calc.evalFormula(e);if(isNaN(t))throw new Error(e+" is not a valid expression");return t}return Number(e)}_ensureValue(e){let t=Ge.ensure(e);if(v.isNullOrUndefined(t))return t;if(!Ge.isNumber(t))throw this.session.text(this.invalidValueMessageKey,e);return t}_validateValue(e){return v.isNullOrUndefined(e)||(!v.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._onNumberTooSmall(),!v.isNullOrUndefined(this.maxValue)&&e>this.maxValue&&this._onNumberTooLarge()),e}_onNumberTooLarge(){throw v.isNullOrUndefined(this.minValue)?this.session.text("NumberTooLargeMessageX",this._formatValue(this.maxValue)):this.session.text("NumberTooLargeMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}_onNumberTooSmall(){throw v.isNullOrUndefined(this.maxValue)?this.session.text("NumberTooSmallMessageX",this._formatValue(this.minValue)):this.session.text("NumberTooSmallMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}_formatValue(e){return v.isNullOrUndefined(e)?"":typeof e!="number"?e+"":this.decimalFormat.format(e,!0)}setMinValue(e){this.minValue!==e&&(this._setMinValue(e),this.validate())}_setMinValue(e){this._setProperty("minValue",e),!v.isNullOrUndefined(this.maxValue)&&!v.isNullOrUndefined(this.minValue)&&e>this.maxValue&&this._setMaxValue(e)}setMaxValue(e){this.maxValue!==e&&(this._setMaxValue(e),this.validate())}_setMaxValue(e){this._setProperty("maxValue",e),!v.isNullOrUndefined(this.maxValue)&&!v.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._setMinValue(e)}}class Hc extends Qa{_onWidgetParseError(e){e.preventDefault()}_onWidgetEvent(e){e.type==="parseError"?this._onWidgetParseError(e):super._onWidgetEvent(e)}static modifyPrototype(){!ie.get().remote||v.replacePrototypeFunction(fo,"clearErrorStatus",function(){if(!this.modelAdapter)return this.clearErrorStatusOrig()},!0)}}ie.addListener("bootstrap",Hc.modifyPrototype);function ZA(i,e,t){return e=e0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function e0(i){var e=t0(i,"string");return typeof e=="symbol"?e:String(e)}function t0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Nc{constructor(){ZA(this,"_tokens",void 0),this._tokens=[]}isFormula(e){return e.match(/^[\d()+\-*/.]+$/)}evalFormula(e){return this._tokens=e.split(/([\d.]+|\(|\)|[+\-*/])/).filter(t=>t.length!==0),this._expr()}_next(){if(this._tokens.length!==0)return this._tokens[0]}_consumeNext(){let e=this._tokens[0];return this._tokens=this._tokens.slice(1,this._tokens.length),e}_expr(){return this._sum()}_sum(){let e=this._prod();for(;this._next()==="+"||this._next()==="-";)switch(this._consumeNext()){case"+":e=e+this._prod();break;case"-":e=e-this._prod();break}return e}_prod(){let e=this._unary();for(;this._next()==="*"||this._next()==="/";)switch(this._consumeNext()){case"*":e=e*this._unary();break;case"/":e=e/this._unary();break}return e}_unary(){let e=1;this._next()==="+"?this._consumeNext():this._next()==="-"&&(this._consumeNext(),e=-1);let t;return(t=this._group())!==void 0||(t=this._consumeNext()),e*t}_group(){if(this._next()==="("){this._consumeNext();let e=this._expr();if(this._next()!==")")throw"missing closing bracket";return this._consumeNext(),e}}}function s_(i,e,t){return e=i0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function i0(i){var e=r0(i,"string");return typeof e=="symbol"?e:String(e)}function r0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class $o extends fo{constructor(){super(),this.minValue=$o.MIN_VALUE,this.maxValue=$o.MAX_VALUE}_getDefaultFormat(e){return"#,##0"}_parseValue(e){let t=super._parseValue(e);return v.isNullOrUndefined(t)?null:this.decimalFormat.round(t,!1)}}s_($o,"MIN_VALUE",Number.MIN_SAFE_INTEGER),s_($o,"MAX_VALUE",Number.MAX_SAFE_INTEGER);class ad extends M{_render(){this.addContainer(this.$parent,"placeholder-field"),this.addLabel()}_renderLabel(){this._renderEmptyLabel()}}class o_ extends dt{}function s0(i,e,t){return e=o0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function o0(i){var e=n0(i,"string");return typeof e=="symbol"?e:String(e)}function n0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class n_ extends M{constructor(){super(),s0(this,"planner",void 0),this._addWidgetProperties(["planner"]),this.gridDataHints.weightY=1}_render(){this.addContainer(this.$parent,"planner-field"),this.addLabel(),this.addStatus(),this.planner&&this._renderPlanner()}_renderPlanner(){this.planner.render(),this.addField(this.planner.$container)}_removePlanner(){this.planner.remove(),this._removeField()}}class l_ extends dt{}function _l(i,e,t){return e=l0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function l0(i){var e=a0(i,"string");return typeof e=="symbol"?e:String(e)}function a0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class bl extends Le{constructor(){super(),_l(this,"focusWhenSelected",void 0),_l(this,"wrapText",void 0),_l(this,"radioValue",void 0),_l(this,"$radioButton",void 0),_l(this,"lookupRow",void 0),this.gridDataHints.fillHorizontal=!0,this.focusWhenSelected=!0,this.wrapText=!1,this.buttonKeyStroke=new yl(this,null),this.radioValue=null}_initDefaultKeyStrokes(){this.keyStrokeContext.registerKeyStrokes([new yl(this,"ENTER"),new yl(this,"SPACE")])}_render(){this.addContainer(this.$parent,"radio-button",new Vc(this)),this.addFieldContainer(this.$parent.makeDiv()),this.$radioButton=this.$fieldContainer.appendDiv("radio-button-circle").data("radiobutton",this),this.addField(this.$radioButton),this.$buttonLabel=this.$fieldContainer.appendDiv("label"),ee.linkElementWithLabel(this.$radioButton,this.$buttonLabel),this.$fieldContainer.on("mousedown",this._onMouseDown.bind(this)),G.installForEllipsis(this.$buttonLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}_remove(){G.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),super._remove()}_renderProperties(){super._renderProperties(),this._renderWrapText(),this._renderSelected()}setWrapText(e){this.setProperty("wrapText",e)}_renderWrapText(){this.$buttonLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}select(){this.setSelected(!0)}_renderSelected(){this.$fieldContainer.toggleClass("checked",this.selected),this.$field.toggleClass("checked",this.selected)}setTabbable(e){this.rendered&&this.$field.setTabbable(e&&!F.get().supportsOnlyTouch())}isTabbable(){return this.rendered&&this.$field.isTabbable()}_renderIconId(){super._renderIconId();let e=this.get$Icon();e.length>0&&e.insertAfter(this.$radioButton)}doAction(){return!this.enabledComputed||!this.visible?!1:(this.select(),!0)}_onMouseDown(e){if(!this.enabledComputed)return;let t=this.get$Icon().is(e.target),r=this.$radioButton.is(e.target),s=this.$buttonLabel.isOrHas(e.target);!r&&!s&&!t||(this.select(),this.focusWhenSelected&&(s||t)&&this.focusAndPreventDefault(e))}}function d0(i,e,t){return e=h0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function h0(i){var e=u0(i,"string");return typeof e=="symbol"?e:String(e)}function u0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vc extends ed{constructor(e){super(e),d0(this,"radioButton",void 0),this.radioButton=e}layout(e){super.layout(e);let t=this.radioButton.get$Icon(),r=this.radioButton.$radioButton,s=this.radioButton.$buttonLabel,n=this.radioButton.$fieldContainer.width()-(r.outerWidth(!0)+(t.length?t.outerWidth(!0):0));s.css("max-width",n)}}class a_ extends Pc{}function Xt(i,e,t){return e=c0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function c0(i){var e=p0(i,"string");return typeof e=="symbol"?e:String(e)}function p0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ds extends ge{constructor(){super(),Xt(this,"layoutConfig",void 0),Xt(this,"fields",void 0),Xt(this,"radioButtons",void 0),Xt(this,"gridColumnCount",void 0),Xt(this,"selectedButton",void 0),Xt(this,"lookupStatus",void 0),Xt(this,"lookupCall",void 0),Xt(this,"htmlBody",void 0),Xt(this,"$body",void 0),Xt(this,"_lookupExecuted",void 0),Xt(this,"_selectButtonLocked",void 0),Xt(this,"_lookupInProgress",void 0),Xt(this,"_currentLookupCall",void 0),Xt(this,"_buttonPropertyChangeHandler",void 0),this.logicalGrid=u.create(Ks),this.layoutConfig=null,this.fields=[],this.radioButtons=[],this.gridColumnCount=ds.DEFAULT_GRID_COLUMN_COUNT,this.selectedButton=null,this.$body=null,this.lookupStatus=null,this.lookupCall=null,this._lookupExecuted=!1,this._selectButtonLocked=!1,this._lookupInProgress=!1,this._currentLookupCall=null,this._addWidgetProperties(["fields"]),this._addCloneProperties(["lookupCall","layoutConfig","gridColumnCount"]),this._buttonPropertyChangeHandler=this._onButtonPropertyChange.bind(this)}_init(e){super._init(e),this._setLayoutConfig(this.layoutConfig),this._setGridColumnCount(this.gridColumnCount)}_initValue(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._setFields(this.fields),super._initValue(e)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new zc(this),new Gc(this)])}_initButtons(){this.radioButtons=this.fields.filter(e=>e instanceof bl),this.radioButtons.forEach(this._initButton.bind(this))}_initButton(e){e.events.count("propertyChange",this._buttonPropertyChangeHandler)===0&&e.on("propertyChange",this._buttonPropertyChangeHandler),e.selected&&(this.setValue(e.radioValue),this.selectButton(e),e.focused&&this.setFocused(!0))}_render(){this.addContainer(this.$parent,"radiobutton-group"),this.addLabel(),this.addMandatoryIndicator(),this.$body=this.$container.appendDiv("radiobutton-group-body"),this.htmlBody=S.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout()),this.addField(this.$body),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderFields(),this._renderLayoutConfig()}_createBodyLayout(){return new Kc(this,this.layoutConfig)}_setLogicalGrid(e){super._setLogicalGrid(e),this.logicalGrid&&this.logicalGrid.setGridConfig(new Wc)}invalidateLogicalGrid(e){super.invalidateLogicalGrid(!1),u.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}setLayoutConfig(e){this.setProperty("layoutConfig",e)}_setLayoutConfig(e){e||(e=new di),this._setProperty("layoutConfig",di.ensure(e))}_renderLayoutConfig(){this.layoutConfig.applyToLayout(this.htmlBody.layout),this.rendered&&this.htmlBody.invalidateLayoutTree()}isClearable(){return!1}getFields(){return this.fields}visitFields(e){let t=super.visitFields(e);if(t===ye.TERMINATE)return ye.TERMINATE;if(t===ye.SKIP_SUBTREE)return;let r=this.getFields();for(let s=0;s<r.length;s++)if(t=r[s].visitFields(e),t===ye.TERMINATE)return ye.TERMINATE}getFocusableElement(){return this.session.focusManager.findFirstFocusableElement(this.$container)}setFields(e){this.setProperty("fields",e)}_setFields(e){this._setProperty("fields",e),this._initButtons()}_renderFields(){this._ensureLookupCallExecuted(),this.fields.forEach(function(e){e.render(this.$body),e.setLayoutData(new Nr(e)),this._linkWithLabel(e.$field)},this),this._provideTabIndex(),this.invalidateLogicalGrid()}_renderEnabled(){super._renderEnabled(),this._provideTabIndex()}_provideTabIndex(){let e;this.radioButtons.forEach(function(t){t.enabledComputed&&this.enabledComputed&&!e?(t.setTabbable(!0),e=t):e&&this.enabledComputed&&t.enabledComputed&&t.selected?(e.setTabbable(!1),t.setTabbable(!0),e=t):t.setTabbable(!1)},this)}setGridColumnCount(e){this.setProperty("gridColumnCount",e)}_setGridColumnCount(e){return e<0&&(e=this._calcDefaultGridColumnCount()),e===this.gridColumnCount?!1:(this._setProperty("gridColumnCount",e),this.invalidateLogicalGrid(),!0)}_calcDefaultGridColumnCount(){let e=1,t=this.gridDataHints;return t&&t.h>1&&(e=t.h),Math.ceil(this.fields.length/e)}getButtonForRadioValue(e){return e===null?null:f.find(this.radioButtons,t=>v.equals(t.radioValue,e))}_validateValue(e){if(super._validateValue(e),!this.initialized&&this.lookupCall||this._ensureLookupCallExecuted())return e;if(!this.getButtonForRadioValue(e)&&e!==null&&e!==void 0&&!this._lookupInProgress)throw this.session.text("InvalidValueMessageX",e);return e}_valueChanged(){super._valueChanged(),(this.value!==null||this.initialized)&&this.selectButton(this.getButtonForRadioValue(this.value))}selectFirstButton(){this.selectButtonByIndex(0)}selectLastButton(){this.selectButtonByIndex(this.radioButtons.length-1)}selectButtonByIndex(e){this.radioButtons.length&&e>=0&&e<this.radioButtons.length&&this.selectButton(this.radioButtons[e])}selectButton(e){if(this.selectedButton!==e&&!this._selectButtonLocked){if(this._selectButtonLocked=!0,this.selectedButton&&this.selectedButton.setSelected(!1),e){let t=this.getTabbableButton(),r=!1;t&&(r=t.isFocused()),e.setSelected(!0),e.setTabbable(!0),r&&e.focus(),t&&t!==e&&t.setTabbable(!1)}this._selectButtonLocked=!1,this.setProperty("selectedButton",e)}}getTabbableButton(){return f.find(this.radioButtons,e=>e.visible&&e.isTabbable())}insertButton(e){let t=this.fields.slice();t.push(e),this.setFields(t)}_onButtonPropertyChange(e){e.propertyName==="selected"?e.newValue?(this.setValue(e.source.radioValue),this.selectButton(e.source)):e.source===this.selectedButton&&this.selectButton(null):e.propertyName==="focused"&&this.setFocused(e.newValue)}_setLookupCall(e){this._setProperty("lookupCall",ei.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}_ensureLookupCallExecuted(){return!this.lookupCall||this._lookupExecuted?!1:(this._lookupByAll(),!0)}_createLoadingSupport(){return new rr({widget:this,$container:function(){return this.$body}.bind(this)})}_lookupByAll(){if(!this.lookupCall)return;let e=a().Deferred(),t=function(r){this._lookupByAllDone(r),e.resolve(r)}.bind(this);return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t),e.promise()}_executeLookup(e,t){return t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._lookupInProgress=!0,this.setLoading(!0),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(()=>{this._lookupInProgress=!1,this._lookupExecuted=!0,this._currentLookupCall=null,this.setLoading(!1),this._clearLookupStatus()})}_lookupByAllDone(e){try{if(e.exception){this.setErrorStatus(E.error({message:e.exception}));return}if(e.lookupRows.length===0){this.setLookupStatus(E.warning({message:this.session.text("SmartFieldNoDataFound"),code:ds.ErrorCode.NO_DATA}));return}this._populateRadioButtonGroup(e)}finally{this.trigger("lookupCallDone",{result:e})}}_populateRadioButtonGroup(e){let t=e.lookupRows,r=this.fields.slice();t.forEach(s=>{r.push(this._createLookupRowRadioButton(s))}),this.setFields(r),this.setValue(this.value),this.selectButton(this.getButtonForRadioValue(this.value))}_clearLookupStatus(){this.setLookupStatus(null)}setLookupStatus(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}_errorStatus(){return this.lookupStatus||this.errorStatus}_createLookupRowRadioButton(e){let t={parent:this,label:e.text,radioValue:e.key};e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),e.enabled===!1&&(t.enabled=!1),e.active===!1&&(t.visible=!1),e.cssClass&&(t.cssClass=e.cssClass);let r=u.create(bl,t);return r.lookupRow=e,r}clone(e,t){let r=super.clone(e,t);return this._deepCloneProperties(r,"fields",t),r._initButtons(),r}}Xt(ds,"DEFAULT_GRID_COLUMN_COUNT",-1),Xt(ds,"ErrorCode",{NO_DATA:1});class d_ extends Ot{_initModel(e,t){let r=super._initModel(e,t);return r.logicalGrid=null,r}}class Wc extends gs{getGridWidgets(){return this.widget.fields}}class Kc extends Uo{constructor(e,t){super(e,t)}_initDefaults(){super._initDefaults(),this.hgap=ue.get().smallColumnGap}}class zc extends B{constructor(e){super(),this.field=e,this.which=[_.LEFT,_.UP],this.renderingHints.render=!1}handle(e){let t,r=a()(e.target).data("radiobutton");this.field.radioButtons.some(s=>t&&s===r?(t.select(),t.focus(),!0):(s.enabledComputed&&s.visible&&(t=s),!1),this)}}class Gc extends B{constructor(e){super(),this.field=e,this.which=[_.RIGHT,_.DOWN],this.renderingHints.render=!1}handle(e){let t,r=a()(e.target).data("radiobutton");this.field.radioButtons.some(s=>t&&s.enabledComputed&&s.visible?(s.select(),s.focus(),!0):(s===r&&s.enabledComputed&&s.visible&&(t=s),!1),this)}}class yl extends cn{constructor(e,t){super(e,t),this.renderingHints.hAlign=ht.LEFT}_accept(e){return super._accept(e)&&!this.field.selected}}function _i(i,e,t){return e=f0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function f0(i){var e=m0(i,"string");return typeof e=="symbol"?e:String(e)}function m0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vl extends xs{constructor(){super(),_i(this,"layoutConfig",void 0),_i(this,"fields",void 0),_i(this,"htmlBody",void 0),_i(this,"boxErrorStatus",void 0),_i(this,"boxTooltipText",void 0),_i(this,"boxMenus",void 0),_i(this,"boxMenusVisible",void 0),_i(this,"_lastVisibleField",void 0),_i(this,"_isOverwritingStatusFromField",void 0),_i(this,"_isErrorStatusOverwritten",void 0),_i(this,"_isTooltipTextOverwritten",void 0),_i(this,"_isMenusOverwritten",void 0),_i(this,"_fieldPropertyChangeHandler",void 0),_i(this,"_lastVisibleFieldSuppressStatusHandler",void 0),this._addWidgetProperties("fields"),this._addCloneProperties(["layoutConfig"]),this.logicalGrid=u.create(Ks),this.layoutConfig=null,this.fields=[],this._fieldPropertyChangeHandler=this._onFieldPropertyChange.bind(this),this._lastVisibleFieldSuppressStatusHandler=this._onLastVisibleFieldSuppressStatusChange.bind(this)}_init(e){super._init(e),this._setLayoutConfig(this.layoutConfig),this._initDateFields(),this.setErrorStatus(this.errorStatus),this.setTooltipText(this.tooltipText),this.setMenus(this.menus),this.setMenusVisible(this.menusVisible)}_initDateFields(){let e=this._getDateFields(),t=null;for(let r=0;r<e.length;r++){let s=e[r];s.autoDate&&(s.hasModelAutoDateSet=!0),s.hasModelAutoDateSet||s.setAutoDate(t),t=this._getAutoDateProposal(s)}}_render(){this.addContainer(this.$parent,"sequence-box"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus(),this._handleStatus(),this.htmlBody=S.install(this.$field,this.session),this.htmlBody.setLayout(this._createBodyLayout());for(let e=0;e<this.fields.length;e++){let t=this.fields[e];t.labelUseUiWidth=!0,t.on("propertyChange",this._fieldPropertyChangeHandler),t.render(this.$field),this._modifyLabel(t),t.setLayoutData(new Nr(t))}}_renderProperties(){super._renderProperties(),this._renderLayoutConfig()}_createBodyLayout(){return new qc(this,this.layoutConfig)}_remove(){this.fields.forEach(e=>e.off("propertyChange",this._fieldPropertyChangeHandler)),this._lastVisibleField&&this._lastVisibleField.off("propertyChange:suppressStatus",this._lastVisibleFieldSuppressStatusHandler),super._remove()}invalidateLogicalGrid(e){super.invalidateLogicalGrid(!1),u.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}_setLogicalGrid(e){super._setLogicalGrid(e),this.logicalGrid&&this.logicalGrid.setGridConfig(new Uc)}setLayoutConfig(e){this.setProperty("layoutConfig",e)}_setLayoutConfig(e){e||(e=new di),this._setProperty("layoutConfig",di.ensure(e))}_renderLayoutConfig(){let e=this.htmlBody.layout;this.layoutConfig.applyToLayout(e),this.rendered&&this.htmlBody.invalidateLayoutTree()}_onFieldPropertyChange(e){let t=e.propertyName==="visible";u.isOneOf(e.propertyName,["errorStatus","tooltipText","visible","menus","menusVisible"])&&this._handleStatus(t),e.propertyName==="value"&&this._onFieldValueChange(e)}_handleStatus(e){if(e&&this._lastVisibleField&&(this._lastVisibleField.off("propertyChange:suppressStatus",this._lastVisibleFieldSuppressStatusHandler),this._lastVisibleField.setSuppressStatus(null),this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus())),this._lastVisibleField=this._getLastVisibleField(),!this._lastVisibleField)return;this._isOverwritingStatusFromField=!0,this._lastVisibleField.errorStatus?(this.setErrorStatus(this._lastVisibleField.errorStatus),this._isErrorStatusOverwritten=!0):(this.setErrorStatus(this.boxErrorStatus),this._isErrorStatusOverwritten=!1),this._lastVisibleField.hasStatusTooltip()?(this.setTooltipText(this._lastVisibleField.tooltipText),this._isTooltipTextOverwritten=!0):(this.setTooltipText(this.boxTooltipText),this._isTooltipTextOverwritten=!1);let t=this._lastVisibleField.getContextMenuItems(!1);t&&t.length>0?(this._updateBoxMenuOwner(this.fieldStatus),this.setMenus(t),this.setMenusVisible(this._lastVisibleField.menusVisible),this._isMenusOverwritten=!0):(this._updateBoxMenuOwner(this),this.setMenus(this.boxMenus),this.setMenusVisible(this.boxMenusVisible),this._isMenusOverwritten=!1),this._isOverwritingStatusFromField=!1,this._lastVisibleField.setSuppressStatus(M.SuppressStatus.ICON),this._lastVisibleField.on("propertyChange:suppressStatus",this._lastVisibleFieldSuppressStatusHandler),e&&this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus())}_onLastVisibleFieldSuppressStatusChange(e){e.preventDefault()}setErrorStatus(e){this._isOverwritingStatusFromField&&!this._isErrorStatusOverwritten?this.boxErrorStatus=this.errorStatus:this._isOverwritingStatusFromField||(this.boxErrorStatus=e),(this._isOverwritingStatusFromField||!this._isErrorStatusOverwritten)&&super.setErrorStatus(e)}setTooltipText(e){this._isOverwritingStatusFromField&&!this._isTooltipTextOverwritten?this.boxTooltipText=this.tooltipText:this._isOverwritingStatusFromField||(this.boxTooltipText=e),(this._isOverwritingStatusFromField||!this._isTooltipTextOverwritten)&&super.setTooltipText(e)}setMenus(e){let t=this._createChildren(e);this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenus=this.menus:this._isOverwritingStatusFromField||(this.boxMenus=t),(this._isOverwritingStatusFromField||!this._isMenusOverwritten)&&super.setMenus(t)}_updateBoxMenuOwner(e){this.boxMenus.forEach(t=>t.setOwner(e))}setMenusVisible(e){this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenusVisible=this.menusVisible:this._isOverwritingStatusFromField||(this.boxMenusVisible=e),(this._isOverwritingStatusFromField||!this._isMenusOverwritten)&&super.setMenusVisible(e)}_getLastVisibleField(){let e=this.fields.filter(t=>t.visible);if(e.length!==0)return e[e.length-1]}_onFieldValueChange(e){e.source instanceof Kt&&this._onDateFieldValueChange(e)}_onDateFieldValueChange(e){let t=e.source,r=this._getDateFields(),s=this._getAutoDateProposal(t);for(let o=r.indexOf(t)+1;o<r.length;o++){let n=r[o];if(n.hasModelAutoDateSet||n.setAutoDate(s),n.value)break}}_getDateFields(){return this.fields.filter(e=>e instanceof Kt)}_getAutoDateProposal(e){let t=null;return e&&e.value&&(!e.hasDate&&e.hasTime?t=T.shiftTime(e.value,1,0,0):t=T.shift(e.value,0,0,1)),t}_modifyLabel(e){e instanceof Fs&&(e.labelVisible=!1),e instanceof Kt?(e.$dateField&&this._linkWithLabel(e.$dateField),e.$timeField&&this._linkWithLabel(e.$timeField)):e.$field&&this._linkWithLabel(e.$field)}setFields(e){if(this.rendered)throw new Error("Setting fields is not supported if sequence box is already rendered.");this.setProperty("fields",e)}getFields(){return this.fields}clone(e,t){let r=super.clone(e,t);return this._deepCloneProperties(r,"fields",t),r}}class Uc extends gs{getGridColumnCount(){return this.widget.fields.length}getGridWidgets(){return this.widget.fields}}class qc extends Uo{constructor(e,t){super(e,t)}_initDefaults(){super._initDefaults(),this.hgap=ue.get().smallColumnGap}}class h_ extends un{_initModel(e,t){let r=super._initModel(e,t);return r.logicalGrid=null,r}}function g0(i,e,t){return e=_0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _0(i){var e=b0(i,"string");return typeof e=="symbol"?e:String(e)}function b0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class u_ extends ge{constructor(){super(...arguments),g0(this,"slider",void 0)}_init(e){super._init(e);let t=a().extend({parent:this},e);this.slider=u.create(du,t)}_render(){this.addContainer(this.$parent,"slider-field"),this.addLabel(),this.addMandatoryIndicator(),this._renderSlider()}_renderSlider(){this.slider.render(),this.addField(this.slider.$container)}_readDisplayText(){return String(this.slider.value)}_parseValue(e){return Number(e)}setValue(e){this.slider.setValue(e)}getValue(){return this.slider.value}}function Te(i,e,t){return e=y0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function y0(i){var e=v0(i,"string");return typeof e=="symbol"?e:String(e)}function v0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ae extends ge{constructor(){super(),Te(this,"popup",void 0),Te(this,"lookupCall",void 0),Te(this,"codeType",void 0),Te(this,"lookupRow",void 0),Te(this,"browseHierarchy",void 0),Te(this,"browseMaxRowCount",void 0),Te(this,"browseAutoExpandAll",void 0),Te(this,"browseLoadIncremental",void 0),Te(this,"searchRequired",void 0),Te(this,"activeFilterEnabled",void 0),Te(this,"activeFilter",void 0),Te(this,"activeFilterLabels",void 0),Te(this,"columnDescriptors",void 0),Te(this,"displayStyle",void 0),Te(this,"touchMode",void 0),Te(this,"embedded",void 0),Te(this,"lookupStatus",void 0),Te(this,"lookupSeqNo",void 0),Te(this,"initActiveFilter",void 0),Te(this,"maxLength",void 0),Te(this,"maxLengthHandler",void 0),Te(this,"_currentLookupCall",void 0),Te(this,"_pendingLookup",void 0),Te(this,"_pendingOpenPopup",void 0),Te(this,"_tabPrevented",void 0),Te(this,"_userWasTyping",void 0),Te(this,"_acceptInputEnabled",void 0),Te(this,"_acceptInputDeferred",void 0),Te(this,"_notUnique",void 0),Te(this,"_lastSearchText",void 0),Te(this,"_cellEditorPopup",void 0),Te(this,"_lockLookupRow",void 0),this.popup=null,this.lookupCall=null,this.codeType=null,this._pendingLookup=null,this._pendingOpenPopup=!1,this._tabPrevented=null,this.lookupRow=null,this.browseHierarchy=!1,this.browseMaxRowCount=ae.DEFAULT_BROWSE_MAX_COUNT,this.browseAutoExpandAll=!0,this.browseLoadIncremental=!1,this.searchRequired=!1,this.activeFilterEnabled=!1,this.activeFilter=null,this.activeFilterLabels=[],this.columnDescriptors=null,this.displayStyle=ae.DisplayStyle.DEFAULT,this.touchMode=!1,this.embedded=!1,this._userWasTyping=!1,this._acceptInputEnabled=!0,this._acceptInputDeferred=a().Deferred(),this._notUnique=!1,this._lastSearchText=null,this.lookupStatus=null,this._currentLookupCall=null,this.lookupSeqNo=0,this.initActiveFilter=null,this.disabledCopyOverlay=!0,this.maxLength=500,this.maxLengthHandler=u.create(Nn,{target:this}),this._addCloneProperties(["lookupRow","codeType","lookupCall","activeFilter","activeFilterEnabled","activeFilterLabels","browseHierarchy","browseMaxRowCount","browseAutoExpandAll","browseLoadIncremental","searchRequired","columnDescriptors","displayStyle"])}_init(e){super._init(e),this.activeFilterLabels.length===0&&(this.activeFilterLabels=[this.session.text("ui.All"),this.session.text("ui.Inactive"),this.session.text("ui.Active")]),ee.initTouch(this,e)}_initValue(e){this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType),this._setLookupRow(this.lookupRow),super._initValue(e)}markAsSaved(){super.markAsSaved(),this.setInitActiveFilter(this.activeFilter)}resetValue(){super.resetValue(),this.setActiveFilter(this.initActiveFilter)}_createKeyStrokeContext(){return new Fr}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new Yc(this))}_render(){this.addContainer(this.$parent,"has-icon "+this.cssClassName(),new dd(this)),this.addLabel();let t=(this.isDropdown()?ee.makeInputDiv:ee.makeInputOrDiv).call(ee,this).on("mousedown",this._onFieldMouseDown.bind(this));this.touchMode||t.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(t),this.maxLengthHandler.install(t),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderMaxLength()}_renderGridData(){super._renderGridData(),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}_renderGridDataHints(){super._renderGridDataHints(),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}cssClassName(){let e=this.displayStyle;return this.displayStyle===ae.DisplayStyle.DEFAULT&&(e="smart"),e+"-field"}_readSearchText(){let e=this._readDisplayText(),t=u.nvl(this.displayText,""),r=t.split(`
`);return r.length===1||y.empty(e)?e:(r.shift(),f.insert(r,e,0),y.join(`
`,r))}_readDisplayText(){return ee.valOrText(this.$field)}_renderDisplayText(){let e=this._prepareDisplayText();ee.valOrText(this.$field,e),super._renderDisplayText()}_prepareDisplayText(){let e=u.nvl(this.displayText,""),t=e.split(`
`);return t.length&&(e=t[0]),e}acceptInput(e){if(!this._acceptInputEnabled)return a().log.isTraceEnabled()&&a().log.trace("(SmartField#acceptInput) Skipped acceptInput because _acceptInputEnabled=false"),this._acceptInputDeferred.promise();this._acceptInputEnabled=!1,setTimeout(()=>{this._acceptInputEnabled=!0});let t=this._readSearchText(),r=y.empty(t),s=this._checkSearchTextChanged(t),o=this._getSelectedLookupRow(s);if(this._setProperty("displayText",t),this._acceptInputDeferred=a().Deferred(),this._flushLookupStatus(),this._clearPendingLookup(),this.touchMode){a().log.isDebugEnabled()&&a().log.debug("(SmartField#acceptInput) Always send acceptInput for touch field"),this._inputAccepted();return}return this._acceptInput(e,t,r,s,o)}_getSelectedLookupRow(e){return!this.isPopupOpen()||e&&this._userWasTyping?null:this.lookupSeqNo===this.popup.lookupResult.seqNo?this.popup.getSelectedLookupRow():null}_checkSearchTextChanged(e){return this.isDropdown()||!this._userWasTyping?!1:!this._searchTextEquals(e,this._lastSearchText)}_searchTextEquals(e,t){let r=y.nullIfEmpty(this._firstTextLine(e)),s=y.nullIfEmpty(t);return y.equalsIgnoreCase(r,s)}_clearPendingLookup(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}_acceptInput(e,t,r,s,o){let n=!1;if(this.removing?n=!0:!o&&this.lookupRow&&(n=y.nvl(this.lookupRow.text)===t),n){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_acceptInput) unchanged: widget is removing or searchText is equals. Close popup"),this._clearLookupStatus(),this._inputAccepted(!1);return}if(this._notUnique&&!r&&this._setNotUniqueError(t),!o&&!this.lookupRow&&r){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_acceptInput) unchanged: text is empty. Close popup"),this._clearLookupStatus(),this.errorStatus&&this.errorStatus.code===ae.ErrorCode.NO_RESULTS&&this.clearErrorStatus(),this._inputAccepted(s||this._userWasTyping);return}if(!o&&r){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_acceptInput) empty. Set lookup-row to null, close popup"),this._clearLookupStatus(),this.setLookupRow(null),this._inputAccepted();return}if(o){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",o.toString()),this._clearLookupStatus(),this.setLookupRow(o),this._inputAccepted();return}return s||this._userWasTyping?this._acceptByText(e,this._firstTextLine(t)):this._hasUiError()?this._hasNotUniqueError()&&this.popup?this.popup.selectFirstLookupRow():this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise()}_firstTextLine(e){return y.empty(e)?e:e.split(`
`)[0]}_acceptByText(e,t){e=u.nvl(e,!1),a().log.isDebugEnabled()&&a().log.debug("(SmartField#_acceptByText) sync="+e+" searchText=",t),e?this._acceptByTextSync(t):this._acceptByTextAsync(t)}_acceptByTextSync(e){this._lastSearchText=null,this._inputAccepted(),this._hasUiError()||this.resetDisplayText()}_acceptByTextAsync(e){this._lastSearchText=e,this._executeLookup(this.lookupCall.cloneForText(e),!0).done(this._acceptByTextDone.bind(this)).done(this._triggerLookupCallDone.bind(this)),this._triggerAcceptByText(e)}_inputAccepted(e,t){e=u.nvl(e,!0),t=u.nvl(t,!0),this.embedded||this.closePopup(),this._userWasTyping=!1,e&&this._triggerAcceptInput(t),this._focusNextTabbable(),this._acceptInputDeferred.resolve()}_focusNextTabbable(){if(this._tabPrevented){let e=this.entryPoint().find(":tabbable"),t=this._tabPrevented.shiftKey?-1:1,r=e.index(this.$field),s=r+t;s<0?s=e.length-1:s>=e.length&&(s=0),a().log.isDebugEnabled()&&a().log.debug("(SmartField#_inputAccepted) tab-index="+r+" next tab-index="+s);let o=e.eq(s).focus();v.isFunction(o[0].select)&&o[0].select(),o.addClass("keyboard-navigation"),this._tabPrevented=null}}_acceptByTextDone(e){if(this._userWasTyping=!1,this._extendResult(e),this._notUnique=e.numLookupRows>1,e.uniqueMatch){let t=e.uniqueMatch;this._isLookupRowActive(t)?(this.setLookupRow(t),this._inputAccepted()):this.setErrorStatus(E.error({message:this.session.text("SmartFieldInactiveRow",e.text)}));return}this._acceptInputFail(e)}_extendResult(e){e.seqNo=this.lookupSeqNo,e.uniqueMatch=null;let t="by"+y.toUpperCaseFirstLetter(e.queryBy.toLowerCase());if(e[t]=!0,this.browseHierarchy){let r=u.create(sp,{parent:this,smartField:this});r.setLookupResult(e);let s=r.findLeafs();e.numLookupRows=s.length,e.numLookupRows===1&&(e.uniqueMatch=s[0].lookupRow)}else e.numLookupRows=e.lookupRows.length,e.numLookupRows===1&&(e.uniqueMatch=e.lookupRows[0])}_acceptInputFail(e){let t=e.text;e.numLookupRows||(this.embedded||this.closePopup(),this.setValue(null),this.setDisplayText(t),this.setErrorStatus(E.error({message:this.session.text("SmartFieldCannotComplete",t),code:ae.ErrorCode.NO_RESULTS}))),e.numLookupRows>1&&(this.setValue(null),this.setDisplayText(t),this._setNotUniqueError(t),this.isPopupOpen()?this.popup.setLookupResult(e):this._lookupByTextOrAllDone(e),this.isPopupOpen()&&this.popup.selectFirstLookupRow()),this._acceptInputDeferred.resolve(),this._triggerAcceptInputFail()}lookupByRec(e){return a().log.isDebugEnabled()&&a().log.debug("(SmartField#lookupByRec) rec=",e),this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForRec(e)).then(t=>(t.appendResult=!0,t.rec=e,this.isPopupOpen()&&this.popup.setLookupResult(t),t)).then(this._triggerLookupCallDone.bind(this))}_isLookupRowActive(e){return e.enabled?this.activeFilterEnabled?this.activeFilter==="TRUE"?e.active:this.activeFilter==="FALSE"?!e.active:!0:!0:!1}_renderEnabled(){super._renderEnabled(),this.$field.setTabbable(this.enabledComputed)}setMaxLength(e){this.setProperty("maxLength",e)}_renderMaxLength(){this.maxLengthHandler.render()}setLookupCall(e){this.setProperty("lookupCall",e)}_setLookupCall(e){this._setProperty("lookupCall",ei.ensure(e,this.session)),this._syncBrowseMaxRowCountWithLookupCall()}_setCodeType(e){if(this._setProperty("codeType",e),!e)return;let t=u.create(Yl,{session:this.session,codeType:e});this.setProperty("lookupCall",t)}_formatValue(e){return v.isNullOrUndefined(e)?"":this.lookupRow?this._formatLookupRow(this.lookupRow):(this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForKey(e),!0).then(t=>({formattedValue:this._lookupByKeyDone(t),result:t})).then(t=>{let{formattedValue:r,result:s}=t;return this._triggerLookupCallDone(s),r}))}_lookupByKeyDone(e){this._notUnique=!1;let t=ei.firstLookupRow(e);return this.setLookupRow(t),this._formatLookupRow(t)}_formatLookupRow(e){return e?e.text:""}openPopup(e){let t=this._readDisplayText(),r=this.searchRequired?!0:null;return a().log.isInfoEnabled()&&a().log.info("SmartField#openPopup browse="+e+" searchText="+t+" popup="+this.popup+" pendingOpenPopup="+this._pendingOpenPopup),this._tabPrevented=null,this._pendingOpenPopup=!0,y.empty(t)?e=!0:this.errorStatus&&(this._hasNotUniqueError()?(r=!0,e=!1):this.searchRequired||(e=!0)),this._lookupByTextOrAll(e,t,r)}_hasUiError(e){let t=this._errorStatus();if(!t)return!1;e?e=f.ensure(e):e=[ae.ErrorCode.NO_RESULTS,ae.ErrorCode.NOT_UNIQUE];let s=E.asFlatList(t).reduce((o,n)=>(n.code&&o.indexOf(n.code)===-1&&o.push(n.code),o),[]);return e.some(o=>s.indexOf(o)>-1)}_lookupByTextOrAll(e,t,r){if(t=u.nvl(t,this._readDisplayText()),e=u.nvl(e,y.empty(t)),r=u.nvl(r,!1),this.isDropdown()&&(e=!0),!e&&!r){let n=null;if(this._lastSearchText?n=this._lastSearchText:n=this._getLastSearchText(),this._searchTextEquals(t,n)){this._pendingOpenPopup=!1,a().log.debug("(SmartField#_lookupByTextOrAll) searchText is equals -> skip lookup");return}}this._clearPendingLookup();let s=a().Deferred(),o=function(n){this._lookupByTextOrAllDone(n),s.resolve(n)}.bind(this);return e?(a().log.isDebugEnabled()&&a().log.debug("(SmartField#_lookupByTextOrAll) lookup byAll (searchText empty)"),this._lastSearchText=null,this.searchRequired?(o({queryBy:me.TEXT,lookupRows:[]}),this.setLookupStatus(E.warning({message:this.session.text("TooManyRows"),code:ae.ErrorCode.SEARCH_REQUIRED}))):this._executeLookup(this.lookupCall.cloneForAll(),!0).done(o).done(this._triggerLookupCallDone.bind(this))):this._pendingLookup=setTimeout(()=>{a().log.isDebugEnabled()&&a().log.debug("(SmartField#_lookupByTextOrAll) lookup byText searchText="+t),this._lastSearchText=t,this._executeLookup(this.lookupCall.cloneForText(t),!0).done(o).done(this._triggerLookupCallDone.bind(this))},ae.DEBOUNCE_DELAY),s.promise()}_getLastSearchText(){return v.optProperty(this.lookupRow,"text")}_lookupByTextOrAllDone(e){if(this._extendResult(e),this._notUnique=!e.byAll&&e.numLookupRows>1,this._handleException(e))return;if(!this.rendered||!this.isFocused()&&!this.isTouchable()){this.closePopup();return}let t=!e.numLookupRows;if(t&&e.byAll){this.activeFilterEnabled?this._ensurePopup(e):this.closePopup(),this.setLookupStatus(E.warning({message:this.session.text("SmartFieldNoDataFound"),code:ae.ErrorCode.NO_DATA}));return}if(t){this._handleEmptyResult(),this.setLookupStatus(E.warning({message:this.session.text("SmartFieldCannotComplete",e.text),code:ae.ErrorCode.NO_RESULTS}));return}let r=null;e.numLookupRows>this.browseMaxRowCount&&(e.lookupRows=e.lookupRows.slice(0,this.browseMaxRowCount),r=E.info({message:this.session.text("SmartFieldMoreThanXRows",this.browseMaxRowCount)})),this._ensurePopup(e,r)}_ensurePopup(e,t){this.popup?(this.popup.setLookupResult(e),this.popup.setStatus(t)):this._renderPopup(e,t)}_handleException(e){return e.exception?(this.setErrorStatus(E.error({message:e.exception})),this.closePopup(),!0):!1}_handleEmptyResult(){if(this.touchMode||this.activeFilterEnabled){let e={lookupRows:[]};this._ensurePopup(e)}else this.embedded?this.popup.clearLookupRows():this.closePopup()}_renderPopup(e,t){this.$field.addClass("focused"),this.$container.addClass("popup-open");let r=this.touchMode&&!this.isDropdown(),s=r?"SmartFieldTouchPopup":"SmartFieldPopup";this._pendingOpenPopup=!1,this.popup=u.create(s,{parent:this,$anchor:this.$field,boundToAnchor:!r,closeOnAnchorMouseDown:!1,field:this,lookupResult:e,status:t}),this.popup.open(),this.popup.$container.css("--inactive-lookup-row-suffix-text","'".concat(this.session.text("InactiveState"),"'"));let o=r?this.popup._field:this;this.popup.on("lookupRowSelected",o._onLookupRowSelected.bind(o)),this.popup.on("activeFilterSelected",this._onActiveFilterSelected.bind(this)),this.popup.one("remove",()=>{this.popup=null,this.rendered&&(this.$container.removeClass("popup-open"),this.$field.removeClass("focused"),this._renderErrorStatus())})}closePopup(){this._pendingOpenPopup=!1,this.popup&&this.popup.close()}aboutToBlurByMouseDown(e){this.touchMode||ee.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}_onFieldMouseDown(e){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_onFieldMouseDown)"),this.activate(!0)}activate(e){if(!(!this.enabledComputed||!this.rendered)){if(!this.isDropdown()&&!ee.handleOnClick(this)){this.popup&&this.popup.removalPending&&this.popup.one("remove",()=>{this.rendered&&this.activate(e)});return}(!e||F.get().supportsOnlyTouch())&&this.$field.focus(),this.togglePopup()}}_onIconMouseDown(e){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_onIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.embedded||(this.isDropdown()?this.togglePopup():this.popup||this.openPopup(!this.searchRequired)))}_onClearIconMouseDown(e){a().log.isDebugEnabled()&&a().log.debug("(SmartField#_onClearIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.clear())}_clear(){this._tabPrevented=null,this._lastSearchText=this._readDisplayText(),this._userWasTyping=!0,ee.valOrText(this.$field,""),this.touchMode&&this.setValue(null),this.isPopupOpen()&&setTimeout(this._lookupByTextOrAll.bind(this,!0)),this._updateHasText()}togglePopup(){a().log.isInfoEnabled()&&a().log.info("(SmartField#togglePopup) popupOpen=",this.isPopupOpen()),this.isPopupOpen()?this.closePopup():this.openPopup(!this.searchRequired)}_onFieldBlur(e){this.setFocused(!1),this.setLoading(!1),!this.isTouchable()&&(this.acceptInput(!1),this.closePopup())}isTouchable(){return this.embedded||this.touchMode}_onFieldKeyUp(e){if(e.which===_.ESC)return;let t=e.which,r=(e.ctrlKey||e.metaKey)&&t===_.V||e.shiftKey&&t===_.INSERT,s=(e.ctrlKey||e.metaKey)&&t===_.X||e.shiftKey&&t===_.DELETE;!((r||s)&&!this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===_.ENTER||t===_.TAB||t===_.SHIFT||t===_.CTRL||t===_.ALT||t===_.HOME||t===_.END||t===_.LEFT||t===_.RIGHT||t===_.WIN_LEFT||t===_.WIN_RIGHT||t===_.SELECT||t===_.NUM_LOCK||t===_.CAPS_LOCK||t===_.SCROLL_LOCK||t===_.PAUSE||t===_.PRINT_SCREEN||this._isNavigationKey(e)||this._isFunctionKey(e))||this._handleInput()}_handleInput(){this._pendingOpenPopup||this.isPopupOpen()?this.isDropdown()||this._lookupByTextOrAll():this._pendingOpenPopup||this.openPopup()}isPopupOpen(){return!!(this.popup&&!this.popup.removalPending)}_onFieldKeyDown(e){if(this._updateUserWasTyping(e),e.which===_.TAB){this.mode===M.Mode.DEFAULT&&(e.preventDefault(),e.stopPropagation(),a().log.isDebugEnabled()&&a().log.debug("(SmartField#_onFieldKeyDown) set _tabPrevented"),this._tabPrevented={shiftKey:e.shiftKey}),this.acceptInput();return}if(e.which===_.ENTER){this._handleEnterKey(e);return}let t=e.which;this.isDropdown()&&(e.ctrlKey||e.altKey||e.metaKey||t===_.ESC||t===_.SHIFT||t===_.CTRL||t===_.ALT||t===_.WIN_LEFT||t===_.WIN_RIGHT||t===_.SELECT||t===_.NUM_LOCK||t===_.CAPS_LOCK||t===_.SCROLL_LOCK||t===_.PAUSE||t===_.PRINT_SCREEN||this._isFunctionKey(e))||(this._isNavigationKey(e)||this.isDropdown())&&(this.isPopupOpen()?this.popup.delegateKeyEvent(e):this._pendingOpenPopup||this.openPopup(!this.searchRequired),e.stopPropagation(),e.preventDefault())}_onFieldInput(){this._updateHasText(),this._userWasTyping||(this.isFocused()||this.focus(),this._handleInput())}_updateUserWasTyping(e){let t=e.which,r=(e.ctrlKey||e.metaKey)&&t===_.V||e.shiftKey&&t===_.INSERT,s=(e.ctrlKey||e.metaKey)&&t===_.X||e.shiftKey&&t===_.DELETE;!((r||s)&&!this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===_.ESC||t===_.TAB||t===_.SHIFT||t===_.CTRL||t===_.ALT||t===_.HOME||t===_.END||t===_.LEFT||t===_.RIGHT||t===_.WIN_LEFT||t===_.WIN_RIGHT||t===_.SELECT||t===_.NUM_LOCK||t===_.CAPS_LOCK||t===_.SCROLL_LOCK||t===_.PAUSE||t===_.PRINT_SCREEN||this._isFunctionKey(e))||(this._userWasTyping=!(this._isNavigationKey(e)||t===_.ENTER))}_isNavigationKey(e){let t=[_.PAGE_UP,_.PAGE_DOWN,_.UP,_.DOWN];return this.isDropdown()&&(t.push(_.HOME),t.push(_.END)),u.isOneOf(e.which,t)}_handleEnterKey(e){this.isPopupOpen()&&(this.popup.selectLookupRow(),e.stopPropagation())}_isFunctionKey(e){return e.which>=_.F1&&e.which<=_.F12}_onLookupRowSelected(e){this._clearPendingLookup();let t=this.original()._currentLookupCall;t&&(t.abort(),this.original()._currentLookupCall=null,this.setLoading(!1)),this.setLookupRow(e.lookupRow),this._inputAccepted(),this.closePopup()}_onActiveFilterSelected(e){this.setActiveFilter(e.activeFilter);let t=!this.searchRequired,r=this._readSearchText();this.lookupRow?this.lookupRow.text!==r&&(t=!1):y.hasText(r)&&(t=!1),this._lookupByTextOrAll(t,r,!0)}setBrowseMaxRowCount(e){this.setProperty("browseMaxRowCount",e),this._syncBrowseMaxRowCountWithLookupCall()}_syncBrowseMaxRowCountWithLookupCall(){this.lookupCall&&this.lookupCall.setMaxRowCount(this.browseMaxRowCount+1)}setBrowseAutoExpandAll(e){this.setProperty("browseAutoExpandAll",e)}setBrowseLoadIncremental(e){this.setProperty("browseLoadIncremental",e),this.lookupCall&&this.lookupCall.setLoadIncremental(e)}setActiveFilter(e){this.setProperty("activeFilter",this.activeFilterEnabled?e:null)}setActiveFilterEnabled(e){this.setProperty("activeFilterEnabled",e)}setInitActiveFilter(e){this.setProperty("initActiveFilter",e)}setSearchRequired(e){this.setProperty("searchRequired",e)}_executeLookup(e,t){this.lookupSeqNo++,this.setLoading(!0);let r=this.original()._currentLookupCall;return t&&r&&r.abort(),this.original()._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(()=>{this.original()._currentLookupCall=null,this.setLoading(!1),this._clearLookupStatus(),this._clearNoResultsErrorStatus()})}_clearNoResultsErrorStatus(){this.isTouchable()||this._userWasTyping&&this.errorStatus&&this.errorStatus.code===ae.ErrorCode.NO_RESULTS&&this.setErrorStatus(null)}virtual(){return this.browseMaxRowCount>ae.DEFAULT_BROWSE_MAX_COUNT}isDropdown(){return this.displayStyle===ae.DisplayStyle.DROPDOWN}_setLookupRow(e){this.lookupRow&&this.removeCssClass(this.lookupRow.cssClass),this._setProperty("lookupRow",e),e&&this.addCssClass(e.cssClass)}setLookupRow(e){this.lookupRow!==e&&(this._notUnique=!1,this.clearErrorStatus(),this._setLookupRow(e),this._lockLookupRow=!0,e?this.setValue(this._getValueFromLookupRow(e)):this.setValue(null),this._lockLookupRow=!1,this.resetDisplayText())}setDisplayText(e){super.setDisplayText(e),this._userWasTyping=!1}resetDisplayText(){let e=this.formatValue(this.value);e&&a().isFunction(e.promise)?e.done(this._setAndRenderDisplayText.bind(this)).fail(()=>{a().log.isInfoEnabled()&&a().log.info("Could not resolve display text for value: "+this.value)}):this._setAndRenderDisplayText(e)}_setAndRenderDisplayText(e){this._setProperty("displayText",e),this.rendered&&this._renderDisplayText()}_getValueFromLookupRow(e){return e.key}_setValue(e){this._lockLookupRow||(v.isNullOrUndefined(e)?this._setLookupRow(null):this._checkResetLookupRow(e)&&this._setLookupRow(null)),super._setValue(e),this._notUnique=!1}_checkResetLookupRow(e){return this.lookupRow&&this.lookupRow.key!==e}getValueForSelection(){return this._showSelection()?this.value:null}_showSelection(){if(v.isNullOrUndefined(this.value)||v.isNullOrUndefined(this.lookupRow))return!1;let e;if(this.rendered){e=this._readDisplayText();let t=this.additionalLines();t&&(e=[e].concat(t).join(`
`))}else e=this.displayText;return e===this.lookupRow.text}isClearable(){return super.isClearable()&&!this.isDropdown()&&!this.touchMode}_triggerLookupCallDone(e){return this.trigger("lookupCallDone",{result:e}),e}_triggerAcceptInputFail(){this._triggerAcceptInput(!1,!0)}_triggerAcceptInput(e,t){this.trigger("acceptInput",{displayText:this.displayText,errorStatus:this.errorStatus,value:this.value,lookupRow:this.lookupRow,acceptByLookupRow:u.nvl(e,!0),failure:u.nvl(t,!1)})}_triggerAcceptByText(e){this.trigger("acceptByText",{searchText:e,errorStatus:this.errorStatus})}onCellEditorRendered(e){e.openFieldPopup&&(this._cellEditorPopup=e.cellEditorPopup,this.openPopup(!this.searchRequired))}additionalLines(){let e=u.nvl(this.displayText,""),t=e.split(`
`);return t.length>1?(t.shift(),t):null}_createLoadingSupport(){return new Kd({widget:this,loadingIndicatorDelay:400})}_isInitialShowStatus(){return this.touchMode&&(this._pendingOpenPopup||this.isPopupOpen())?!1:super._isInitialShowStatus()}acceptInputFromField(e){this._copyValuesFromField(e),this._cellEditorPopup?(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null):this.acceptInput()}_copyValuesFromField(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.setErrorStatus(e.errorStatus),this.setDisplayText(e.displayText)}_setNotUniqueError(e){this.setErrorStatus(E.error({message:this.session.text("SmartFieldNotUnique",e),code:ae.ErrorCode.NOT_UNIQUE}))}_hasNotUniqueError(){return this._notUnique||this._hasUiError(ae.ErrorCode.NOT_UNIQUE)}_errorStatus(){return this.lookupStatus||this.errorStatus}setLookupStatus(e){this.setProperty("lookupStatus",e)&&this.rendered&&this._renderErrorStatus()}clearErrorStatus(){this.setErrorStatus(null),this._clearLookupStatus()}_clearLookupStatus(){this.setLookupStatus(null)}_flushLookupStatus(){if(!!this.lookupStatus){if(this.lookupStatus.code===ae.ErrorCode.NO_RESULTS||this.lookupStatus.code===ae.ErrorCode.NOT_UNIQUE){let e=this.lookupStatus.clone();e.severity=E.Severity.ERROR,this.setErrorStatus(e)}this._clearLookupStatus()}}requestInput(){this.enabledComputed&&this.rendered&&(this.focus(),this.openPopup(!this.searchRequired))}}Te(ae,"DisplayStyle",{DEFAULT:"default",DROPDOWN:"dropdown"}),Te(ae,"ErrorCode",{NOT_UNIQUE:1,NO_RESULTS:2,NO_DATA:3,SEARCH_REQUIRED:4}),Te(ae,"DEBOUNCE_DELAY",200),Te(ae,"DEFAULT_BROWSE_MAX_COUNT",100),Te(ae,"ActiveFilter",{UNDEFINED:"UNDEFINED",FALSE:"FALSE",TRUE:"TRUE"}),Te(ae,"ACTIVE_FILTER_VALUES",[ae.ActiveFilter.UNDEFINED,ae.ActiveFilter.FALSE,ae.ActiveFilter.TRUE]);function w0(i,e,t){return e=T0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function T0(i){var e=S0(i,"string");return typeof e=="symbol"?e:String(e)}function S0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class xo extends nd{constructor(){super(),this._addRemoteProperties(["activeFilter"])}_postCreateWidget(){super._postCreateWidget(),this.widget.lookupCall=u.create(ql,this)}_syncResult(e){let t=this.widget._currentLookupCall;!t&&this.widget.touchMode&&this.widget.popup&&this.widget.popup._field&&(t=this.widget.popup._field._currentLookupCall),t&&t.resolveLookup(e)}_syncDisplayText(e){this.widget.setDisplayText(e)}_orderPropertyNamesOnSync(e){return Object.keys(e).sort(this._createPropertySortFunc(xo.PROPERTIES_ORDER))}_onWidgetEvent(e){e.type==="acceptByText"?this._onWidgetAcceptByText(e):super._onWidgetEvent(e)}_onWidgetAcceptByText(e){this._sendProperty("errorStatus",e.errorStatus)}_onWidgetAcceptInput(e){let t={displayText:e.displayText,errorStatus:e.errorStatus};e.errorStatus?y.empty(e.displayText)&&(t.value=null):(t.value=e.value,e.acceptByLookupRow&&(t.lookupRow=e.lookupRow)),this._send("acceptInput",t,{showBusyIndicator:!e.whileTyping,coalesce:function(r){return this.target===r.target&&this.type===r.type&&this.whileTyping===r.whileTyping}})}}w0(xo,"PROPERTIES_ORDER",["lookupRow","value","errorStatus","displayText"]);function C0(i,e,t){return e=P0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function P0(i){var e=x0(i,"string");return typeof e=="symbol"?e:String(e)}function x0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class dd extends li{constructor(e){super(e),C0(this,"_smartField",void 0),this._smartField=e}layout(e){if(super.layout(e),this._smartField.embedded)return;let t=this._smartField.popup;t&&t.rendered&&(t.position(),t.validateLayout())}}class Yc extends B{constructor(e){super(),this.field=e,this.which=[_.ESC],this.stopPropagation=!0,this.preventInvokeAcceptInputOnActiveValueField=!0,this.renderingHints.$drawingArea=function(t,r){return this.field.$fieldContainer}.bind(this)}_accept(e){return!(!super._accept(e)||!this.field.popup)}handle(e){this.field.closePopup(),this.field.resetDisplayText()}}function hd(i,e,t){return e=F0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function F0(i){var e=E0(i,"string");return typeof e=="symbol"?e:String(e)}function E0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Al extends pe{constructor(){super(),hd(this,"field",void 0),hd(this,"lookupResult",void 0),hd(this,"smartField",void 0),hd(this,"proposalChooser",void 0),this.animateRemoval=Al.hasPopupAnimation(),this.windowPaddingX=0,this.windowPaddingY=0}_init(e){e.withFocusContext=!1,super._init(e),this.smartField=this.parent,this.proposalChooser=this._createProposalChooser(),this.proposalChooser.on("lookupRowSelected",this._triggerEvent.bind(this)),this.proposalChooser.on("activeFilterSelected",this._triggerEvent.bind(this)),this.smartField.on("remove",this._onRemoveSmartField.bind(this)),this.setLookupResult(e.lookupResult),this.setStatus(e.status)}_createProposalChooser(){let e=this.smartField.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return u.create(e,{parent:this})}_createLayout(){return new Xc(this)}_render(){let e=this.smartField.cssClassName()+"-popup";super._render(),this.$container.addClass(e).on("mousedown",this._onContainerMouseDown.bind(this)),this.$container.toggleClass("alternative",this.smartField.fieldStyle===M.FieldStyle.ALTERNATIVE),this.findDesktop().adjustOverlayOrder(this),this.proposalChooser.render()}setLookupResult(e){this._setProperty("lookupResult",e),this.proposalChooser.setLookupResult(e)}getSelectedLookupRow(){let e=this.proposalChooser.getSelectedLookupRow();return e&&e.enabled?e:null}setStatus(e){this.proposalChooser.setStatus(e)}selectFirstLookupRow(){this.proposalChooser.selectFirstLookupRow()}selectLookupRow(){this.proposalChooser.triggerLookupRowSelected()}delegateKeyEvent(e){e.originalEvent.smartFieldEvent=!0,this.proposalChooser.delegateKeyEvent(e)}_triggerEvent(e){this.trigger(e.type,e)}_onContainerMouseDown(e){return!1}_onRemoveSmartField(e){this.animateRemoval=!1,this.remove()}_isMouseDownOnAnchor(e){let t=e.target;return this.field.$field.isOrHas(t)||this.field.$icon.isOrHas(t)||this.field.$clearIcon&&this.field.$clearIcon.isOrHas(t)}_onAnimationEnd(){this.proposalChooser.updateScrollbars()}static hasPopupAnimation(){return F.get().supportsCssAnimation()}}function jc(i,e,t){return e=A0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function A0(i){var e=D0(i,"string");return typeof e=="symbol"?e:String(e)}function D0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class c_ extends el{constructor(){super(...arguments),jc(this,"field",void 0),jc(this,"lookupResult",void 0),jc(this,"smartField",void 0)}_init(e){e.withFocusContext=!1,e.smartField=e.parent,super._init(e),this.setLookupResult(e.lookupResult),this.setStatus(e.status),this.one("close",this._beforeClosePopup.bind(this)),this.smartField.on("propertyChange",this._onPropertyChange.bind(this)),this.addCssClass("smart-field-touch-popup")}_initWidget(e){this._widget=this._createProposalChooser(),this._widget.on("lookupRowSelected",this._triggerEvent.bind(this)),this._widget.on("activeFilterSelected",this._triggerEvent.bind(this))}_createProposalChooser(){let e=this.parent.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return u.create(e,{parent:this,touch:!0,smartField:this._field})}_fieldOverrides(){let e=super._fieldOverrides();return e.proposalChooser=null,e}_onMouseDownOutside(){this._acceptInput()}delegateKeyEvent(e){e.originalEvent.smartFieldEvent=!0,this._widget.delegateKeyEvent(e)}getSelectedLookupRow(){return this._widget.getSelectedLookupRow()}_triggerEvent(e){this.trigger(e.type,e)}setLookupResult(e){this._widget.setLookupResult(e)}setStatus(e){this._widget.setStatus(e)}clearLookupRows(){this._widget.clearLookupRows()}selectFirstLookupRow(){this._widget.selectFirstLookupRow()}selectLookupRow(){this._widget.triggerLookupRowSelected()}_onPropertyChange(e){e.propertyName==="lookupStatus"&&this._field.setLookupStatus(e.newValue)}_beforeClosePopup(e){this.smartField.acceptInputFromField(this._field)}}function M0(i,e,t){return e=$0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $0(i){var e=R0(i,"string");return typeof e=="symbol"?e:String(e)}function R0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Xc extends Ii{constructor(e){super(e),M0(this,"animating",void 0),this.animating=!1,this.doubleCalcPrefSize=!1}layout(e){let t,r,s=this._htmlProposalChooser();if(this.animating){this.popup.htmlComp.$comp.oneAnimationEnd(()=>{this.popup.revalidateLayout()});return}super.layout(e),r=this.popup.htmlComp.size(),t=r.subtract(this.popup.htmlComp.insets()),s.setSize(t),this.popup.htmlComp.layouted?this.popup.position():Al.hasPopupAnimation()&&(this.animating=!0,this.popup.htmlComp.$comp.css("visibility","hidden"),this.popup.session.layoutValidator.schedulePostValidateFunction(()=>{this.popup.htmlComp.$comp.css("visibility",""),this.popup.htmlComp.$comp.addClassForAnimation("animate-open"),this.popup.htmlComp.$comp.oneAnimationEnd(()=>{this.animating=!1,this.popup._onAnimationEnd()})}))}preferredLayoutSize(e,t){let r,s=this._htmlProposalChooser(),o=w.offsetBounds(this.popup.smartField.$field);return s?(r=s.prefSize(t),r=r.add(this.popup.htmlComp.insets())):r=new A(ue.get().formColumnWidth,ue.get().formRowHeight*2),r.width=Math.max(o.width,r.width),r.height=Math.max(15,Math.min(350,r.height)),r.width>this._maxWindowSize()&&(r.width=this._maxWindowSize()),r}_htmlProposalChooser(){let e=this.popup.proposalChooser;return e?e.htmlComp:null}_maxWindowSize(){return this.popup.$container.window().width()-2*this.popup.windowPaddingX}}function L0(i,e,t){return e=I0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function I0(i){var e=k0(i,"string");return typeof e=="symbol"?e:String(e)}function k0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class p_ extends ae{constructor(){super(),L0(this,"_$multilineLines",void 0),this._$multilineLines=null}_render(){let e,t;this.addContainer(this.$parent,"smart-field has-icon",new dd(this)),this.addLabel(),this.addFieldContainer(this.$parent.makeDiv("multiline")),t=S.install(this.$fieldContainer,this.session),t.setLayout(new Qc(this)),e=ee.makeInputOrDiv(this,"multiline-input").on("mousedown",this._onFieldMouseDown.bind(this)).appendTo(this.$fieldContainer),this.touchMode||e.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(e),this._$multilineLines=this.$fieldContainer.appendDiv("multiline-lines").on("click",this._onMultilineLinesClick.bind(this)),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.addStatus()}_renderEnabled(){super._renderEnabled(),this._$multilineLines.setEnabled(this.enabledComputed)}_onMultilineLinesClick(e){this.enabledComputed&&(this.$field.window(!0).getSelection().toString()||this.$field.focus())}_renderDisplayText(){super._renderDisplayText();let e=this.additionalLines();e?this._$multilineLines.html(f.formatEncoded(e,"<br/>")):this._$multilineLines.empty()}_getInputBounds(){let e=w.offsetBounds(this.$fieldContainer),t=w.offsetBounds(this.$field);return e.height=t.height,e}_renderFocused(){super._renderFocused(),this._$multilineLines.toggleClass("focused",this.focused)}_updateErrorStatusClasses(e,t){super._updateErrorStatusClasses(e,t),this._updateErrorStatusClassesOnElement(this._$multilineLines,e,t)}}class f_ extends xo{}function Jc(i,e,t){return e=B0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function B0(i){var e=O0(i,"string");return typeof e=="symbol"?e:String(e)}function O0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qc extends te{constructor(e){super(),Jc(this,"smartField",void 0),Jc(this,"htmlPropertyChangeHandler",void 0),Jc(this,"rowHeight",void 0),this.smartField=e,this._initDefaults(),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this.smartField.one("remove",()=>{ue.get().off("propertyChange",this.htmlPropertyChangeHandler)})}_initDefaults(){this.rowHeight=ue.get().formRowHeight}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this.smartField.invalidateLayoutTree()}layout(e){let t=S.get(e),r=e.children(".multiline-input"),s=e.children(".multiline-lines"),o=t.availableSize().subtract(t.insets());r.cssHeight(this.rowHeight),s.cssHeight(o.height-this.rowHeight)}}function m_(i,e,t){return e=H0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function H0(i){var e=N0(i,"string");return typeof e=="symbol"?e:String(e)}function N0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Zc extends ae{constructor(){super(),m_(this,"trimText",void 0),m_(this,"lookupOnAcceptByText",void 0),this.maxLength=4e3,this.trimText=!0,this.lookupOnAcceptByText=!1}_getValueFromLookupRow(e){return e.text}_getLastSearchText(){return this.value}cssClassName(){return"proposal-field"}_handleEnterKey(e){let t=!!this.popup;this.acceptInput(),this.popup&&this.closePopup(),t&&e.stopPropagation()}_lookupByTextOrAllDone(e){if(!super._handleException(e)){if(e.lookupRows.length===0){this.setLoading(!1),this._handleEmptyResult();return}super._lookupByTextOrAllDone(e)}}_formatValue(e){return u.nvl(e,"")}_validateValue(e){if(v.isNullOrUndefined(e))return e;let t=y.asString(e);return this.trimText&&(t=t.trim()),t===""&&(t=null),t}_ensureValue(e){return y.asString(e)}_acceptByText(e,t){a().log.isDebugEnabled()&&a().log.debug("(ProposalField#_acceptByText) searchText=",t),!e&&this.lookupOnAcceptByText&&y.hasText(t)?super._acceptByTextAsync(t):this._customTextAccepted(t)}_acceptByTextDone(e){if(this._userWasTyping=!1,this._extendResult(e),e.uniqueMatch){let t=e.uniqueMatch;if(this._isLookupRowActive(t)){this.setLookupRow(t),this._inputAccepted();return}}this._customTextAccepted(e.text)}_checkResetLookupRow(e){return this.lookupRow&&this.lookupRow.text!==e}_checkSearchTextChanged(e){return this._checkDisplayTextChanged(e)}_customTextAccepted(e){this._setLookupRow(null),this._setValue(e),this._inputAccepted(!0,!1)}getValueForSelection(){return this._showSelection()?this.lookupRow.key:null}_copyValuesFromField(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.value!==e.value&&this.setValue(e.value)}_acceptInput(e,t,r,s,o){if(!o&&this.lookupRow&&this.lookupRow.text===t){a().log.isDebugEnabled()&&a().log.debug("(ProposalField#_acceptInput) unchanged: text is equals. Close popup"),this._inputAccepted(!1);return}if(o){a().log.isDebugEnabled()&&a().log.debug("(ProposalField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",o.toString()),this.clearErrorStatus(),this.setLookupRow(o),this._inputAccepted();return}return s?(this.clearErrorStatus(),this._acceptByText(e,t)):this._hasUiError()?this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise()}setTrimText(e){this.setProperty("trimText",e)}_updateEmpty(){this.empty=y.empty(this.value)}}class g_ extends xo{constructor(){super(),this._addRemoteProperties(["lookupRows"])}}function ep(i,e,t){return e=V0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function V0(i){var e=W0(i,"string");return typeof e=="symbol"?e:String(e)}function W0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tp extends ts{constructor(){super(...arguments),ep(this,"lookupRow",void 0),ep(this,"parentId",void 0),ep(this,"proposalChooser",void 0)}_renderText(){this.htmlEnabled?this.$text.html(this.text):this.$text.textOrNbsp(this.text)}_getStyles(){return this.lookupRow}_decorate(){!this.$node||(super._decorate(),this.$node.toggleClass("inactive",!this.lookupRow.active))}isBrowseLoadIncremental(){return this.proposalChooser.isBrowseLoadIncremental()}loadChildren(){if(this.isBrowseLoadIncremental()){let e=this.lookupRow.key;return this.proposalChooser.smartField.lookupByRec(e)}return a().resolvedPromise()}hasChildNodes(){return this.isBrowseLoadIncremental()&&!this.childrenLoaded?!0:super.hasChildNodes()}}function Es(i,e,t){return e=K0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function K0(i){var e=z0(i,"string");return typeof e=="symbol"?e:String(e)}function z0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ud extends I{constructor(){super(),Es(this,"smartField",void 0),Es(this,"activeFilterGroup",void 0),Es(this,"status",void 0),Es(this,"statusVisible",void 0),Es(this,"touch",void 0),Es(this,"content",void 0),Es(this,"$status",void 0),Es(this,"_updateStatusTimeout",void 0),this.activeFilterGroup=null,this.status=null,this.statusVisible=!0,this.touch=!1,this.$status=null,this._updateStatusTimeout=null}_init(e){super._init(e),e.smartField||(this.smartField=this.parent.smartField),this.content=this._createContent()}triggerLookupRowSelected(e){e=e||this.selectedRow(),!(!e||!e.enabled)&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}_render(){this.$container=this.$parent.appendDiv("proposal-chooser").toggleClass("touch",this.touch),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new ip(this,this._createLayoutResetter())),this._renderContent(),this.$status=this.$container.appendDiv("status").setVisible(!1),this.smartField.activeFilterEnabled&&(this.activeFilterGroup=u.create(ds,{parent:this,labelVisible:!1,statusVisible:!1,gridColumnCount:ae.ACTIVE_FILTER_VALUES.length}),ae.ACTIVE_FILTER_VALUES.forEach(function(e,t){this._insertActiveFilterButton(e,t)},this),this.activeFilterGroup.render(),this.activeFilterGroup.$container.addClass("active-filter"),this.activeFilterGroup.removeMandatoryIndicator())}_renderContent(){this.content.render(),this.content.$container.setTabbable(!1),this.content.$container.addClass("focused")}_renderProperties(){super._renderProperties(),this._updateStatus()}delegateEvent(e){e.originalEvent.smartFieldEvent=!0,this.content.$container.trigger(e)}delegateKeyEvent(e){this.content.$container.trigger(e)}_renderStatus(){this._updateStatus()}_renderStatusVisible(){this._updateStatus()}_computeStatusVisible(){return!!(this.statusVisible&&this.status)}_updateStatus(){clearTimeout(this._updateStatusTimeout),v.optProperty(this.status,"severity")===E.Severity.OK?this._updateStatusTimeout=setTimeout(this._updateStatusImpl.bind(this),250):this._updateStatusImpl()}_updateStatusImpl(){if(!this.rendered&&!this.rendering)return;let e=this.$status.isVisible(),t=this.$status.text(),r=this._computeStatusVisible();e===r&&t===v.optProperty(this.status,"message")||(a().log.isDebugEnabled()&&a().log.debug("(ProposalChooser#_updateStatusImpl) $status.visible="+r),this.$status.setVisible(r),this.status?this._setStatusMessage(this.status.message):this.$status.text(""),this.htmlComp.invalidateLayoutTree())}_setStatusMessage(e){E.animateStatusMessage(this.$status,e)}_insertActiveFilterButton(e,t){let r=u.create(bl,{parent:this.activeFilterGroup,label:this._activeFilterLabel(t),radioValue:ae.ACTIVE_FILTER_VALUES[t],selected:this.smartField.activeFilter===e,focusWhenSelected:!1,gridDataHints:{useUiWidth:!0}});r.on("propertyChange",s=>{s.propertyName==="selected"&&s.newValue===!0&&this.trigger("activeFilterSelected",{activeFilter:s.source.radioValue})}),this.activeFilterGroup.insertButton(r)}setVirtual(e){this.content instanceof W&&this.content.setVirtual(e)}setStatus(e){this.setProperty("status",e)}setBusy(e){this.content.setProperty("loading",e),this.content.setProperty("enabled",!e)}_activeFilterLabel(e){return this.smartField.activeFilterLabels[e]}updateScrollbars(){this.content.updateScrollbars()}_isProposal(){return this.smartField instanceof Zc}_selectProposal(e,t){this._isProposal()||(e.byAll?this.trySelectCurrentValue():t.length===1&&this.selectFirstLookupRow())}}function __(i,e,t){return e=G0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function G0(i){var e=U0(i,"string");return typeof e=="symbol"?e:String(e)}function U0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ip extends te{constructor(e,t){super(),__(this,"_proposalChooser",void 0),__(this,"_layoutResetter",void 0),this._proposalChooser=e,this._layoutResetter=t}layout(e){let t,r=S.get(e),s=S.get(e.children(this._layoutResetter.cssSelector)),o=r.size().subtract(r.insets()),n=this._proposalChooser.$status,l=n&&n.isVisible(),d=this._proposalChooser.activeFilterGroup;l&&(o.height-=w.size(n).height),d&&(t=d.htmlComp.prefSize(),o.height-=t.height),s.setSize(o),d&&d.htmlComp.setSize(new A(o.width,t.height))}preferredLayoutSize(e,t){let r,s,o,n,l,d,h,p=this._proposalChooser.htmlComp,m=this._proposalChooser.$status,g=this._proposalChooser.activeFilterGroup,b=e.parent();return o=this._proposalChooser.content.htmlComp.prefSize(t),s=o,x.storeScrollPositions(e,this._proposalChooser.session),d=e.css("width"),h=e.css("height"),e.detach(),this._layoutResetter.modifyDom(),e.css("display","inline-block").css("width","auto").css("height","auto"),b.append(e),o.width=w.prefSize(e,{restoreScrollPositions:!1}).width,e.detach(),this._layoutResetter.restoreDom(),e.css("display","block").css("width",d).css("height",h),b.append(e),x.restoreScrollPositions(e,this._proposalChooser.session),m&&m.isVisible()&&(r=m.css("display"),m.css("display","inline-block"),n=w.prefSize(m,{includeMargin:!0,useCssSize:!0}),m.css("display",r),s=new A(Math.max(s.width,n.width),s.height+n.height)),g&&(l=g.htmlComp.prefSize(),s=new A(Math.max(s.width,l.width),s.height+l.height)),e.toggleClass("empty",o.height===0),s.add(p.insets())}}class b_ extends ud{_createContent(){let e=!1,t=[],r=this.smartField.columnDescriptors;r?r.forEach(function(o,n){e=e||!!o.text,t.push(this._createColumnForDescriptor(o))},this):t.push(this._createColumn());let s=this._createTable(t,e);return s.on("rowClick",this._onRowClick.bind(this)),s}_createLayoutResetter(){return u.create(cd,this.content)}_createColumn(){return u.create(Me,{session:this.session,width:Me.NARROW_MIN_WIDTH,horizontalAlignment:this.smartField.gridData.horizontalAlignment})}_createColumnForDescriptor(e){let t=Me.NARROW_MIN_WIDTH;return e.width&&e.width>0&&(t=e.width),u.create(Me,{session:this.session,text:e.text,cssClass:u.nvl(e.cssClass,null),width:t,autoOptimizeWidth:u.nvl(e.autoOptimizeWidth,!1),fixedWidth:u.nvl(e.fixedWidth,!1),fixedPosition:u.nvl(e.fixedPosition,!1),horizontalAlignment:u.nvl(e.horizontalAlignment,this.smartField.gridData.horizontalAlignment),visible:u.nvl(e.visible,!0),htmlEnabled:u.nvl(e.htmlEnabled,!1)})}_createTable(e,t){return u.create(W,{parent:this,headerVisible:t,autoResizeColumns:!0,multiSelect:!1,multilineText:!0,scrollToSelection:!0,columns:e,headerMenusEnabled:!1,textFilterEnabled:!1})}_onRowClick(e){let t=e.row;!t||!t.enabled||(this.setBusy(!0),this.triggerLookupRowSelected(t))}selectedRow(){return this.content.selectedRow()}setLookupResult(e){let t=[],r=e.lookupRows,s=!!this.smartField.columnDescriptors;this.content.deleteAllRows(),r.forEach(o=>{t.push(this._createTableRow(o,s))}),this.content.insertRows(t),this._selectProposal(e,t)}trySelectCurrentValue(){let e=this.smartField.getValueForSelection();if(v.isNullOrUndefined(e))return;let t=f.find(this.content.rows,r=>r.lookupRow.key===e);t&&this.content.selectRow(t)}selectFirstLookupRow(){this.content.rows.length&&this.content.selectRow(this.content.rows[0])}clearSelection(){this.content.deselectAll()}clearLookupRows(){this.content.removeAllRows()}_createTableRow(e,t){let r=fn.createTableRow(e,t);return t&&f.pushAll(r.cells,this._transformTableRowData(e,e.additionalTableRowData)),r}_renderContent(){this.content.setVirtual(this.smartField.virtual()),super._renderContent(),this.content.$data.addClass("top-border-on-first-row")}getSelectedLookupRow(){let e=this.content.selectedRow();return e?e.lookupRow:null}_transformTableRowData(e,t){let r=this.smartField.columnDescriptors,s=[];return r.forEach(o=>{s.push(fn.createTableCell(e,o,t))}),s}}function rp(i,e,t){return e=q0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function q0(i){var e=Y0(i,"string");return typeof e=="symbol"?e:String(e)}function Y0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class cd{constructor(e){rp(this,"cssSelector",void 0),rp(this,"_table",void 0),rp(this,"_fillerWidth",void 0),this._table=e,this._fillerWidth=null,this.cssSelector=".table"}modifyDom(){this._table.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._table.$data.css("display","inline-block"),this._modifyFiller(this._table.$fillBefore),this._modifyFiller(this._table.$fillAfter),this._modifyTableData(this._cssBackup)}restoreDom(){this._table.$container.css("display","block").css("width","100%").css("height","100%"),this._table.$data.css("display","block"),this._restoreFiller(this._table.$fillBefore),this._restoreFiller(this._table.$fillAfter),this._modifyTableData(this._cssRestore)}_cssBackup(e,t){let r=e.css(t);e.css(t,"").data("backup"+t,r)}_cssRestore(e,t){let r="backup"+t,s=e.data(r);e.css(t,s).removeData(r)}_modifyTableData(e){let t=this;this._table.$rows().each(function(){let r=a()(this);e(r,"width"),t._table.$cellsForRow(r).each(function(){let s=a()(this);e(s,"min-width"),e(s,"max-width")})})}_modifyFiller(e){e&&(this._fillerWidth=e.css("width"),e.css("width",""))}_restoreFiller(e){e&&e.css("width",this._fillerWidth)}}class sp extends ud{_createContent(){let e=u.create(fe,{parent:this,requestFocusOnNodeControlMouseDown:!1,scrollToSelection:!0,textFilterEnabled:!1});return e.on("nodeClick",this._onNodeClick.bind(this)),e}_createLayoutResetter(){return u.create(op,this.content)}_onNodeClick(e){this.triggerLookupRowSelected(e.node)}selectedRow(){return this.content.selectedNode()}isBrowseLoadIncremental(){return this.smartField.browseLoadIncremental}getSelectedLookupRow(){let e=this.content.selectedNode();return e?e.lookupRow:null}selectFirstLookupRow(){this.content.nodes.length&&this.content.selectNode(this.content.nodes[0])}clearSelection(){this.content.deselectAll()}setLookupResult(e){let t,r,s=e.lookupRows;if(u.nvl(e.appendResult,!1))if(r=s.map(this._createTreeNode.bind(this)),t=this._flatListToSubTree(r),t.length){let n=null;t.forEach(l=>{n=this.content.nodesMap[l.parentId],this._appendChildNode(n,l)}),n&&this.content.insertNodes(t,n)}else{let n=this.content.nodesMap[this._createNodeId(e.rec)];n.leaf=!0,n.childrenLoaded=!0,this.content.updateNode(n)}else this.content.deleteAllChildNodes(),r=s.map(this._createTreeNode.bind(this)),t=this._flatListToSubTree(r),e.byText&&this._expandAllParentNodes(r),this.content.insertNodes(t);this._selectProposal(e,r)}_expandAllParentNodes(e){e.reduce((s,o)=>((o.leaf||!o.childrenLoaded&&o.childNodes.length===0)&&s.push(o),s),[]).forEach(r.bind(this));function r(s){if(!(!s.parentNode||s.parentNode.expanded))for(s=s.parentNode;s;)this.content.setNodeExpanded(s,!0),s=s.parentNode}}trySelectCurrentValue(){let e=this.smartField.getValueForSelection();if(v.isNullOrUndefined(e))return;let t=v.values(this.content.nodesMap),r=f.find(t,s=>s.lookupRow.key===e);r&&this.content.selectNode(r)}_createTreeNode(e){let t=!0,r=this.smartField.browseAutoExpandAll;return this.isBrowseLoadIncremental()&&(r=!1,t=!1),u.create(tp,{parent:this.content,proposalChooser:this,childNodeIndex:0,enabled:e.enabled,htmlEnabled:!1,iconId:e.iconId,id:this._createNodeId(e.key),parentId:this._createNodeId(e.parentKey),expanded:r,initialExpanded:r,text:e.text,lookupRow:e,leaf:t,tooltipText:e.tooltipText})}_createNodeId(e){return v.isNullOrUndefined(e)||typeof e=="string"?e:JSON.stringify(e)}findLeafs(){let e=[];return fe.visitNodes((t,r)=>{(t.leaf||!t.childNodes.length)&&e.push(t)},this.content.nodes),e}_flatListToSubTree(e){let t={};e.forEach(s=>{v.isNullOrUndefined(s.id)||(t[s.id]=s)});let r=[];return e.forEach(s=>{let o=t[s.parentId];if(o===s)throw new Error("Cannot link a node to itself. Id: "+s.parentId);o?this._appendChildNode(o,s):(s.childNodeIndex=r.length,s.parentNode=null,r.push(s))}),r}_appendChildNode(e,t){e.childNodes||(e.childNodes=[]),t.childNodeIndex=e.childNodes.length,t.parentNode=e,e.childNodes.push(t),e.leaf=!1,e.childrenLoaded=!0}clearLookupRows(){this.content.deleteAllNodes()}}function y_(i,e,t){return e=j0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function j0(i){var e=X0(i,"string");return typeof e=="symbol"?e:String(e)}function X0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class op{constructor(e){y_(this,"cssSelector",void 0),y_(this,"_tree",void 0),this._tree=e,this.cssSelector=".tree"}modifyDom(){this._ensureFirstLast(),this._tree.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._tree.$data.css("display","inline-block")}restoreDom(){this._tree.$container.css("display","block").css("width","100%").css("height","100%"),this._tree.$data.css("display","block")}_ensureFirstLast(){let e=this._tree.$data.children(".tree-node").removeClass("first last");e.first().addClass("first"),e.last().addClass("last")}}function rt(i,e,t){return e=J0(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function J0(i){var e=Q0(i,"string");return typeof e=="symbol"?e:String(e)}function Q0(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _e extends xs{constructor(){super(),rt(this,"firstField",void 0),rt(this,"secondField",void 0),rt(this,"collapsibleField",void 0),rt(this,"fieldCollapsed",void 0),rt(this,"toggleCollapseKeyStroke",void 0),rt(this,"firstCollapseKeyStroke",void 0),rt(this,"secondCollapseKeyStroke",void 0),rt(this,"splitHorizontal",void 0),rt(this,"splitterEnabled",void 0),rt(this,"splitterPosition",void 0),rt(this,"minSplitterPosition",void 0),rt(this,"splitterPositionType",void 0),rt(this,"fieldMinimized",void 0),rt(this,"minimizeEnabled",void 0),rt(this,"htmlSplitArea",void 0),rt(this,"collapseHandle",void 0),rt(this,"_oldSplitterPositionType",void 0),rt(this,"_$splitArea",void 0),rt(this,"_$splitter",void 0),rt(this,"_$window",void 0),rt(this,"_$body",void 0),this._addWidgetProperties(["firstField","secondField","collapsibleField"]),this._addPreserveOnPropertyChangeProperties(["collapsibleField"]),this.firstField=null,this.secondField=null,this.collapsibleField=null,this.fieldCollapsed=!1,this.toggleCollapseKeyStroke=null,this.firstCollapseKeyStroke=null,this.secondCollapseKeyStroke=null,this.splitHorizontal=!0,this.splitterEnabled=!0,this.splitterPosition=.5,this.minSplitterPosition=0,this.splitterPositionType=_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST,this.fieldMinimized=!1,this.minimizeEnabled=!0,this._$splitArea=null,this._$splitter=null}_init(e){super._init(e),this._setToggleCollapseKeyStroke(e.toggleCollapseKeyStroke),this._setFirstCollapseKeyStroke(e.firstCollapseKeyStroke),this._setSecondCollapseKeyStroke(e.secondCollapseKeyStroke),this._updateCollapseHandle(),this._initResponsive()}_initResponsive(){this.getFields().forEach(e=>{e instanceof Fe&&e.responsive===null&&e.setResponsive(!0)})}_render(){this.addContainer(this.$parent,"split-box"),this._$splitArea=this.$parent.makeDiv("split-area"),this.addField(this._$splitArea),this.htmlSplitArea=S.install(this._$splitArea,this.session),this.htmlSplitArea.setLayout(new dp(this)),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.firstField&&(this.firstField.render(this._$splitArea),this.firstField.$container.addClass("first-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.firstField.on("propertyChange",t.bind(this)),this.secondField&&(this.secondField.render(this._$splitArea),this.secondField.$container.addClass("second-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.secondField.on("propertyChange",t.bind(this)),this._$splitter=this._$splitArea.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis").on("mousedown",e.bind(this)))),this._updateFieldVisibilityClasses();function e(r){if(r.which!==1)return;let s,o,n,l,d,h;this.splitterEnabled&&(s={x:r.pageX,y:r.pageY},this._$window.on("mousemove.splitbox",g.bind(this)).on("mouseup.splitbox",b.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),a()("iframe").addClass("dragging-in-progress"),o=this._$splitArea.offset(),n=w.size(this._$splitArea,!0),d=this._$splitter.offset(),l=w.size(this._$splitter,!0),h=this._$splitArea.appendDiv("temp-splitter").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.splitHorizontal?h.cssLeft(d.left-o.left):h.cssTop(d.top-o.top),this._$splitter.addClass("dragging"));let p=this.splitterPosition,m=10;function g(C){if(!(C.pageX===s.x&&C.pageY===s.y))if(s={x:C.pageX,y:C.pageY},this.splitHorizontal){let P=C.pageX-o.left,R,k,N=Math.floor((l.width+ue.get().fieldMandatoryIndicatorWidth)/2);this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?(R=u.nvl(this.minSplitterPosition,0),k=n.width-l.width+N):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(R=(n.width-l.width)*u.nvl(this.minSplitterPosition,0),k=n.width-l.width+N):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(R=0,k=n.width-l.width+N-u.nvl(this.minSplitterPosition,0)):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&(R=0,k=n.width-l.width+N-Math.floor(u.nvl(this.minSplitterPosition,0)*(n.width-l.width)));let be=N;P<R+N+m?(P=R,be=0):P>k-m&&(P=k),h.cssLeft(P-be),p=P-be,this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?p=p/(n.width-l.width):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?p=1-p/(n.width-l.width):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(p=n.width-l.width-p)}else{let P=C.pageY-o.top,R=Math.floor(l.height/2);P<m?(P=0,R=0):n.height-P<m&&(P=n.height,R=l.height),h.cssTop(P-R),p=P-R,this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?p=p/(n.height-l.height):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?p=1-p/(n.height-l.height):this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(p=n.height-p-l.height)}}function b(C){C.which===1&&(this._$window.off("mousemove.splitbox").off("mouseup.splitbox"),h&&(this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),a()("iframe").removeClass("dragging-in-progress"),h.remove(),this._$splitter.removeClass("dragging"),this.newSplitterPosition(p,!0)))}return!1}function t(r){r.propertyName==="visible"&&(this._updateFieldVisibilityClasses(),this.htmlSplitArea.invalidateLayoutTree(!1))}}_renderProperties(){super._renderProperties(),this._renderSplitterPosition(),this._renderSplitterEnabled(),this._renderCollapsibleField(),this._renderCollapseHandle(),this._renderFieldMinimized()}_remove(){this._$splitArea=null,this._$splitter=null,super._remove()}_setSplitterPosition(e){this._setProperty("splitterPosition",e),this._oldSplitterPositionType=null}_renderSplitterPosition(){this.newSplitterPosition(this.splitterPosition,!1)}_setSplitterPositionType(e){this.rendered&&!this._oldSplitterPositionType&&(this._oldSplitterPositionType=this.splitterPositionType),this._setProperty("splitterPositionType",e)}_renderSplitterPositionType(){if(this._oldSplitterPositionType){let e=this.htmlSplitArea.size(),t=this.splitterPosition,r=w.size(this._$splitter,!0),s=this.minSplitterPosition,o=0;this.splitHorizontal?o=e.width-r.width:o=e.height-r.height;let n=this._isSplitterPositionTypeRelative(this._oldSplitterPositionType),l=this._isSplitterPositionTypeRelative(this.splitterPositionType),d=!n,h=!l;n&&h?(this._oldSplitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST&&this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND||this._oldSplitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?t=o-o*t:t=o*t,s&&(s=o*s)):d&&l?(this._oldSplitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST&&this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND||this._oldSplitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?t=(o-t)/o:t=t/o,s&&(s=s/o)):d&&h?t=o-t:t=1-t,this.setMinSplitterPosition(s),this._oldSplitterPositionType=null,this.newSplitterPosition(t,!0)}}_isSplitterPositionTypeRelative(e){return e===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||e===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND}_renderSplitterEnabled(){this._$splitter&&this._$splitter.setEnabled(this.splitterEnabled)}setFieldCollapsed(e){this.setProperty("fieldCollapsed",e),this._updateCollapseHandleButtons()}_renderFieldCollapsed(){this._renderCollapsibleField()}setCollapsibleField(e){this.setProperty("collapsibleField",e),this._updateCollapseHandle()}_updateCollapseHandle(){if(this.toggleCollapseKeyStroke&&this.unregisterKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.collapsibleField){let e=er.HorizontalAlignment.LEFT;this.collapsibleField!==this.firstField&&(e=er.HorizontalAlignment.RIGHT),this.collapseHandle?this.collapseHandle.setHorizontalAlignment(e):(this.collapseHandle=u.create(er,{parent:this,horizontalAlignment:e}),this.collapseHandle.on("action",this.collapseHandleButtonPressed.bind(this)),this.toggleCollapseKeyStroke&&this.registerKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.registerKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.registerKeyStrokes(this.secondCollapseKeyStroke),this.rendered&&this._renderCollapseHandle()),this._updateCollapseHandleButtons()}else this.collapseHandle&&(this.collapseHandle.destroy(),this.collapseHandle=null)}_updateCollapseHandleButtons(){if(!this.collapseHandle)return;let e,t,r=this.fieldCollapsed,s=this.fieldMinimized,o=this._isMinimizable(),n=this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,l=n&&this.collapsibleField===this.secondField||!n&&this.collapsibleField===this.firstField;n?l?(e=!s&&o||r,t=!r):(e=!r,t=r||s&&o):l?(e=!r,t=!s&&o||r):(e=r||s&&o,t=!r),this.collapseHandle.setLeftVisible(e),this.collapseHandle.setRightVisible(t),this.firstCollapseKeyStroke&&(e?this.registerKeyStrokes(this.firstCollapseKeyStroke):this.unregisterKeyStrokes(this.firstCollapseKeyStroke)),this.secondCollapseKeyStroke&&(t?this.registerKeyStrokes(this.secondCollapseKeyStroke):this.unregisterKeyStrokes(this.secondCollapseKeyStroke))}getEffectiveSplitterPosition(){return this._isMinimizable()&&this.fieldMinimized?this.minSplitterPosition:this.splitterPosition}setMinSplitterPosition(e){this.setProperty("minSplitterPosition",e),this._updateCollapseHandleButtons()}_renderMinSplitterPosition(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}setFieldMinimized(e){this.setProperty("fieldMinimized",e),this._updateCollapseHandleButtons()}_renderFieldMinimized(){this.$container.removeClass("first-field-minimized second-field-minimized"),this.firstField&&this.firstField.$container.removeClass("minimized"),this.secondField&&this.secondField.$container.removeClass("minimized"),this.collapsibleField&&this.fieldMinimized&&(this.collapsibleField.$container.addClass("minimized"),this.$container.toggleClass("first-field-minimized",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-minimized",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}setMinimizeEnabled(e){this.setProperty("minimizeEnabled",e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(this.splitterPosition)&&this.setFieldMinimized(!0),this._updateCollapseHandleButtons()}_renderMinimizeEnabled(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}_isMinimizable(){return!!this.minSplitterPosition&&this.minimizeEnabled}_renderCollapsibleField(){this.$container.removeClass("first-field-collapsed second-field-collapsed"),this.firstField&&this.firstField.$container.removeClass("collapsed"),this.secondField&&this.secondField.$container.removeClass("collapsed"),this.collapsibleField&&this.fieldCollapsed&&(this.collapsibleField.$container.addClass("collapsed"),this.$container.toggleClass("first-field-collapsed",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-collapsed",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}_setToggleCollapseKeyStroke(e){e&&(this.toggleCollapseKeyStroke instanceof B&&this.unregisterKeyStrokes(this.toggleCollapseKeyStroke),this.toggleCollapseKeyStroke=new np(this,e),this.collapseHandle&&this.registerKeyStrokes(this.toggleCollapseKeyStroke))}_setFirstCollapseKeyStroke(e){e&&(this.firstCollapseKeyStroke instanceof B&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.firstCollapseKeyStroke=new lp(this,e),this.collapseHandle&&this.registerKeyStrokes(this.firstCollapseKeyStroke))}_setSecondCollapseKeyStroke(e){e&&(this.secondCollapseKeyStroke instanceof B&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.secondCollapseKeyStroke=new ap(this,e),this.collapseHandle&&this.registerKeyStrokes(this.secondCollapseKeyStroke))}_renderCollapseHandle(){this.collapseHandle&&this.collapseHandle.render()}newSplitterPosition(e,t){if(this._isSplitterPositionTypeRelative(this.splitterPositionType)?e=Math.max(0,Math.min(1,e)):e=Math.max(0,e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(e)){this.setFieldMinimized(!0);return}let r=this.splitterPosition!==e;this.splitterPosition=e,r&&(this.trigger("positionChange",{position:e}),t&&this._updateFieldMinimized()),this._updateCollapseHandleButtons(),this.htmlSplitArea.invalidateLayoutTree(!1)}_updateFieldMinimized(){this._isMinimizable()?this.setFieldMinimized(this._isSplitterPositionInMinimalRange(this.splitterPosition)):this.setFieldMinimized(!1)}_isSplitterPositionInMinimalRange(e){return this._isMinimizable()?e<=this.minSplitterPosition:!1}toggleFieldCollapsed(){this.setFieldCollapsed(!this.fieldCollapsed)}collapseHandleButtonPressed(e){let t=this.fieldCollapsed,r=this.fieldMinimized,s=this._isMinimizable(),o=this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,n=!!e.left&&!o||!!e.right&&o;o&&this.collapsibleField===this.secondField||!o&&this.collapsibleField===this.firstField?n?t||(r&&s?this.setFieldMinimized(!1):this.setFieldCollapsed(!0)):t?this.setFieldCollapsed(!1):r||s&&this.setFieldMinimized(!0):n?t?this.setFieldCollapsed(!1):r&&this.setFieldMinimized(!1):t||(r||!s?this.setFieldCollapsed(!0):this.setFieldMinimized(!0))}getFields(){let e=[];return this.firstField&&e.push(this.firstField),this.secondField&&e.push(this.secondField),e}_updateFieldVisibilityClasses(){if(!this.rendered&&!this.rendering)return;let e=this.firstField&&this.firstField.isVisible(),t=this.secondField&&this.secondField.isVisible(),s=!(e&&t)&&(e||t);this.$container.toggleClass("single-field",s)}}rt(_e,"SPLITTER_POSITION_TYPE_RELATIVE_FIRST","relativeFirst"),rt(_e,"SPLITTER_POSITION_TYPE_RELATIVE_SECOND","relativeSecond"),rt(_e,"SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST","absoluteFirst"),rt(_e,"SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND","absoluteSecond");class v_ extends un{constructor(){super(),this._addRemoteProperties(["collapsibleField","fieldCollapsed","minSplitterPosition","fieldMinimized"])}_onWidgetPositionChange(e){this._send("setSplitterPosition",{splitterPosition:e.position})}_onWidgetEvent(e){e.type==="positionChange"?this._onWidgetPositionChange(e):super._onWidgetEvent(e)}}class np extends B{constructor(e,t){super(),this.field=e,this.parseAndSetKeyStroke(t),this.inheritAccessibility=!1}handle(e){this.field.toggleFieldCollapsed()}_postRenderKeyBox(e,t){let r=this.field.collapseHandle.$container;t.addClass("split-box-collapse-key-box");let s=r.offsetTo(this.field.$container);t.cssLeft(s.left-t.outerWidth()).cssTop(s.top)}}class lp extends B{constructor(e,t){super(),this.field=e,this.parseAndSetKeyStroke(t),this.inheritAccessibility=!1}handle(e){this.field.collapseHandleButtonPressed({left:!0})}_postRenderKeyBox(e,t){let r=this.field.collapseHandle.$container;t.addClass("split-box-collapse-key-box left");let s=r.offsetTo(this.field.$container);t.cssLeft(s.left-t.outerWidth()).cssTop(s.top)}}class ap extends B{constructor(e,t){super(),this.field=e,this.parseAndSetKeyStroke(t),this.inheritAccessibility=!1}handle(e){this.field.collapseHandleButtonPressed({right:!0})}_postRenderKeyBox(e,t){let r=this.field.collapseHandle.$container;t.addClass("split-box-collapse-key-box right");let s=r.offsetTo(this.field.$container);t.cssLeft(s.left+r.width()-t.outerWidth()).cssTop(s.top-t.outerHeight())}}function Z0(i,e,t){return e=eD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function eD(i){var e=tD(i,"string");return typeof e=="symbol"?e:String(e)}function tD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class dp extends te{constructor(e){super(),Z0(this,"splitBox",void 0),this.splitBox=e}layout(e){let t=S.get(e),r=e.children(".splitter"),s=e.children(".form-field"),o=S.optGet(s.eq(0)),n=S.optGet(s.eq(1)),l=this.splitBox.splitHorizontal;r.removeClass("hidden");let d,h=t.availableSize().subtract(t.insets()),p=o&&o.isVisible(),m=n&&n.isVisible(),g=p&&m,b=!g&&(p||m),C=this.splitBox.getEffectiveSplitterPosition(),P=new A(h);if(g&&(l?P.width-=o.margins().right:P.height-=o.margins().bottom),g){let k=new A(P),N=new A(P);this.computeInnerFieldsDimensions(l,k,N,C),d=new re(0,0,k.width,k.height);let be=new re(0,0,N.width,N.height);l?(r.cssLeft(d.width),be.x=d.width+o.margins().right):(r.cssTop(d.height),be.y=d.height+o.margins().bottom),o.setBounds(d),n.setBounds(be)}else{if(b){let k=p?o:n,N=h.subtract(k.margins());k.setBounds(new re(0,0,N.width,N.height))}r.addClass("hidden")}let R=this.splitBox.collapseHandle;if(R){let k=R.$container,N=this.splitBox.firstField&&this.splitBox.firstField.visible&&this.splitBox.secondField&&this.splitBox.secondField.visible;k.setVisible(N);let be=null;if(g&&this.splitBox.collapsibleField===this.splitBox.firstField){let st=w.size(k);be=d.width-st.width}k.cssLeft(be)}}preferredLayoutSize(e,t){let r=S.get(e),s=e.children(".form-field"),o=S.optGet(s.eq(0)),n=S.optGet(s.eq(1)),l=this.splitBox.splitHorizontal,d=this.splitBox.getEffectiveSplitterPosition(),h=a().extend({},t),p=a().extend({},t);if(t.widthHint){let C=new A(t.widthHint,0),P=new A(t.widthHint,0);this.computeInnerFieldsDimensions(l,C,P,d),h.widthHint=C.width,p.widthHint=P.width}let m=new A(0,0);o&&(m=o.prefSize(h).add(o.margins()));let g=new A(0,0);n&&(g=n.prefSize(p).add(n.margins()));let b;return l?b=new A(m.width+g.width,Math.max(m.height,g.height)):b=new A(Math.max(m.width,g.width),m.height+g.height),b=b.add(r.insets()),b}computeInnerFieldsDimensions(e,t,r,s){e?this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.width=Math.floor(t.width*s),r.width-=t.width):this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(r.width=Math.floor(r.width*s),t.width-=r.width):(s=Math.min(s,t.width),this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.width=t.width-s,r.width=s):(t.width=s,r.width=r.width-s)):this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.height=Math.floor(t.height*s),r.height-=t.height):this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(r.height=Math.floor(r.height*s),t.height-=r.height):(s=Math.min(s,t.height),this.splitBox.splitterPositionType===_e.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.height=t.height-s,r.height=s):(t.height=s,r.height=r.height-s))}}function Nt(i,e,t){return e=iD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iD(i){var e=rD(i,"string");return typeof e=="symbol"?e:String(e)}function rD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wi extends fl{constructor(){super(),Nt(this,"format",void 0),Nt(this,"hasAction",void 0),Nt(this,"inputMasked",void 0),Nt(this,"inputObfuscated",void 0),Nt(this,"maxLength",void 0),Nt(this,"maxLengthHandler",void 0),Nt(this,"multilineText",void 0),Nt(this,"selectionStart",void 0),Nt(this,"selectionEnd",void 0),Nt(this,"selectionTrackingEnabled",void 0),Nt(this,"spellCheckEnabled",void 0),Nt(this,"trimText",void 0),Nt(this,"wrapText",void 0),Nt(this,"mouseClicked",void 0),Nt(this,"_onSelectionChangingActionHandler",void 0),this.format=null,this.hasAction=!1,this.inputMasked=!1,this.inputObfuscated=!1,this.maxLength=4e3,this.maxLengthHandler=u.create(Nn,{target:this}),this.multilineText=!1,this.selectionStart=0,this.selectionEnd=0,this.selectionTrackingEnabled=!1,this.spellCheckEnabled=!1,this.trimText=!0,this.wrapText=!1,this._onSelectionChangingActionHandler=this._onSelectionChangingAction.bind(this)}_initValue(e){e=Ce.resolveText(e,this.session.locale.languageTag),super._initValue(e)}_readDisplayText(){return this.$field?this.$field.val():""}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new up(this),new cp(this)])}_createKeyStrokeContext(){return new Fr}_init(e){super._init(e),this._setMultilineText(this.multilineText)}_render(){this.addContainer(this.$parent,"string-field",new hp(this)),this.addLabel(),this.addMandatoryIndicator();let e;this.multilineText?(e=this._makeMultilineField(),this.$container.addClass("multiline")):e=ee.makeTextField(this.$parent),this.addField(e),this.maxLengthHandler.install(e),this.addStatus()}_makeMultilineField(){let e=function(){this.mouseClicked=!0}.bind(this);return this.$parent.makeElement("<textarea>").on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).on("mousedown",e).on("focus",t=>{this.$field.off("mousedown",e),this.mouseClicked||setTimeout(()=>{!this.rendered||this.session.focusManager.isElementCovertByGlassPane(this.$field)||(this._renderSelectionStart(),this._renderSelectionEnd())}),this.mouseClicked=!1}).on("focusout",()=>{this.$field.on("mousedown",e)}).addDeviceClass()}_onFieldBlur(e){super._onFieldBlur(e),this.multilineText&&this._updateSelection(),this.inputObfuscated&&this.$field.val(this.displayText)}_onMouseWheel(e){let t=e.originalEvent||this.$container.window(!0).event.originalEvent,r=t.wheelDelta?-t.wheelDelta:t.detail,s=this.$field[0].scrollTop;if(r<0&&s===0)return;let o=this.$field[0].scrollHeight-this.$field[0].clientHeight;if(r>0&&s>=o-1){this.$field[0].scrollTop=o;return}t.stopPropagation()}_renderProperties(){super._renderProperties(),this._renderInputMasked(),this._renderWrapText(),this._renderFormat(),this._renderSpellCheckEnabled(),this._renderHasAction(),this._renderMaxLength(),this._renderSelectionTrackingEnabled(),this._renderDropType()}addIcon(e){this.$icon=ee.appendIcon(this.$container).on("click",this._onIconClick.bind(this))}isClearable(){return super.isClearable()&&!this.multilineText}setSelectionStart(e){this.setProperty("selectionStart",e)}_renderSelectionStart(){u.nvl(this.selectionStart,null)!==null&&(this.$field[0].selectionStart=this.selectionStart)}setSelectionEnd(e){this.setProperty("selectionEnd",e)}_renderSelectionEnd(){u.nvl(this.selectionEnd,null)!==null&&(this.$field[0].selectionEnd=this.selectionEnd)}setSelectionTrackingEnabled(e){this.setProperty("selectionTrackingEnabled",e)}_renderSelectionTrackingEnabled(){this.$field.off("select",this._onSelectionChangingActionHandler).off("mousedown",this._onSelectionChangingActionHandler).off("keydown",this._onSelectionChangingActionHandler).off("input",this._onSelectionChangingActionHandler),this.selectionTrackingEnabled&&this.$field.on("select",this._onSelectionChangingActionHandler).on("mousedown",this._onSelectionChangingActionHandler).on("keydown",this._onSelectionChangingActionHandler).on("input",this._onSelectionChangingActionHandler)}setInputMasked(e){this.setProperty("inputMasked",e)}_renderInputMasked(){this.multilineText||this.$field.attr("type",this.inputMasked?"password":"text")}_renderInputObfuscated(){this.inputObfuscated&&this.focused&&this.$field.val("")}setHasAction(e){this.setProperty("hasAction",e)}_renderHasAction(){this.hasAction?(this.$icon||(this.addIcon(),this.$icon.addClass("action")),this.$container.addClass("has-icon")):(this._removeIcon(),this.$container.removeClass("has-icon")),this.revalidateLayout()}_renderEnabled(){super._renderEnabled(),this.revalidateLayout()}setFormatUpper(e){e?this.setFormat(Wi.Format.UPPER):this.setFormat(null)}setFormatLower(e){e?this.setFormat(Wi.Format.LOWER):this.setFormat(null)}setFormat(e){this.setProperty("format",e)}_renderFormat(){this.format===Wi.Format.LOWER?this.$field.css("text-transform","lowercase"):this.format===Wi.Format.UPPER?this.$field.css("text-transform","uppercase"):this.$field.css("text-transform","")}setSpellCheckEnabled(e){this.setProperty("spellCheckEnabled",e)}_renderSpellCheckEnabled(){this.spellCheckEnabled?this.$field.attr("spellcheck","true"):this.$field.attr("spellcheck","false")}_renderDisplayText(){if(this.inputObfuscated&&this.focused){this.$field.val("");return}let e=y.nvl(this.displayText),t=y.nvl(this.$field.val()),r=this._getSelection();if(super._renderDisplayText(),this.trimText&&t!==e){let s=t.match(Wi.TRIM_REGEXP);s&&s[2]===e&&this._setSelection({start:Math.max(r.start-s[1].length,0),end:Math.min(r.end-s[1].length,e.length)})}}insertText(e){if(!this.rendered){this._postRenderActions.push(this.insertText.bind(this,e));return}this._insertText(e)}_insertText(e){if(!e)return;let t=this._getSelection(),r=this._applyTextToSelection(this.$field.val(),e,t);if(r.length>this.maxLength){this._showNotification("ui.CannotInsertTextTooLong");return}this.$field.val(r),this._setSelection(t.start+e.length),this.updateDisplayTextOnModify&&this.acceptInput(!0),this.acceptInput()}_applyTextToSelection(e,t,r){return this.inputObfuscated&&(e=""),e.slice(0,r.start)+t+e.slice(r.end)}setWrapText(e){this.setProperty("wrapText",e)}_renderWrapText(){this.$field.attr("wrap",this.wrapText?"soft":"off")}setTrimText(e){this.setProperty("trimText",e)}_renderTrimText(){}setMultilineText(e){this.setProperty("multilineText",e)}_setMultilineText(e){this._setProperty("multilineText",e),this.keyStrokeContext.setMultiline(this.multilineText)}_renderGridData(){super._renderGridData(),this.updateInnerAlignment({useHorizontalAlignment:!this.multilineText})}_renderGridDataHints(){super._renderGridDataHints(),this.updateInnerAlignment({useHorizontalAlignment:!0})}setMaxLength(e){this.setProperty("maxLength",e)}_renderMaxLength(){this.maxLengthHandler.render()}_onIconClick(){this.acceptInput(),this.$field.focus(),this.trigger("action")}_onSelectionChangingAction(e){e.type==="mousedown"?this.$field.window().one("mouseup.stringfield",()=>{setTimeout(this._updateSelection.bind(this))}):e.type==="keydown"?setTimeout(this._updateSelection.bind(this)):this._updateSelection()}_getSelection(){let e=u.nvl(this.$field[0].selectionStart,null),t=u.nvl(this.$field[0].selectionEnd,null);return(e===null||t===null)&&(e=0,t=0),{start:e,end:t}}_setSelection(e,t){typeof e=="number"?t=u.nvl(t,e):typeof e=="object"&&(t=e.end,e=e.start),this.$field[0].selectionStart=e,this.$field[0].selectionEnd=t,this._updateSelection()}_updateSelection(){let e=this.selectionStart,t=this.selectionEnd;this.selectionStart=this.$field[0].selectionStart,this.selectionEnd=this.$field[0].selectionEnd,this.selectionTrackingEnabled&&(this.selectionStart!==e||this.selectionEnd!==t)&&this.triggerSelectionChange()}triggerSelectionChange(){this.trigger("selectionChange",{selectionStart:this.selectionStart,selectionEnd:this.selectionEnd})}_validateValue(e){return v.isNullOrUndefined(e)?e:(e=y.asString(e),this.trimText&&(e=e.trim()),super._validateValue(e))}_clear(){super._clear(),this.inputObfuscated=!1}_updateEmpty(){this.empty=y.empty(this.value)}acceptInput(e){let t=u.nvl(this._readDisplayText(),"");this.inputObfuscated&&t!==""&&(this.inputObfuscated=!1),super.acceptInput(e)}_onFieldFocus(e){super._onFieldFocus(e),this.inputObfuscated&&(this.$field.val(""),setTimeout(()=>{if(!this.rendered)return;let t=this.$field[0];t.selectionStart=0,t.selectionEnd=0}))}_showNotification(e){u.create(ii,{parent:this,severity:E.Severity.WARNING,message:this.session.text(e)}).show()}_checkDisplayTextChanged(e,t){let r=super._checkDisplayTextChanged(e,t);return r&&this.inputObfuscated&&e===""?!1:r}}Nt(Wi,"Format",{LOWER:"a",UPPER:"A"}),Nt(Wi,"TRIM_REGEXP",new RegExp("^(\\s*)(.*?)(\\s*)$"));class hp extends li{constructor(e){super(e)}_layoutClearIcon(e,t,r,s){e.$icon&&e.$icon.isVisible()&&(r+=w.prefSize(e.$icon,!0).width),super._layoutClearIcon(e,t,r,s)}}class w_ extends Qa{_initProperties(e){e.insertText!==void 0&&delete e.insertText}_syncInsertText(e){this.widget.insertText(e)}_onWidgetSelectionChange(e){this._send("selectionChange",{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},{showBusyIndicator:!1,delay:500,coalesce:function(t){return this.target===t.target&&this.type===t.type}})}_onWidgetAction(e){this._send("action")}_onWidgetEvent(e){e.type==="selectionChange"?this._onWidgetSelectionChange(e):e.type==="action"?this._onWidgetAction(e):super._onWidgetEvent(e)}}class up extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER],this.renderingHints.render=!1,this.preventDefault=!1}_applyPropagationFlags(e){super._applyPropagationFlags(e);let t=this.field.$container.activeElement(!0);this.preventInvokeAcceptInputOnActiveValueField=!e.isPropagationStopped()&&t.tagName.toLowerCase()==="textarea",this.preventInvokeAcceptInputOnActiveValueField&&e.stopPropagation()}handle(e){}}class cp extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER],this.ctrl=!0}_accept(e){return super._accept(e)&&this.field.hasAction}handle(e){this.field._onIconClick()}}function As(i,e,t){return e=sD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sD(i){var e=oD(i,"string");return typeof e=="symbol"?e:String(e)}function oD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mn extends xs{constructor(){super(),As(this,"selectedTab",void 0),As(this,"header",void 0),As(this,"tabItems",void 0),As(this,"tabAreaStyle",void 0),As(this,"_$tabContent",void 0),As(this,"_statusPositionOrig",void 0),As(this,"_tabBoxHeaderPropertyChangeHandler",void 0),this.gridDataHints.useUiHeight=!0,this.gridDataHints.w=M.FULL_WIDTH,this.header=null,this.selectedTab=null,this.tabItems=[],this.tabAreaStyle=_r.DisplayStyle.DEFAULT,this._$tabContent=null,this._statusPositionOrig=null,this._addWidgetProperties(["tabItems","selectedTab"]),this._addPreserveOnPropertyChangeProperties(["selectedTab"]),this._tabBoxHeaderPropertyChangeHandler=this._onTabBoxHeaderPropertyChange.bind(this)}_init(e){super._init(e),this.header=u.create(_p,{parent:this,tabBox:this}),this._initProperties(e),this.header.on("propertyChange",this._tabBoxHeaderPropertyChangeHandler)}_initProperties(e){this._setTabItems(this.tabItems),this._setSelectedTab(this.selectedTab),this._setTabAreaStyle(this.tabAreaStyle)}_destroy(){super._destroy(),this.header.off("propertyChange",this._tabBoxHeaderPropertyChangeHandler)}_render(){this.addContainer(this.$parent,"tab-box",new wp(this)),this.header.render(this.$container),this.addStatus(),this._$tabContent=this.$container.appendDiv("tab-content"),S.install(this._$tabContent,this.session).setLayout(new Cr)}_renderProperties(){super._renderProperties(),this._renderSelectedTab()}_remove(){super._remove(),this._removeSelectedTab()}getContextMenuItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return[]}_removeMenus(){}deleteTabItem(e){let t=this.tabItems.indexOf(e),r=this.tabItems.slice();t>=0&&(r.splice(t,1),this.setTabItems(r))}insertTabItem(e,t){if(!e)return;t=u.nvl(t,this.tabItems.length);let r=this.tabItems.slice();r.splice(t,0,e),this.setTabItems(r)}setTabItems(e){this.setProperty("tabItems",e)}_setTabItems(e){e=e||[],(this.tabItems||[]).filter(r=>e.indexOf(r)<0).forEach(r=>{r.remove()}),this._setProperty("tabItems",e),this.header.setTabItems(this.tabItems),this.tabItems.indexOf(this.selectedTab)<0&&this.setSelectedTab(this.tabItems[0])}_renderTabItems(e){}_removeTabItems(e){}_removeTabContent(){this.tabItems.forEach(e=>{e.remove()})}selectTabById(e){let t=this.getTabItem(e);if(!t)throw new Error("Tab with ID '"+e+"' does not exist");this.setSelectedTab(t)}setSelectedTab(e){this.setProperty("selectedTab",e)}_setSelectedTab(e){a().log.isDebugEnabled()&&a().log.debug("(TabBox#_selectTab) tab="+e),this.selectedTab&&this.selectedTab.rendered&&this.selectedTab.remove(),this._setProperty("selectedTab",e),this.header.setSelectedTabItem(this.selectedTab)}_renderSelectedTab(){this.selectedTab&&(this.selectedTab.render(this._$tabContent),this.selectedTab.get$Scrollable().data("scroll-shadow-customizer",this._updateScrollShadow.bind(this))),this.rendered&&(this._updateScrollShadow(),S.get(this._$tabContent).invalidateLayoutTree())}_removeSelectedTab(){this.selectedTab&&(this.selectedTab.get$Scrollable().removeData("scroll-shadow-customizer"),this.selectedTab.remove())}_updateScrollShadow(){if(!this.rendered)return;let e=this.selectedTab&&this.selectedTab.hasScrollShadow("top"),t=this.$container.hasClass("has-scroll-shadow-top");this.$container.toggleClass("has-scroll-shadow-top",e),t!==e&&this.invalidateLayoutTree(!1),ee.adjustStatusPositionForScrollShadow(this,()=>e&&this.labelVisible)}setTabAreaStyle(e){this.setProperty("tabAreaStyle",e)}_setTabAreaStyle(e){this.tabAreaStyle=e,this.header&&this.header.tabArea&&this.header.tabArea.setDisplayStyle(e)}_renderStatusPosition(){super._renderStatusPosition(),this.fieldStatus&&(this.statusPosition===M.StatusPosition.TOP?this.$status.appendTo(this.header.$container):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}_updateFieldStatus(){super._updateFieldStatus(),this.selectedTab&&this.selectedTab.notification&&this.selectedTab.invalidateLayoutTree()}_renderLabelVisible(){super._renderLabelVisible(),this._updateScrollShadow()}getFields(){return this.tabItems}getTabItem(e){return f.find(this.tabItems,t=>t.id===e)}focus(){if(!this.rendered)return this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1;if(this.selectedTab)return this.selectedTab.focus()}getFocusableElement(){return this.selectedTab?this.selectedTab.getFocusableElement():null}isTabItemFocused(e){return this.header.isTabItemFocused(e)}focusTabItem(e){return this.header.focusTabItem(e)}getTabForItem(e){return this.header.getTabForItem(e)}_onTabBoxHeaderPropertyChange(e){e.propertyName==="selectedTabItem"&&this.setSelectedTab(e.newValue)}}As(mn,"MenuTypes",{Header:"TabBox.Header"});class pp extends B{constructor(e){super(),this.field=e,this.which=[_.LEFT],this.renderingHints.render=!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}handle(e){this.field.selectPreviousTab(!0),this.field.selectedTab.$container.addClass("keyboard-navigation")}}class fp extends B{constructor(e){super(),this.field=e,this.which=[_.RIGHT],this.renderingHints.render=!1,this.stopPropagation=!0,this.keyStrokeMode=B.Mode.DOWN,this.inheritAccessibility=!1}handle(e){this.field.selectNextTab(!0),this.field.selectedTab.$container.addClass("keyboard-navigation")}}class T_ extends un{constructor(){super(),this._addRemoteProperties(["selectedTab"])}exportAdapterData(e){return e=super.exportAdapterData(e),delete e.selectedTab,e}}function mp(i,e,t){return e=nD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nD(i){var e=lD(i,"string");return typeof e=="symbol"?e:String(e)}function lD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class gp extends te{constructor(e){super(),mp(this,"tabBoxHeader",void 0),mp(this,"htmlPropertyChangeHandler",void 0),mp(this,"fieldStatusWidth",void 0),this.tabBoxHeader=e,this.fieldStatusWidth=null,this._initDefaults(),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this.tabBoxHeader.one("remove",()=>{ue.get().off("propertyChange",this.htmlPropertyChangeHandler)})}_initDefaults(){this.fieldStatusWidth=ue.get().fieldStatusWidth}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this.tabBoxHeader.invalidateLayoutTree()}layout(e){let t=S.get(e),r=this.tabBoxHeader.tabArea,s=r.htmlComp.margins(),o,n=this.tabBoxHeader.menuBar,l=n.htmlComp.margins(),d,h=this.tabBoxHeader.tabBox.$status,p=new A,m=t.insets(),g=t.availableSize({exact:!0}).subtract(t.insets());d=n.htmlComp.prefSize({widthHint:0}),this.tabBoxHeader.tabBox.statusPosition===M.StatusPosition.TOP&&h&&h.isVisible()&&(p.height=h.outerHeight(!0),p.width=this.fieldStatusWidth+w.margins(h).horizontal()),o=r.htmlComp.prefSize({widthHint:g.width-d.width-l.horizontal()-p.width,exact:!1}),r.htmlComp.setSize(new A(o.width,g.height-s.vertical())),n.htmlComp.layout.collapsed=r.htmlComp.layout.overflowTabs.length>0,n.htmlComp.setBounds(new re(m.left+o.width+s.horizontal(),m.top,g.width-o.width-s.horizontal()-l.horizontal()-p.width,g.height-l.vertical())),this.tabBoxHeader.tabBox.statusPosition===M.StatusPosition.TOP&&h&&h.isVisible()&&h.cssWidth(this.fieldStatusWidth).cssRight(m.right).cssHeight(g.height-w.margins(h).vertical())}preferredLayoutSize(e,t){let r=S.get(e),s=r.insets(),o=(t.widthHint||r.availableSize().width)-r.insets().horizontal(),n=new A,l=this.tabBoxHeader.tabBox.$status,d=new A,h=this.tabBoxHeader.tabArea,p=h.htmlComp.margins(),m=this.tabBoxHeader.menuBar,g=m.htmlComp.margins(),b=m.htmlComp.prefSize({widthHint:0});this.tabBoxHeader.tabBox.statusPosition===M.StatusPosition.TOP&&l&&l.isVisible()&&(d.height=l.outerHeight(!0),d.width=this.fieldStatusWidth+w.margins(l).horizontal(),n.width+=d.width,n.height=Math.max(n.height,d.height));let C=h.htmlComp.prefSize({widthHint:o-b.width-g.horizontal()-p.horizontal()-d.width});n.width+=C.width+p.horizontal(),n.height=Math.max(n.height,C.height+p.vertical());let P=m.htmlComp.prefSize({widthHint:o-C.width-p.horizontal()-g.horizontal()-d.width});return n.width+=P.width+g.horizontal(),n.height=Math.max(n.height,P.height+g.vertical()),n.add(s)}}function gn(i,e,t){return e=aD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aD(i){var e=dD(i,"string");return typeof e=="symbol"?e:String(e)}function dD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _p extends I{constructor(){super(),gn(this,"tabBox",void 0),gn(this,"tabArea",void 0),gn(this,"menuBar",void 0),gn(this,"$borderBottom",void 0),gn(this,"_tabBoxPropertyChangeHandler",void 0),gn(this,"_tabAreaPropertyChangeHandler",void 0),this.tabBox=null,this.tabArea=null,this.menuBar=null,this.$borderBottom=null,this._tabBoxPropertyChangeHandler=this._onTabBoxPropertyChange.bind(this),this._tabAreaPropertyChangeHandler=this._onTabAreaPropertyChange.bind(this)}_init(e){super._init(e),this.tabArea=u.create(_r,{parent:this,tabBox:this.tabBox}),this.tabArea.on("propertyChange",this._tabAreaPropertyChangeHandler),this.menuBar=u.create(ce,{parent:this,menuOrder:new rs}),this.tabBox.on("propertyChange",this._tabBoxPropertyChangeHandler),this.menuBar.setMenuItems(this.tabBox.menus),this.setVisible(this.tabBox.labelVisible)}_render(){this.$container=this.$parent.appendDiv("tab-box-header"),this.$borderBottom=this.$container.appendDiv("bottom-border"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new gp(this)),this.tabArea.render(this.$container),this.menuBar.render(this.$container),this.$container.append(this.menuBar.$container)}_destroy(){this.tabBox.off("propertyChange",this._tabBoxPropertyChangeHandler),this.tabArea.off("propertyChange",this._tabAreaPropertyChangeHandler),super._destroy()}setTabItems(e){this.tabArea.setTabItems(e)}_setSelectedTab(e){e?this.setSelectedTabItem(e.tabItem):this.setSelectedTabItem(null)}setSelectedTabItem(e){this.setProperty("selectedTabItem",e)}_setSelectedTabItem(e){this._setProperty("selectedTabItem",e),this.tabArea.setSelectedTabItem(e)}isTabItemFocused(e){return this.tabArea.isTabItemFocused(e)}focusTabItem(e){return this.tabArea.focusTabItem(e)}getTabForItem(e){return this.tabArea.getTabForItem(e)}_onTabBoxPropertyChange(e){e.propertyName==="menus"?this.menuBar.setMenuItems(this.tabBox.menus):e.propertyName==="labelVisible"&&this.setVisible(this.tabBox.labelVisible)}_onTabAreaPropertyChange(e){e.propertyName==="selectedTab"&&this._setSelectedTab(e.newValue)}}function Vt(i,e,t){return e=hD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hD(i){var e=uD(i,"string");return typeof e=="symbol"?e:String(e)}function uD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class pd extends I{constructor(){super(),Vt(this,"label",void 0),Vt(this,"subLabel",void 0),Vt(this,"selected",void 0),Vt(this,"overflown",void 0),Vt(this,"marked",void 0),Vt(this,"errorStatus",void 0),Vt(this,"tooltipText",void 0),Vt(this,"fieldStatus",void 0),Vt(this,"tabItem",void 0),Vt(this,"tabbable",void 0),Vt(this,"$title",void 0),Vt(this,"$label",void 0),Vt(this,"$subLabel",void 0),Vt(this,"_preventTabSelection",void 0),Vt(this,"_tabPropertyChangeHandler",void 0),Vt(this,"_statusMouseDownHandler",void 0),Vt(this,"_desktopPropertyChangeHandler",void 0),this.label=null,this.subLabel=null,this.selected=!1,this.overflown=!1,this.marked=!1,this.errorStatus=null,this.tooltipText=null,this.fieldStatus=null,this.tabItem=null,this.tabbable=!1,this.$label=null,this.$subLabel=null,this.$title=null,this._preventTabSelection=!1,this._tabPropertyChangeHandler=this._onTabPropertyChange.bind(this),this._statusMouseDownHandler=this._onStatusMouseDown.bind(this),this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this)}_init(e){super._init(e),this.visible=this.tabItem.visible,this.label=this.tabItem.label,this.subLabel=this.tabItem.subLabel,this.cssClass=this.tabItem.cssClass,this.marked=this.tabItem.marked,this.errorStatus=this.tabItem.errorStatus,this.tooltipText=this.tabItem.tooltipText,this.fieldStatus=u.create(Xa,{parent:this,visible:!1}),this.fieldStatus.on("statusMouseDown",this._statusMouseDownHandler),this.tabItem.on("propertyChange",this._tabPropertyChangeHandler)}_destroy(){super._destroy(),this.tabItem.off("propertyChange",this._tabPropertyChangeHandler),this.fieldStatus.off("statusMouseDown",this._statusMouseDownHandler)}_render(){this.$container=this.$parent.appendDiv("tab-item"),this.htmlComp=S.install(this.$container,this.session),this.$title=this.$container.appendDiv("title"),this.$label=this.$title.appendDiv("label"),G.installForEllipsis(this.$label,{parent:this}),this.$subLabel=this.$title.appendDiv("sub-label"),G.installForEllipsis(this.$subLabel,{parent:this}),this.fieldStatus.render(),this.fieldStatus.$container.cssWidth(ue.get().fieldStatusWidth),this.$container.on("mousedown",this._onTabMouseDown.bind(this)),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}_remove(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),super._remove()}_renderProperties(){super._renderProperties(),this._renderVisible(),this._renderLabel(),this._renderSubLabel(),this._renderTabbable(),this._renderSelected(),this._renderMarked(),this._renderOverflown(),this._renderTooltipText(),this._renderErrorStatus()}_renderVisible(){super._renderVisible(),this._updateStatus()}setLabel(e){this.setProperty("label",e)}_renderLabel(){this.$label.textOrNbsp(this.label),this.$label.attr("data-text",this.label),this.invalidateLayoutTree()}setSubLabel(e){this.setProperty("subLabel",e)}_renderSubLabel(){this.$subLabel.textOrNbsp(this.subLabel),this.invalidateLayoutTree()}setTooltipText(e){this.setProperty("tooltipText",e)}_renderTooltipText(){this.$container.toggleClass("has-tooltip",y.hasText(this.tooltipText)),this._updateStatus()}setErrorStatus(e){this.setProperty("errorStatus",e)}_renderErrorStatus(){let e=!!this.errorStatus,t=e?"has-"+this.errorStatus.cssClass():"";this._updateErrorStatusClasses(t),this._updateStatus()}_updateErrorStatusClasses(e){this.$container.removeClass(M.SEVERITY_CSS_CLASSES),e&&this.$container.addClass(e)}_updateStatus(){let e=this._computeVisible(),t=null,r=!0,s=!1;this.fieldStatus.setVisible(e),e&&(this.errorStatus?(t=this.errorStatus,r=!t.isError(),s=!0):t=u.create(E,{message:this.tooltipText,severity:E.Severity.INFO}),this.fieldStatus.update(t,null,r,s))}_computeVisible(){return this.visible&&!this.overflown&&(!!this.errorStatus||y.hasText(this.tooltipText))}setTabbable(e){this.setProperty("tabbable",e)}_renderTabbable(){this.$container.setTabbable(this.tabbable&&!F.get().supportsOnlyTouch())}select(){this.setSelected(!0)}setSelected(e){this.setProperty("selected",e)}_renderSelected(){this.$container.select(this.selected),this.$container.setTabbable(this.selected&&!F.get().supportsOnlyTouch())}setMarked(e){this.setProperty("marked",e)}_renderMarked(){this.$container.toggleClass("marked",this.marked)}setOverflown(e){this.setProperty("overflown",e)}_renderOverflown(){this.$container.toggleClass("overflown",this.overflown),this._updateStatus()}_onDesktopPropertyChange(e){e.propertyName==="dense"&&this.invalidateLayout()}_onTabMouseDown(e){if(this._preventTabSelection){this._preventTabSelection=!1;return}this.setTabbable(!0),this.$container.focus(),this.select(),this.$label&&(G.cancel(this.$label),G.close(this.$label)),this.$subLabel&&(G.cancel(this.$subLabel),G.close(this.$subLabel))}_onStatusMouseDown(e){this._preventTabSelection=!0,e.preventDefault()}_onTabPropertyChange(e){e.propertyName==="visible"?this.setVisible(e.newValue):e.propertyName==="label"?this.setLabel(this.tabItem.label):e.propertyName==="subLabel"?this.setSubLabel(this.tabItem.subLabel):e.propertyName==="cssClass"?this.setCssClass(this.tabItem.cssClass):e.propertyName==="marked"?this.setMarked(this.tabItem.marked):e.propertyName==="errorStatus"?this.setErrorStatus(e.newValue):e.propertyName==="tooltipText"&&this.setTooltipText(e.newValue)}}function Or(i,e,t){return e=cD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cD(i){var e=pD(i,"string");return typeof e=="symbol"?e:String(e)}function pD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _r extends I{constructor(){super(),Or(this,"tabBox",void 0),Or(this,"tabs",void 0),Or(this,"displayStyle",void 0),Or(this,"hasSubLabel",void 0),Or(this,"selectedTab",void 0),Or(this,"ellipsis",void 0),Or(this,"$selectionMarker",void 0),Or(this,"_tabItemPropertyChangeHandler",void 0),Or(this,"_tabPropertyChangeHandler",void 0),this.tabBox=null,this.tabs=[],this.displayStyle=_r.DisplayStyle.DEFAULT,this.hasSubLabel=!1,this.selectedTab=null,this._tabItemPropertyChangeHandler=this._onTabItemPropertyChange.bind(this),this._tabPropertyChangeHandler=this._onTabPropertyChange.bind(this),this.ellipsis=null,this.$selectionMarker=null}_init(e){super._init(e),this.tabBox=e.tabBox,this.ellipsis=u.create(tl,{parent:this,cssClass:"overflow-tab-item unfocusable",iconId:null,inheritAccessibility:!1,text:"0"})}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new pp(this),new fp(this)])}_render(){this.$container=this.$parent.appendDiv("tab-area"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new bp(this)),this.ellipsis.render(this.$container),this.$selectionMarker=this.$container.appendDiv("selection-marker")}_renderProperties(){super._renderProperties(),this._renderTabs(),this._renderSelectedTab(),this._renderHasSubLabel(),this._renderDisplayStyle()}_remove(){super._remove(),this._removeTabs()}setSelectedTabItem(e){this.setSelectedTab(this.getTabForItem(e))}getTabForItem(e){return f.find(this.tabs,t=>t.tabItem===e)}setSelectedTab(e){this.setProperty("selectedTab",e)}_setSelectedTab(e){this.selectedTab&&this.selectedTab.setSelected(!1),e&&e.setSelected(!0),this._setProperty("selectedTab",e),this._setTabbableItem(e)}_renderSelectedTab(){this.selectedTab&&this.selectedTab.overflown&&this.invalidateLayoutTree()}isTabItemFocused(e){return this.getTabForItem(e).isFocused()}focusTabItem(e){return this.focusTab(this.getTabForItem(e))}focusTab(e){return e.focus()}setTabItems(e){this.setProperty("tabs",e),this._updateHasSubLabel(),this.invalidateLayoutTree()}_setTabs(e){let t=this.tabs.slice(),r=e.map(s=>{let o=this.getTabForItem(s);return o?f.remove(t,o):(o=u.create(pd,{parent:this,tabItem:s}),s.on("propertyChange",this._tabItemPropertyChangeHandler),o.on("propertyChange",this._tabPropertyChangeHandler)),o});t.forEach(s=>{s.tabItem.off("propertyChange",this._tabItemPropertyChangeHandler)}),this._removeTabs(t),this._setProperty("tabs",r)}_renderTabs(){this.tabs.slice().reverse().forEach((e,t,r)=>{e.rendered||e.render(),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this)),e.$container.prependTo(this.$container),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this))})}_removeTabs(e){e=e||this.tabs,e.forEach(t=>{t.remove()})}setDisplayStyle(e){this.setProperty("displayStyle",e)}_renderDisplayStyle(){this.$container.toggleClass("spread-even",this.displayStyle===_r.DisplayStyle.SPREAD_EVEN),this.invalidateLayoutTree()}_onTabItemFocus(){this.setFocused(!0)}_onTabItemBlur(){this.setFocused(!1)}_updateHasSubLabel(){let e=this.visibleTabs();this._setHasSubLabel(e.some(t=>y.hasText(t.subLabel)))}visibleTabs(){return this.tabs.filter(e=>e.isVisible())}_setHasSubLabel(e){this.hasSubLabel!==e&&(this._setProperty("hasSubLabel",e),this.rendered&&this._renderHasSubLabel())}_renderHasSubLabel(){this.$container.toggleClass("has-sub-label",this.hasSubLabel),this.visibleTabs().forEach(e=>e.invalidateLayout()),this.invalidateLayoutTree()}selectNextTab(e){this._moveSelectionHorizontal(!0,e)}selectPreviousTab(e){this._moveSelectionHorizontal(!1,e)}_moveSelectionHorizontal(e,t){let r=this.tabs.slice(),s=this.$container.activeElement(),o=!1;e||(r.reverse(),o=s[0]===this.ellipsis.$container[0]),r.forEach(function(n,l){if(o&&n.visible&&!n.overflown){this.setSelectedTab(n),this._setTabbableItem(n),t&&n.focus(),o=!1;return}s[0]===n.$container[0]&&(o=!0)},this),e&&o&&this.ellipsis.isTabTarget()&&(this._setTabbableItem(this.ellipsis),t&&this.ellipsis.focus())}_setTabbableItem(e){let t=this.tabs;e&&(this.ellipsis.setTabbable(!1),t.forEach(r=>{r.setTabbable(!1)}),e.setTabbable(!0))}_onTabPropertyChange(e){e.propertyName==="selected"&&this.setSelectedTab(e.source)}_onTabItemPropertyChange(e){e.propertyName==="visible"&&(this._updateHasSubLabel(),this.invalidateLayoutTree()),e.propertyName==="subLabel"&&this._updateHasSubLabel()}}Or(_r,"DisplayStyle",{DEFAULT:"default",SPREAD_EVEN:"spreadEven"});function wl(i,e,t){return e=fD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fD(i){var e=mD(i,"string");return typeof e=="symbol"?e:String(e)}function mD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class bp extends te{constructor(e){super(),wl(this,"tabArea",void 0),wl(this,"overflowTabs",void 0),wl(this,"visibleTabs",void 0),wl(this,"_tabAreaPropertyChangeHandler",void 0),this.tabArea=e,this.overflowTabs=[],this.visibleTabs=[],this._tabAreaPropertyChangeHandler=this._onTabAreaPropertyChange.bind(this),this.tabArea.on("propertyChange",this._tabAreaPropertyChangeHandler),this.tabArea.one("remove",()=>{this.tabArea.off("propertyChange",this._tabAreaPropertyChangeHandler)})}layout(e){let t=S.get(e),r=t.availableSize().subtract(t.insets());this.preferredLayoutSize(e,{widthHint:r.width}),this._layoutSelectionMarker()}_layoutSelectionMarker(){let e=this.tabArea.$selectionMarker,t=this.tabArea.selectedTab,r;t?(e.setVisible(!0),r=w.bounds(t.$container),e.cssLeft(r.x),e.cssWidth(r.width)):e.setVisible(!1)}_updateEllipsis(){let e=this.tabArea.ellipsis;e.setHidden(this.overflowTabs.length<1),e.setText(this.overflowTabs.length+""),this.visibleTabs.forEach(t=>t.setOverflown(!1)),this.overflowTabs.forEach(t=>t.setOverflown(!0)),e.childActions.forEach(t=>t.destroy()),e.setChildActions(this.overflowTabs.map(t=>{let r=u.create(yp,{parent:e,tab:t,text:t.label,visible:t.visible});return r.on("action",s=>{a().log.isDebugEnabled()&&a().log.debug("(TabAreaLayout#_onClickEllipsis) tab="+t),e.popup.close(),t.select(),t.focus()}),r}))}preferredLayoutSize(e,t){let r=S.get(e),s=new A(0,0),o=Number.MAX_VALUE;this.visibleTabs=this.tabArea.visibleTabs();let n=this.visibleTabs.map((l,d)=>l.selected?-1:d).filter(l=>l>=0);if(this.overflowTabs=[],(t.widthHint===0||t.widthHint)&&(o=t.widthHint-r.insets().horizontal()),o<=0)return this._minSize(this.visibleTabs).add(r.insets());for(this._setFirstLastMarker(this.visibleTabs),this._updateEllipsis(),s=this._prefSize(this.visibleTabs);s.width>o&&n.length>0;){let l=n.splice(-1)[0];this.overflowTabs.splice(0,0,this.visibleTabs[l]),this.visibleTabs.splice(l,1),this._setFirstLastMarker(this.visibleTabs),this._updateEllipsis(),s=this._prefSize(this.visibleTabs)}return this.tabArea.displayStyle===_r.DisplayStyle.SPREAD_EVEN?w.prefSize(e,t):w.exactPrefSize(s.add(r.insets()),t)}_minSize(e){let t=[];return this.overflowTabs=e.filter(r=>r.selected?(t.push(r),!1):!0),this.visibleTabs=t,this._setFirstLastMarker(t),this._prefSize(t)}_prefSize(e,t){let r=e.map(s=>this._tabSize(s)).reduce((s,o)=>(s.height=Math.max(s.height,o.height),s.width+=o.width,s),new A(0,0));if(t=u.nvl(t,this.overflowTabs.length>0),t){let s=this._tabSize(this.tabArea.ellipsis);r.height=Math.max(r.height,s.height),r.width+=s.width}return r}_setFirstLastMarker(e,t){t=u.nvl(t,this.overflowTabs.length>0),this.tabArea.tabs.forEach(r=>{r.htmlComp.$comp.removeClass("first last")}),this.tabArea.ellipsis.$container.removeClass("first last"),e.length>0&&(e[0].$container.addClass("first"),t?this.tabArea.ellipsis.$container.addClass("last"):e[e.length-1].$container.addClass("last"))}_tabSize(e){let t=e.htmlComp,r,s=t.$comp.attr("class");if(this.tabArea.displayStyle===_r.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.removeClass("spread-even"),t.$comp.removeClass("overflown"),t.$comp.removeClass("hidden"),r=t.prefSize({exact:!0}).add(w.margins(t.$comp)),e instanceof pd&&e.fieldStatus&&e.fieldStatus.htmlComp){let o=e.overflown&&!e.fieldStatus.visible;o&&e.fieldStatus.setVisible(!0);let n=e.fieldStatus.htmlComp.prefSize({includeMargin:!0}).width;o&&e.fieldStatus.setVisible(!1),r.width+=n}return t.$comp.attrOrRemove("class",s),this.tabArea.displayStyle===_r.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.addClass("spread-even"),r}_onTabAreaPropertyChange(e){e.propertyName==="selectedTab"&&this._layoutSelectionMarker()}}class yp extends le{constructor(){super(...arguments),wl(this,"tab",void 0)}}function vp(i,e,t){return e=gD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gD(i){var e=_D(i,"string");return typeof e=="symbol"?e:String(e)}function _D(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wp extends te{constructor(e){super(),vp(this,"htmlPropertyChangeHandler",void 0),vp(this,"_tabBox",void 0),vp(this,"_statusWidth",void 0),this._tabBox=e,this._statusWidth=null,this._initDefaults(),this.htmlPropertyChangeHandler=this._onHtmlEnvironmentPropertyChange.bind(this),ue.get().on("propertyChange",this.htmlPropertyChangeHandler),this._tabBox.one("remove",()=>{ue.get().off("propertyChange",this.htmlPropertyChangeHandler)})}_initDefaults(){this._statusWidth=ue.get().fieldStatusWidth}_onHtmlEnvironmentPropertyChange(){this._initDefaults(),this._tabBox.invalidateLayoutTree()}layout(e){let t,r,s,o,n=S.get(e),l=S.get(this._tabBox._$tabContent),d=S.get(this._tabBox.header.$container),h=0,p=new A,m=this._tabBox.tooltip(),g=this._tabBox.$status,b=this._tabBox.statusPosition;t=n.availableSize().subtract(n.insets()),d.isVisible()&&(s=d.margins(),h=t.subtract(s).width,g&&g.isVisible()&&(this._layoutStatus(),b===M.StatusPosition.DEFAULT&&(h-=this._statusWidth+w.margins(g).horizontal())),o=d.prefSize({widthHint:h}),g&&g.isVisible()&&this._layoutStatus(o.height),o.width=h,d.setSize(o),p=o.add(s)),r=t.subtract(l.margins()),r.height-=p.height,l.setSize(r),m&&m.rendered&&m.position()}_layoutStatus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=this._tabBox.htmlComp,r=t.insets({includeBorder:!1}),s=r.top,o=r.right,n=this._tabBox.header.$container,l=this._tabBox.$status,d=w.margins(l),h=s,p=this._tabBox.statusPosition,m=e-d.vertical();p===M.StatusPosition.DEFAULT?h+=n.cssMarginTop():m-=l.cssBorderWidthY(),l.cssWidth(this._statusWidth).cssTop(h).cssRight(o).cssHeight(m)}preferredLayoutSize(e,t){t=t||{};let r=S.get(e),s=S.get(this._tabBox._$tabContent),o=S.get(this._tabBox.header.$container),n=new A,l=new A,d=this._tabBox.$status,h=this._tabBox.statusPosition,p=r.availableSize().subtract(r.insets()).width;return t.heightHint=null,o.isVisible()&&(d&&d.isVisible()&&h===M.StatusPosition.DEFAULT&&(p-=d.outerWidth(!0)),n=o.prefSize({widthHint:p}).add(o.margins())),l=s.prefSize(t).add(r.insets()).add(s.margins()),new A(Math.max(n.width,l.width),l.height+n.height)}}function S_(i,e,t){return e=bD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bD(i){var e=yD(i,"string");return typeof e=="symbol"?e:String(e)}function yD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tp extends Fe{constructor(){super(),S_(this,"selectionKeystroke",void 0),S_(this,"marked",void 0),this.selectionKeystroke=null,this.marked=!1}_createLayout(){return new Sp(this)}_computeTitleVisible(e){return!1}addStatus(){}_computeStatusVisible(){return!1}setMarked(e){this.setProperty("marked",e)}getContextMenuItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return[]}focus(){return this.select(),this.parent.focusTabItem(this)}isFocused(){return this.parent.isTabItemFocused(this)}select(){this.parent.selectedTab!==this&&this.parent.setSelectedTab(this)}getTab(){return this.parent.getTabForItem(this)}}class C_ extends Mc{}class Sp extends rd{constructor(e){super(e)}_$status(){return this.groupBox.parent.$status}_layoutStatus(){}_menuBarSize(e,t,r){let s=Zr.size(e,t),o=this.groupBox.parent;return s.width=o.header.$container.outerWidth(),s}_headerHeight(){return 0}}function Ds(i,e,t){return e=vD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vD(i){var e=wD(i,"string");return typeof e=="symbol"?e:String(e)}function wD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ro extends M{constructor(){super(),Ds(this,"table",void 0),Ds(this,"eventDelegator",void 0),Ds(this,"_tableChangedHandler",void 0),Ds(this,"_deletedRows",void 0),Ds(this,"_insertedRows",void 0),Ds(this,"_updatedRows",void 0),Ds(this,"_checkedRows",void 0),this.gridDataHints.weightY=1,this.gridDataHints.h=3,this.eventDelegator=null,this._tableChangedHandler=this._onTableChanged.bind(this),this._deletedRows=v.createMap(),this._insertedRows=v.createMap(),this._updatedRows=v.createMap(),this._checkedRows=v.createMap(),this.table=null,this._addWidgetProperties(["table"])}_init(e){super._init(e),this._setTable(this.table)}_render(){this.addContainer(this.$parent,"table-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this._renderTable()}setTable(e){this.setProperty("table",e)}_setTable(e){this.table&&(this.table.off(Ro.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null)),this._setProperty("table",e),e&&(e.on(Ro.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator=gr.create(this,e,{delegateProperties:["enabled","disabledStyle","loading"]}),e.setDisabledStyle(this.disabledStyle),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}_renderTable(){!this.table||(this.table.render(),this.addField(this.table.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}_removeTable(){!this.table||(this.table.remove(),this._removeField(),this.invalidateLayoutTree())}computeRequiresSave(){return Object.keys(this._deletedRows).length>0||Object.keys(this._insertedRows).length>0||Object.keys(this._updatedRows).length>0||Object.keys(this._checkedRows).length>0}_onTableChanged(e){u.isOneOf(e.type,"rowsDeleted","allRowsDeleted")?this._updateDeletedRows(e.rows):e.type==="rowsInserted"?this._updateInsertedRows(e.rows):e.type==="rowsUpdated"?this._updateUpdatedRows(e.rows):e.type==="rowsChecked"&&this._updateCheckedRows(e.rows)}_updateDeletedRows(e){e.forEach(function(t){if(t.id in this._insertedRows){delete this._insertedRows[t.id],delete this._updatedRows[t.id],delete this._checkedRows[t.id];return}this._deletedRows[t.id]=t},this)}_updateInsertedRows(e){e.forEach(function(t){this._insertedRows[t.id]=t},this)}_updateUpdatedRows(e){e.forEach(function(t){t.status!==Qt.Status.NON_CHANGED&&(this._updatedRows[t.id]=t)},this)}_updateCheckedRows(e){e.forEach(function(t){t.id in this._checkedRows?delete this._checkedRows[t.id]:this._checkedRows[t.id]=t},this)}markAsSaved(){super.markAsSaved(),this._deletedRows=v.createMap(),this._insertedRows=v.createMap(),this._updatedRows=v.createMap(),this._checkedRows=v.createMap(),this.table.markRowsAsNonChanged()}getValidationResult(){let e=super.getValidationResult();if(e&&!e.valid)return e;let t=!this.errorStatus,r=!this.mandatory||!this.empty,s=f.ensure(this.table.rows),o=f.ensure(this.table.columns),n=()=>{},l=this.label||"";return s.some(function(d){return o.some(h=>{let p=h.isContentValid(d);return p.valid?!1:(n=()=>{e.reveal(),this.table.focusCell(h,d)},l&&(l+=": "),l+=h.text,t=t&&p.validByErrorStatus,r=r&&p.validByMandatory,!(t||r))},this)},this),{valid:t&&r,validByErrorStatus:t,validByMandatory:r,field:this,label:l,reveal:n}}getDelegateScrollable(){return this.table}}Ds(Ro,"TABLE_CHANGE_EVENTS","rowsInserted rowsDeleted allRowsDeleted rowsUpdated rowsChecked");class P_ extends dt{}function x_(i,e,t){return e=TD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function TD(i){var e=SD(i,"string");return typeof e=="symbol"?e:String(e)}function SD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cp extends pe{constructor(){super(),x_(this,"table",void 0),x_(this,"field",void 0),this.table=null,this.windowPaddingX=0,this.windowPaddingY=0}_init(e){super._init(e);let t=u.create(Me,{session:this.session,text:"Tag",autoOptimizeWidth:!1});this.table=u.create(W,{parent:this,headerVisible:!1,autoResizeColumns:!0,multiSelect:!1,scrollToSelection:!0,columns:[t],headerMenusEnabled:!1,textFilterEnabled:!1}),this.table.on("rowClick",this._onRowClick.bind(this))}_createLayout(){return new Pp(this)}_render(){super._render(),this.$container.addClass("tag-chooser-popup").on("mousedown",this._onContainerMouseDown.bind(this)),this.findDesktop().adjustOverlayOrder(this),this._renderTable()}_renderTable(){this.table.setVirtual(!1),this.table.render(),this.table.$container.setTabbable(!1).addClass("focused")}setLookupResult(e){let t=e.lookupRows;this.table.deleteAllRows();let r=t.map(s=>fn.createTableRow(s));this.table.insertRows(r)}_onRowClick(e){this.triggerLookupRowSelected()}_onContainerMouseDown(e){return!1}_isMouseDownOnAnchor(e){return this.field.$field.isOrHas(e.target)}delegateKeyEvent(e){e.originalEvent.smartFieldEvent=!0,this.table.$container.trigger(e)}triggerLookupRowSelected(e){e=e||this.selectedRow(),!(!e||!e.enabled)&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}selectedRow(){return this.table.selectedRow()}}class Pp extends Ii{constructor(e){super(e),this.doubleCalcPrefSize=!1}layout(e){super.layout(e);let t=this.popup.htmlComp,r=t.size().subtract(t.insets());this.popup.table.htmlComp.setSize(r),this.popup.position()}preferredLayoutSize(e,t){let r=u.create(cd,this.popup.table);r.modifyDom();let s=super.preferredLayoutSize(e);return r.restoreDom(),s}}function mo(i,e,t){return e=CD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CD(i){var e=PD(i,"string");return typeof e=="symbol"?e:String(e)}function PD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bd extends ge{constructor(){super(),mo(this,"lookupCall",void 0),mo(this,"maxLength",void 0),mo(this,"fieldHtmlComp",void 0),mo(this,"popup",void 0),mo(this,"tagBar",void 0),mo(this,"maxLengthHandler",void 0),mo(this,"_currentLookupCall",void 0),this.$field=null,this.fieldHtmlComp=null,this.popup=null,this.lookupCall=null,this._currentLookupCall=null,this.tagBar=null,this.maxLength=500,this.maxLengthHandler=u.create(Nn,{target:this})}_init(e){super._init(e),this.tagBar=u.create(ui,{parent:this,tags:this.value,clickable:e.clickable}),this.tagBar.on("tagRemove",this._onTagRemove.bind(this)),this.on("propertyChange",this._onValueChange.bind(this)),this._setLookupCall(this.lookupCall)}_onTagRemove(e){this.removeTag(e.tag)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new xp(this),new md(this._createFieldAdapter()),new fd(this._createFieldAdapter()),new Fp(this)])}_createKeyStrokeContext(){return new Fr}_render(){this.addContainer(this.$parent,"tag-field",new Ep(this)),this.addLabel(),this.addMandatoryIndicator();let e=this.$container.appendDiv();this.fieldHtmlComp=S.install(e,this.session),this.fieldHtmlComp.setLayout(new Ln(this)),this.tagBar.render(e);let t=e.appendElement("<input>","field").attr("type","text").on("keydown",this._onInputKeydown.bind(this)).on("keyup",this._onInputKeyup.bind(this)).on("input",this._onFieldInput.bind(this));this.addFieldContainer(e),this.addField(t),this.maxLengthHandler.install(t),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderValue(),this._renderMaxLength()}_renderValue(){this.tagBar.updateTags()}_setValue(e){super._setValue(e),this.tagBar&&this.tagBar.setTags(this.value)}_setLookupCall(e){this._setProperty("lookupCall",ei.ensure(e,this.session))}formatValue(e){return""}_validateValue(e){let t=f.ensure(e),r=[];return t.forEach(s=>{y.empty(s)||(s=s.toLowerCase(),r.indexOf(s)<0&&r.push(s))}),r}_parseValue(e){let t=f.ensure(this.value);return t=t.slice(),t.push(e),t}_renderDisplayText(){this.$field.val(this.displayText),super._renderDisplayText(),this._updateInputVisible()}_renderEnabled(){super._renderEnabled(),this._updateInputVisible()}_renderFieldStyle(){super._renderFieldStyle(),this.rendered&&this.fieldHtmlComp.invalidateLayoutTree()}setMaxLength(e){this.setProperty("maxLength",e)}_renderMaxLength(){this.maxLengthHandler.render()}_updateInputVisible(){let e,t=!this.$field.isVisible();this.enabledComputed?e=!0:e=y.hasText(this.displayText),this.$field.setVisible(e),e!==t&&this._renderValue()}_readDisplayText(){return this.$field.val()}_clear(){this.$field.val("")}acceptInput(e){if(this.popup){this.popup.selectedRow()?this.popup.triggerLookupRowSelected():this.closePopup();return}super.acceptInput(!1)}_triggerAcceptInput(e){this.trigger("acceptInput",{displayText:this.displayText,whileTyping:e,value:this.value})}aboutToBlurByMouseDown(e){ee.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}_onFieldBlur(e){this.closePopup(),super._onFieldBlur(e),this.rendered&&!this.removing&&this.tagBar.blur()}_onFieldFocus(e){super._onFieldFocus(e),this.rendered&&!this.removing&&this.tagBar.focus()}_onFieldInput(){this._updateHasText()}addTag(e){let t=this._parseValue(e);this.setValue(t),this._triggerAcceptInput()}removeTag(e){if(y.empty(e))return;e=e.toLowerCase();let t=f.ensure(this.value);t.indexOf(e)!==-1&&(t=t.slice(),f.remove(t,e),this.setValue(t),this._triggerAcceptInput(),this.focus())}_onInputKeydown(e){this._isNavigationKey(e)&&this.popup?this.popup.delegateKeyEvent(e):e.which===_.ESC&&this.closePopup()}_isNavigationKey(e){return u.isOneOf(e.which,[_.PAGE_UP,_.PAGE_DOWN,_.UP,_.DOWN])}_onInputKeyup(e){e.which!==_.ESC&&(this._isNavigationKey(e)||this._lookupByText(this.$field.val()))}_lookupByText(e){if(!!this.lookupCall){if(y.empty(e)||e.length<2){this.closePopup();return}this._currentLookupCall=this.lookupCall.cloneForText(e),this.trigger("prepareLookupCall",{lookupCall:this._currentLookupCall}),this._currentLookupCall.execute().always(()=>{this._currentLookupCall=null}).done(this._onLookupDone.bind(this))}}_onLookupDone(e){try{if(!this.rendered||!this.isFocused()||e.lookupRows.length===0){this.closePopup();return}this.openPopup(),this.popup.setLookupResult(e)}finally{this.trigger("lookupCallDone",{result:e})}}openPopup(){this.popup||(this.popup=u.create(Cp,{parent:this,$anchor:this.$field,boundToAnchor:!0,closeOnAnchorMouseDown:!1,field:this}),this.popup.on("lookupRowSelected",this._onLookupRowSelected.bind(this)),this.popup.one("close",this._onPopupClose.bind(this)),this.popup.open())}closePopup(){this.popup&&!this.popup.destroying&&this.popup.close()}_onLookupRowSelected(e){this._clear(),this._updateHasText(),this.addTag(e.lookupRow.key),this.closePopup()}_onPopupClose(e){this.popup=null}isInputFocused(){let e=this.$fieldContainer.activeElement();return this.$field.is(e)}_onValueChange(e){e.propertyName==="value"&&this._renderLabel()}_renderPlaceholder(e){let t=!!f.ensure(this.value).length;e=u.nvl(e,this.$field),e&&e.placeholder(t?"":this.label)}_createFieldAdapter(){return Bd.createFieldAdapter(this)}static createFieldAdapter(e){return{$container:()=>e.$fieldContainer,enabled:()=>y.empty(e._readDisplayText()),focus:()=>e.$field.focus(),removeTag:t=>e.removeTag(t)}}}class F_ extends nd{_initProperties(e){e.insertText!==void 0&&delete e.insertText}_postCreateWidget(){super._postCreateWidget();let e=ql;this.widget.lookupCall=u.create(e,this)}_syncResult(e){let t=this.widget._currentLookupCall;t&&t.resolveLookup(e)}_onWidgetAcceptInput(e){this._send("acceptInput",{displayText:e.displayText,value:e.value})}}class xp extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER],this.renderingHints.render=!1,this.preventDefault=!1,this.stopPropagation=!0}_accept(e){return super._accept(e)?(this.stopPropagation=y.hasText(this.field._readDisplayText()),this.field.isInputFocused()):!1}handle(e){this.field.acceptInput()}}function xD(i,e,t){return e=FD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FD(i){var e=ED(i,"string");return typeof e=="symbol"?e:String(e)}function ED(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fd extends B{constructor(e){super(),xD(this,"fieldAdapter",void 0),this.fieldAdapter=e,this.which=[_.DELETE],this.renderingHints.render=!1,this.preventDefault=!1}_accept(e){return super._accept(e)?this._$focusedTag().length>0:!1}handle(e){let t=this._$focusedTag(),r=ui.getTagData(t);this.fieldAdapter.removeTag(r)}_$focusedTag(){return ui.findFocusedTagElement(this.fieldAdapter.$container())}}function AD(i,e,t){return e=DD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DD(i){var e=MD(i,"string");return typeof e=="symbol"?e:String(e)}function MD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class md extends B{constructor(e){super(),AD(this,"fieldAdapter",void 0),this.fieldAdapter=e,this.which=[_.LEFT,_.RIGHT],this.preventDefault=!1,this.preventInvokeAcceptInputOnActiveValueField=!0}_accept(e){return super._accept(e)?this.fieldAdapter.enabled():!1}handle(e){e.which===_.LEFT?this._focusTagElement(-1):e.which===_.RIGHT&&this._focusTagElement(1)}_focusTagElement(e){let t=-1,r=-2,s=ui.findFocusableTagElements(this.fieldAdapter.$container()),o=s.length;if(o===0)return;let n=t;if(s.each(function(l){a()(this).hasClass("focused")&&(n=l)}),n===t)e===-1&&(n=o-1);else{let l=n+e;l>=o?n=r:l<0?n=t:(ui.unfocusTagElement(s.eq(n)),n=l)}n===t||(n===r?this.fieldAdapter.focus():ui.focusTagElement(s.eq(n)))}}class Fp extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER,_.SPACE],this.renderingHints.render=!1,this.preventDefault=!1}_accept(e){return super._accept(e)?this.field.tagBar&&this.field.tagBar.isOverflowIconFocused():!1}handle(e){this.field.tagBar.openOverflowPopup()}}class Ep extends li{constructor(e){super(e)}_$elementForIconLayout(){return this.formField.$fieldContainer}}function E_(i,e,t){return e=$D(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $D(i){var e=RD(i,"string");return typeof e=="symbol"?e:String(e)}function RD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ln extends te{constructor(e){super(),E_(this,"tagField",void 0),this.tagField=e}layout(e){let t=S.get(e),r=this.tagField.value&&this.tagField.value.length>0,s=this.tagField.$field,o=this.tagField.tagBar.htmlComp;if(this.tagField.tagBar.setVisible(r),r){s.removeClass("fullwidth");let n=t.availableSize().subtract(t.insets()),l=n.width;s.isVisible()&&(l=n.width*(1-Ln.MIN_INPUT_TAG_RATIO));let d=o.prefSize(!0),h=Math.min(l,d.width);o.setSize(new A(h,d.height).subtract(o.margins()));let p=n.width-h;s.cssWidth(p)}else s.addClass("fullwidth").removeAttr("style")}}E_(Ln,"MIN_INPUT_TAG_RATIO",.33);function A_(i,e,t){return e=LD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LD(i){var e=ID(i,"string");return typeof e=="symbol"?e:String(e)}function ID(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class D_ extends M{constructor(){super(),A_(this,"tileGrid",void 0),A_(this,"eventDelegator",void 0),this.eventDelegator=null,this._addWidgetProperties(["tileGrid"])}_init(e){super._init(e),this._setTileGrid(this.tileGrid)}_createLoadingSupport(){return null}_render(){this.addContainer(this.$parent,"tile-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tileGrid&&this._renderTileGrid()}_renderProperties(){super._renderProperties(),this._renderDropType()}setTileGrid(e){this.setProperty("tileGrid",e)}_setTileGrid(e){this.tileGrid&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("tileGrid",e),e&&(this.eventDelegator=gr.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}_renderTileGrid(){!this.tileGrid||(this.tileGrid.render(),this.addField(this.tileGrid.$container),this.invalidateLayoutTree())}_removeTileGrid(){!this.tileGrid||(this.tileGrid.remove(),this._removeField(),this.invalidateLayoutTree())}getDelegateScrollable(){return this.tileGrid}}class M_ extends dt{}function $_(i,e,t){return e=kD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kD(i){var e=BD(i,"string");return typeof e=="symbol"?e:String(e)}function BD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class R_ extends Po{constructor(){super(),$_(this,"tree",void 0),$_(this,"_populating",void 0),this.tree=null,this._populating=!1,this._addWidgetProperties(["tree","filterBox"])}_init(e){super._init(e),this.tree.on("nodesChecked",this._onTreeNodesChecked.bind(this)),this.tree.setScrollTop(this.scrollTop)}_initStructure(e){this.tree||(this.tree=this._createDefaultTreeBoxTree())}_initValue(e){this.tree||(this.tree=this._createDefaultTreeBoxTree()),super._initValue(e)}_render(){super._render(),this.$container.addClass("tree-box")}_createFieldContainerLayout(){return new Ap(this,this.tree,this.filterBox)}_renderStructure(){this.tree.render(this.$fieldContainer),this.addField(this.tree.$container)}_onTreeNodesChecked(e){this._populating||this._syncTreeToValue()}_syncTreeToValue(){if(!this.lookupCall||this._valueSyncing)return;this._valueSyncing=!0;let e=v.values(this.tree.nodesMap).filter(t=>t.checked).map(t=>t.lookupRow.key);this.setValue(e),this._valueSyncing=!1}_valueChanged(){super._valueChanged(),this._syncValueToTree(this.value)}_syncValueToTree(e){if(!this.lookupCall||this._valueSyncing||!this.initialized)return;this._valueSyncing=!0;let t={checkOnlyEnabled:!1,checkChildren:!1};try{if(f.empty(e))this.uncheckAll(t);else{if(this._ensureLookupCallExecuted())return;this.uncheckAll(t),v.values(this.tree.nodesMap).forEach(s=>{f.contains(e,s.lookupRow.key)&&this.tree.checkNode(s,!0,t)},this)}this._updateDisplayText()}finally{this._valueSyncing=!1}}uncheckAll(e){for(let t in this.tree.nodesMap)this.tree.nodesMap.hasOwnProperty(t)&&this.tree.uncheckNode(this.tree.nodesMap[t],e)}_lookupByAllDone(e){return super._lookupByAllDone(e)?(this._populateTree(e),!0):!1}_populateTree(e){let t=[];this._populating=!0,this._populateTreeRecursive(null,t,e.lookupRows),this.tree.deleteAllNodes(),this.tree.insertNodes(t),this._populating=!1,this._syncValueToTree(this.value)}_populateTreeRecursive(e,t,r){let s;r.forEach(function(o){o.parentKey===e&&(s=this._createNode(o),this._populateTreeRecursive(s.lookupRow.key,s.childNodes,r),s.leaf=!s.childNodes.length,t.push(s))},this)}getCheckedLookupRows(){return this.value===null||f.empty(this.value)||this.tree.nodes.length===0?[]:v.values(this.tree.nodesMap).filter(e=>e.checked).map(e=>e.lookupRow)}_createNode(e){let t=u.create(ts,{parent:this.tree,text:e.text,lookupRow:e});return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),e.enabled===!1&&(t.enabled=!1),e.cssClass&&(t.cssClass=e.cssClass),e.active===!1&&(t.active=!1,t.cssClass=(t.cssClass?t.cssClass+" ":"")+"inactive"),t}_createDefaultTreeBoxTree(){return u.create(fe,{parent:this,checkable:!0})}getDelegateScrollable(){return this.tree}}class L_ extends Ot{}class Ap extends Za{constructor(e,t,r){super(e,t,r)}}function OD(i,e,t){return e=HD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HD(i){var e=ND(i,"string");return typeof e=="symbol"?e:String(e)}function ND(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Dp extends M{constructor(){super(),OD(this,"tree",void 0),this.gridDataHints.weightY=1,this.gridDataHints.h=3,this._addWidgetProperties(["tree"])}_render(){this.addContainer(this.$parent,"tree-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tree&&this._renderTree()}setTree(e){this.setProperty("tree",e)}_setTree(e){this._setProperty("tree",e),e&&e.setScrollTop(this.scrollTop)}_renderTree(){!this.tree||(this.tree.render(),this.addField(this.tree.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}_removeTree(){!this.tree||(this.tree.remove(),this._removeField(),this.invalidateLayoutTree())}getDelegateScrollable(){return this.tree}}class Mp extends dt{}function go(i,e,t){return e=VD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function VD(i){var e=WD(i,"string");return typeof e=="symbol"?e:String(e)}function WD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class I_ extends M{constructor(){super(),go(this,"activeStepIndex",void 0),go(this,"steps",void 0),go(this,"previousActiveStepIndex",void 0),go(this,"stepsMap",void 0),go(this,"keepActiveStepAtLeftBorder",void 0),go(this,"animateScrolling",void 0),go(this,"$wizardStepsBody",void 0),this.activeStepIndex=-1,this.steps=[],this.previousActiveStepIndex=-1,this.stepsMap={},this.$wizardStepsBody=null,this.keepActiveStepAtLeftBorder=F.get().type===F.Type.MOBILE,this.animateScrolling=F.get().type===F.Type.MOBILE}_init(e){super._init(e),this._updateStepsMap()}_render(){this.addContainer(this.$parent,"wizard-progress-field",new $p(this)),this.addField(this.$parent.makeDiv("wizard-steps")),this.addStatus(),this.addLabel(),this.$field.toggleClass("compact",F.get().type===F.Type.MOBILE);let e=this.htmlComp.layout;e.compactFieldWidth=-1,this.$wizardStepsBody=this.$field.appendDiv("wizard-steps-body"),this._installScrollbars({axis:"x",scrollShadow:"none"}),this.parent instanceof Fe&&this.parent.controls[0]===this&&this.parent.parent instanceof Y&&this.parent.parent.$container.addClass("wizard-container-form")}_renderProperties(){super._renderProperties(),this._renderSteps(),this._renderActiveStepIndex()}_setSteps(e){this._setProperty("steps",e),this._updateStepsMap()}_renderSteps(){this.$wizardStepsBody.children(".wizard-step").each(function(){G.uninstall(a()(this))}),this.$wizardStepsBody.empty(),this.steps.forEach((e,t)=>{let r=this.$wizardStepsBody.appendDiv("wizard-step").addClass(e.cssClass).data("wizard-step",e);e.$step=r,this._updateStepClasses(e),this.session.inspector&&(Vo.applyInfo(e,r),r.attr("data-step-index",e.index)),y.hasText(e.tooltipText)&&G.install(r,{parent:this,text:e.tooltipText,tooltipPosition:"bottom"});let s=r.appendDiv("icon");e.iconId?s.icon(e.iconId):e.finished?s.icon(ve.CHECKED_BOLD):s.text(t+1);let o=r.appendDiv("text");o.appendDiv("title").textOrNbsp(e.title).attr("data-text",e.title),e.subTitle&&o.appendDiv("sub-title").textOrNbsp(e.subTitle),t<this.steps.length-1&&this.$wizardStepsBody.appendDiv("wizard-step-separator")}),this.invalidateLayoutTree(!1)}_setActiveStepIndex(e){this.previousActiveStepIndex=this.activeStepIndex,this._setProperty("activeStepIndex",u.nvl(e,-1))}_renderActiveStepIndex(){this.steps.forEach(this._updateStepClasses.bind(this)),this.invalidateLayoutTree(!1)}_updateStepClasses(e){let t=e.$step;t.removeClass("selected first last action-enabled disabled"),t.off("click.selected");let r=this.steps.indexOf(e),s=this.steps.indexOf(this.stepsMap[this.activeStepIndex]);this.enabledComputed&&e.enabled&&e.actionEnabled&&r!==this.activeStepIndex?(t.addClass("action-enabled"),t.on("click.selected",this._onStepClick.bind(this))):(!this.enabledComputed||!e.enabled)&&t.addClass("disabled"),t.toggleClass("finished",e.finished),r>=0&&s>=0&&(r===s&&t.addClass("selected"),r===0&&t.addClass("first"),r===this.steps.length-1&&t.addClass("last")),r===this.steps.length-1&&this.$wizardStepsBody.css("background-color",t.css("background-color"))}_stepIndex(e){if(e){let t=e.data("wizard-step");if(t)return t.index}return-1}_updateStepsMap(){this.stepsMap={},this.steps.forEach(e=>{this.stepsMap[e.index]=e})}_resolveStep(e){for(let t=0;t<this.steps.length;t++){let r=this.steps[t];if(r.index===e)return r}return null}_onStepClick(e){let t=a()(e.currentTarget),r=this._stepIndex(t);r>=0&&r!==this.activeStepIndex&&this.trigger("stepAction",{stepIndex:r})}scrollToActiveStep(){let e=this.stepsMap[this.activeStepIndex];if(!e)return;let t=e.$step,r=t.position().left,s=this.animateScrolling&&this.htmlComp.layouted;if(this.keepActiveStepAtLeftBorder){let o=this.steps[0].$step,n=r-o.cssPaddingLeft()+t.cssPaddingLeft();x.scrollLeft(this.$field,n,{animate:s})}else{let o=this.$field.scrollLeft(),n=t.width(),l=this.$field.width(),d=this.previousActiveStepIndex>this.activeStepIndex,h=o+Math.floor(l*(d?.25:.75)),p=r+Math.floor(n/2);(d&&p<h||!d&&p>h)&&x.scrollLeft(this.$field,o+(p-h),{animate:s})}}}class k_ extends dt{_onWidgetStepAction(e){this._send("doStepAction",{stepIndex:e.stepIndex})}_onWidgetEvent(e){e.type==="stepAction"?this._onWidgetStepAction(e):super._onWidgetEvent(e)}}class $p extends li{constructor(e){super(e)}layout(e){super.layout(e);let t=this.formField.$field.scrollLeft(),r=this.formField.$wizardStepsBody;r.width("auto");let s=r[0].scrollWidth;r.width(s),this.formField.$field.scrollLeft(t),this.formField.scrollToActiveStep()}}function Rp(i,e,t){return e=KD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function KD(i){var e=zD(i,"string");return typeof e=="symbol"?e:String(e)}function zD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _n extends M{constructor(){super(),Rp(this,"innerForm",void 0),Rp(this,"initialFocusEnabled",void 0),Rp(this,"_formDestroyHandler",void 0),this._addWidgetProperties(["innerForm"]),this.innerForm=null,this.initialFocusEnabled=!1,this._formDestroyHandler=this._onInnerFormDestroy.bind(this)}_init(e){super._init(e),this._setInnerForm(this.innerForm)}_render(){this.addContainer(this.$parent,"wrapped-form-field"),this.addLabel(),this.addStatus()}_renderProperties(){super._renderProperties(),this._renderInnerForm()}setInnerForm(e){this.setProperty("innerForm",e)}_setInnerForm(e){this.innerForm&&this.innerForm.off("destroy",this._formDestroyHandler),e&&e.on("destroy",this._formDestroyHandler),this._setProperty("innerForm",e)}_renderInnerForm(){!this.innerForm||(this.innerForm.setDisplayHint(Y.DisplayHint.VIEW),this.innerForm.setModal(!1),this.innerForm.setClosable(!1),this.innerForm.renderInitialFocusEnabled=this.initialFocusEnabled,this.innerForm.rootGroupBox&&this.innerForm.rootGroupBox.setMenuBarPosition(Fe.MenuBarPosition.BOTTOM),this.innerForm.render(),this.addField(this.innerForm.$container),this.innerForm.invalidateLayoutTree(),this._renderInitialFocusEnabled())}_removeInnerForm(){this.innerForm&&this.innerForm.remove(),this._removeField()}_onInnerFormDestroy(e){this._removeInnerForm(),this._setInnerForm(null)}_renderInitialFocusEnabled(){this.innerForm&&this.initialFocusEnabled&&this.innerForm.renderInitialFocus()}}class B_ extends dt{}function bn(i,e,t){return e=GD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function GD(i){var e=UD(i,"string");return typeof e=="symbol"?e:String(e)}function UD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class O_ extends I{constructor(){super(),bn(this,"activated",void 0),bn(this,"label",void 0),bn(this,"htmlEnabled",void 0),bn(this,"tooltipText",void 0),bn(this,"$label",void 0),bn(this,"$button",void 0),this.activated=!1,this.label=null,this.htmlEnabled=!1,this.tooltipText=null,this.$label=null,this.$button=null}_init(e){super._init(e),this.setTooltipText(e.tooltipText)}_render(){this.$container=this.$parent.appendDiv("switch"),this.$label=this.$container.appendDiv("switch-label"),this.$button=this.$container.appendDiv("switch-button").on("click",this._onSwitchButtonClick.bind(this))}_renderProperties(){super._renderProperties(),this._renderActivated(),this._renderLabel(),this._renderTooltipText()}_onSwitchButtonClick(e){if(!this.enabledComputed)return;this.trigger("switch").defaultPrevented||this.setActivated(!this.activated),G.cancel(this.$container)}setLabel(e){this.setProperty("label",e)}_renderLabel(){this.htmlEnabled?this.$label.html(this.label):this.$label.text(this.label)}setActivated(e){this.setProperty("activated",e)}_renderActivated(){this.$button.toggleClass("activated",this.activated)}setTooltipText(e){this.setProperty("tooltipText",e)}_renderTooltipText(){y.hasText(this.tooltipText)?G.install(this.$container,{parent:this,text:this.tooltipText}):G.uninstall(this.$container)}}function yn(i,e,t){return e=qD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qD(i){var e=YD(i,"string");return typeof e=="symbol"?e:String(e)}function YD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ui extends I{constructor(){super(),yn(this,"overflowEnabled",void 0),yn(this,"overflowVisible",void 0),yn(this,"tags",void 0),yn(this,"clickable",void 0),yn(this,"overflow",void 0),yn(this,"$overflowIcon",void 0),this.overflowEnabled=!0,this.$overflowIcon=null,this.overflowVisible=!1,this.overflow=null,this.tags=[],this.clickable=!1}_render(){this.$container=this.$parent.appendDiv("tag-bar"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Lp(this)),this._installTooltipSupport()}_renderProperties(){super._renderProperties(),this._renderTags(),this._renderOverflowVisible()}_remove(){this.$overflowIcon=null,this.overflowVisible=!1,this.closeOverflowPopup(),this._uninstallTooltipSupport(),super._remove()}setTags(e){this.setProperty("tags",e)}updateTags(){this.rendered&&this._renderTags()}_renderTags(){let e=f.ensure(this.tags);this.renderTags(this.$container,e),this.invalidateLayoutTree()}setClickable(e){this.setProperty("clickable",e)}_renderClickable(){this._renderTagsClickable(this.$container.children(".tag-element")),this.invalidateLayoutTree()}_onTagClick(e){let t=ui.getTagData(a()(e.currentTarget));return this._triggerTagClick(t),!1}_triggerTagClick(e){this.trigger("tagClick",{tag:e})}_renderEnabled(){super._renderEnabled(),this._renderTagsRemovable(this.$container.children(".tag-element")),this.invalidateLayoutTree()}_onTagRemoveClick(e){return this.enabledComputed&&this.removeTagByElement(a()(e.currentTarget)),!1}removeTagByElement(e){let t=ui.getTagData(e);t&&this._triggerTagRemove(t,e)}_triggerTagRemove(e,t){this.trigger("tagRemove",{tag:e,$tag:t})}_onOverflowIconMousedown(e){return this.toggleOverflowPopup(),!1}isOverflowIconFocused(){if(!this.$overflowIcon)return!1;let e=this.$container.activeElement();return this.$overflowIcon.is(e)}openOverflowPopup(){this.overflow||(this.$overflowIcon.addClass("selected"),this.overflow=this._createOverflowPopup(),this.overflow.open(),this.overflow.one("destroy",e=>{this.$overflowIcon&&this.$overflowIcon.removeClass("selected"),this.overflow=null}))}_createOverflowPopup(){return u.create(Dl,{parent:this,closeOnAnchorMouseDown:!1,focusableContainer:!0,$anchor:this.$overflowIcon,cssClass:this.cssClass})}closeOverflowPopup(){this.overflow&&this.overflow.close()}toggleOverflowPopup(){this.overflow?this.closeOverflowPopup():this.openOverflowPopup()}_installTooltipSupport(){G.install(this.$container,{parent:this,selector:".tag-text",text:this._tagTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!F.get().isCustomEllipsisTooltipPossible()})}_uninstallTooltipSupport(){G.uninstall(this.$container)}_tagTooltipText(e){return e.isContentTruncated()?e.text():null}_removeFocusFromTagElements(){ui.findFocusableTagElements(this.$container).removeClass("focused").setTabbable(!1)}focus(e){return this.$container.addClass("focused"),this._removeFocusFromTagElements(),this.closeOverflowPopup(),!1}blur(){this.$container.removeClass("focused");let e=event.relatedTarget;this.overflow&&this.overflow.$container.has(e)||this.closeOverflowPopup()}setOverflowVisible(e){this.setProperty("overflowVisible",e)}_renderOverflowVisible(){this.overflowVisible?this.$overflowIcon||(this.$overflowIcon=this.$container.prependDiv("overflow-icon").on("mousedown",this._onOverflowIconMousedown.bind(this))):this.$overflowIcon&&(this.$overflowIcon.remove(),this.$overflowIcon=null)}visibleTags(){if(!this.rendered)return[];let e=[];return this.$container.find(".tag-element:not(.hidden)").each(function(){e.push(ui.getTagData(a()(this)))}),e}renderTags(e,t){e.find(".tag-element").remove(),t.forEach(s=>this.renderTag(e,s));let r=e.children(".tag-element");this._renderTagsClickable(r),this._renderTagsRemovable(r)}renderTag(e,t){let r=e.appendDiv("tag-element").data("tag",t);return r.appendSpan("tag-text",t),r}_renderTagsClickable(e){e.each((t,r)=>{let s=a()(r),o=s.children(".tag-text"),n=s.data("click-handler");this.clickable?n||(n=this._onTagClick.bind(this),s.data("click-handler",n),o.on("mousedown",n)):(o.off("mousedown",n),s.removeData("click-handler")),s.toggleClass("clickable",this.clickable)})}_renderTagsRemovable(e){e.each((t,r)=>{let s=a()(r),o=s.children(".tag-remove-icon"),n=s.data("remove-handler");this.enabledComputed?n||(n=this._onTagRemoveClick.bind(this),s.data("remove-handler",n),s.appendSpan("tag-remove-icon").on("click",n)):(o.off("click",n),o.remove(),s.removeData("remove-handler")),s.toggleClass("removable",this.enabledComputed)})}static findFocusedTagElement(e){return e.find(".tag-element.focused")}static findFocusableTagElements(e){return e.find(".tag-element:not(.hidden),.overflow-icon")}static focusFirstTagElement(e){this.focusTagElement(this.firstTagElement(e))}static firstTagElement(e){return e.find(".tag-element").first()}static focusTagElement(e){e.setTabbable(!0).addClass("focused").focus()}static unfocusTagElement(e){e.setTabbable(!1).removeClass("focused")}static getTagData(e){let t=e.data("tag");return t||e.parent().data("tag")}}function jD(i,e,t){return e=XD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XD(i){var e=JD(i,"string");return typeof e=="symbol"?e:String(e)}function JD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Lp extends te{constructor(e){super(),jD(this,"tagBar",void 0),this.tagBar=e}layout(e){let t=S.get(e);if(!(this.tagBar.tags&&this.tagBar.tags.length>0))return;let o=t.availableSize().subtract(t.insets()).width,n=0,l=!1,d,h,p=e.find(".tag-element"),m=p.length,g=[];for(p.removeClass("hidden"),h=m-1;h>=0&&(d=a()(p[h]),g[h]=w.size(d,{includeMargin:!0}),l=n+g[h].width>o,!l);h--)n+=g[h].width;if(this.tagBar.setOverflowVisible(l),l)for(n=w.size(this.tagBar.$overflowIcon,{includeMargin:!0}).width,h=m-1;h>=0;h--){if(d=a()(p[h]),!g[h]){d.addClass("hidden");continue}n+g[h].width>o?d.addClass("hidden"):n+=g[h].width}}preferredLayoutSize(e,t){let r=S.get(e),s=this.tagBar.tags&&this.tagBar.tags.length>0,o=r.availableSize(),n=0,l=0;if(!s)return new A(0,o.height);let d=e.find(".tag-element");return d.removeClass("hidden"),d.each((h,p)=>{let m=w.size(a()(p),{includeMargin:!0});n+=m.width,l=Math.max(m.height,l)}),new A(n,l).add(r.insets())}}function H_(i,e,t){return e=QD(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QD(i){var e=ZD(i,"string");return typeof e=="symbol"?e:String(e)}function ZD(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Dl extends pe{constructor(){super(),H_(this,"$body",void 0),H_(this,"_tagBarPropertyChangeListener",void 0),this.windowPaddingX=0,this.windowPaddingY=0,this._tagBarPropertyChangeListener=null,this.initialFocus=function(){return ui.firstTagElement(this.$body).setTabbable(!0).addClass("focused")[0]}}_init(e){super._init(e),this._tagBarPropertyChangeListener=this._onTagBarPropertyChange.bind(this),this.parent.on("propertyChange",this._tagBarPropertyChangeListener)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new md(this._createFieldAdapter()),new fd(this._createFieldAdapter())])}_destroy(){this.parent.off("propertyChange",this._tagBarPropertyChangeListener),super._destroy()}_render(){super._render(),this.$container.addClass("tag-overflow-popup"),this.$body=this.$container.appendDiv("popup-body")}_createLayout(){return new Ip(this)}_renderProperties(){super._renderProperties(),this._renderTags()}_renderTags(){let e=this.parent,t=e.visibleTags(),s=f.ensure(e.tags).filter(o=>t.indexOf(o)===-1);e.renderTags(this.$body,s),this.rendering||this.invalidateLayoutTree()}_focusFirstTagElement(){ui.focusFirstTagElement(this.$body)}_onTagBarPropertyChange(e){if(e.propertyName==="tags"){let t=f.ensure(this.parent.tags),r=this.parent.visibleTags(),s=t.length;s===0||s===r.length?this.close():(this._renderTags(),this._focusFirstTagElement())}}_createFieldAdapter(){return Dl.createFieldAdapter(this)}static createFieldAdapter(e){return{$container:()=>e.$body,enabled:()=>!0,focus:()=>{},removeTag:t=>{e.parent.parent.removeTag(t)}}}}class Ip extends Ii{preferredLayoutSize(e,t){let r=super.preferredLayoutSize(e,t);return r.width=w.size(this.popup.$body,{exact:!0}).width,r.width+=this.popup.htmlComp.insets().horizontal(),r}}function Hr(i,e,t){return e=eM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function eM(i){var e=tM(i,"string");return typeof e=="symbol"?e:String(e)}function tM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wt extends I{constructor(){super(),Hr(this,"colorScheme",void 0),Hr(this,"displayStyle",void 0),Hr(this,"filterAccepted",void 0),Hr(this,"gridData",void 0),Hr(this,"gridDataHints",void 0),Hr(this,"rowId",void 0),Hr(this,"selected",void 0),Hr(this,"selectable",void 0),Hr(this,"plainText",void 0),this.displayStyle=Wt.DisplayStyle.DEFAULT,this.filterAccepted=!0,this.gridData=null,this.rowId=null,this.gridDataHints=new ze,this.colorScheme=null,this.selected=!1,this.selectable=!1,this.plainText=null}_createLoadingSupport(){return new rr({widget:this})}_init(e){super._init(e),this._setGridDataHints(this.gridDataHints),this._setColorScheme(this.colorScheme),this._setSelectable(this.selectable)}_render(){this.$container=this.$parent.appendDiv("tile"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Cr)}_renderProperties(){super._renderProperties(),this._renderColorScheme(),this._renderSelectable(),this._renderSelected(),this._renderDisplayStyle()}_postRender(){this.$container.addClass("tile"),this.htmlComp.layout.animateClasses=["animate-visible","animate-invisible","animate-insert","animate-remove"]}_renderDisplayStyle(){this.$container.toggleClass("default-tile",this.displayStyle===Wt.DisplayStyle.DEFAULT)}setGridDataHints(e){this.setProperty("gridDataHints",e),this.rendered&&this.parent.invalidateLogicalGrid()}_setGridDataHints(e){e||(e=new ze),this._setProperty("gridDataHints",ze.ensure(e))}setColorScheme(e){this.setProperty("colorScheme",e)}_setColorScheme(e){let t={scheme:Lt.ColorSchemeId.DEFAULT,inverted:!1};e=Lt.ensureColorScheme(e,!0),e=a().extend({},t,e),this._setProperty("colorScheme",e)}_renderColorScheme(){Lt.toggleColorSchemeClasses(this.$container,this.colorScheme)}setSelected(e){e&&!this.selectable||this.setProperty("selected",e)}_renderSelected(){this.$container.toggleClass("selected",this.selected)}setSelectable(e){this.setProperty("selectable",e)}_setSelectable(e){this._setProperty("selectable",e),this.selectable||this.setSelected(!1)}_renderSelectable(){this.$container.toggleClass("selectable",this.selectable)}setFilterAccepted(e){this.setProperty("filterAccepted",e)}_renderFilterAccepted(){this._renderVisible()}_renderVisible(){if(this.rendering){this.$container.setVisible(this.isVisible());return}this.removalPending||(this.isVisible()?(this.$container.addClass("invisible"),this.$container.setVisible(!0),this.session.layoutValidator.schedulePostValidateFunction(()=>{!this.rendered||!this.isVisible()||(this.$container.removeClass("invisible animate-invisible"),this.$container.addClassForAnimation("animate-visible"),this.$container.oneAnimationEnd(()=>{x.update(this.parent.get$Scrollable())}))})):(this.$container.removeClass("invisible animate-visible"),this.$container.addClassForAnimation("animate-invisible"),this.$container.oneAnimationEnd(()=>{this.$container.setVisible(this.isVisible()),x.update(this.parent.get$Scrollable())})),this.invalidateParentLogicalGrid())}isVisible(){return this.visible&&this.filterAccepted}}Hr(Wt,"DisplayStyle",{DEFAULT:"default",PLAIN:"plain"});class vn extends He{}function de(i,e,t){return e=iM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iM(i){var e=rM(i,"string");return typeof e=="symbol"?e:String(e)}function rM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}const kp="> .tile";class _o extends I{constructor(){super(),de(this,"animateTileRemoval",void 0),de(this,"animateTileInsertion",void 0),de(this,"comparator",void 0),de(this,"contextMenu",void 0),de(this,"empty",void 0),de(this,"filters",void 0),de(this,"filteredTiles",void 0),de(this,"filteredElementsDirty",void 0),de(this,"focusedTile",void 0),de(this,"gridColumnCount",void 0),de(this,"prefGridColumnCount",void 0),de(this,"layoutConfig",void 0),de(this,"menus",void 0),de(this,"multiSelect",void 0),de(this,"renderAnimationEnabled",void 0),de(this,"selectable",void 0),de(this,"selectedTiles",void 0),de(this,"selectionHandler",void 0),de(this,"scrollable",void 0),de(this,"startupAnimationDone",void 0),de(this,"startupAnimationEnabled",void 0),de(this,"tiles",void 0),de(this,"tileRemovalPendingCount",void 0),de(this,"viewRangeSize",void 0),de(this,"viewRangeRendered",void 0),de(this,"virtual",void 0),de(this,"virtualScrolling",void 0),de(this,"withPlaceholders",void 0),de(this,"placeholderProducer",void 0),de(this,"textFilterEnabled",void 0),de(this,"filterSupport",void 0),de(this,"createTextFilter",void 0),de(this,"updateTextFilterText",void 0),de(this,"$filterFieldContainer",void 0),de(this,"$fillBefore",void 0),de(this,"$fillAfter",void 0),de(this,"_doubleClickSupport",void 0),de(this,"_filterMenusHandler",void 0),de(this,"_renderViewPortAfterAttach",void 0),de(this,"_scrollParentScrollHandler",void 0),this.animateTileRemoval=!0,this.animateTileInsertion=!0,this.comparator=null,this.contextMenu=null,this._doubleClickSupport=new Vs,this.empty=!1,this.filters=[],this.filteredTiles=[],this.filteredElementsDirty=!0,this.focusedTile=null,this.gridColumnCount=4,this.prefGridColumnCount=this.gridColumnCount,this.logicalGrid=u.create(Ks),this.layoutConfig=null,this.menus=[],this.multiSelect=!0,this.renderAnimationEnabled=!1,this.selectable=!1,this.selectedTiles=[],this.selectionHandler=new gd(this),this.scrollable=!0,this.startupAnimationDone=!1,this.startupAnimationEnabled=!1,this.tiles=[],this.tileRemovalPendingCount=0,this.viewRangeSize=0,this.viewRangeRendered=new O(0,0),this.virtual=!1,this.virtualScrolling=null,this.withPlaceholders=!1,this.placeholderProducer=null,this.$filterFieldContainer=null,this.textFilterEnabled=!1,this.filterSupport=this._createFilterSupport(),this.createTextFilter=null,this.updateTextFilterText=null,this._filterMenusHandler=this._filterMenus.bind(this),this._renderViewPortAfterAttach=!1,this._scrollParentScrollHandler=this._onScrollParentScroll.bind(this),this._addWidgetProperties(["tiles","selectedTiles","menus"]),this._addPreserveOnPropertyChangeProperties(["selectedTiles"]),this.$fillBefore=null,this.$fillAfter=null}_init(e){super._init(e),this._setGridColumnCount(this.gridColumnCount),this._setLayoutConfig(this.layoutConfig),this._initVirtualScrolling(),this._initTiles(),this.setFilters(this.filters,!1),this.filter(),this._setMenus(this.menus),this._sortWhileInit(),this.updateFilteredElements()}_createKeyStrokeContext(){return new Oe}_initVirtualScrolling(){this.virtualScrolling=this._createVirtualScrolling()}_createVirtualScrolling(){return new Th({widget:this,enabled:this.virtual,viewRangeSize:this.viewRangeSize,rowHeight:this._heightForRow.bind(this),rowCount:this.rowCount.bind(this),_renderViewRange:this._renderViewRange.bind(this)})}_createLoadingSupport(){return new rr({widget:this})}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStrokes([new Gp(this),new Up(this),new qp(this),new Yp(this),new jp(this),new Xp(this),new Jp(this),new sa(this,this.showContextMenu,this)])}_initTiles(){this.tiles.forEach(e=>{this._initTile(e)})}_initTile(e){e.setSelectable(this.selectable),e.setSelected(this.selectedTiles.indexOf(e)>=0),e.setParent(this),e.setFilterAccepted(!0)}_render(){this.$container=this.$parent.appendDiv("tile-grid"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.on("mousedown",kp,this._onTileMouseDown.bind(this)).on("click",kp,this._onTileClick.bind(this)).on("dblclick",kp,this._onTileDoubleClick.bind(this)),this.$filterFieldContainer=this.$container.prependDiv("filter-field-container")}_createLayout(){return new hs(this,this.layoutConfig)}_renderProperties(){super._renderProperties(),this._renderLayoutConfig(),this._renderScrollable(),this._renderVirtual(),this._renderSelectable(),this._renderEmpty(),this._renderTextFilterEnabled()}_remove(){this.$fillBefore=null,this.$fillAfter=null,this.filterSupport.remove(),this.viewRangeRendered=new O(0,0),this._updateVirtualScrollable(),super._remove()}_renderOnAttach(){super._renderOnAttach(),this._renderViewPortAfterAttach&&(this._renderViewPort(),this._renderViewPortAfterAttach=!1)}_renderEnabled(){super._renderEnabled(),this._updateTabbable()}_updateTabbable(){!this.textFilterEnabled&&!this.selectable?this.$container.setTabbable(!1):this.$container.setTabbableOrFocusable(this.enabledComputed)}insertTile(e){this.insertTiles([e])}insertTiles(e,t){if(e=f.ensure(e),e.length===0)return;let r=this.tiles;this.setTiles(r.concat(e),t)}deleteTile(e){this.deleteTiles([e])}deleteTiles(e,t){if(e=f.ensure(e),e.length===0)return;let r=this.tiles.slice();f.removeAll(r,e),this.setTiles(r,t)}deleteAllTiles(){this.setTiles([])}setTiles(e,t){let r=f.ensure(e);if(v.equals(this.tiles,e))return;let s=this._createChildren(r);this.withPlaceholders&&u.nvl(t,!0)&&this._deletePlaceholders(s);let o=f.diff(s,this.tiles);if(this._insertTiles(o),this.withPlaceholders&&u.nvl(t,!0)){let d=this.placeholders();d=d.slice(Math.min(this._filterTiles(o).length,d.length),d.length),f.pushAll(s,d)}let n=f.diff(this.tiles,s);this._deleteTiles(n),this._sort(s),this.filteredElementsDirty=this.filteredElementsDirty||n.length>0||o.length>0||!f.equals(this.tiles,s);let l=this.tiles;this._setProperty("tiles",s),this.updateFilteredElements(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(l),this._renderInsertTiles(o))}_insertTiles(e){e.length!==0&&e.forEach(t=>{this._insertTile(t)})}_insertTile(e){this._initTile(e),this._applyFilters([e]),!this.virtual&&this.rendered&&this._renderTile(e)}_renderTile(e){if(e.removalPending){e.one("remove",()=>{e.rendered||(this._renderTile(e),this._renderTileVisibleForFilter(e),this.tileRemovalPendingCount===0&&this.invalidateLayoutTree())});return}e.render(),e.setLayoutData(new Nr(e)),e.$container.addClass("newly-rendered")}_renderInsertTiles(e){e.forEach(t=>{!t.rendered||(t.$container.addClass("invisible"),this.one("layoutAnimationDone",()=>{t.rendered&&(t.$container.removeClass("invisible"),this._animateTileInsertion(t)&&t.$container.addClassForAnimation("animate-insert"))}))}),this.htmlComp.layouting||this.invalidateLayoutTree()}_removeAllTiles(){this.tiles.forEach(e=>{e.remove()}),this.viewRangeRendered=new O(0,0)}_renderAllTiles(){this.tiles.forEach(e=>{this._renderTile(e)})}_deleteTiles(e){e.length!==0&&(e.forEach(t=>{this._deleteTile(t)}),this.deselectTiles(e),this.rendered&&!this.htmlComp.layouting&&this.invalidateLayoutTree())}_deleteTile(e){this._animateTileRemoval(e)&&(e.animateRemoval=!0),e.owner===this?e.destroy():this.rendered&&e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,e===this.focusedTile&&this.setFocusedTile(null)}_animateTileRemoval(e){return this.animateTileRemoval&&e&&e.isVisible()&&!(e instanceof bi)}_animateTileInsertion(e){return this.animateTileInsertion&&e&&e.isVisible()&&!(e instanceof bi)}_onAnimatedTileRemove(e){!e.removalPending||(this.tileRemovalPendingCount++,e.one("remove",()=>{this.tileRemovalPendingCount--,this.rendered&&this.tileRemovalPendingCount===0&&!this.htmlComp.layouting&&this.invalidateLayoutTree()}))}setComparator(e){this.comparator!==e&&(this.comparator=e)}_sortWhileInit(){this.sort()}sort(){let e=this.tiles.slice();if(this._sort(e),f.equals(this.tiles,e))return;let t=this.tiles;this._setProperty("tiles",e),this.filteredElementsDirty=!0,this.updateFilteredElements(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(t))}_sort(e){if(this.comparator===null)return;let t=[];this.withPlaceholders&&(t=this._deletePlaceholders(e)),e.sort(this.comparator),f.pushAll(e,t)}invalidateLayoutTree(e){this.tileRemovalPendingCount>0||super.invalidateLayoutTree(e)}setGridColumnCount(e){this.setProperty("gridColumnCount",e)}_setGridColumnCount(e){this._setProperty("gridColumnCount",e),this.prefGridColumnCount=e,this.invalidateLogicalGrid()}setLayoutConfig(e){this.setProperty("layoutConfig",e)}_setLayoutConfig(e){e||(e=new tr),this._setProperty("layoutConfig",tr.ensure(e))}_renderLayoutConfig(){let e=this.htmlComp.layout,t=e.minWidth;this.layoutConfig.applyToLayout(e),this.virtualScrolling&&(this.virtualScrolling.setMinRowHeight(this._minRowHeight()),this.setViewRangeSize(this.virtualScrolling.viewRangeSize,!1)),t!==e.minWidth&&this._renderScrollable(),this.invalidateLayoutTree()}_setMenus(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e)}_filterMenus(e,t,r,s,o){return Ke.filterAccordingToSelection("TileGrid",this.selectedTiles.length,e,t,{onlyVisible:r,enableDisableKeyStrokes:s,notAllowedTypes:o})}showContextMenu(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}_showContextMenu(e){if(e=e||{},!this.rendered||!this.attached||this.selectedTiles.length===0)return;let t=e.menuItems||this._filterMenus(this.menus,kt.CONTEXT_MENU,!0,!1);if(t.length===0)return;let r=u.nvl(e.pageX,null),s=u.nvl(e.pageY,null);if(r===null||s===null){let o,n=this.$container.scrollParent();n.length===0&&(n=this.$container);let l=w.offsetBounds(n),d=this.focusedTile||f.last(this.selectedTiles);this.isTileInView(d)?o=d.$container.offset():o=this.$container.offset(),r=o.left+10,s=o.top+10,r=Math.min(Math.max(r,l.x+1),l.right()-1),s=Math.min(Math.max(s,l.y+1),l.bottom()-1)}this.contextMenu&&this.contextMenu.close(),this.contextMenu=u.create(mt,{parent:this,menuItems:t,location:{x:r,y:s},$anchor:this.$container,menuFilter:e.menuFilter||this._filterMenusHandler}),this.contextMenu.open()}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.layoutConfig.minWidth>0?"both":"y"}):this.layoutConfig.minWidth>0&&this._installScrollbars({axis:"x"}),this.$container.toggleClass("scrollable",this.scrollable),this._updateVirtualScrollable(),this.invalidateLayoutTree()}_onScroll(e){let t=this.$container[0].scrollTop,r=this.$container[0].scrollLeft;this.scrollTop!==t&&this.virtual&&this.htmlComp.layout.updateViewPort(),this.scrollTop=t,this.scrollLeft=r}_onScrollParentScroll(e){this.htmlComp.layout.updateViewPort()}setWithPlaceholders(e){this.setProperty("withPlaceholders",e)}_renderWithPlaceholders(){this.invalidateLayoutTree()}setPlaceholderProducer(e){this.setProperty("placeholderProducer",e)}fillUpWithPlaceholders(){if(!this.withPlaceholders){this._deleteAllPlaceholders();return}this._deleteObsoletePlaceholders(),this._insertMissingPlaceholders()}tilesWithoutPlaceholders(){return this.withPlaceholders?this.tiles.filter(e=>!(e instanceof bi)):this.tiles}_createPlaceholders(){let e,t,r=this.gridColumnCount,s=this.filteredTiles,o=[];if(s.length>0){let n=s[s.length-1];t=n.gridData.x+n.gridData.w-1}else t=-1;if(t===r-1)return[];e=r-1-t;for(let n=0;n<e;n++)o.push(this._createPlaceholder());return o}_createPlaceholder(){let e=this.placeholderProducer&&this.placeholderProducer()||{};if(e instanceof bi)return e;if(v.isPlainObject(e))return u.create(a().extend(!0,{},{objectType:bi,parent:this},e));throw new Error("Placeholder producer returned unexpected result.")}_deleteObsoletePlaceholders(){let e=[],t=!1;this.placeholders().forEach(s=>{s.gridData.x===0&&this.filteredTiles[0]!==s&&(t=!0),t&&e.push(s)}),this.deleteTiles(e,!1)}_deleteAllPlaceholders(){this.deleteTiles(this.placeholders(),!1)}placeholders(){let e,t=[];for(e=this.tiles.length-1;e>=0&&this.tiles[e]instanceof bi;e--)f.insert(t,this.tiles[e],0);return t}_insertMissingPlaceholders(){let e=this._createPlaceholders();this.insertTiles(e,!1)}_deletePlaceholders(e){let t,r=[];for(t=e.length-1;t>=0;t--)e[t]instanceof bi&&(r.push(e[t]),f.remove(e,e[t]));return r.reverse()}validateLogicalGrid(){!this.logicalGrid.dirty||(this.logicalGrid.validate(this),this.fillUpWithPlaceholders(),this.logicalGrid.setDirty(!0),this.logicalGrid.validate(this))}_setLogicalGrid(e){super._setLogicalGrid(e),this.logicalGrid&&this.logicalGrid.setGridConfig(new Op)}setFocusedTile(e){this.focusedTile===e||(this.focusedTile=e,!this.rendered||!e||this.isFocused())||this.$container.scrollParents().length===0||this.focus({preventScroll:!0})}setSelectable(e){this.setProperty("selectable",e),e||this.deselectAllTiles(),this.tiles.forEach(t=>{t.setSelectable(e)})}_renderSelectable(){this.$container.toggleClass("selectable",this.selectable),this._updateTabbable(),this.invalidateLayoutTree()}setMultiSelect(e){this.setProperty("multiSelect",e)}selectTiles(e){let t=this._createChildren(f.ensure(e));if(t=this._filterTiles(t),this.selectable||(t=[]),!this.multiSelect&&t.length>1&&(t=[t[0]]),f.equals(this.selectedTiles,t))return;let r=this.selectedTiles;f.removeAll(r,t),r.forEach(s=>{s.setSelected(!1),s===this.focusedTile&&this.setFocusedTile(null)}),t.forEach(s=>{s.setSelected(!0)}),this.setProperty("selectedTiles",t.slice())}selectTile(e){this.selectTiles([e])}selectAllTiles(){this.selectTiles(this.filteredTiles)}deselectTiles(e){e=f.ensure(e);let t=this.selectedTiles.slice();f.removeAll(t,e)&&this.selectTiles(t)}deselectTile(e){this.deselectTiles([e])}deselectAllTiles(){this.selectTiles([])}toggleSelection(){this.selectedTiles.length===this.filteredTiles.length?this.deselectAllTiles():this.selectAllTiles()}addTilesToSelection(e){e=f.ensure(e),this.selectTiles(this.selectedTiles.concat(e))}addTileToSelection(e){this.addTilesToSelection([e])}isTileInView(e){let t=this.$container.scrollParent();return t.length===0&&(t=this.$container),!e||!e.$container||!t?!1:w.offsetBounds(e.$container).intersects(w.offsetBounds(t))}_onTileMouseDown(e){if(this._doubleClickSupport.mousedown(e),this._selectTileOnMouseDown(e),e.which===3)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}_onTileClick(e){let r=a()(e.currentTarget).data("widget");if(r instanceof bi||this._doubleClickSupport.doubleClicked())return;let s=e.which;this._triggerTileClick(r,s,e)}_triggerTileClick(e,t,r){this.trigger("tileClick",{tile:e,mouseButton:t,originalEvent:r})}_onTileDoubleClick(e){let r=a()(e.currentTarget).data("widget");r instanceof bi||this.doTileAction(r)}doTileAction(e){!e||this._triggerTileAction(e)}_triggerTileAction(e){this.trigger("tileAction",{tile:e})}setSelectionHandler(e){this.selectionHandler=e}_selectTileOnMouseDown(e){this.selectionHandler.selectTileOnMouseDown(e)}scrollTo(e,t){this.ensureTileRendered(e),this.htmlComp.layout.updateViewPort(!0),e.reveal(t)}revealSelection(){if(!this.rendered){this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this));return}this.selectedTiles.length>0&&this.scrollTo(this.selectedTiles[0])}addFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.addFilter(e,t)}removeFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.removeFilter(e,t)}setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.setFilters(e,t)}filter(){this.filterSupport.filter()}_applyFilters(e,t){return this.filterSupport.applyFilters(e.filter(r=>!(r instanceof bi)),t)}_createFilterSupport(){return new Ho({widget:this,$container:()=>this.$filterFieldContainer,getElementsForFiltering:this.tilesWithoutPlaceholders.bind(this),createTextFilter:this._createTextFilter.bind(this),updateTextFilterText:this._updateTextFilterText.bind(this)})}_createTextFilter(){return v.isFunction(this.createTextFilter)?this.createTextFilter():new Tn}_updateTextFilterText(e,t){return v.isFunction(this.updateTextFilterText)?this.updateTextFilterText(e,t):e instanceof Tn?e.setText(t):!1}setTextFilterEnabled(e){this.setProperty("textFilterEnabled",e)}isTextFilterFieldVisible(){return this.textFilterEnabled}_renderTextFilterEnabled(){this._updateTabbable(),this.filterSupport.renderFilterField()}updateFilteredElements(e,t){if(!this.filteredElementsDirty){this._updateEmpty();return}this.setProperty("filteredTiles",this._filterTiles()),this.invalidateLogicalGrid(!1),this.filteredElementsDirty=!1,e&&(e.newlyHidden.some(r=>r===this.focusedTile)&&this.setFocusedTile(null),this.deselectTiles(e.newlyHidden),this.rendered&&!this.removing&&(this._renderTileDelta(e),this._renderTileOrder(this.tiles))),this._updateEmpty()}_updateEmpty(){this.setEmpty(this.filteredTiles.length===0)}setEmpty(e){this.setProperty("empty",e)}_renderEmpty(){this.$container.toggleClass("empty",this.empty),this.invalidateLayoutTree()}_filterTiles(e){return e=u.nvl(e,this.tiles),this.filters.length===0?e.slice():e.filter(t=>t.filterAccepted)}findTileIndexAt(e,t,r,s){return r=u.nvl(r,0),f.findIndexFrom(this.filteredTiles,r,(o,n)=>o.gridData.x===e&&o.gridData.y===t,s)}findTilesInRange(e,t){if(e.equals(this.virtualScrolling.maxViewRange()))return this.filteredTiles;let r=[];for(let s=e.from;s<e.to;s++)this.eachTileInRow(s,o=>{(!t||t(o))&&r.push(o)});return r}findTilesInRow(e){let t=[];return this.eachTileInRow(e,r=>{t.push(r)}),t}eachTileInRow(e,t){let r=e*this.gridColumnCount,s=[];for(let o=r;o<r+this.gridColumnCount;o++)this.filteredTiles[o]&&t(this.filteredTiles[o],o);return s}setVirtual(e){this.setProperty("virtual",e)}_setVirtual(e){this._setProperty("virtual",e),this.virtualScrolling.setEnabled(this.virtual)}_renderVirtual(){this._updateVirtualScrollable(),this.rendering||this.setViewRangeSize(this.calculateViewRangeSize(),!1),this.rendered&&(this._removeAllTiles(),this.virtual&&this._renderFiller()),this.virtual||this._renderAllTiles(),this._renderViewPort(),this.invalidateLayoutTree()}_updateVirtualScrollable(){let e=this.virtualScrolling.$scrollable;if(e&&e.off("scroll",this._scrollParentScrollHandler),!this.virtual||this.removing){this.virtualScrolling.set$Scrollable(null);return}this.scrollable?this.virtualScrolling.set$Scrollable(this.$container):(this.virtualScrolling.set$Scrollable(this.$container.scrollParent()),this.virtualScrolling.$scrollable.on("scroll",this._scrollParentScrollHandler))}calculateViewRangeSize(){return this.virtualScrolling.calculateViewRangeSize()}setViewRangeSize(e,t){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.virtualScrolling.setViewRangeSize(e,t))}_heightForRow(e){let t=0,r=this.htmlComp.layout;if(t=r.rowHeight,e!==this.rowCount()-1&&(t+=r.vgap),!Ge.isNumber(t))throw new Error("Calculated height is not a number: "+t);return t}_minRowHeight(){let e=this.htmlComp.layout;return e.rowHeight+e.vgap/2}rowCount(e){return e=u.nvl(e,this.gridColumnCount),Math.ceil(this.filteredTiles.length/e)}_renderViewPort(){if(!this.isAttachedAndRendered()){this._renderViewPortAfterAttach=!0;return}!this.virtual||this.virtualScrolling.renderViewPort()}_renderViewRange(e){if(e.equals(this.viewRangeRendered)){e.size()===0&&this._renderFiller();return}this.viewRangeRendered.subtract(e).filter(s=>s.size()>0).forEach(s=>{this._removeTilesInRange(s)}),e.subtract(this.viewRangeRendered).filter(s=>s.size()>0).forEach(s=>{this._renderTilesInRange(s)}),this._renderFiller()}_renderTilesInRange(e){let t=0,r=0;if(this.filteredTiles.length===0)return;e=this.virtualScrolling.maxViewRange().intersect(e);let n=this.viewRangeRendered.union(e);if(n.length===2)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(let d=e.from;d<e.to;d++)this.eachTileInRow(d,l.bind(this)),t++;a().log.isTraceEnabled()&&(a().log.trace(t+" new rows rendered from "+e),a().log.trace(this._rowsRenderedInfo()));function l(d){d.rendered||(this._renderTile(d),r++)}}_renderTileDelta(e){if(!this.virtual)return[];let t=this.renderedTiles(),r=this.virtualScrolling.calculateCurrentViewRange(),s=this.findTilesInRange(r),o=f.diff(t,s),n=f.diff(s,t);return e&&e.newlyHidden.forEach(l=>{l.rendered&&this._removeTileByFilter(l)}),o.forEach(l=>{l.remove()}),n.forEach(l=>{this._renderTile(l)}),e&&(this.htmlComp.suppressInvalidate=!0,e.newlyShown.forEach(l=>{l.rendered&&this._renderTileVisibleForFilter(l)}),this.htmlComp.suppressInvalidate=!1),this.viewRangeRendered=r,this._renderFiller(),this.htmlComp.layouting||this.invalidateLayoutTree(),n}_removeTileByFilter(e){e.$container.removeClass("animate-invisible"),e.animateRemoval=!0,e.animateRemovalClass="animate-invisible",e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,setTimeout(()=>{e.animateRemovalClass="animate-remove"})}_renderTileVisibleForFilter(e){!e.filterAccepted||e.$container.hasClass("animate-visible")||e.removalPending||(e.$container.setVisible(!1),e._renderVisible())}_renderTileOrder(e){let t=!1;this.tiles.forEach((r,s)=>{if(e[s]!==r||t){if(this.virtual&&!r.rendered)return;t=!0,r.$container.appendTo(this.$container)}}),t&&!this.virtual&&this.invalidateLayoutTree()}_rowsRenderedInfo(){let e=this.$container.children(".tile").length,t="("+this.viewRangeRendered+")";return e+" tiles rendered in range "+t}_removeTilesInRange(e){let t=0,r=this.viewRangeRendered.subtract(e);if(r.length===2)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+r);this.viewRangeRendered=r[0];for(let s=e.from;s<e.to;s++)this._removeTilesInRow(s),t++;a().log.isTraceEnabled()&&(a().log.trace(t+" rows removed from "+e+"."),a().log.trace(this._rowsRenderedInfo()))}_removeTilesInRow(e){this.findTilesInRow(e).forEach(r=>{r.remove()})}rowHasRenderedTiles(e){return this.findTilesInRow(e).some(r=>r.rendered&&!r.removing)}ensureTileRendered(e){if(!e.rendered){let t=e.gridData.y;this.virtualScrolling.renderViewRangeForRowIndex(t),this.invalidateLayoutTree()}}_renderFiller(){this.$fillBefore||(this.$fillBefore=this.$container.prependDiv("filler"));let e=this._calculateFillerHeight(new O(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.css("width","100%"),a().log.isTraceEnabled()&&a().log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$container.appendDiv("filler")),this.$fillAfter.appendTo(this.$container);let t=this._calculateFillerHeight(new O(this.viewRangeRendered.from,this.viewRangeRendered.to));this.$fillAfter.cssTop(e+t);let r=this._calculateFillerHeight(new O(this.viewRangeRendered.to,this.rowCount()));this.$fillAfter.cssHeight(r),this.$fillAfter.css("width","100%"),a().log.isTraceEnabled()&&a().log.trace("FillAfter height: "+r)}_calculateFillerHeight(e){let t=0;for(let r=e.from;r<e.to;r++)t+=this._heightForRow(r);return t}renderedTiles(){if(!this.rendered)return[];if(!this.virtual)return this.filteredTiles;let e=[];return this.$container.children(".tile").each((t,r)=>{let s=u.widget(r);s.removalPending||e.push(s)}),e}}de(_o,"MenuTypes",{EmptySpace:"TileGrid.EmptySpace",SingleSelection:"TileGrid.SingleSelection",MultiSelection:"TileGrid.MultiSelection"});function sM(i,e,t){return e=oM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function oM(i){var e=nM(i,"string");return typeof e=="symbol"?e:String(e)}function nM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bp extends He{constructor(){super(),sM(this,"tileFilter",void 0),this.tileFilter=null,this._addRemoteProperties(["selectedTiles"])}_syncSelectedTiles(e){this.addFilterForPropertyName("selectedTiles"),this.widget.selectTiles(e)}_syncTiles(e){this.addFilterForPropertyName("selectedTiles"),this.widget.setTiles(e)}_initProperties(e){super._initProperties(e),v.isNullOrUndefined(e.filteredTiles)||(this.tileFilter=u.create(_d,{tileIds:e.filteredTiles}),e.filters=[this.tileFilter]),delete e.filteredTiles}_syncFilteredTiles(e){v.isNullOrUndefined(e)?(this.widget.removeFilter(this.tileFilter),this.tileFilter=null):(this.tileFilter||(this.tileFilter=u.create(_d),this.widget.addFilter(this.tileFilter,!1)),this.tileFilter.setTileIds(e),this.widget.filter())}_onWidgetTileClick(e){let t={tile:e.tile.id,mouseButton:e.mouseButton};this._send("tileClick",t)}_onWidgetTileAction(e){let t={tile:e.tile.id};this._send("tileAction",t)}_onWidgetEvent(e){e.type==="tileClick"?this._onWidgetTileClick(e):e.type==="tileAction"?this._onWidgetTileAction(e):super._onWidgetEvent(e)}static modifyTileGridPrototype(){!ie.get().remote||v.replacePrototypeFunction(_o,"_sortWhileInit",function(){this.modelAdapter||this._sortWhileInitOrig()},!0)}}ie.addListener("bootstrap",Bp.modifyTileGridPrototype);class Op extends gs{getGridWidgets(){return this.widget.filteredTiles}}function wn(i,e,t){return e=lM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function lM(i){var e=aM(i,"string");return typeof e=="symbol"?e:String(e)}function aM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hs extends Uo{constructor(e,t){super(e,t),wn(this,"containerPos",void 0),wn(this,"containerScrollTop",void 0),wn(this,"maxWidth",void 0),wn(this,"tiles",void 0),wn(this,"_calculatingPrimitivePrefSize",void 0),this.containerPos=null,this.containerScrollTop=null,this.tiles=[],this._calculatingPrimitivePrefSize=!1}static getTileDimensions(){if(!(hs._DEFAULT_SIZE instanceof re)){let e=L.getSize("tile-grid-layout-config","height","height",-1),t=L.getSize("tile-grid-layout-config","width","width",-1),r=L.getSize("tile-grid-layout-config","margin-left","marginLeft",-1),s=L.getSize("tile-grid-layout-config","margin-top","marginTop",-1);hs._DEFAULT_SIZE=new re(r,s,t,e)}return hs._DEFAULT_SIZE}_initDefaults(){super._initDefaults();let e=hs.getTileDimensions();this.hgap=e.x,this.vgap=e.y,this.columnWidth=e.width,this.rowHeight=e.height,this.maxWidth=-1}updateViewPort(e){let t=this.widget;!t.rendered||(u.nvl(e,!1)||t._renderViewPort(),this._layout(t.$container),t.trigger("layoutAnimationDone"))}layout(e){let t=this.widget.htmlComp,r=t.layouted||this.widget.startupAnimationEnabled&&!this.widget.startupAnimationDone||this.widget.renderAnimationEnabled;this.tiles=this.widget.renderedTiles(),x.setVisible(e,!1),r&&this._storeBounds(this.tiles),this._updateMaxWidth(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1);let s=!1,o=e.outerWidth();for(o=Math.max(o,this.minWidth),t.prefSize().width<=o&&(this._layout(e),s=!0);!s&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),t.prefSize().width<=o&&(this._layout(e),s=!0);if(s||this._layout(e),t.layouted||this.widget._renderScrollTop(),this.widget.virtual&&(!t.layouted||this._sizeChanged(t)||this.widget.withPlaceholders)){this.widget.setViewRangeSize(this.widget.calculateViewRangeSize(),!1);let l=this.widget._renderTileDelta();this._storeBounds(l),f.pushAll(this.tiles,l),this._layout(e)}let n=[];r&&(n=this._animateTiles()),this.widget.startupAnimationDone=!0,n.length>0?a().promiseAll(n).done(this._onAnimationDone.bind(this)):this._onAnimationDone(),this._updateFilterFieldMaxWidth(e)}_sizeChanged(e){return e.sizeCached&&!e.sizeCached.equals(e.size())}_storeBounds(e){e.forEach((t,r)=>{let s=w.cssBounds(t.$container);t.$container.data("oldBounds",s),t.$container.data("was-layouted",t.htmlComp.layouted)})}_validateGridData(e){return e.$comp.removeClass("newly-rendered"),super._validateGridData(e)}_layoutCellBounds(e,t){return this.widget.virtual&&this.widget.$fillBefore&&(t.top+=this.widget.$fillBefore.outerHeight(!0)),super._layoutCellBounds(e,t)}_animateTiles(){let e=this.widget.htmlComp,t=e.$comp;this.containerPos=e.offset(),this.containerScrollTop=t.scrollTop(),x.setVisible(t,!0),x.opacity(t,0);let r=[];return this.tiles.forEach((s,o)=>{if(!s.rendered)return;let n=this._animateTile(s);n&&r.push(n),s.$container.removeData("oldBounds"),s.$container.removeData("was-layouted")}),r}_animateTile(e){let t=this.widget.htmlComp;if(e.$container.stop(),e.$container.hasClass("invisible")||e.$container.hasClass("animate-visible"))return;let r=w.cssBounds(e.$container),s=e.$container.data("oldBounds");if(e instanceof bi&&!e.$container.data("was-layouted")&&(s=r.clone()),!t.layouted&&(this.widget.startupAnimationDone||!this.widget.startupAnimationEnabled)&&this.widget.renderAnimationEnabled&&(s=new re(r.x*.95,r.y*.95,r.width,r.height)),!s.equals(r)&&!(!this._inViewport(r)&&!this._inViewport(s))&&!(!e.$container.data("was-layouted")&&!this._inViewport(r)))return this._animateTileBounds(e,s,r)}_inViewport(e){e=e.translate(this.containerPos.x,this.containerPos.y).translate(0,-this.containerScrollTop);let t=new Z(e.x,e.y),r=new Z(e.x+e.width,e.y+e.height),s=this.widget.$container.scrollParent();return x.isLocationInView(t,s)||x.isLocationInView(r,s)}_onAnimationDone(){this._updateScrollbar(),this.widget.trigger("layoutAnimationDone")}_animateTileBounds(e,t,r){let s=e.$container[0],o=[s.style.overflow,s.style.overflowX,s.style.overflowY],n=()=>{s.style.overflow=o[0],s.style.overflowX=o[1],s.style.overflowY=o[2]},l=[];return e.$container.cssLeftAnimated(t.x,r.x,{start:d=>{l.push(d)},queue:!1}).cssTopAnimated(t.y,r.y,{start:d=>{l.push(d)},queue:!1}).cssWidthAnimated(t.width,r.width,{start:d=>{l.push(d)},queue:!1}).cssHeightAnimated(t.height,r.height,{start:d=>{l.push(d)},queue:!1}),a().promiseAll(l).then(n)}_updateScrollbar(){x.setVisible(this.widget.$container,!0),x.opacity(this.widget.$container,1);let e=this.widget.htmlComp;for(;e;){if(e.scrollable){x.update(e.$comp,!0);break}e=e.getParent()}}_updateMaxWidth(){let e=this.widget.htmlComp;if(e.$comp.cssPaddingRight(null),this.maxWidth<=0)return;let t=e.$comp.cssPaddingRight(),r=e.size(),s=r.width,o=Math.min(r.width,this.maxWidth),n=s-o-e.$comp.cssPaddingLeft()-e.$comp.cssBorderWidthX();n>t&&e.$comp.cssPaddingRight(n)}_resetGridColumnCount(){this.widget.gridColumnCount=this.widget.prefGridColumnCount}preferredLayoutSize(e,t){return t=a().extend({},t),this.widget.virtual?this.virtualPrefSize(e,t):this.primitivePrefSize(e,t)}virtualPrefSize(e,t){let r,s,o=S.get(e).insets(),n=new A,l=this.columnWidth,d=this.rowHeight,h=this.hgap,p=this.vgap;if(t.widthHint){s=Math.floor(t.widthHint/(l+h));let m=s*(l+h);return t.widthHint-m>l&&s++,s=Math.max(Math.min(this.widget.prefGridColumnCount,s),1),r=this.widget.rowCount(s),n.width=t.widthHint,n.height=Math.max(r*d+(r-1)*p,0),n.width+=o.horizontal(),n.height+=o.vertical(),n}return s=this.widget.gridColumnCount,r=this.widget.rowCount(),n.width=Math.max(s*l+(s-1)*h,0),n.height=Math.max(r*d+(r-1)*p,0),n.width+=o.horizontal(),n.height+=o.vertical(),n}primitivePrefSize(e,t){if(!t.widthHint||this._calculatingPrimitivePrefSize)return super.preferredLayoutSize(e,t);this._calculatingPrimitivePrefSize=!0;let r=this._primitivePrefSize(t);return this._calculatingPrimitivePrefSize=!1,r}_primitivePrefSize(e){let t,r=this.widget.htmlComp,s=!1,o=this.widget.gridColumnCount,n=e.widthHint;for(e.removeInsetsFromHints=!1,n+=r.insets().horizontal(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),t=r.prefSize(e),t.width<=n&&(s=!0);!s&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),t=r.prefSize(e),t.width<=n&&(s=!0);return this.widget.gridColumnCount=o,t}_updateFilterFieldMaxWidth(e){let t=S.get(e),r=t.availableSize().subtract(t.insets()).width;this.widget.$filterFieldContainer.css("--filter-field-max-width",r*.6+"px")}}wn(hs,"_DEFAULT_SIZE",void 0);function dM(i,e,t){return e=hM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hM(i){var e=uM(i,"string");return typeof e=="symbol"?e:String(e)}function uM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tr extends di{constructor(e){super(e),dM(this,"maxWidth",void 0),e=e||{},e.maxWidth>-2&&(this.maxWidth=e.maxWidth)}applyToLayout(e){super.applyToLayout(e),this.maxWidth&&(e.maxWidth=this.maxWidth)}clone(){return new tr(this)}static ensure(e){return e?e instanceof tr?e:new tr(e):null}}function cM(i,e,t){return e=pM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function pM(i){var e=fM(i,"string");return typeof e=="symbol"?e:String(e)}function fM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class gd{constructor(e){cM(this,"tileGrid",void 0),this.tileGrid=e}selectTileOnMouseDown(e){if(!this.isSelectable())return;let r=a()(e.currentTarget).data("widget");if(r instanceof bi||r.selected&&e.which===3)return;let s=!0;if(e.ctrlKey&&(s=!r.selected),e.ctrlKey&&this.isMultiSelect()){s?(this.addTilesToSelection(r),this._checkAndSetFocusedTile(e,r)):(this.deselectTile(r),this._checkAndSetFocusedTile(e,null));return}if(e.shiftKey&&this.isMultiSelect()){if(!this.isHorizontalGridActive())return;let o=this.getVisibleTiles(),n=this.getFocusedTile();n||(n=o[0]);let l=this.computeSelectionBetween(o.indexOf(n),o.indexOf(r),!0);l&&(this.selectTiles(l.selectedTiles),this._checkAndSetFocusedTile(e,l.focusedTile));return}s?(this.selectTile(r),this._checkAndSetFocusedTile(e,r)):(this.deselectAllTiles(),this._checkAndSetFocusedTile(e,null))}getFilteredTiles(){return this.tileGrid.filteredTiles}getFilteredTileCount(){return this.tileGrid.filteredTiles.length}getVisibleTiles(){return this.tileGrid.filteredTiles}getVisibleTileCount(){return this.tileGrid.filteredTiles.length}getGridColumnCount(){return this.tileGrid.gridColumnCount}getVisibleGridRowCount(){return this.tileGrid.logicalGrid.gridRows}getVisibleGridX(e){return e.gridData.x}getVisibleGridY(e){return e.gridData.y}getSelectedTiles(){return this.tileGrid.selectedTiles}isSelectable(){return this.tileGrid.selectable}isMultiSelect(){return this.tileGrid.multiSelect}addTilesToSelection(e){this.tileGrid.addTilesToSelection(e)}selectTile(e){this.tileGrid.selectTile(e)}selectTiles(e){this.tileGrid.selectTiles(e)}deselectTile(e){this.tileGrid.deselectTile(e)}deselectTiles(e){this.tileGrid.deselectTiles(e)}deselectAllTiles(){this.tileGrid.deselectAllTiles()}toggleSelection(){this.tileGrid.toggleSelection()}getFocusedTile(){return this.tileGrid.focusedTile}_checkAndSetFocusedTile(e,t){e.isDefaultPrevented()||t&&t.rendered&&t.$container.hasClass("unfocusable")||this.setFocusedTile(t)}setFocusedTile(e){this.tileGrid.setFocusedTile(e)}scrollTo(e){this.tileGrid.scrollTo(e)}scrollToTop(){this.tileGrid.scrollToTop()}scrollToBottom(){this.tileGrid.scrollToBottom()}findVisibleTileIndexAt(e,t,r,s){return this.tileGrid.findTileIndexAt(e,t,r,s)}getTileGridByRow(e){return e<0||e>=this.getVisibleGridRowCount()?null:this.tileGrid}isHorizontalGridActive(){return this.tileGrid.logicalGrid instanceof Ks}computeSelectionX(e,t){let r=this.getVisibleTiles(),s=null,o=-1,n=this._computeFocusedTile(e);return n.selectedTiles!==null?n:(s=n.focusedTile,o=r.indexOf(s),this.computeSelectionBetween(o,o+e,t))}computeSelectionY(e,t){let r=this.getVisibleTiles(),s=null,o=-1,n=-1,l=-1,d=this.getVisibleGridRowCount(),h=this._computeFocusedTile(e);if(h.selectedTiles!==null)return h;if(s=h.focusedTile,l=r.indexOf(s),o=this.getVisibleGridY(s),n=this.getVisibleGridX(s),e>0&&o===d-1||e<0&&o===0)return;let p=this.findVisibleTileIndexAt(n,o+e,l,e<0);if(p<0){let m=this.getTileGridByRow(o+e);if(!m)return;p=r.indexOf(f.last(m.filteredTiles))}return this.computeSelectionBetween(l,p,t)}computeSelectionToFirst(e){let t=this.getVisibleTiles(),r=this.getFocusedTile(),s=-1,o=this.getSelectedTiles();return o.length===0?(r=f.first(t),{selectedTiles:[r],focusedTile:r}):(r||(r=f.last(o)),s=t.indexOf(r),this.computeSelectionBetween(s,0,e))}computeSelectionToLast(e){let t=this.getVisibleTiles(),r=this.getFocusedTile(),s=-1,o=this.getSelectedTiles();return o.length===0?(r=f.last(t),{selectedTiles:[r],focusedTile:r}):(r||(r=f.last(o)),s=t.indexOf(r),this.computeSelectionBetween(s,t.length-1,e))}_computeFocusedTile(e){let t=this.getVisibleTiles(),r=this.getSelectedTiles(),s=this.getFocusedTile();return r.length===0?(e>0?s=f.first(t):s=f.last(t),{focusedTile:s,selectedTiles:[s]}):(s||(e>0?s=f.last(r):s=f.first(r)),{focusedTile:s,selectedTiles:null})}computeSelectionBetween(e,t,r){let s=this.getVisibleTiles(),o=this.getSelectedTiles(),n=s[t];if(e<0||e>s.length-1||t<0||t>s.length-1||e===t)return;if(!r)return{selectedTiles:[n],focusedTile:n};let l=[];return n.selected?t>e?(l=o.slice(),f.removeAll(l,s.slice(e,t))):(l=o.slice(),f.removeAll(l,s.slice(t+1,e+1))):t>e?(l=f.union(o,s.slice(e,t+1)),n=this._findLastSelectedTileAfter(s,t)):(l=f.union(s.slice(t,e+1),o),n=this._findLastSelectedTileBefore(s,t)),{selectedTiles:l,focusedTile:n}}executeSelection(e){if(!!e){if(e.selectedTiles.length>0){this.selectTiles(e.selectedTiles),this.scrollTo(e.focusedTile);let t=this.getVisibleGridY(e.focusedTile),r=this.getVisibleGridRowCount();t===0?this.scrollToTop():t===r-1&&this.scrollToBottom()}this.setFocusedTile(e.focusedTile)}}_findLastSelectedTileBefore(e,t){if(t===0)return e[t];let r=f.findFromReverse(e,t,(s,o)=>{let n=e[o-1];return n?!n.selected:!1});return r||(r=e[0]),r}_findLastSelectedTileAfter(e,t){if(t===e.length-1)return e[t];let r=f.findFrom(e,t,(s,o)=>{let n=e[o+1];return n?!n.selected:!1});return r||(r=e[e.length-1]),r}}function Hp(i,e,t){return e=mM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function mM(i){var e=gM(i,"string");return typeof e=="symbol"?e:String(e)}function gM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tn{constructor(){Hp(this,"text",void 0),Hp(this,"_htmlTileContentChangeHandler",void 0),Hp(this,"_tilePropertyChangeHandler",void 0),this.text=null,this._htmlTileContentChangeHandler=this._onHtmlTileContentChange.bind(this),this._tilePropertyChangeHandler=this._onTilePropertyChange.bind(this)}setText(e){return e=e||"",e=e.toLowerCase(),v.equals(this.text,e)?!1:(this.text=e,!0)}accept(e){if(y.empty(this.text))return!0;let r=this._plainTextForTile(e).trim().toLowerCase();return y.empty(r)?!1:r.indexOf(this.text)>-1}_plainTextForTile(e){if(e.plainText)return e.plainText;if(e instanceof Vp)return e.plainText=y.plainText(e.content)||"",e.one("propertyChange:content",this._htmlTileContentChangeHandler),e.plainText;if(!e.parent.rendered)return"";let t=!1;return e.rendered||(e.render(),t=!0),e.plainText=y.plainText(e.$container.html())||"",t&&e.remove(),e.on("propertyChange",this._tilePropertyChangeHandler),e.plainText}_onHtmlTileContentChange(e){delete e.source.plainText}_onTilePropertyChange(e){e.propertyName!=="filterAccepted"&&(delete e.source.plainText,e.source.off("propertyChange",this._tilePropertyChangeHandler))}}function _M(i,e,t){return e=bM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bM(i){var e=yM(i,"string");return typeof e=="symbol"?e:String(e)}function yM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Np extends Wt{constructor(){super(),_M(this,"widgets",void 0),this.widgets=[],this._addWidgetProperties(["widgets"])}_render(){this.$container=this.$parent.appendDiv(),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderWidgets()}setWidgets(e){this.setProperty("widgets",e)}_renderWidgets(){this.widgets.forEach(e=>{e.render()}),this.invalidateLayoutTree()}}function vM(i,e,t){return e=wM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wM(i){var e=TM(i,"string");return typeof e=="symbol"?e:String(e)}function TM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vp extends Wt{constructor(){super(),vM(this,"content",void 0),this.content=null}_render(){this.$container=this.$parent.appendDiv("html-tile"),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderContent()}setContent(e){this.setProperty("content",e)}_renderContent(){if(!this.content){this.$container.empty();return}this.$container.html(this.content),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.invalidateLayoutTree()}_onImageLoad(e){this.invalidateLayoutTree()}_onImageError(e){this.invalidateLayoutTree()}}class N_ extends vn{}function SM(i,e,t){return e=CM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CM(i){var e=PM(i,"string");return typeof e=="symbol"?e:String(e)}function PM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class V_ extends Wt{constructor(){super(),SM(this,"bean",void 0),this.bean=null}_render(){this.$container=this.$parent.appendDiv("bean-tile"),this.htmlComp=S.install(this.$container,this.session)}_renderProperties(){super._renderProperties(),this._renderBean()}_renderBean(){}triggerAppLinkAction(e){this.trigger("appLinkAction",{ref:e})}_onAppLinkAction(e){let r=a()(e.delegateTarget).data("ref");this.triggerAppLinkAction(r)}}class W_ extends vn{_onWidgetAppLinkAction(e){this._send("appLinkAction",{ref:e.ref})}_onWidgetEvent(e){e.type==="appLinkAction"?this._onWidgetAppLinkAction(e):super._onWidgetEvent(e)}}function xt(i,e,t){return e=xM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xM(i){var e=FM(i,"string");return typeof e=="symbol"?e:String(e)}function FM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wp extends _h{constructor(){super(),xt(this,"gridColumnCount",void 0),xt(this,"multiSelect",void 0),xt(this,"selectable",void 0),xt(this,"takeTileFiltersFromGroup",void 0),xt(this,"tileComparator",void 0),xt(this,"filters",void 0),xt(this,"tileGridLayoutConfig",void 0),xt(this,"tileGridSelectionHandler",void 0),xt(this,"withPlaceholders",void 0),xt(this,"virtual",void 0),xt(this,"textFilterEnabled",void 0),xt(this,"filterSupport",void 0),xt(this,"createTextFilter",void 0),xt(this,"updateTextFilterText",void 0),xt(this,"$filterFieldContainer",void 0),xt(this,"_selectionUpdateLocked",void 0),xt(this,"_tileGridPropertyChangeHandler",void 0),xt(this,"_groupBodyHeightChangeHandler",void 0),this.exclusiveExpand=!1,this.gridColumnCount=null,this.multiSelect=null,this.selectable=null,this.takeTileFiltersFromGroup=!0,this.tileComparator=null,this.filters=[],this.tileGridLayoutConfig=null,this.tileGridSelectionHandler=new zp(this),this.withPlaceholders=null,this.virtual=null,this.$filterFieldContainer=null,this.textFilterEnabled=!1,this.filterSupport=this._createFilterSupport(),this.createTextFilter=null,this.updateTextFilterText=null,this._selectionUpdateLocked=!1,this._tileGridPropertyChangeHandler=this._onTileGridPropertyChange.bind(this),this._groupBodyHeightChangeHandler=this._onGroupBodyHeightChange.bind(this)}_render(){super._render(),this.$container.addClass("tile-accordion"),this.$filterFieldContainer=this.$container.prependDiv("filter-field-container")}_createLayout(){return new Kp(this)}_renderProperties(){super._renderProperties(),this._renderTextFilterEnabled()}_remove(){this.filterSupport.remove(),super._remove()}_init(e){super._init(e),this.setFilters(this.filters)}_createKeyStrokeContext(){return new Oe}_initGroup(e){super._initGroup(e),e.body.setSelectionHandler(this.tileGridSelectionHandler),this.gridColumnCount!==null&&e.body.setGridColumnCount(this.gridColumnCount),this.setProperty("gridColumnCount",e.body.gridColumnCount),this.multiSelect!==null&&e.body.setMultiSelect(this.multiSelect),this.setProperty("multiSelect",e.body.multiSelect),this.selectable!==null&&e.body.setSelectable(this.selectable),this.setProperty("selectable",e.body.selectable),this.tileGridLayoutConfig!==null&&e.body.setLayoutConfig(this.tileGridLayoutConfig),this.setProperty("tileGridLayoutConfig",e.body.layoutConfig),this.tileComparator!==null&&(e.body.setComparator(this.tileComparator),e.body.sort()),this.setProperty("tileComparator",e.body.comparator),this.filters.length>0&&e.body.addFilter(this.filters),this.takeTileFiltersFromGroup&&this.setFilters(e.body.filters),this.withPlaceholders!==null&&e.body.setWithPlaceholders(this.withPlaceholders),this.setProperty("withPlaceholders",e.body.withPlaceholders),this.virtual!==null&&e.body.setVirtual(this.virtual),this.setProperty("virtual",e.body.virtual),e.body.selectedTiles.length>0&&this._handleSelectionChanged(e.body),e.body.on("propertyChange",this._tileGridPropertyChangeHandler),this._handleCollapsed(e),e.body.__tileAccordionEventDelegator=gr.create(e.body,this,{delegateEvents:["tileClick","tileAction"]})}_deleteGroup(e){e.body&&(e.body.off("propertyChange",this._tileGridPropertyChangeHandler),e.body.__tileAccordionEventDelegator.destroy(),e.body.__tileAccordionEventDelegator=null),super._deleteGroup(e)}setGroups(e){let t=this.getTileCount(),r=this.getFilteredTileCount(),s=this.getSelectedTileCount();super.setGroups(e);let o=this.getTileCount(),n=this.getFilteredTileCount(),l=this.getSelectedTileCount();o!==t&&this.triggerPropertyChange("tiles",null,null),n!==r&&this.triggerPropertyChange("filteredTiles",null,null),l!==s&&this.triggerPropertyChange("selectedTiles",null,null)}setGridColumnCount(e){this.groups.forEach(t=>{t.body.setGridColumnCount(e)}),this.setProperty("gridColumnCount",e)}setTileGridLayoutConfig(e){this.groups.forEach(t=>{t.body.setLayoutConfig(e),e=t.body.layoutConfig}),this.setProperty("tileGridLayoutConfig",e)}setWithPlaceholders(e){this.groups.forEach(t=>{t.body.setWithPlaceholders(e)}),this.setProperty("withPlaceholders",e)}setVirtual(e){this.groups.forEach(t=>{t.body.setVirtual(e)}),this.setProperty("virtual",e)}setSelectable(e){this.groups.forEach(t=>{t.body.setSelectable(e)}),this.setProperty("selectable",e)}setMultiSelect(e){this.groups.forEach(t=>{t.body.setMultiSelect(e)}),this.setProperty("multiSelect",e)}getGroupById(e){return f.find(this.groups,t=>t.id===e)}getGroupByTile(e){return e.findParent(t=>t instanceof Si)}_groupTiles(e){let t={};return this.groups.forEach(r=>{t[r.id]=[]}),e.forEach(function(r){let s=this.getGroupByTile(r);if(!s)throw new Error("No group found for tile "+r.id);t[s.id]||(t[s.id]=[]),t[s.id].push(r)},this),t}deleteTile(e){this.deleteTiles([e])}deleteTiles(e){if(e=f.ensure(e),e.length===0)return;let t=this.getTiles();f.removeAll(t,e),this.setTiles(t)}deleteAllTiles(){this.setTiles([])}setTiles(e){let t=f.ensure(e);if(v.equals(this.getTiles(),t))return;let r=this._createChildren(t),s=this._groupTiles(r);for(let o in s)this.getGroupById(o).body.setTiles(s[o])}getTiles(){let e=[];return this.groups.forEach(t=>{f.pushAll(e,t.body.tiles)}),e}getTileCount(){let e=0;return this.groups.forEach(t=>{e+=t.body.tiles.length}),e}addFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.addFilter(e,t)}removeFilter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.removeFilter(e,t)}setFilters(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.filterSupport.setFilters(e,t)}_setFilters(e){let t=f.ensure(e);this.groups.forEach(r=>{r.body.setFilters(t.slice(),!1)}),this._setProperty("filters",t.slice())}filter(){this.filterSupport.filter()}_filter(){return this.groups.forEach(e=>e.body.filter()),null}_createFilterSupport(){return new Ho({widget:this,$container:()=>this.$filterFieldContainer,filterElements:this._filter.bind(this),createTextFilter:this._createTextFilter.bind(this),updateTextFilterText:this._updateTextFilterText.bind(this)})}_createTextFilter(){return v.isFunction(this.createTextFilter)?this.createTextFilter():new Tn}_updateTextFilterText(e,t){return v.isFunction(this.updateTextFilterText)?this.updateTextFilterText(e,t):e instanceof Tn?e.setText(t):!1}setTextFilterEnabled(e){this.setProperty("textFilterEnabled",e)}isTextFilterFieldVisible(){return this.textFilterEnabled}_renderTextFilterEnabled(){this.filterSupport.renderFilterField()}getFilteredTiles(){let e=[];return this.groups.forEach(t=>{f.pushAll(e,t.body.filteredTiles)}),e}getFilteredTileCount(){let e=0;return this.groups.forEach(t=>{e+=t.body.filteredTiles.length}),e}getVisibleTiles(){let e=[];return this.expandedGroups().forEach(t=>{f.pushAll(e,t.body.filteredTiles)}),e}getVisibleTileCount(){let e=0;return this.expandedGroups().forEach(t=>{e+=t.body.filteredTiles.length}),e}findVisibleTileIndexAt(e,t,r,s){return r=u.nvl(r,0),f.findIndexFrom(this.getVisibleTiles(),r,(o,n)=>this.getVisibleGridX(o)===e&&this.getVisibleGridY(o)===t,s)}selectTiles(e){e=f.ensure(e);let t=this._groupTiles(e);for(let r in t)this.getGroupById(r).body.selectTiles(t[r])}selectTile(e){this.selectTiles([e])}selectAllTiles(){this.selectTiles(this.getVisibleTiles())}deselectTiles(e){e=f.ensure(e);let t=this.getSelectedTiles().slice();f.removeAll(t,e)&&this.selectTiles(t)}deselectTile(e){this.deselectTiles([e])}deselectAllTiles(){this.selectTiles([])}addTilesToSelection(e){e=f.ensure(e),this.selectTiles(this.getSelectedTiles().concat(e))}addTileToSelection(e){this.addTilesToSelection([e])}getSelectedTiles(){let e=[];return this.groups.forEach(t=>{f.pushAll(e,t.body.selectedTiles)}),e}getSelectedTile(){return this.getSelectedTiles()[0]}getSelectedTileCount(){let e=0;return this.groups.forEach(t=>{e+=t.body.selectedTiles.length}),e}toggleSelection(){this.getSelectedTileCount()===this.getVisibleTileCount()?this.deselectAllTiles():this.selectAllTiles()}setTileComparator(e){this.groups.forEach(t=>{t.body.setComparator(e)}),this.setProperty("tileComparator",e)}sortTiles(){this.groups.forEach(e=>{e.body.sort()})}setFocusedTile(e){let t=null;e!==null&&(t=this.getGroupByTile(e)),this.groups.forEach(r=>{r===t?r.body.setFocusedTile(e):r.body.setFocusedTile(null)})}getFocusedTile(){let e=null;return this.groups.some(t=>t.body.focusedTile?(e=t.body.focusedTile,!0):!1),e}getVisibleGridRowCount(){return this.expandedGroups().reduce((e,t)=>e+t.body.logicalGrid.gridRows,0)}getVisibleGridX(e){return e.gridData.x}getVisibleGridY(e){let t=this.getGroupByTile(e),r=this.getVisibleRowByGroup(t);return e.gridData.y+r}getGroupByVisibleRow(e){if(e<0||e>=this.getVisibleGridRowCount())return null;let t=0;return f.find(this.expandedGroups(),r=>{let s=r.body.logicalGrid.gridRows;if(t<=e&&e<t+s)return!0;t+=s})}getVisibleRowByGroup(e){let t=0;return this.expandedGroups().some(s=>{let o=s.body.logicalGrid.gridRows;return s===e?!0:(t+=o,!1)})?t:-1}expandedGroups(){return this.groups.filter(e=>!e.collapsed)}_handleSelectionChanged(e){if(this._selectionUpdateLocked)return;let t=e.parent;if(e.selectedTiles.length>0&&t.collapsed){e.deselectAllTiles();return}!this.multiSelect&&e.selectedTiles.length>0&&(this._selectionUpdateLocked=!0,this.groups.forEach(r=>{r.body!==e&&r.body.deselectAllTiles()}),this._selectionUpdateLocked=!1)}_onTileGridPropertyChange(e){e.propertyName==="selectedTiles"?(this._handleSelectionChanged(e.source),this.triggerPropertyChange("selectedTiles",null,null)):e.propertyName==="filteredTiles"?this.triggerPropertyChange("filteredTiles",null,null):e.propertyName==="tiles"&&this.triggerPropertyChange("tiles",null,null)}_onGroupCollapsedChange(e){super._onGroupCollapsedChange(e),this._handleCollapsed(e.source)}_handleCollapsed(e){e.collapsed&&e.body.deselectAllTiles(),e.rendered&&(e.on("bodyHeightChange",this._groupBodyHeightChangeHandler),e.one("bodyHeightChangeDone",this._onGroupBodyHeightChangeDone.bind(this)))}_onGroupBodyHeightChange(e){this.groups.forEach(t=>{e.source===t||t.bodyAnimating||t.body.virtual&&t.body.htmlComp&&t.body.htmlComp.layout.updateViewPort()})}_onGroupBodyHeightChangeDone(e){e.source.off("bodyHeightChange",this._groupBodyHeightChangeHandler)}tileAtScrollTop(e){return f.find(this.getTiles().filter(t=>t.rendered),t=>t.$container.position().top>=e)}}class K_ extends bh{_initProperties(e){super._initProperties(e),e.takeTileFiltersFromGroup=!1}}function EM(i,e,t){return e=AM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function AM(i){var e=DM(i,"string");return typeof e=="symbol"?e:String(e)}function DM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Kp extends la{constructor(e,t){super(t),EM(this,"tileAccordion",void 0),this.tileAccordion=e}layout(e){let t=this.tileAccordion.groups.map(r=>r.body).map(r=>this._getTileGridHeight(r));super.layout(e),this._updateFilterFieldMaxWidth(e),this.tileAccordion.groups.map(r=>r.body).forEach((r,s)=>this._updateTileGridViewPort(r,t[s]))}_updateTileGridViewPort(e,t){if(!e.rendered||!e.htmlComp||t<=0)return;let r=this._getTileGridHeight(e);t===r&&e.virtual&&(e.setViewRangeSize(e.calculateViewRangeSize(),!1),e.htmlComp.layout.updateViewPort())}_getTileGridHeight(e){if(!e||!e.htmlComp)return 0;let r=e.htmlComp.sizeCached;return r?r.height:0}_updateFilterFieldMaxWidth(e){let t=S.get(e),r=t.availableSize().subtract(t.insets()).width;this.tileAccordion.$filterFieldContainer.css("--filter-field-max-width",r*.6+"px")}}function MM(i,e,t){return e=$M(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function $M(i){var e=RM(i,"string");return typeof e=="symbol"?e:String(e)}function RM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zp extends gd{constructor(e){super(e),MM(this,"tileAccordion",void 0),this.tileAccordion=e}getFilteredTiles(){return this.tileAccordion.getFilteredTiles()}getFilteredTileCount(){return this.tileAccordion.getFilteredTileCount()}getVisibleTiles(){return this.tileAccordion.getVisibleTiles()}getVisibleTileCount(){return this.tileAccordion.getVisibleTileCount()}getSelectedTiles(){return this.tileAccordion.getSelectedTiles()}getFocusedTile(){return this.tileAccordion.getFocusedTile()}getVisibleGridRowCount(){return this.tileAccordion.getVisibleGridRowCount()}getVisibleGridX(e){return this.tileAccordion.getVisibleGridX(e)}getVisibleGridY(e){return this.tileAccordion.getVisibleGridY(e)}scrollTo(e){this.tileAccordion.getGroupByTile(e).body.scrollTo(e)}getTileGridByRow(e){let t=this.tileAccordion.getGroupByVisibleRow(e);return t?t.body:null}findVisibleTileIndexAt(e,t,r,s){return this.tileAccordion.findVisibleTileIndexAt(e,t,r,s)}isHorizontalGridActive(){return this.tileAccordion.groups.length===0?!1:this.tileAccordion.groups[0].body.logicalGrid instanceof Ks}}class ss extends B{constructor(e){super(),this.field=e,this.shift=e.multiSelect?void 0:!1,this.renderingHints.$drawingArea=(t,r)=>{let s=this._computeNewSelection();if(s&&s.focusedTile)return s.focusedTile.$container},this.inheritAccessibility=!1}getSelectionHandler(){return this.field.selectionHandler}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isSelectable()||this.getSelectionHandler().getFilteredTileCount()===0)}handle(e){this.getSelectionHandler().executeSelection(this._computeNewSelection(e.shiftKey))}_computeNewSelection(e){return null}}class Gp extends ss{constructor(e){super(e),this.ctrl=!0,this.shift=!1,this.which=[_.A],this.renderingHints.$drawingArea=(t,r)=>{let s=this.getSelectionHandler().getVisibleTiles()[0];if(s)return s.$container}}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isMultiSelect())}handle(e){this.getSelectionHandler().toggleSelection()}}class Up extends ss{constructor(e){super(e),this.stopPropagation=!0,this.repeatable=!0,this.which=[_.LEFT],this.renderingHints.text="←"}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionX(-1,e)}}class qp extends ss{constructor(e){super(e),this.stopPropagation=!0,this.repeatable=!0,this.which=[_.RIGHT],this.renderingHints.text="→"}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionX(1,e)}}class Yp extends ss{constructor(e){super(e),this.stopPropagation=!0,this.repeatable=!0,this.which=[_.DOWN],this.renderingHints.text="↓"}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionY(1,e)}}class jp extends ss{constructor(e){super(e),this.stopPropagation=!0,this.repeatable=!0,this.which=[_.UP],this.renderingHints.text="↑"}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionY(-1,e)}}class Xp extends ss{constructor(e){super(e),this.stopPropagation=!0,this.which=[_.HOME]}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionToFirst(e)}}class Jp extends ss{constructor(e){super(e),this.stopPropagation=!0,this.which=[_.END]}_accept(e){return!(!super._accept(e)||!this.getSelectionHandler().isHorizontalGridActive())}_computeNewSelection(e){return this.getSelectionHandler().computeSelectionToLast(e)}}function z_(i,e,t){return e=LM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function LM(i){var e=IM(i,"string");return typeof e=="symbol"?e:String(e)}function IM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _d{constructor(e){z_(this,"synthetic",void 0),z_(this,"tileMap",void 0),e=e||{},this.synthetic=!0,this.tileMap={},e.tileIds&&this.setTileIds(e.tileIds)}setTileIds(e){this.tileMap={},e.forEach(t=>{this.tileMap[t]=t})}accept(e){return!!this.tileMap[e.id]}}function G_(i,e,t){return e=kM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kM(i){var e=BM(i,"string");return typeof e=="symbol"?e:String(e)}function BM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Qp extends Wt{constructor(){super(),G_(this,"tileWidget",void 0),G_(this,"_widgetPropertyChangeHandler",void 0),this.tileWidget=null,this._addWidgetProperties(["tileWidget"]),this._widgetPropertyChangeHandler=this._onWidgetPropertyChange.bind(this)}_init(e){super._init(e),this._setTileWidget(this.tileWidget)}_destroy(){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),super._destroy()}_renderProperties(){super._renderProperties(),this._renderTileWidget()}_renderTileWidget(){this.tileWidget&&this.tileWidget.render()}_removeTileWidget(){this.tileWidget&&this.tileWidget.remove()}_onWidgetPropertyChange(e){e.propertyName==="visible"?this.setVisible(e.newValue):e.propertyName==="enabled"?this.setEnabled(e.newValue):e.propertyName==="disabledStyle"&&this.setDisabledStyle(e.newValue)}_setTileWidget(e){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),this._setProperty("tileWidget",e),e&&(this.tileWidget.visible||this.setVisible(!1),this.tileWidget.enabled||this.setEnabled(!1),this.tileWidget.disabledStyle!==I.DisabledStyle.DEFAULT&&this.setDisabledStyle(this.tileWidget.disabledStyle),this.tileWidget.on("propertyChange",this._widgetPropertyChangeHandler)),this.invalidateLayoutTree()}}class U_ extends vn{}class bi extends Wt{constructor(){super(),this.cssClass="placeholder-tile",this.displayStyle=Wt.DisplayStyle.PLAIN}_setSelectable(e){super._setSelectable(!1)}}function OM(i,e,t){return e=HM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HM(i){var e=NM(i,"string");return typeof e=="symbol"?e:String(e)}function NM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vi extends Qp{constructor(){super(),this.displayStyle=Vi.DisplayStyle.DASHBOARD}_renderProperties(){super._renderProperties(),this._renderFieldLabelVisible(),this._renderCompact()}_renderTileWidget(){super._renderTileWidget(),this.displayStyle===Vi.DisplayStyle.DASHBOARD&&this.tileWidget&&this.tileWidget.htmlComp&&this.tileWidget.htmlComp.layout instanceof li&&(this.tileWidget.htmlComp.layout.statusWidth=0)}_renderDisplayStyle(){super._renderDisplayStyle(),this.$container.toggleClass("dashboard",this.displayStyle===Vi.DisplayStyle.DASHBOARD)}_renderFieldLabelVisible(){this.displayStyle===Vi.DisplayStyle.DASHBOARD&&this.tileWidget instanceof Ao&&this.tileWidget.$container.toggleClass("no-padding",!this.tileWidget.labelVisible&&!this.tileWidget.errorStatus)}_renderCompact(){this.$container.toggleClass("compact",F.get().type===F.Type.MOBILE)}_onWidgetPropertyChange(e){super._onWidgetPropertyChange(e),(e.propertyName==="labelVisible"||e.propertyName==="errorStatus")&&this.rendered&&this._renderFieldLabelVisible()}}OM(Vi,"DisplayStyle",{DEFAULT:Wt.DisplayStyle.DEFAULT,PLAIN:Wt.DisplayStyle.PLAIN,DASHBOARD:"dashboard"});class q_ extends vn{}class Zp extends Vi{_render(){super._render(),this.$container.addClass("button-tile")}}function VM(i,e,t){return e=WM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WM(i){var e=KM(i,"string");return typeof e=="symbol"?e:String(e)}function KM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tl extends Le{constructor(){super(),VM(this,"$iconContainer",void 0),this.processButton=!1,this.$iconContainer=null}_render(){if(this.parent.displayStyle!==Vi.DisplayStyle.DASHBOARD){super._render();return}let e=this.$parent.makeDiv();this.$buttonLabel=e.appendSpan("label"),this.addContainer(this.$parent,"tile-button"),this.addField(e),this.htmlComp.setLayout(new jo),this.$container.on("click",this._onClick.bind(this)).unfocusable()}_remove(){this.$iconContainer=null,super._remove()}_renderIconId(){if(this.parent.displayStyle!==Vi.DisplayStyle.DASHBOARD){super._renderIconId();return}this.$field.removeClass("with-icon without-icon"),this.iconId?(this.$iconContainer||(this.$iconContainer=this.$field.prependDiv("icon-container")),this.$iconContainer.icon(this.iconId),this.$field.addClass("with-icon")):(this.$iconContainer&&(this.$iconContainer.remove(),this.$iconContainer=null),this.$field.addClass("without-icon")),this.invalidateLayoutTree()}_renderTooltipText(){y.hasText(this.tooltipText)?G.install(this.$container,{parent:this,text:this.tooltipText}):G.uninstall(this.$container)}}class Y_ extends Lc{_render(){super._render(),this.$container.addClass("scrollbar-y-outside")}_installScrollbars(e){super._installScrollbars($.extend(!0,{},e,{scrollShadow:"gradient"}))}}function bd(i,e,t){return e=zM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zM(i){var e=GM(i,"string");return typeof e=="symbol"?e:String(e)}function GM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class j_ extends Ro{constructor(){super(),bd(this,"_tableBlurHandler",void 0),bd(this,"_tableFocusHandler",void 0),bd(this,"_menuBarPropertyChangeHandler",void 0),bd(this,"_documentMouseDownHandler",void 0),this._tableBlurHandler=this._onTableBlur.bind(this),this._tableFocusHandler=this._onTableFocus.bind(this),this._menuBarPropertyChangeHandler=this._onMenuBarPropertyChange.bind(this),this._documentMouseDownHandler=this._onDocumentMouseDown.bind(this)}_render(){super._render(),this.session.focusManager.restrictedFocusGain||this.$container.document(!0).addEventListener("mousedown",this._documentMouseDownHandler,!0)}_remove(){this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),super._remove()}_renderTable(){super._renderTable(),this.parent.displayStyle===Vi.DisplayStyle.DASHBOARD&&this.table&&(this.table.$container.on("blur",this._tableBlurHandler).on("focus",this._tableFocusHandler),this.table.menuBar.on("propertyChange",this._menuBarPropertyChangeHandler),this._toggleHasMenuBar(),document.activeElement!==this.table.$container[0]&&this._hideMenuBar(!0))}_removeTable(){this.parent.displayStyle===Vi.DisplayStyle.DASHBOARD&&(this.table&&(this.table.$container.off("blur",this._tableBlurHandler).off("focus",this._tableFocusHandler),this.table.menuBar.off("propertyChange",this._menuBarPropertyChangeHandler)),super._removeTable())}_onTableBlur(e){let t=a()(".popup").data("widget");this.has(t)||this._hideMenuBar(!0)}_onTableFocus(e){this._hideMenuBar(!1)}_hideMenuBar(e){this.table.menuBar.hiddenByUi=e,this.table.menuBar.updateVisibility()}_onMenuBarPropertyChange(e){e.propertyName==="visible"&&this._toggleHasMenuBar()}_toggleHasMenuBar(){!this.rendered&&!this.rendering||this.$container.toggleClass("has-menubar",this.table.menuBar.visible)}_onDocumentMouseDown(e){let t=a()(".popup"),r=t.data("widget");this.table&&r&&this.table.has(r)&&t.has(e.target)&&e.preventDefault()}}function pt(i,e,t){return e=UM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UM(i){var e=qM(i,"string");return typeof e=="symbol"?e:String(e)}function qM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yd extends I{constructor(){super(),pt(this,"view",void 0),pt(this,"title",void 0),pt(this,"subTitle",void 0),pt(this,"iconId",void 0),pt(this,"closable",void 0),pt(this,"saveNeeded",void 0),pt(this,"saveNeededVisible",void 0),pt(this,"status",void 0),pt(this,"selected",void 0),pt(this,"$title",void 0),pt(this,"$subTitle",void 0),pt(this,"$iconContainer",void 0),pt(this,"$statusContainer",void 0),pt(this,"$close",void 0),pt(this,"$titleLine",void 0),pt(this,"$saveNeeded",void 0),pt(this,"$statusIcons",void 0),pt(this,"_statusContainerUsageCounter",void 0),pt(this,"_viewPropertyChangeListener",void 0),pt(this,"_viewRemoveListener",void 0),pt(this,"_glassPaneContribution",void 0),this.view=null,this.title=null,this.subTitle=null,this.iconId=null,this.cssClass=null,this.closable=!1,this.saveNeeded=!1,this.saveNeededVisible=!1,this.status=null,this.selected=!1,this.$title=null,this.$subTitle=null,this.$iconContainer=null,this.$statusContainer=null,this.$statusIcons=[],this._statusContainerUsageCounter=0,this._viewPropertyChangeListener=this._onViewPropertyChange.bind(this),this._viewRemoveListener=this._onViewRemove.bind(this),this._glassPaneContribution=e=>this.$close?(this.$close.addClass("glasspane-parent"),this.$close):null}_init(e){super._init(e),this.view=e.view,this.title=this.view?this.view.title:e.title,this.subTitle=this.view?this.view.subTitle:e.subTitle,this.iconId=this.view?this.view.iconId:e.iconId,this.cssClass=this.view?this.view.cssClass:e.cssClass,this.closable=this.view?this.view.closable:e.closable,this.saveNeeded=this.view?this.view.saveNeeded:e.saveNeeded,this.saveNeededVisible=this.view?this.view.saveNeededVisible:e.saveNeededVisible,this.status=this.view?this.view.status:e.status,this.view&&(this._installViewListeners(),this.view.addGlassPaneContribution(this._glassPaneContribution))}renderAfter(e,t){this.render(e),t&&this.$container.insertAfter(t.$container)}_render(){this.$container=this.$parent.prependDiv("simple-tab"),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$titleLine=this.$container.appendDiv("title-line"),this.$iconContainer=this.$titleLine.appendDiv("icon-container"),this.$title=this.$titleLine.appendDiv("title"),G.installForEllipsis(this.$title,{parent:this}),this.$statusContainer=this.$titleLine.appendDiv("status-container"),this.$subTitle=this.$container.appendDiv("sub-title"),G.installForEllipsis(this.$subTitle,{parent:this})}_renderProperties(){super._renderProperties(),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderCssClass(),this._renderClosable(),this._renderSaveNeeded(),this._renderStatus(),this._renderSelected()}_remove(){this.$close=null,super._remove()}setTitle(e){this.setProperty("title",e)}_renderTitle(){(this.title||this.subTitle)&&this.$title.textOrNbsp(this.title)}setSubTitle(e){this.setProperty("subTitle",e)}_renderSubTitle(){this.subTitle?(this.title||this._renderTitle(),this.$subTitle.textOrNbsp(this.subTitle)):this.title||this._renderTitle()}setIconId(e){this.setProperty("iconId",e)}_renderIconId(){this.$iconContainer.icon(this.iconId)}setClosable(e){this.setProperty("closable",e)}_renderClosable(){if(this.closable){if(this.$close)return;this.$container.addClass("closable"),this.$close=this.$container.appendDiv("closer").on("click",this._onClose.bind(this))}else{if(!this.$close)return;this.$container.removeClass("closable"),this.$close.remove(),this.$close=null}}setSaveNeededVisible(e){this.saveNeededVisible!==e&&(this._setProperty("saveNeededVisible",e),this.rendered&&this._renderSaveNeeded())}setSaveNeeded(e){this.saveNeeded!==e&&(this._setProperty("saveNeeded",e),this.rendered&&this._renderSaveNeeded())}_renderSaveNeeded(){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$saveNeeded=this.$statusContainer.prependDiv("status save-needer"),this._statusContainerUsageCounter++}else{if(!this.$saveNeeded)return;this.$container.removeClass("save-needed"),this.$saveNeeded.remove(),this.$saveNeeded=null,this._statusContainerUsageCounter--}}setStatus(e){this.setProperty("status",e)}_renderStatus(){this._statusContainerUsageCounter-=this.$statusIcons.length===0?0:1,this.$statusIcons.forEach(e=>e.remove()),this.$statusIcons=[],this.status&&this.status.asFlatList().forEach(e=>{if(!(!e||!e.iconId&&!e.message)){if(e.iconId){let t=this.$statusContainer.appendIcon(e.iconId,"status");e.cssClass()&&t.addClass(e.cssClass()),this.$statusIcons.push(t)}if(e.message){let t=this.$statusContainer.appendSpan("status message");e.cssClass()&&t.addClass(e.cssClass());let r=t.appendSpan("text",e.message);G.installForEllipsis(r,{parent:this}),this.$statusIcons.push(t)}}}),this._statusContainerUsageCounter+=this.$statusIcons.length===0?0:1,this.$container.toggleClass("has-status",this._statusContainerUsageCounter>0)}select(){this.setSelected(!0)}deselect(){this.setSelected(!1)}setSelected(e){this.setProperty("selected",e)}_renderSelected(){this.$container.toggleClass("selected",this.selected)}_onMouseDown(e){this.$close&&this.$close.isOrHas(e.target)||(this.trigger("click"),this.$title&&(G.cancel(this.$title),G.close(this.$title)),this.$subTitle&&(G.cancel(this.$subTitle),G.close(this.$subTitle)),e.preventDefault())}_onClose(e){this.view&&this.view.abort()}getMenuText(){return y.join(" – ",this.title,this.subTitle)}_installViewListeners(){this.view.on("propertyChange",this._viewPropertyChangeListener),this.view.on("remove",this._viewRemoveListener)}_uninstallViewListeners(){this.view.off("propertyChange",this._viewPropertyChangeListener),this.view.off("remove",this._viewRemoveListener)}_onViewPropertyChange(e){e.propertyName==="title"?this.setTitle(this.view.title):e.propertyName==="subTitle"?this.setSubTitle(this.view.subTitle):e.propertyName==="iconId"?this.setIconId(this.view.iconId):e.propertyName==="cssClass"?this.setCssClass(e.newValue):e.propertyName==="saveNeeded"?this.setSaveNeeded(e.newValue):e.propertyName==="saveNeededVisible"?this.setSaveNeededVisible(e.newValue):e.propertyName==="closable"?this.setClosable(e.newValue):e.propertyName==="status"&&this.setStatus(e.newValue)}_onViewRemove(e){this._uninstallViewListeners(),this.rendered?this.remove():this.trigger("remove")}}function Sl(i,e,t){return e=YM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function YM(i){var e=jM(i,"string");return typeof e=="symbol"?e:String(e)}function jM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ni extends I{constructor(){super(),Sl(this,"displayStyle",void 0),Sl(this,"tabs",void 0),Sl(this,"_selectedViewTab",void 0),Sl(this,"_tabClickHandler",void 0),this.displayStyle=Ni.DisplayStyle.DEFAULT,this.tabs=[],this._selectedViewTab=null}_init(e){super._init(e),this._tabClickHandler=this._onTabClick.bind(this)}_render(){this.$container=this.$parent.appendDiv("simple-tab-area"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}_createLayout(){return new vd(this)}_renderProperties(){super._renderProperties(),this._renderDisplayStyle(),this._renderTabs()}setDisplayStyle(e){this.setProperty("displayStyle",e)}_renderDisplayStyle(){this.$container.toggleClass("spread-even",this.displayStyle===Ni.DisplayStyle.SPREAD_EVEN),this.invalidateLayoutTree()}_renderTabs(){this.tabs.slice().reverse().forEach(e=>this._renderTab(e)),ke.updateFirstLastMarker(this.tabs)}_renderTab(e){e.renderAfter(this.$container)}_renderVisible(){this.$container.setVisible(this.visible&&this.tabs.length>0),this.invalidateLayoutTree()}_onTabClick(e){this.selectTab(e.source)}getTabs(){return this.tabs}getVisibleTabs(){return this.tabs.filter(e=>e.$container?e.$container.isVisible():e.visible)}selectTab(e){this._selectedViewTab!==e&&(this.deselectTab(this._selectedViewTab),this._selectedViewTab=e,e&&e.select(),this.trigger("tabSelect",{viewTab:e}),e&&e.rendered&&!e.$container.isVisible()&&this.invalidateLayoutTree())}deselectTab(e){!e||this._selectedViewTab===e&&this._selectedViewTab.deselect()}getSelectedTab(){return this._selectedViewTab}addTab(e,t){let r=-1;t&&(r=this.tabs.indexOf(t)),this.tabs.splice(r+1,0,e),e.on("click",this._tabClickHandler),this.rendered&&(this._renderVisible(),e.renderAfter(this.$container,t),ke.updateFirstLastMarker(this.getTabs()),this.invalidateLayoutTree())}destroyTab(e){let t=this.tabs.indexOf(e);t>-1&&(this.tabs.splice(t,1),e.destroy(),e.off("click",this._tabClickHandler),this.rendered&&(this._renderVisible(),ke.updateFirstLastMarker(this.getTabs()),this.invalidateLayoutTree()))}}Sl(Ni,"DisplayStyle",{DEFAULT:"default",SPREAD_EVEN:"spreadEven"});function Sn(i,e,t){return e=XM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function XM(i){var e=JM(i,"string");return typeof e=="symbol"?e:String(e)}function JM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vd extends te{constructor(e){super(),Sn(this,"tabArea",void 0),Sn(this,"tabWidth",void 0),Sn(this,"tabMinWidth",void 0),Sn(this,"overflowTabItemWidth",void 0),Sn(this,"_$overflowTab",void 0),Sn(this,"_overflowTabsIndizes",void 0),this.tabArea=e,this._$overflowTab=null,this._overflowTabsIndizes=[],this.tabWidth=null,this.tabMinWidth=null,this.overflowTabItemWidth=null}layout(e){let t=this.tabArea.htmlComp,r=t.size({exact:!0}),s=t.$comp.children(".simple-tab"),o=this.tabArea.getTabs().length,n=this.smallPrefSize();if(r=r.subtract(t.insets()),this._initSizes(),this._$overflowTab&&this._$overflowTab.remove(),s.setVisible(!0),this._overflowTabsIndizes=[],ke.updateFirstLastMarker(this.tabArea.getTabs()),n.width<=r.width){e.removeClass("overflown");return}e.addClass("overflown"),r.width-=this.overflowTabItemWidth;let l=Math.floor(r.width/this.tabMinWidth),d=o-l,h=0;s.each((g,b)=>{a()(b).hasClass("selected")&&(h=g)});let p,m=h-Math.floor(l/2);m<0?(m=0,p=l-1):(p=m+l-1,p>o-1&&(p=o-1,m=p-l+1)),this._$overflowTab=t.$comp.appendDiv("simple-overflow-tab-item").on("mousedown",this._onOverflowTabItemMouseDown.bind(this)),this._$overflowTab.appendDiv("num-tabs").text(d),s.each((g,b)=>{(g<m||g>p)&&(a()(b).setVisible(!1),this._overflowTabsIndizes.push(g))}),ke.updateFirstLastMarker(this.tabArea.getVisibleTabs())}smallPrefSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._initSizes(),e=a().extend({minTabWidth:this.tabMinWidth},e),this.preferredLayoutSize(this.tabArea.$container,e)}preferredLayoutSize(e,t){this._initSizes();let r=u.nvl(t.minTabWidth,0)||u.nvl(this.tabWidth,0),o=this.tabArea.getTabs().length*r;t=a().extend({useCssSize:!0},t);let n=w.prefSize(this.tabArea.$container,t);return t.widthHint&&this.tabArea.displayStyle===Ni.DisplayStyle.SPREAD_EVEN&&(o=Math.max(t.widthHint,o)),new A(o,n.height)}_initSizes(){if(this.tabWidth!=null&&this.tabMinWidth!=null&&this.overflowTabItemWidth!=null)return;let e=this.tabArea.$container.children(".simple-tab").eq(0);if(e.length===0)return;e=e.clone().addClass("selected");let t=this.tabArea.$container.attr("class"),r=e.attr("class");this.tabWidth===null&&(this.tabWidth=L.getSize([t,r],"width","width",0)),this.tabMinWidth===null&&(this.tabMinWidth=L.getSize([t,r],"min-width","minWidth")),this.overflowTabItemWidth===null&&(this.overflowTabItemWidth=L.getSize([t,"simple-overflow-tab-item"],"min-width","minWidth"),this.overflowTabItemWidth+=L.getSize([t,"simple-overflow-tab-item"],"margin-left","marginLeft"),this.overflowTabItemWidth+=L.getSize([t,"simple-overflow-tab-item"],"margin-right","marginRight"))}_onOverflowTabItemMouseDown(e){let t=this.tabArea,r=[],s=a()(e.currentTarget);if(s.data("popup")){s.data("popup").close();return}this._overflowTabsIndizes.forEach(n=>{let l=this.tabArea.getTabs()[n],d=u.create(le,{parent:this.tabArea,text:l.getMenuText()});d.on("action",function(){a().log.isDebugEnabled()&&a().log.debug("(SimpleTabAreaLayout#_onMouseDownOverflow) tab="+this),t.selectTab(this)}.bind(l)),r.push(d)});let o=u.create(mt,{parent:this.tabArea,menuItems:r,cloneMenuItems:!1,$anchor:s,closeOnAnchorMouseDown:!1});s.addClass("selected"),s.data("popup",o),o.one("remove",()=>{s.removeClass("selected"),s.data("popup",null)}),o.open()}}function q(i,e,t){return e=QM(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function QM(i){var e=ZM(i,"string");return typeof e=="symbol"?e:String(e)}function ZM(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ie extends I{constructor(){super(),q(this,"displayStyle",void 0),q(this,"title",void 0),q(this,"selectViewTabsKeyStrokesEnabled",void 0),q(this,"selectViewTabsKeyStrokeModifier",void 0),q(this,"cacheSplitterPosition",void 0),q(this,"browserHistoryEntry",void 0),q(this,"logoId",void 0),q(this,"logoUrl",void 0),q(this,"navigationVisible",void 0),q(this,"navigationHandleVisible",void 0),q(this,"logoActionEnabled",void 0),q(this,"benchVisible",void 0),q(this,"headerVisible",void 0),q(this,"geolocationServiceAvailable",void 0),q(this,"benchLayoutData",void 0),q(this,"nativeNotificationDefaults",void 0),q(this,"menus",void 0),q(this,"addOns",void 0),q(this,"dialogs",void 0),q(this,"views",void 0),q(this,"keyStrokes",void 0),q(this,"viewButtons",void 0),q(this,"messageBoxes",void 0),q(this,"fileChoosers",void 0),q(this,"outline",void 0),q(this,"activeForm",void 0),q(this,"selectedViewTabs",void 0),q(this,"notifications",void 0),q(this,"navigation",void 0),q(this,"header",void 0),q(this,"bench",void 0),q(this,"splitter",void 0),q(this,"splitterVisible",void 0),q(this,"formController",void 0),q(this,"messageBoxController",void 0),q(this,"fileChooserController",void 0),q(this,"initialFormRendering",void 0),q(this,"resizing",void 0),q(this,"offline",void 0),q(this,"inBackground",void 0),q(this,"openUriHandler",void 0),q(this,"theme",void 0),q(this,"dense",void 0),q(this,"animateLayoutChange",void 0),q(this,"url",void 0),q(this,"responsiveHandler",void 0),q(this,"$notifications",void 0),q(this,"$overlaySeparator",void 0),q(this,"_resizeHandler",void 0),q(this,"_glassPaneTargetFilters",void 0),q(this,"_offlineNotification",void 0),q(this,"_benchActiveViewChangedHandler",void 0),q(this,"_popstateHandler",void 0),this.title=null,this.selectViewTabsKeyStrokesEnabled=!0,this.selectViewTabsKeyStrokeModifier="control",this.cacheSplitterPosition=!0,this.browserHistoryEntry=null,this.logoId=null,this.navigationVisible=!0,this.navigationHandleVisible=!0,this.logoActionEnabled=!1,this.benchVisible=!0,this.headerVisible=!0,this.geolocationServiceAvailable=F.get().supportsGeolocation(),this.benchLayoutData=null,this.nativeNotificationDefaults=null,this.menus=[],this.addOns=[],this.dialogs=[],this.views=[],this.keyStrokes=[],this.viewButtons=[],this.messageBoxes=[],this.fileChoosers=[],this.outline=null,this.activeForm=null,this.selectedViewTabs=[],this.notifications=[],this.navigation=null,this.header=null,this.bench=null,this.splitter=null,this.splitterVisible=!1,this.formController=null,this.messageBoxController=null,this.fileChooserController=null,this.initialFormRendering=!1,this.offline=!1,this.inBackground=!1,this.openUriHandler=null,this.theme=null,this.dense=!1,this.url=null,this.$notifications=null,this._addWidgetProperties(["viewButtons","menus","views","selectedViewTabs","dialogs","outline","messageBoxes","notifications","fileChoosers","addOns","keyStrokes","activeForm","focusedElement"]),this._addPreserveOnPropertyChangeProperties(["focusedElement"]),this._glassPaneTargetFilters=[],this._benchActiveViewChangedHandler=this._onBenchActivateViewChanged.bind(this)}_init(e){let t=e.session||e.parent.session;t.desktop=this,e.nativeNotificationDefaults=this._createNativeNotificationDefaults(e),super._init(e),this.url=new Et,this._initTheme(),this.formController=u.create(Hf,{displayParent:this,session:this.session}),this.messageBoxController=new gl(this,this.session),this.fileChooserController=new ll(this,this.session),this._resizeHandler=this.onResize.bind(this),this._popstateHandler=this.onPopstate.bind(this),this.updateSplitterVisibility(),this.resolveTextKeys(["title"]),this._setViews(this.views),this._setViewButtons(this.viewButtons),this._setMenus(this.menus),this._setKeyStrokes(this.keyStrokes),this._setBenchLayoutData(this.benchLayoutData),this._setDisplayStyle(this.displayStyle),this._setDense(this.dense),this.openUriHandler=u.create(lf,{session:this.session}),this._glassPaneTargetFilters.push((r,s)=>{let o=u.widget(r);return!s.has(o)})}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.registerKeyStrokes([new nf(this),new df(this)])}_createNativeNotificationDefaults(e){return a().extend({title:e.title,iconId:e.logoId},e.nativeNotificationDefaults)}setNativeNotificationDefaults(e){this.setProperty("nativeNotificationDefaults",e)}_onBenchActivateViewChanged(e){if(this.initialFormRendering)return;let t=e.view;t instanceof Y&&this.bench.outlineContent!==t&&!t.detailForm&&this._setFormActivated(t)}_render(){this.$container=this.$parent,this.$container.addClass("desktop"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._resizeHandler).on("popstate",this._popstateHandler),this.$overlaySeparator=this.$container.appendDiv("overlay-separator").setVisible(!1),this._renderDense(),this._renderNavigationVisible(),this._renderHeaderVisible(),this._renderBenchVisible(),this._renderTitle(),this._renderLogoUrl(),this._renderSplitterVisible(),this._renderInBackground(),this._renderNavigationHandleVisible(),this._renderNotifications(),this._renderBrowserHistoryEntry(),this.addOns.forEach(e=>e.render()),this._setupDragAndDrop(),this._disableContextMenu()}_remove(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this.$container.window().off("resize",this._resizeHandler).off("popstate",this._popstateHandler),super._remove()}_postRender(){super._postRender(),this.initialFormRendering=!0,this._renderDisplayChildrenOfOutline(),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this.initialFormRendering=!1}_setDisplayStyle(e){this._setProperty("displayStyle",e);let t=this.displayStyle===Ie.DisplayStyle.COMPACT;if(this.header){if(this.header.tabArea){const r=Ni.DisplayStyle;this.header.tabArea.setDisplayStyle(t?r.SPREAD_EVEN:r.DEFAULT)}this.header.setToolBoxVisible(!t),this.header.animateRemoval=t}this.navigation&&(this.navigation.setToolBoxVisible(t),this.navigation.htmlComp.layoutData.fullWidth=t),this.bench&&this.bench.setOutlineContentVisible(!t),this.outline&&(this.outline.setCompact(t),this.outline.setEmbedDetailContent(t))}setDense(e){this.setProperty("dense",e)}_setDense(e){this._setProperty("dense",e),L.clearCache(),ue.get().init(this.dense?"dense":null)}_renderDense(){this.$container.toggleClass("dense",this.dense)}_createLayout(){return new tf(this)}_renderDisplayChildrenOfOutline(){!this.outline||(this.outline.formController.render(),this.outline.messageBoxController.render(),this.outline.fileChooserController.render(),this.outline.selectedViewTabs?this.outline.selectedViewTabs.forEach(e=>{this.formController._activateView(e)}):this.outline.views.filter(t=>t.modal).forEach(this.formController._activateView.bind(this.formController)))}_removeDisplayChildrenOfOutline(){!this.outline||(this.outline.formController.remove(),this.outline.messageBoxController.remove(),this.outline.fileChooserController.remove())}computeParentForDisplayParent(e){let t=e;return e instanceof fr&&(t=this),t}_renderTitle(){let e=this.title;if(e==null)return;let t=a()("div.scout");t.length<=1&&(t.document(!0).title=e)}_renderActiveForm(){}_renderBench(){this.bench||(this.bench=this._createBench(),this.bench.on("viewActivate",this._benchActiveViewChangedHandler),this.bench.render(),this.bench.$container.insertBefore(this.$overlaySeparator),this.invalidateLayoutTree())}_createBench(){return u.create(Pi,{parent:this,animateRemoval:!0,headerTabArea:this.header?this.header.tabArea:void 0,outlineContentVisible:this.displayStyle!==Ie.DisplayStyle.COMPACT})}_removeBench(){!this.bench||(this.bench.off("viewActivate",this._benchActiveViewChangedHandler),this.bench.on("destroy",()=>{this.bench=null,this.invalidateLayoutTree()}),this.bench.destroy())}_renderBenchVisible(){this.animateLayoutChange=this.rendered,this.benchVisible?(this._renderBench(),this._renderInBackground()):this._removeBench()}_renderNavigation(){this.navigation||(this.navigation=this._createNavigation(),this.navigation.render(),this.navigation.$container.prependTo(this.$container),this.$container.removeClass("navigation-invisible"),this.invalidateLayoutTree())}_createNavigation(){return u.create(zt,{parent:this,outline:this.outline,toolBoxVisible:this.displayStyle===Ie.DisplayStyle.COMPACT,layoutData:{fullWidth:this.displayStyle===Ie.DisplayStyle.COMPACT}})}_removeNavigation(){this.$container.addClass("navigation-invisible"),this.navigation&&(this.navigation.destroy(),this.navigation=null,this.invalidateLayoutTree())}_renderNavigationVisible(){this.animateLayoutChange=this.rendered,this.navigationVisible?this._renderNavigation():this.animateLayoutChange?this.invalidateLayoutTree():this._removeNavigation()}_renderHeader(){this.header||(this.header=this._createHeader(),this.header.render(),this.navigation&&this.navigation.rendered?this.header.$container.insertAfter(this.navigation.$container):this.header.$container.prependTo(this.$container),this.bench&&this.bench._setTabArea(this.header.tabArea),this.invalidateLayoutTree())}_createHeader(){let e=this.displayStyle===Ie.DisplayStyle.COMPACT;return u.create(hf,{parent:this,logoUrl:this.logoUrl,animateRemoval:e,toolBoxVisible:!e,tabArea:{displayStyle:e?Ni.DisplayStyle.SPREAD_EVEN:Ni.DisplayStyle.DEFAULT}})}_removeHeader(){!this.header||(this.header.on("destroy",()=>{this.invalidateLayoutTree(),this.header=null}),this.header.destroy())}_renderHeaderVisible(){this.headerVisible?this._renderHeader():this._removeHeader()}_renderLogoUrl(){this.header&&this.header.setLogoUrl(this.logoUrl)}_renderSplitterVisible(){this.splitterVisible?this._renderSplitter():this._removeSplitter()}_renderSplitter(){this.splitter||!this.navigation||(this.splitter=u.create(Xr,{parent:this,$anchor:this.navigation.$container,$root:this.$container}),this.splitter.render(),this.splitter.$container.insertBefore(this.$overlaySeparator),this.splitter.on("move",this._onSplitterMove.bind(this)),this.splitter.on("moveEnd",this._onSplitterMoveEnd.bind(this)),this.splitter.on("positionChange",this._onSplitterPositionChange.bind(this)),this.updateSplitterPosition())}_removeSplitter(){!this.splitter||(this.splitter.destroy(),this.splitter=null)}_renderInBackground(){this.$container.toggleClass("in-background",this.inBackground&&this.displayStyle!==Ie.DisplayStyle.COMPACT),this.bench&&this.bench.$container.toggleClass("drop-shadow",this.inBackground)}_renderBrowserHistoryEntry(){if(!F.get().supportsHistoryApi())return;let e=this.$container.window(!0),t=this.browserHistoryEntry;if(t){let r=this._createHistoryPath(t),s=(this.rendered?e.history.pushState:e.history.replaceState).bind(e.history),o={deepLinkPath:t.deepLinkPath};s(o,t.title,r)}}_createHistoryPath(e){if(!e.pathVisible)return"";let t=e.path,r=this.url.clone();if(r.removeParameter("dl"),r.removeParameter("i"),v.countOwnProperties(r.parameterMap)>0){let s=new Et(t);for(let o in r.parameterMap)s.addParameter(o,r.getParameter(o));t=s.toString({alwaysFirst:["dl","i"]})}return t}_setupDragAndDrop(){let e=t=>{t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="none"};this.$container.on("dragenter",e),this.$container.on("dragover",e),this.$container.on("drop",t=>{t.stopPropagation(),t.preventDefault()})}updateSplitterVisibility(){this.setSplitterVisible(this.navigationVisible&&this.benchVisible&&this.displayStyle!==Ie.DisplayStyle.COMPACT)}setSplitterVisible(e){this.setProperty("splitterVisible",e)}updateSplitterPosition(){if(!this.splitter)return;let e=this.cacheSplitterPosition&&this._loadCachedSplitterPosition();if(e){let t=parseInt(e,10);this.splitter.setPosition(t),this.invalidateLayoutTree()}else this.splitter.setPosition(),this.invalidateLayoutTree()}_disableContextMenu(){this.$container.on("contextmenu",e=>{e.target.nodeName!=="INPUT"&&e.target.nodeName!=="TEXTAREA"&&!e.target.isContentEditable&&e.preventDefault()})}setOutline(e){if(this.outline!==e)try{this.bench&&this.bench.setChanging(!0),this.rendered&&this._removeDisplayChildrenOfOutline(),this.outline=e,this._setDisplayStyle(this.displayStyle),this._setOutlineActivated(),this.navigation&&this.navigation.setOutline(this.outline),this.trigger("outlineChange"),this.rendered&&this._renderDisplayChildrenOfOutline()}finally{this.bench&&this.bench.setChanging(!1)}}_setViews(e){e&&e.forEach(t=>t.setDisplayParent(this)),this._setProperty("views",e)}_setViewButtons(e){this.updateKeyStrokes(e,this.viewButtons),this._setProperty("viewButtons",e)}setMenus(e){this.header&&this.header.setMenus(e)}_setMenus(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e)}_setKeyStrokes(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}setNavigationHandleVisible(e){this.setProperty("navigationHandleVisible",e)}_renderNavigationHandleVisible(){this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}setNavigationVisible(e){this.setProperty("navigationVisible",e),this.updateSplitterVisibility()}setBenchVisible(e){this.setProperty("benchVisible",e),this.updateSplitterVisibility()}setHeaderVisible(e){this.setProperty("headerVisible",e)}_setBenchLayoutData(e){e=Io.ensure(e),this._setProperty("benchLayoutData",e)}_setInBackground(e){this._setProperty("inBackground",e)}outlineDisplayStyle(){if(this.outline)return this.outline.displayStyle}shrinkNavigation(){this.outline&&this.outline.toggleBreadcrumbStyleEnabled&&this.navigationVisible&&this.outlineDisplayStyle()===fe.DisplayStyle.DEFAULT?this.outline.setDisplayStyle(fe.DisplayStyle.BREADCRUMB):this.setNavigationVisible(!1)}enlargeNavigation(){this.outline&&this.navigationVisible&&this.outlineDisplayStyle()===fe.DisplayStyle.BREADCRUMB?(this.outline.setDisplayStyle(fe.DisplayStyle.DEFAULT),this.cacheSplitterPosition&&this.splitter&&(this.validateLayoutTree(),this._storeCachedSplitterPosition(this.splitter.position))):this.setNavigationVisible(!0)}switchToBench(e){this.setHeaderVisible(u.nvl(e,!0)),this.setBenchVisible(!0),this.setNavigationVisible(!1)}switchToNavigation(){this.setNavigationVisible(!0),this.setHeaderVisible(!1),this.setBenchVisible(!1)}revalidateHeaderLayout(){this.header&&this.header.revalidateLayout()}goOffline(){this.offline||(this.offline=!0,this._removeOfflineNotification(),this._offlineNotification=u.create(_f,{parent:this}),this._offlineNotification.show())}goOnline(){this._removeOfflineNotification()}_removeOfflineNotification(){this._offlineNotification&&(setTimeout(this.removeNotification.bind(this,this._offlineNotification),3e3),this._offlineNotification=null)}addNotification(e){!e||(this.notifications.push(e),this.rendered&&this._renderNotification(e))}_renderNotification(e){this.$notifications?this.$notifications.appendTo(this.$container):this.$notifications=this.$container.appendDiv("desktop-notifications"),e.fadeIn(this.$notifications),e.duration>0&&(e.removeTimeout=setTimeout(e.hide.bind(e),e.duration),e.one("remove",()=>this.removeNotification(e)))}_renderNotifications(){this.notifications.forEach(e=>this._renderNotification(e))}removeNotification(e){let t;typeof e=="string"?t=f.find(this.notifications,r=>e===r.id):t=e,t&&(t.removeTimeout&&clearTimeout(t.removeTimeout),f.remove(this.notifications,t),this.rendered&&(t.rendered&&t.one("remove",this._onNotificationRemove.bind(this)),t.fadeOut()))}getPopups(){if(!this.$container)return[];let e=[];return this.$container.children(".popup").each((t,r)=>{let s=a()(r),o=ke.get(s);o instanceof pe&&e.push(o)}),e}getPopupsFor(e){return this.getPopups().filter(t=>e.has(t))}removePopupsFor(e){this.getPopupsFor(e).forEach(t=>t.remove())}openUri(e,t){if(!this.rendered){this._postRenderActions.push(this.openUri.bind(this,e,t));return}this.openUriHandler.openUri(e,t)}bringOutlineToFront(){if(!this.rendered){this._postRenderActions.push(this.bringOutlineToFront.bind(this));return}!this.inBackground||this.displayStyle===Ie.DisplayStyle.BENCH||(this._setInBackground(!1),this._setOutlineActivated(),this.navigationVisible&&this.navigation.bringToFront(),this.benchVisible&&this.bench.bringToFront(),this.headerVisible&&this.header.bringToFront(),this._renderInBackground())}sendOutlineToBack(){this.inBackground||(this._setInBackground(!0),this.navigationVisible&&this.navigation.sendToBack(),this.benchVisible&&this.bench.sendToBack(),this.headerVisible&&this.header.sendToBack(),this._renderInBackground())}inFront(){return!0}_glassPaneTargets(e){let t=this.$container.children().not(".splitter").not(".desktop-notifications").not(".overlay-separator");if(e){e.$container&&(t=t.not(e.$container));let s=this.$overlaySeparator.nextAll().toArray(),o=[];e.$container&&s.indexOf(e.$container[0])>-1&&(o=e.$container.nextAll().toArray());let n=null;if(s.length)for(let l=s.length-1;l>=0;l--){let d=s[l];if(!!this._isGlassPaneTargetFiltered(d,e)){n=d;break}}t=t.filter((l,d)=>o.indexOf(d)>-1||d===n?!1:this._isGlassPaneTargetFiltered(d,e))}let r;return e instanceof Y&&e.displayHint===Y.DisplayHint.VIEW?(t=t.not(".desktop-bench").not(".desktop-header"),this.header&&this.header.toolBox&&this.header.toolBox.$container&&t.push(this.header.toolBox.$container),r=a().makeArray(t),f.pushAll(r,this._getBenchGlassPaneTargetsForView(e))):r=a().makeArray(t),this._pushPopupWindowGlassPaneTargets(r,e),r}_isGlassPaneTargetFiltered(e,t){return this._glassPaneTargetFilters.every(r=>r(e,t))}addGlassPaneTargetFilter(e){this._glassPaneTargetFilters.push(e)}removeGlassPaneTargetFilter(e){f.remove(this._glassPaneTargetFilters,e)}_deferredGlassPaneTarget(e){let t=new To;return e.one("init",()=>t.ready([e.$container])),t}_getBenchGlassPaneTargetsForView(e){let t=[];return t=t.concat(this._getTabGlassPaneTargetsForView(e,this.header)),this.bench&&this.bench.visibleTabBoxes().forEach(r=>{!r.rendered||(r.hasView(e)?t=t.concat(this._getTabGlassPaneTargetsForView(e,r)):t.push(r.$container))}),t}_getTabGlassPaneTargetsForView(e,t){let r=[];return t&&t.tabArea&&t.tabArea.tabs.forEach(s=>{s.view!==e&&(r.push(s.$container),s.$container.addClass("glasspane-parent"))}),r}_pushPopupWindowGlassPaneTargets(e,t){this.formController.popupWindows.forEach(r=>{t!==r.form&&e.push(r.initialized?r.$container[0]:this._deferredGlassPaneTarget(r))})}showForm(e,t){let r=e.displayParent||this;e.setDisplayParent(r),this._setFormActivated(e),r.formController.registerAndRender(e,t,!0)}hideForm(e){if(!!e.displayParent){if(this.displayStyle===Ie.DisplayStyle.COMPACT&&e.isView()&&this.benchVisible){let t=this.bench.getViews().slice();f.remove(t,e),t.length===0&&this.switchToNavigation()}e.displayParent.formController.unregisterAndRemove(e),(!this.benchVisible||this.bench.getViews().length===0)&&this.bringOutlineToFront()}}isFormShown(e){return(e.displayParent||this).formController.isFormShown(e)}activateForm(e){if(!e){this._setFormActivated(null);return}(e.displayParent||this).formController.activateForm(e),this._setFormActivated(e),e.dialogs.forEach(r=>{r.modal&&this.activateForm(r)})}_setOutlineActivated(){this._setFormActivated(null),this.outline&&this.outline.activateCurrentPage()}_setFormActivated(e){!this.rendered||this.initialFormRendering||this.activeForm!==e&&(this.activeForm=e,e?e.displayHint===Y.DisplayHint.VIEW&&!e.detailForm&&this.bench&&this.bench.hasView(e)&&this.sendOutlineToBack():this.bringOutlineToFront(),this.triggerFormActivate(e))}triggerFormActivate(e){this.trigger("formActivate",{form:e})}cancelViews(e){this.trigger("cancelForms",{forms:e}).defaultPrevented||this._cancelViews(e)}_cancelViews(e){if(e=e.filter(s=>!f.find(s.views,o=>o.modal)),e.length===1){e[0].cancel();return}let t=e.filter(s=>{let o=!1;return s.visitDisplayChildren(n=>{n.lifecycle.requiresSave()&&(o=!0)},n=>n instanceof Y),s.lifecycle.requiresSave()||o}),r=a().resolvedPromise();if(t.length>0){let s=u.create(In,{parent:this,session:this.session,displayParent:this,unsavedForms:t});s.open(),r=s.whenSave().then(()=>{let o=s.openFormsField.value;return o.forEach(n=>{n.visitDisplayChildren(l=>{l instanceof Y?l.ok():l.close()}),n.ok()}),o})}r.then(s=>{s&&f.removeAll(e,s),e.forEach(o=>{o.visitDisplayChildren(n=>n.close()),o.close()})})}onLayoutAnimationComplete(){this.headerVisible||this._removeHeader(),this.navigationVisible||this._removeNavigation(),this.benchVisible||this._removeBench(),this.trigger("animationEnd"),this.animateLayoutChange=!1}onLayoutAnimationStep(){this.repositionTooltips()}onResize(e){this.revalidateLayoutTree()}resetPopstateHandler(){this.setPopstateHandler(this.onPopstate.bind(this))}setPopstateHandler(e){if(this.rendered||this.rendering){let t=this.$container.window();this._popstateHandler&&t.off("popstate",this._popstateHandler),e&&t.on("popstate",e)}this._popstateHandler=e}onPopstate(e){let r=e.originalEvent.state;r&&r.deepLinkPath&&this.trigger("historyEntryActivate",r)}_onSplitterMove(e){this.resizing=!0;let t=Math.floor(this.$container.outerWidth(!0)/2);e.position>t&&(e.source.setPosition(t),e.preventDefault())}_onSplitterPositionChange(e){this.htmlComp.layouting||this.revalidateLayout()}_onSplitterMoveEnd(e){let t=e.position;this.cacheSplitterPosition&&this._storeCachedSplitterPosition(this.splitter.position),t<zt.BREADCRUMB_STYLE_WIDTH?this.navigation.$container.animate({width:zt.BREADCRUMB_STYLE_WIDTH},{progress:function(){this.resizing=!0,this.splitter.setPosition(),this.revalidateLayout(),this.resizing=!1}.bind(this),complete:function(){this.resizing=!0,this.splitter.setPosition(),this.cacheSplitterPosition&&this._storeCachedSplitterPosition(this.splitter.position),this.revalidateLayout(),this.resizing=!1}.bind(this)}):this.resizing=!1}_loadCachedSplitterPosition(){return Pe.getItemFromSessionStorage("scout:desktopSplitterPosition")||Pe.getItemFromLocalStorage("scout:desktopSplitterPosition:"+window.location.pathname)}_storeCachedSplitterPosition(e){Pe.setItemToSessionStorage("scout:desktopSplitterPosition",e+""),Pe.setItemToLocalStorage("scout:desktopSplitterPosition:"+window.location.pathname,e+"")}_onNotificationRemove(e){this.notifications.length===0&&this.$notifications&&(this.$notifications.remove(),this.$notifications=null)}onReconnecting(){!this.offline||this._offlineNotification.reconnect()}onReconnectingSucceeded(){!this.offline||(this.offline=!1,this._offlineNotification.reconnectSucceeded(),this._removeOfflineNotification())}onReconnectingFailed(){!this.offline||this._offlineNotification.reconnectFailed()}dataChange(e){this.trigger("dataChange",e)}_activeTheme(){return Gl.get("scout.ui.theme")||Ie.DEFAULT_THEME}logoAction(){this.logoActionEnabled&&this.trigger("logoAction")}_initTheme(){let e=this.theme;this.url.hasParameter("theme")?e=y.nullIfEmpty(this.url.getParameter("theme"))||Ie.DEFAULT_THEME:e===null&&(e=this._activeTheme()),this.setTheme(e)}setTheme(e){this.setProperty("theme",e),this.theme!==this._activeTheme()&&this._switchTheme(e)}_switchTheme(e){Gl.set("scout.ui.theme",e,30*24*3600),a()("body").setVisible(!1);let t={clearBody:!1};this.url.hasParameter("theme")&&(this.url.removeParameter("theme"),t.redirectUrl=this.url.toString()),u.reloadPage(t)}moveOverlaysBehindAndFocus(e,t){t=a().ensure(t),t.nextAll().toArray().forEach(r=>{f.containsAll(e,[r])&&a()(r).insertBefore(t)}),t.isOrHas(t.activeElement())||this.session.focusManager.activateFocusContext(t)}adjustOverlayOrder(e){if(!this.rendered)return;let t=this.$overlaySeparator.nextAll();if(!t.is(e.$container))return;const r=t.not(e.$container),s=d=>e.findParent(p=>p.$container&&p.$container.is(d))||u.widget(d),o=d=>{let h=null;return r.toArray().reverse().some(p=>{let m=s(p);return m&&!(m instanceof Ie)&&m.has(d)?(h=m,!0):!1}),h};let n=o(e),l=r.toArray().filter(d=>{let h=s(d);return h instanceof lr&&o(h)===n});f.hasElements(l)?e.$container.insertAfter(f.last(l)):e.$container.insertAfter(n?n.$container:this.$overlaySeparator)}repositionTooltips(){this.$container.children(".tooltip").each(function(){u.widget(a()(this)).position()})}_renderTrackFocus(){this.trackFocus?this.$container[0].addEventListener("focusin",this._focusInListener,!0):this.$container[0].removeEventListener("focusin",this._focusInListener,!0)}_onFocusIn(e){super._onFocusIn(e);let t=a()(e.target),r=u.widget(t);this.setProperty("focusedElement",r)}}q(Ie,"DisplayStyle",{DEFAULT:"default",BENCH:"bench",COMPACT:"compact"}),q(Ie,"UriAction",{DOWNLOAD:"download",OPEN:"open",NEW_WINDOW:"newWindow",POPUP_WINDOW:"popupWindow",SAME_WINDOW:"sameWindow"}),q(Ie,"DEFAULT_THEME","default");class X_ extends He{constructor(){super(),this._addRemoteProperties(["benchVisible","navigationVisible","navigationHandleVisible","headerVisible","geolocationServiceAvailable","inBackground","focusedElement"])}_goOffline(){this.widget.goOffline()}_goOnline(){this.widget.goOnline()}_onWidgetHistoryEntryActivate(e){this._send("historyEntryActivate",{deepLinkPath:e.deepLinkPath})}_onWidgetFormActivate(e){e.form&&!e.form.modelAdapter||this._sendFormActivate(e.form)}_sendFormActivate(e){let t={formId:e?e.modelAdapter.id:null};this._send("formActivate",t,{coalesce:function(r){return this.target===r.target&&this.type===r.type&&!(r.formId===null&&this.formId!==null)}})}_prepareRemoteProperty(e,t){return e==="focusedElement"?t:super._prepareRemoteProperty(e,t)}_sendFocusedElement(e){for(;e&&!e.modelAdapter;)e=e.parent;this._sendProperty("focusedElement",e?e.id:null)}_logoAction(e){this._send("logoAction")}_onWidgetEvent(e){e.type==="formActivate"?this._onWidgetFormActivate(e):e.type==="historyEntryActivate"?this._onWidgetHistoryEntryActivate(e):e.type==="logoAction"?this._logoAction(e):e.type==="cancelForms"?this._onWidgetCancelAllForms(e):super._onWidgetEvent(e)}_onFormShow(e){let t=this.session.getModelAdapter(e.displayParent);if(t){let r=this.session.getOrCreateWidget(e.form,t.widget);r.setDisplayParent(t.widget),this.session.asyncEvents.some(o=>o.type==="formActivate"&&o.target===this.id)||this.addFilterForWidgetEvent(o=>o.type==="formActivate"&&o.form===r),this.widget.showForm(r,e.position)}}_onFormHide(e){if(this.session.getModelAdapter(e.displayParent)){let r=this.session.getModelAdapter(e.form);this.widget.hideForm(r.widget)}}_onFormActivate(e){let t=this.session.getWidget(e.form);this.widget.activateForm(t)}_onWidgetCancelAllForms(e){e.preventDefault();let t=[];e.forms&&(t=e.forms.map(r=>r.modelAdapter.id)),this._send("cancelForms",{formIds:t})}_onMessageBoxShow(e){let t=this.session.getModelAdapter(e.displayParent);if(t){let r=this.session.getOrCreateWidget(e.messageBox,t.widget),s=t.widget;r.setDisplayParent(s),s.messageBoxController.registerAndRender(r)}}_onMessageBoxHide(e){let t=this.session.getModelAdapter(e.displayParent);if(t){let r=this.session.getModelAdapter(e.messageBox);t.widget.messageBoxController.unregisterAndRemove(r.widget)}}_onFileChooserShow(e){let t=this.session.getModelAdapter(e.displayParent);if(t){let r=t.widget,s=this.session.getOrCreateWidget(e.fileChooser,r);s.setDisplayParent(r),r.fileChooserController.registerAndRender(s)}}_onFileChooserHide(e){let t=this.session.getModelAdapter(e.displayParent);if(t){let r=this.session.getModelAdapter(e.fileChooser);t.widget.fileChooserController.unregisterAndRemove(r.widget)}}_onOpenUri(e){this.widget.openUri(e.uri,e.action)}_onOutlineChanged(e){let t=this.session.getOrCreateWidget(e.outline,this.widget);this.widget.setOutline(t)}_onAddNotification(e){let t=this.session.getOrCreateWidget(e.notification,this.widget);this.widget.addNotification(t)}_onRemoveNotification(e){this.widget.removeNotification(e.notification)}_onOutlineContentActivate(e){this.widget.bringOutlineToFront()}_onRequestGeolocation(e){if(navigator.geolocation){let t=function(s){this._send("geolocationDetermined",{latitude:s.coords.latitude,longitude:s.coords.longitude})}.bind(this),r=function(s){this._send("geolocationDetermined",{errorCode:s.code,errorMessage:s.message})}.bind(this);navigator.geolocation.getCurrentPosition(t,r)}}onModelAction(e){e.type==="formShow"?this._onFormShow(e):e.type==="formHide"?this._onFormHide(e):e.type==="formActivate"?this._onFormActivate(e):e.type==="messageBoxShow"?this._onMessageBoxShow(e):e.type==="messageBoxHide"?this._onMessageBoxHide(e):e.type==="fileChooserShow"?this._onFileChooserShow(e):e.type==="fileChooserHide"?this._onFileChooserHide(e):e.type==="openUri"?this._onOpenUri(e):e.type==="outlineChanged"?this._onOutlineChanged(e):e.type==="outlineContentActivate"?this._onOutlineContentActivate(e):e.type==="addNotification"?this._onAddNotification(e):e.type==="removeNotification"?this._onRemoveNotification(e):e.type==="requestGeolocation"?this._onRequestGeolocation(e):super.onModelAction(e)}}function Cn(i,e,t){return e=e$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function e$(i){var e=t$(i,"string");return typeof e=="symbol"?e:String(e)}function t$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ef extends I{constructor(){super(),Cn(this,"desktop",void 0),Cn(this,"clickable",void 0),Cn(this,"url",void 0),Cn(this,"image",void 0),Cn(this,"_desktopPropertyChangeHandler",void 0),Cn(this,"_clickHandler",void 0),this.desktop=null,this.clickable=!1,this.image=null,this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this),this._clickHandler=this._onClick.bind(this)}_init(e){super._init(e),this.desktop=this.session.desktop,this.clickable=this.desktop.logoActionEnabled,this.url=e.url,this.image=u.create(_a,{parent:this,imageUrl:this.url})}_render(){this.$container=this.$parent.appendDiv("desktop-logo"),this.htmlComp=S.install(this.$container,this.session),this.image.render(),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}_renderProperties(){super._renderProperties(),this._renderClickable()}_remove(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),super._remove()}_renderClickable(){this.$container.toggleClass("clickable",this.clickable),this.clickable?this.$container.on("click",this._clickHandler):this.$container.off("click",this._clickHandler)}setUrl(e){this.setProperty("url",e),this.image.setImageUrl(e)}setClickable(e){this.setProperty("clickable",e)}_onDesktopPropertyChange(e){e.propertyName==="logoActionEnabled"&&this.setClickable(e.newValue)}_onClick(e){this.desktop.logoAction()}}function i$(i,e,t){return e=r$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function r$(i){var e=s$(i,"string");return typeof e=="symbol"?e:String(e)}function s$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class tf extends te{constructor(e){super(),i$(this,"desktop",void 0),this.desktop=e}layout(e){let t,r=0,s=0,o=this.desktop,n=o.navigation,l=o.header,d=o.bench,h=o.animateLayoutChange,p=this.containerSize(),m=n&&n.htmlComp.layoutData.fullWidth;if(ne.get().handleResponsive(o,e.width()),n&&(r=this.calculateNavigationWidth(p),o.splitter&&o.splitter.setPosition(r),o.navigationVisible)){let b=n.htmlComp,C=new A(r,p.height).subtract(b.margins());b.setSize(C)}if(l){let b=l.htmlComp;if(s=b.$comp.outerHeight(!0),o.headerVisible){h||l.$container.cssLeft(r);let C=new A(p.width-r,s).subtract(b.margins());(!h||m)&&b.setSize(C),h&&(t={left:p.width},g(t,b,C),this._animate(t,b))}}if(d){let b=d.htmlComp;if(o.benchVisible){d.$container.cssTop(s),h||d.$container.cssLeft(r);let C=new A(p.width-r,p.height-s).subtract(b.margins());if(!h||m){let P=b.size();b.setSize(C),b.size().equals(P)||o.repositionTooltips()}h&&(t={left:p.width},g(t,b,C),this._animate(t,b))}}function g(b,C,P){m?C.$comp.cssLeft(p.width):(b.width=P.width,C.setSize(P)),b.left=r}}_animate(e,t){t.$comp.is(":animated")?r.call(this):setTimeout(r.bind(this));function r(){t.$comp.stop().animate(e,{complete:this.desktop.onLayoutAnimationComplete.bind(this.desktop),step:this.desktop.onLayoutAnimationStep.bind(this.desktop)})}}containerSize(){let e=this.desktop.htmlComp;return e.availableSize({exact:!0}).subtract(e.insets())}calculateNavigationWidth(e){if(!this.desktop.navigationVisible)return 0;if(this.desktop.navigation.htmlComp.layoutData.fullWidth)return e.width;let r=0;this.desktop.splitter&&(r=this.desktop.splitter.position);let s=this.desktop.outline;return!this.desktop.resizing&&s&&s.toggleBreadcrumbStyleEnabled&&(s.displayStyle===fe.DisplayStyle.BREADCRUMB?r=zt.BREADCRUMB_STYLE_WIDTH:Math.floor(r)<=zt.BREADCRUMB_STYLE_WIDTH&&(r=zt.DEFAULT_STYLE_WIDTH)),Math.max(r,zt.MIN_WIDTH)}}class rf extends yd{_render(){super._render(),this.$container.addClass("desktop-tab"),this.$container.on("contextmenu",this._onContextMenu.bind(this)),this.$container.prependDiv("edge left"),this.$container.appendDiv("edge right")}_renderClosable(){super._renderClosable(),this.closable&&this.view.closeKeyStroke&&(this.view.closeKeyStroke.renderingHints={hAlign:ht.RIGHT,render:()=>!!this.$close,$drawingArea:()=>this.$close})}_onContextMenu(e){let t=u.create(le,{parent:this,text:this.session.text("ui.CloseAllTabs")});t.on("action",this._onCloseAll.bind(this));let r=u.create(le,{parent:this,text:this.session.text("ui.CloseOtherTabs"),enabled:this.parent.tabs.length>1});r.on("action",this._onCloseOther.bind(this)),u.create(mt,{parent:this,menuItems:[t,r],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}_onCloseAll(){let e=this.parent.tabs.map(t=>t.view);this.session.desktop.cancelViews(e)}_onCloseOther(){let e=this.parent.tabs.map(t=>t.view);f.remove(e,this.view),this.session.desktop.cancelViews(e)}}class wd extends Ni{_render(){super._render(),this.$container.addClass("desktop-tab-area")}_createLayout(){return new sf(this)}updateFirstTabSelected(){let e=this.session.desktop;if(!e.rendered)return;let t=this.getVisibleTabs()[0];e.$container.toggleClass("first-tab-selected",t&&t.selected)}getTabs(){return super.getTabs()}}class sf extends vd{constructor(e){super(e)}layout(e){super.layout(e),this.tabArea.updateFirstTabSelected()}}class Td extends wo{createTabArea(){return u.create(wd,{parent:this.tabBox})}_createTab(e){return u.create(rf,{parent:this.tabArea,view:e})}_shouldCreateTabForView(e){return!e.headerVisible}}class of extends Yn{constructor(e){super(),this.field=e,this.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),this.registerRange(_[1],()=>_[Math.min(this._viewTabs().length,9)]),this.renderingHints.$drawingArea=(t,r)=>{let s=r.which-_[1];return this._viewTabs()[s].$container},this.inheritAccessibility=!1}_isEnabled(){return super._isEnabled()&&this.field.selectViewTabsKeyStrokesEnabled&&this._viewTabs().length>0}handle(e){let t=e.which-_[1],r=this._viewTabs();if(r.length&&t<r.length){let s=r[t];this.field.bench&&this.field.bench.activateView(s.view)}}_viewTabs(){return this.field.bench?this.field.bench.getTabs():[]}}class nf extends B{constructor(e){super(),this.field=e,this.which=[_.F5],this.preventDefault=!0,this.keyStrokeFirePolicy=oe.KeyStrokeFirePolicy.ALWAYS,this.renderingHints.render=!1,this.inheritAccessibility=!1}handle(e){}}function Ms(i,e,t){return e=o$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function o$(i){var e=n$(i,"string");return typeof e=="symbol"?e:String(e)}function n$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Bs extends ir{constructor(e,t){super(),Ms(this,"myWindow",void 0),Ms(this,"form",void 0),Ms(this,"session",void 0),Ms(this,"initialized",void 0),Ms(this,"resizeToPrefSize",void 0),Ms(this,"htmlComp",void 0),Ms(this,"$container",void 0),this.myWindow=e,this.form=t,this.session=t.session,this.initialized=!1,this.$container=null,this.htmlComp=null,t.popupWindow=this,e[Bs.PROP_POPUP_WINDOW]=this,e.name="Scout popup-window "+t.modelClass}_onUnload(){a().log.isDebugEnabled()&&a().log.debug("stored form ID "+this.form.id+" to session storage"),this.form.destroyed?a().log.isDebugEnabled()&&a().log.debug("form ID "+this.form.id+" is already destroyed - don't trigger unload event"):this.trigger("popupWindowUnload",this)}_onReady(){let e=this.myWindow.document,t=a()(this.myWindow),r=a()(e);if(this.myWindow[Bs.PROP_POPUP_WINDOW]=this,u.prepareDOM(e),this.$container=a()(".scout",e),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Cr),this.$container.height(t.height()),this.form.render(this.$container),this.resizeToPrefSize){let s=this.htmlComp.prefSize(),o=new A(this.myWindow.outerWidth,this.myWindow.outerHeight),n=new A(r.width(),r.height()),l=o.width-n.width,d=o.height-n.height;this.myWindow.resizeTo(s.width+l,s.height+d),this.resizeToPrefSize=!1}this.form.htmlComp.validateLayout(),this.session.keyStrokeManager.installTopLevelKeyStrokeHandlers(this.$container),this.session.focusManager.installTopLevelMouseHandlers(this.$container),u.installGlobalMouseDownInterceptor(e),a()(this.myWindow).on("unload",this._onUnload.bind(this)).on("resize",this._onResize.bind(this)),this.myWindow.opener&&(this.myWindow.onerror=this.myWindow.opener.onerror),this._updateTitle(),this.form.on("propertyChange:title propertyChange:subTitle",s=>this._updateTitle()),this.initialized=!0,this.trigger("init")}_onResize(){let e=a()(this.myWindow),t=e.width(),r=e.height(),s=this.myWindow.screenX,o=this.myWindow.screenY;a().log.isDebugEnabled()&&a().log.debug("popup-window resize: width="+t+" height="+r+" top="+o+" left="+s),this.form.storeCacheBounds(new re(s,o,t,r));let n=new A(e.width(),e.height());this.htmlComp.setSize(n)}isClosed(){return this.myWindow.closed}close(){this.myWindow.close()}_updateTitle(){let e=y.join(" - ",this.form.title,this.form.subTitle),t=this.session.desktop.title;this.title(e||t)}title(e){this.myWindow.document.title=e}}Ms(Bs,"PROP_POPUP_WINDOW","popupWindow");function J_(i,e,t){return e=l$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function l$(i){var e=a$(i,"string");return typeof e=="symbol"?e:String(e)}function a$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class lf{constructor(){J_(this,"objectType",void 0),J_(this,"session",void 0)}init(e){this.session=e.session}openUri(e,t){a().log.isDebugEnabled()&&a().log.debug("(OpenUriHandler#openUri) uri="+e+" action="+t),e&&(t=u.nvl(t,Ie.UriAction.OPEN),t===Ie.UriAction.DOWNLOAD?this.handleUriActionDownload(e):t===Ie.UriAction.OPEN?this.handleUriActionOpen(e):t===Ie.UriAction.NEW_WINDOW?this.handleUriActionNewWindow(e):t===Ie.UriAction.POPUP_WINDOW?this.handleUriActionPopupWindow(e):t===Ie.UriAction.SAME_WINDOW&&this.handleUriActionSameWindow(e))}handleUriActionDownload(e){F.get().isIos()?F.get().isStandalone()?this.openUriInSameWindow(e):this.openUriAsNewWindow(e):F.get().browser===F.Browser.CHROME&&this.isUriWithExternallyHandledProtocol(e)?this.openUriInSameWindow(e):this.openUriInIFrame(e)}isUriWithExternallyHandledProtocol(e){return/^(callto|facetime|fax|geo|mailto|maps|notes|sip|skype|tel|google.navigation|sms|msteams):/.test(e)}handleUriActionOpen(e){F.get().isIos()?this.openUriInSameWindow(e):this.isUriWithExternallyHandledProtocol(e)?F.get().browser===F.Browser.CHROME||F.get().isAndroid()?this.openUriInSameWindow(e):this.openUriInIFrame(e):this.openUriAsNewWindow(e)}handleUriActionNewWindow(e){this.openUriAsNewWindow(e)}handleUriActionPopupWindow(e){this.openUriAsPopupWindow(e)}handleUriActionSameWindow(e){this.openUriInSameWindow(e)}openUriInSameWindow(e){window.location.assign(e)}openUriInIFrame(e){let t=this.session.$entryPoint.appendElement("<iframe>","download-frame").attr("tabindex",-1).attr("src",e);setTimeout(()=>{t.remove()},10*1e3)}openUriAsNewWindow(e){u.create(Pn,{session:this.session}).openWindow(e)}openUriAsPopupWindow(e){u.create(Pn,{session:this.session}).openWindow(e,null,"location=no,toolbar=no,menubar=no,resizable=yes,scrollbars=yes")}}function De(i,e,t){return e=d$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function d$(i){var e=h$(i,"string");return typeof e=="symbol"?e:String(e)}function h$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Pi extends I{constructor(){super(),De(this,"desktop",void 0),De(this,"outline",void 0),De(this,"outlineContent",void 0),De(this,"navigationHandle",void 0),De(this,"headerTabArea",void 0),De(this,"columns",void 0),De(this,"components",void 0),De(this,"tabBoxMap",void 0),De(this,"layoutData",void 0),De(this,"headerTabAreaController",void 0),De(this,"changingCounter",void 0),De(this,"changed",void 0),De(this,"outlineContentVisible",void 0),De(this,"navigationHandleVisible",void 0),De(this,"layoutCacheKey",void 0),De(this,"desktopKeyStrokeContext",void 0),De(this,"_removeViewInProgress",void 0),De(this,"_updateOutlineContentTimeout",void 0),De(this,"_desktopOutlineChangeHandler",void 0),De(this,"_desktopPropertyChangeHandler",void 0),De(this,"_desktopAnimationEndHandler",void 0),De(this,"_outlineNodesSelectedHandler",void 0),De(this,"_outlinePageChangedHandler",void 0),De(this,"_outlinePropertyChangeHandler",void 0),De(this,"_outlineContentDestroyHandler",void 0),De(this,"_outlineContentCssClassChangeHandler",void 0),De(this,"_viewAddHandler",void 0),De(this,"_viewRemoveHandler",void 0),De(this,"_viewActivateHandler",void 0),De(this,"_viewDeactivateHandler",void 0),this.columns=[],this.components=null,this.tabBoxMap={},this._removeViewInProgress=0,this.changingCounter=0,this.changed=!1,this.layoutCacheKey=[],this._desktopOutlineChangeHandler=this._onDesktopOutlineChange.bind(this),this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this),this._desktopAnimationEndHandler=this._onDesktopAnimationEnd.bind(this),this._outlineNodesSelectedHandler=this._onOutlineNodesSelected.bind(this),this._outlinePageChangedHandler=this._onOutlinePageChanged.bind(this),this._outlinePropertyChangeHandler=this._onOutlinePropertyChange.bind(this),this._outlineContentDestroyHandler=this._onOutlineContentDestroy.bind(this),this._outlineContentCssClassChangeHandler=this._onOutlineContentCssClassChange.bind(this),this._viewAddHandler=this._onViewAdd.bind(this),this._viewRemoveHandler=this._onViewRemove.bind(this),this._viewActivateHandler=this._onViewActivate.bind(this),this._viewDeactivateHandler=this._onViewDeactivate.bind(this)}_init(e){super._init(e),Pi.VIEW_MIN_HEIGHT=a().pxToNumber(L.get("view-tab-box","min-height").minHeight),Pi.VIEW_MIN_WIDTH=a().pxToNumber(L.get("view-tab-box","min-width").minWidth),this.desktop=this.session.desktop,this.setLayoutData(this.desktop.benchLayoutData),this._createColumns(),this.headerTabArea=e.headerTabArea,this.headerTabArea&&(this.headerTabAreaController=u.create(uf),this.headerTabAreaController.install(this,this.headerTabArea)),this.outlineContentVisible=u.nvl(e.outlineContentVisible,!0),this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}_setTabArea(e){if(this.headerTabArea=e,this.headerTabAreaController){this.headerTabAreaController.install(this,this.headerTabArea);let t=this.getTabBox("C");t.viewStack.slice().reverse().forEach(r=>{this.headerTabAreaController._onViewAdd({view:r}),t.currentView===r&&this.headerTabAreaController._onViewActivate({view:r})}),this.headerTabAreaController._onViewsChanged()}}_createColumns(){let e=this.getLayoutData(),t=[];e&&(t=this.getLayoutData().getColumns());for(let r=0;r<3;r++){let s=this.layoutCacheKey.slice();s.length>0&&s.push("column"+r);let o=u.create(vr,{parent:this,layoutData:t[r],cacheKey:s,cssClass:Pi.VIEW_AREA_COLUMN_CLASSES[r]});o.on("viewAdd",this._viewAddHandler),o.on("viewRemove",this._viewRemoveHandler),o.on("viewActivate",this._viewActivateHandler),o.on("viewDeactivate",this._viewDeactivateHandler),this.columns.push(o)}}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.desktopKeyStrokeContext=new Oe,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke(new of(this.desktop))}_render(){this.$container=this.$parent.appendDiv("desktop-bench"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData(),this._renderColumns(),this._revalidateSplitters(),this._renderNavigationHandleVisible(),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler)}_createLayout(){return new ls(ls.Direction.ROW,this.layoutCacheKey)}visibleColumns(){return this.columns.filter(e=>e.hasViews())}_renderColumns(){this.visibleColumns().forEach(e=>this._renderColumn(e)),this.updateFirstLastMarker()}_renderColumn(e){!e||e.rendered||e.render()}_remove(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),super._remove()}updateFirstLastMarker(){ke.updateFirstLastMarker(this.visibleColumns())}_renderOutlineContent(){!this.outlineContent||(delete this.outlineContent.title,delete this.outlineContent.subTitle,delete this.outlineContent.iconId,this.addView(this.outlineContent,!this.desktop.inBackground),this.desktop.rendered&&this.session.focusManager.validateFocus())}_removeOutlineContent(){!this.outlineContent||this.removeView(this.outlineContent,!1)}_createNavigationHandle(){return u.create(Cd,{parent:this,leftVisible:!1})}_renderNavigationHandle(){this.navigationHandle||(this.navigationHandle=this._createNavigationHandle(),this.navigationHandle.render(),this.navigationHandle.addCssClass("navigation-closed"),this.navigationHandle.on("action",this._onNavigationHandleAction.bind(this)))}_removeNavigationHandle(){!this.navigationHandle||(this.navigationHandle.destroy(),this.navigationHandle=null)}_renderNavigationHandleVisible(){this.navigationHandleVisible?this._renderNavigationHandle():this._removeNavigationHandle(),this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}postRender(){this.columns.forEach(e=>e.postRender())}setChanging(e){e?this.changingCounter++:this.changingCounter--,this.changingCounter===0&&this.changed&&this.rendered&&(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.changed=!1)}updateLayoutData(e){if(this.getLayoutData()===e)return;this.setLayoutData(e);let t=e.getColumns();if(this.columns.forEach((r,s)=>{let o;this.layoutCacheKey&&this.layoutCacheKey.length>0&&(o=this.layoutCacheKey.slice(),o.push("column"+s)),r.updateLayoutData(t[s],o)}),this.rendered){let r=this.htmlComp.layout;r.setCacheKey(this.layoutCacheKey),r.reset(),this.htmlComp.invalidateLayoutTree()}this._updateSplitterMovable()}setLayoutData(e){this.layoutData!==e&&(super.setLayoutData(e),this.layoutData=e,this.layoutCacheKey=[],e.cacheKey&&this.layoutCacheKey.push(e.cacheKey))}getLayoutData(){return this.layoutData}setNavigationHandleVisible(e){this.setProperty("navigationHandleVisible",e)}setOutline(e){this.outline&&(this.outline.off("nodesSelected",this._outlineNodesSelectedHandler),this.outline.off("pageChanged",this._outlinePageChangedHandler),this.outline.off("propertyChange",this._outlinePropertyChangeHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodesSelected",this._outlineNodesSelectedHandler),this.outline.on("pageChanged",this._outlinePageChangedHandler),this.outline.on("propertyChange",this._outlinePropertyChangeHandler)),this.updateOutlineContent()}setOutlineContent(e){if(this.outlineContent===e)return;let t=this.outlineContent;t&&(t.off("destroy",this._outlineContentDestroyHandler),t.off("propertyChange:cssClass",this._outlineContentCssClassChangeHandler)),this.rendered&&this._removeOutlineContent(),e&&(e.one("destroy",this._outlineContentDestroyHandler),e.on("propertyChange:cssClass",this._outlineContentCssClassChangeHandler)),this._setProperty("outlineContent",e),this.desktop.header&&this.desktop.header.onBenchOutlineContentChange(e,t),this._updateOutlineContentHasDimmedBackground(),this._renderOutlineContent()}setOutlineContentVisible(e){e!==this.outlineContentVisible&&(this._setProperty("outlineContentVisible",e),this.updateOutlineContent())}bringToFront(){!this.outlineContent||this._renderOutlineContent()}sendToBack(){}_updateOutlineContentHasDimmedBackground(){if(!this.outlineContent)return;let e=!1;this.outlineContent.cssClass&&(e=this.outlineContent.cssClass.indexOf("dimmed-background")>-1),this.toggleCssClass("outline-content-has-dimmed-background",e)}_computeDetailContentForPage(e){if(!e)throw new Error("called _showDetailContentForPage without node");let t;return e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi?(t=e.detailForm,t.uiCssClass="detail-form"):e.detailTable&&e.detailTableVisible&&(t=e.detailTable,t.uiCssClass="detail-table perma-focus"),t}updateOutlineContent(){if(!this.outlineContentVisible||!this.outline)return;let e,t=this.outline.selectedNode();t?e=this._computeDetailContentForPage(t):e=this.outline.getRootContent(),e&&(e instanceof W&&(e.menuBar.addCssClass("main-menubar"),e.menuBar.removeCssClass("bounded")),e.displayViewId="C"),this.setOutlineContent(e)}updateOutlineContentDebounced(){clearTimeout(this._updateOutlineContentTimeout),this._updateOutlineContentTimeout=setTimeout(()=>this.updateOutlineContent(),300)}updateNavigationHandleVisibility(){this.setNavigationHandleVisible(this.desktop.navigationHandleVisible&&!this.desktop.navigationVisible)}_onDesktopOutlineChange(e){this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}_onOutlineContentDestroy(e){e.source===this.outlineContent&&this.setOutlineContent(null)}_onOutlineContentCssClassChange(e){this._updateOutlineContentHasDimmedBackground()}_onOutlineNodesSelected(e){e.debounce?this.updateOutlineContentDebounced():this.updateOutlineContent()}_onOutlinePageChanged(e){let t=this.outline.selectedNode();(!e.page&&!t||e.page===t)&&this.updateOutlineContent()}_onOutlinePropertyChange(e){u.isOneOf(e.propertyName,["defaultDetailForm","outlineOverview"])&&this.updateOutlineContent()}_onDesktopNavigationVisibleChange(){this.desktop.navigationVisible&&this.updateNavigationHandleVisibility()}_onDesktopNavigationHandleVisibleChange(){this.updateNavigationHandleVisibility()}_onDesktopAnimationEnd(e){this.desktop.navigationVisible||this.updateNavigationHandleVisibility()}_onBenchLayoutDataChange(){this.updateLayoutData(this.desktop.benchLayoutData)}_onDesktopPropertyChange(e){e.propertyName==="navigationVisible"?this._onDesktopNavigationVisibleChange():e.propertyName==="navigationHandleVisible"&&this._onDesktopNavigationHandleVisibleChange(),e.propertyName==="benchLayoutData"&&this._onBenchLayoutDataChange()}_onNavigationHandleAction(e){this.desktop.enlargeNavigation()}_revalidateSplitters(){this.components&&this.components.forEach(e=>{e instanceof Xr&&e.destroy()}),this.components=this.visibleColumns().reduce((e,t)=>{if(e.length>0){let r=u.create(Xr,{parent:this,$anchor:e[e.length-1].$container,$root:this.$container});r.render(),r.setLayoutData(ks.fixed().withOrder(t.getLayoutData().order-1)),r.$container.addClass("line"),e.push(r)}return e.push(t),e},[]),this.components.filter(e=>e instanceof vr).reduce((e,t,r)=>(r>0&&t.$container.insertAfter(e.$container),t),void 0),this._updateSplitterMovable()}_updateSplitterMovable(){!this.components||this.components.forEach((e,t)=>{if(e instanceof Xr){let r=this.components.slice(0,t).reverse(),s=this.components.slice(t+1);if(r.filter(o=>o.getLayoutData().shrink>0).length>0&&s.filter(o=>o.getLayoutData().grow>0).length>0){e.setEnabled(!0),e.on("move",this._onSplitterMove.bind(this));return}if(r.filter(o=>o.getLayoutData().grow>0).length>0&&s.filter(o=>o.getLayoutData().shrink>0).length>0){e.setEnabled(!0),e.on("move",this._onSplitterMove.bind(this));return}e.setEnabled(!1)}})}_onSplitterMove(e){let t=e.source,r=e.position-t.htmlComp.location().x-t.htmlComp.margins().left-t.htmlComp.insets().left;t.getLayoutData().diff=r,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}_onViewAdd(e){this.trigger("viewAdd",{view:e.view})}_onViewRemove(e){this.trigger("viewRemove",{view:e.view})}_onViewActivate(e){let t=e.view;this.outlineContent===t&&this.desktop.bringOutlineToFront(),this.trigger("viewActivate",{view:t})}_onViewDeactivate(e){this.outlineContent===e.view&&this.desktop.sendOutlineToBack(),this.trigger("viewDeactivate",{view:e.view})}addView(e,t){switch(e.displayViewId){case"NW":case"W":case"SW":case"N":case"C":case"S":case"NE":case"E":case"SE":break;default:e.displayViewId="C";break}let r=this._getColumn(e.displayViewId);this.tabBoxMap[e.id]=r,r.addView(e,t),this.rendered&&r.viewCount()===1&&(this._renderColumn(r),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree()))}activateView(e){if(!this.hasView(e))return;let t=this._getColumn(e.displayViewId);t&&t.activateView(e)}_getColumn(e){let t;switch(e){case"NW":case"W":case"SW":t=this.columns[Pi.VIEW_AREA_COLUMN_INDEX.LEFT];break;case"NE":case"E":case"SE":t=this.columns[Pi.VIEW_AREA_COLUMN_INDEX.RIGHT];break;default:t=this.columns[Pi.VIEW_AREA_COLUMN_INDEX.CENTER];break}return t}removeView(e,t){let r=this.tabBoxMap[e.id];r&&(this._removeViewInProgress++,r.removeView(e,t),this._removeViewInProgress--,delete this.tabBoxMap[e.id],this.rendered&&r.viewCount()===0&&this._removeViewInProgress===0&&(r.remove(),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())))}getComponents(){return this.components}getTabBox(e){let t=this._getColumn(e);if(!!t)return t.getTabBox(e)}visibleTabBoxes(){return this.visibleColumns().reduce((e,t)=>(f.pushAll(e,t.visibleTabBoxes()),e),[])}hasView(e){return this.columns.filter(t=>t.hasView(e)).length>0}getViews(e){return this.columns.reduce((t,r)=>(f.pushAll(t,r.getViews(e)),t),[])}getViewTab(e){let t=null;return this.getTabs().some(r=>r.view===e?(t=r,!0):!1),t}getTabs(){let e=[];return e=e.concat(this._getTabsForDisplayViewId("NW")),e=e.concat(this._getTabsForDisplayViewId("W")),e=e.concat(this._getTabsForDisplayViewId("SW")),e=e.concat(this._getTabsForDisplayViewId("N")),this.headerTabAreaController?e=e.concat(this.headerTabAreaController.getTabs()):e=e.concat(this._getTabsForDisplayViewId("C")),e=e.concat(this._getTabsForDisplayViewId("S")),e=e.concat(this._getTabsForDisplayViewId("NE")),e=e.concat(this._getTabsForDisplayViewId("E")),e=e.concat(this._getTabsForDisplayViewId("SE")),e}_getTabsForDisplayViewId(e){return this.getTabBox(e).getController().getTabs()}activeViews(){let e=[];return this.visibleColumns().forEach(t=>{t.visibleTabBoxes().forEach(r=>{e.push(r.currentView)})}),e}}De(Pi,"VIEW_MIN_HEIGHT",null),De(Pi,"VIEW_MIN_WIDTH",null),De(Pi,"VIEW_AREA_COLUMN_INDEX",{LEFT:0,CENTER:1,RIGHT:2}),De(Pi,"VIEW_AREA_COLUMN_CLASSES",["west","center","east"]);function Ji(i,e,t){return e=u$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function u$(i){var e=c$(i,"string");return typeof e=="symbol"?e:String(e)}function c$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vr extends I{constructor(){super(),Ji(this,"tabBoxes",void 0),Ji(this,"layoutData",void 0),Ji(this,"components",void 0),Ji(this,"layoutCacheKey",void 0),Ji(this,"_widgetToTabBox",void 0),Ji(this,"_removeViewInProgress",void 0),Ji(this,"_viewAddHandler",void 0),Ji(this,"_viewRemoveHandler",void 0),Ji(this,"_viewActivateHandler",void 0),Ji(this,"_viewDeactivateHandler",void 0),this.tabBoxes=[],this._widgetToTabBox={},this.components=null,this._removeViewInProgress=0,this._viewAddHandler=this._onViewAdd.bind(this),this._viewRemoveHandler=this._onViewRemove.bind(this),this._viewActivateHandler=this._onViewActivate.bind(this),this._viewDeactivateHandler=this._onViewDeactivate.bind(this)}_init(e){super._init(e),this.layoutData=e.layoutData,this.layoutCacheKey=e.cacheKey,this.cssClass=e.cssClass,this._createTabBoxes()}_render(){this.$container=this.$parent.appendDiv("bench-column"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData()}_renderProperties(){super._renderProperties(),this._renderTabBoxes(),this._revalidateSplitters()}_renderTabBoxes(){this.visibleTabBoxes().forEach(e=>this._renderTabBox(e)),this.updateFirstLastMarker()}_renderTabBox(e){e.rendered||(e.render(),e.htmlComp.validateRoot=!0)}postRender(){this.tabBoxes.forEach(e=>e.postRender())}_createLayout(){return new ls(ls.Direction.COLUMN,this.layoutCacheKey)}updateLayoutData(e,t){if(this.getLayoutData()===e)return;this.layoutCacheKey=t,this.setLayoutData(e);let r=this.layoutData.getRows();if(this.tabBoxes.forEach((s,o)=>s.setLayoutData(r[o])),this._updateSplitterMovable(),this.rendered){let s=this.htmlComp.layout;s.setCacheKey(this.layoutCacheKey),s.reset(),this.htmlComp.invalidateLayoutTree()}}setLayoutData(e){super.setLayoutData(e),this.layoutData=e}getLayoutData(){return this.layoutData}_onViewAdd(e){this.trigger("viewAdd",{view:e.view})}_onViewRemove(e){this.trigger("viewRemove",{view:e.view})}_onViewActivate(e){this.trigger("viewActivate",{view:e.view})}_onViewDeactivate(e){this.trigger("viewDeactivate",{view:e.view})}activateView(e){this.getTabBox(e.displayViewId).activateView(e)}_createTabBoxes(){let e=[];this.layoutData&&(e=this.layoutData.getRows());for(let t=0;t<3;t++){let r=u.create(ia,{parent:this,cssClass:y.join(" ","view-tab-box",vr.TAB_BOX_CLASSES[t]),controller:u.create(Td)});r.setLayoutData(e[t]),r.on("viewAdd",this._viewAddHandler),r.on("viewRemove",this._viewRemoveHandler),r.on("viewActivate",this._viewActivateHandler),r.on("viewDeactivate",this._viewDeactivateHandler),this.tabBoxes.push(r)}}_revalidateSplitters(){this.components&&this.components.forEach(e=>{e instanceof Xr&&e.destroy()}),this.components=this.visibleTabBoxes().reduce((e,t)=>{if(e.length>0){let r=u.create(Xr,{parent:this,$anchor:e[e.length-1].$container,$root:this.$container,splitHorizontal:!1});r.render(),r.setLayoutData(ks.fixed().withOrder(this._getTabBoxLayoutData(t).order-1)),r.$container.addClass("line"),e.push(r)}return e.push(t),e},[]),this.components.filter(e=>e instanceof ia).reduce((e,t,r)=>(r>0&&t.$container.insertAfter(e.$container),t),void 0),this._updateSplitterMovable()}_getTabBoxLayoutData(e){return e.getLayoutData()}_updateSplitterMovable(){!this.components||this.components.forEach((e,t)=>{if(e instanceof Xr){let r=this.components.slice(0,t).reverse(),s=this.components.slice(t+1);if(r.filter(o=>this._getTabBoxLayoutData(o).shrink>0).length>0&&s.filter(o=>this._getTabBoxLayoutData(o).grow>0).length>0){e.setEnabled(!0),e.on("move",this._onSplitterMove.bind(this));return}if(r.filter(o=>this._getTabBoxLayoutData(o).grow>0).length>0&&s.filter(o=>this._getTabBoxLayoutData(o).shrink>0).length>0){e.setEnabled(!0),e.on("move",this._onSplitterMove.bind(this));return}e.setEnabled(!1)}})}_onSplitterMove(e){let t=e.source,r=e.position-t.htmlComp.location().y-t.htmlComp.margins().top-t.htmlComp.insets().top;t.getLayoutData().diff=r,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}addView(e,t){let r=this.getTabBox(e.displayViewId);this._widgetToTabBox[e.id]=r,r.addView(e,t),this.rendered&&r.viewCount()===1&&(r.rendered||r.render(),this._revalidateSplitters(),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())}getTabBox(e){let t;switch(e){case"NW":case"N":case"NE":t=this.tabBoxes[vr.TAB_BOX_INDEX.TOP];break;case"SW":case"S":case"SE":t=this.tabBoxes[vr.TAB_BOX_INDEX.BOTTOM];break;default:t=this.tabBoxes[vr.TAB_BOX_INDEX.CENTER];break}return t}removeView(e,t){let r=this._widgetToTabBox[e.id];r&&(this._removeViewInProgress++,r.removeView(e,t),this._removeViewInProgress--,delete this._widgetToTabBox[e.id],this.rendered&&r.viewCount()===0&&this._removeViewInProgress===0&&(r.remove(),this._revalidateSplitters(),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree()))}viewCount(){return this.tabBoxes.map(e=>e.viewCount()).reduce((e,t)=>e+t,0)}hasView(e){return this.tabBoxes.filter(t=>t.hasView(e)).length>0}hasViews(){return this.viewCount()>0}getViews(e){return this.tabBoxes.reduce((t,r)=>(f.pushAll(t,r.getViews(e)),t),[])}getComponents(){return this.components}visibleTabBoxes(){return this.tabBoxes.filter(e=>e.hasViews())}updateFirstLastMarker(){ke.updateFirstLastMarker(this.visibleTabBoxes())}}Ji(vr,"TAB_BOX_INDEX",{TOP:0,CENTER:1,BOTTOM:2}),Ji(vr,"TAB_BOX_CLASSES",["north","center","south"]);function p$(i,e,t){return e=f$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function f$(i){var e=m$(i,"string");return typeof e=="symbol"?e:String(e)}function m$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class af extends ks{constructor(e){super(e),p$(this,"rows",void 0),e=e||{},this.rows=u.nvl(e.rows,[null,null,null]),this._ensureRows()}getRows(){return this.rows}_ensureRows(){this.rows=this.rows.map((e,t)=>new ks(e).withOrder(t*2))}}function g$(i,e,t){return e=_$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _$(i){var e=b$(i,"string");return typeof e=="symbol"?e:String(e)}function b$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Io{constructor(e){g$(this,"columns",void 0),this.columns=[null,null,null],a().extend(this,e),this._ensureColumns()}_ensureColumns(){this.columns=this.columns.map((e,t)=>new af(e).withOrder(t*2))}getColumns(){return this.columns}static ensure(e){return e?e instanceof Io?e:new Io(e):new Io}}class df extends Yn{constructor(e){super(),this.field=e,this.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),this.registerRange(_[1],_[9]),this.renderingHints.render=!1,this.preventDefault=!0,this.inheritAccessibility=!1}_isEnabled(){return super._isEnabled()&&this.field.selectViewTabsKeyStrokesEnabled}handle(e){}}function yi(i,e,t){return e=y$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function y$(i){var e=v$(i,"string");return typeof e=="symbol"?e:String(e)}function v$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hf extends I{constructor(){super(),yi(this,"desktop",void 0),yi(this,"tabArea",void 0),yi(this,"logoUrl",void 0),yi(this,"logo",void 0),yi(this,"toolBoxVisible",void 0),yi(this,"toolBox",void 0),yi(this,"viewButtonBoxVisible",void 0),yi(this,"viewButtonBox",void 0),yi(this,"outlineContent",void 0),yi(this,"_desktopPropertyChangeHandler",void 0),yi(this,"_desktopAnimationEndHandler",void 0),yi(this,"_outlineContentMenuBarVisibleChangeHandler",void 0),yi(this,"_outlineContentCssClassChangeHandler",void 0),yi(this,"_viewButtonBoxPropertyChangeHandler",void 0),this.tabArea=null,this.toolBoxVisible=!0,this.viewButtonBox=null,this.viewButtonBoxVisible=!1,this.outlineContent=null,this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this),this._desktopAnimationEndHandler=this._onDesktopAnimationEnd.bind(this),this._outlineContentMenuBarVisibleChangeHandler=this._onOutlineContentMenuBarVisibleChange.bind(this),this._outlineContentCssClassChangeHandler=this._onOutlineContentCssClassChange.bind(this),this._viewButtonBoxPropertyChangeHandler=this._onViewButtonBoxPropertyChange.bind(this)}_init(e){super._init(e),this.desktop=this.session.desktop,this.updateViewButtonBoxVisibility(),this.tabArea=this._createTabArea()}_createTabArea(){return u.create(wd,$.extend({parent:this},this.tabArea))}_render(){this.$container=this.$parent.appendDiv("desktop-header"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new cf(this)),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler),this.desktop.bench&&this._setOutlineContent(this.desktop.bench.outlineContent)}_renderProperties(){super._renderProperties(),this._renderViewButtonBoxVisible(),this._renderViewTabs(),this._renderToolBoxVisible(),this._renderLogoUrl(),this._renderInBackground()}_remove(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this._setOutlineContent(null),super._remove()}_renderViewTabs(){this.tabArea.render()}_renderToolBox(){this.toolBox||(this.toolBox=this._createToolBox(),this.toolBox.render())}_createToolBox(){return u.create(xd,{parent:this,menus:this.desktop.menus})}_removeToolBox(){!this.toolBox||(this.toolBox.destroy(),this.toolBox=null)}_renderToolBoxVisible(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox(),this.invalidateLayoutTree()}_renderLogoUrl(){this.logoUrl?this._renderLogo():this._removeLogo(),this.invalidateLayoutTree()}_renderLogo(){this.desktop.displayStyle!==Ie.DisplayStyle.COMPACT&&(this.logo?this.logo.setUrl(this.logoUrl):(this.logo=this._createLogo(),this.logo.render()))}_createLogo(){return u.create(ef,{parent:this,url:this.logoUrl})}_removeLogo(){!this.logo||(this.logo.destroy(),this.logo=null)}_renderViewButtonBox(){this.viewButtonBox||(this.viewButtonBox=this._createViewButtonBox(),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.render(),this.viewButtonBox.$container.prependTo(this.$container),this.updateViewButtonStyling())}_createViewButtonBox(){return u.create(Fd,{parent:this,viewButtons:this.desktop.viewButtons,selectedMenuButtonAlwaysVisible:!0})}_removeViewButtonBox(){!this.viewButtonBox||(this.viewButtonBox.off("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.destroy(),this.viewButtonBox=null)}_renderViewButtonBoxVisible(){this.viewButtonBoxVisible?this._renderViewButtonBox():this._removeViewButtonBox(),this.$container.toggleClass("has-view-button-box",this.viewButtonBoxVisible),this.invalidateLayoutTree()}sendToBack(){this.rendered&&this._renderInBackground()}bringToFront(){this.rendered&&this._renderInBackground()}_renderInBackground(){this.$container.toggleClass("in-background",this.desktop.inBackground)}setLogoUrl(e){this.setProperty("logoUrl",e)}setToolBoxVisible(e){this.setProperty("toolBoxVisible",e)}setViewButtonBoxVisible(e){this.setProperty("viewButtonBoxVisible",e)}setMenus(e){this.toolBox&&this.toolBox.setMenus(e)}_setOutlineContent(e){this.outlineContent!==e&&(this._detachOutlineContentHandlers(),this._setProperty("outlineContent",e),this._attachOutlineContentHandlers(),this.updateViewButtonStyling())}updateViewButtonBoxVisibility(){this.setViewButtonBoxVisible(this.desktop.viewButtons.some(e=>e.visible)&&!this.desktop.navigationVisible&&this.desktop.displayStyle!==Ie.DisplayStyle.COMPACT)}_attachOutlineContentHandlers(){this._attachOutlineContentMenuBarHandler(),this._attachOutlineContentCssClassHandler()}_attachOutlineContentMenuBarHandler(){if(!this.outlineContent)return;let e=this._outlineContentMenuBar(this.outlineContent);e&&e.on("propertyChange:visible",this._outlineContentMenuBarVisibleChangeHandler)}_attachOutlineContentCssClassHandler(){!this.outlineContent||this.outlineContent.on("propertyChange:cssClass",this._outlineContentCssClassChangeHandler)}_detachOutlineContentHandlers(){this._detachOutlineContentMenuBarHandler(),this._detachOutlineContentCssClassHandler()}_detachOutlineContentMenuBarHandler(){if(!this.outlineContent)return;let e=this._outlineContentMenuBar(this.outlineContent);e&&e.off("propertyChange:visible",this._outlineContentMenuBarVisibleChangeHandler)}_detachOutlineContentCssClassHandler(){!this.outlineContent||this.outlineContent.off("propertyChange:cssClass",this._outlineContentCssClassChangeHandler)}_outlineContentMenuBar(e){return e instanceof Y?e.rootGroupBox.menuBar:e.menuBar}updateViewButtonStyling(){this._updateOutlineContentHasMenuBar(),this._updateOutlineContentHasDimmedBackground()}_getOutlineContentForViewButtonStyling(){if(!(!this.viewButtonBoxVisible||!this.outlineContent||!this.outlineContent.visible))return this.outlineContent}_updateOutlineContentHasMenuBar(){let e=this._getOutlineContentForViewButtonStyling();if(!e)return;let t=!1;if(e instanceof Y&&e.detailForm){let r=e.rootGroupBox;t=r.menuBar&&r.menuBarVisible&&r.menuBar.visible}else{let r=e;t=r.menuBar&&r.menuBar.visible}this.$container.toggleClass("outline-content-has-menubar",!!t)}_updateOutlineContentHasDimmedBackground(){let e=this._getOutlineContentForViewButtonStyling();if(!e)return;let t=!1;e.cssClass&&(t=e.cssClass.indexOf("dimmed-background")>-1),this.$container.toggleClass("outline-content-has-dimmed-background",t)}_onDesktopNavigationVisibleChange(){this.desktop.navigationVisible&&this.updateViewButtonBoxVisibility()}_onDesktopAnimationEnd(e){this.updateViewButtonBoxVisibility()}onBenchOutlineContentChange(e,t){this._setOutlineContent(e)}_onDesktopPropertyChange(e){e.propertyName==="navigationVisible"&&this._onDesktopNavigationVisibleChange()}_onOutlineContentMenuBarVisibleChange(e){this._updateOutlineContentHasMenuBar()}_onOutlineContentCssClassChange(e){this._updateOutlineContentHasDimmedBackground()}_onViewButtonBoxPropertyChange(e){(e.propertyName==="menuButtons"||e.propertyName==="tabButtons")&&this.invalidateLayoutTree()}}function Sd(i,e,t){return e=w$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function w$(i){var e=T$(i,"string");return typeof e=="symbol"?e:String(e)}function T$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class uf extends Td{constructor(){super(),Sd(this,"bench",void 0),Sd(this,"tabAreaCenter",void 0),Sd(this,"tabAreaInHeader",void 0),Sd(this,"_viewsChangedHandler",void 0),this.bench=null,this._viewsChangedHandler=this._onViewsChanged.bind(this),this.tabAreaCenter=null,this.tabAreaInHeader=!1}install(e,t){this.bench=u.assertParameter("bench",e);let r=this.bench.getTabBox("C");this.tabAreaCenter=r.tabArea,super.install(r,t)}_installListeners(){super._installListeners(),this.bench.on("viewAdd",this._viewsChangedHandler),this.bench.on("viewRemove",this._viewsChangedHandler)}_onViewsChanged(){this.bench.getViews().some(e=>e.displayViewId!=="C")?this._setViewTabAreaInHeader(!1):this._setViewTabAreaInHeader(!0)}_setViewTabAreaInHeader(e){this.tabAreaInHeader=e,this.tabAreaCenter.setVisible(!e),this.tabArea.setVisible(e);let t=this.tabArea.session.desktop;t.rendered&&t.$container.toggleClass("view-tab-area-in-bench",!e)}getTabs(){return this.tabAreaInHeader?this.tabArea.getTabs():this.tabAreaCenter.getTabs()}_onViewTabSelect(e){super._onViewTabSelect(e),this.tabArea.updateFirstTabSelected()}}function Q_(i,e,t){return e=S$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function S$(i){var e=C$(i,"string");return typeof e=="symbol"?e:String(e)}function C$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class cf extends te{constructor(e){super(),Q_(this,"header",void 0),Q_(this,"desktop",void 0),this.header=e,this.desktop=e.desktop}layout(e){let t,r,s,o,n=this.header.htmlComp,l=n.size(),d=this.header.toolBox,h=this.header.viewButtonBox,p=this.header.tabArea,m=0,g=0,b=0,C=0;if(l=l.subtract(n.insets()),this.header.logo&&(g=w.size(this.header.logo.$container,!0).width),h&&(t=h.htmlComp.prefSize(!0),b=t.width,h.htmlComp.setSize(t.subtract(h.htmlComp.margins()))),p.htmlComp.$comp.cssLeft(b),d&&(r=d.htmlComp.prefSize(!0),C=r.width,st(),Dt()),m=k(),o=be(),s=p.htmlComp.prefSize({widthHint:m,includeMargin:!0}),m>=o.width){m=Math.min(s.width,m),N();return}if(d&&(r=Ye(),C=r.width,st(),Dt()),m=k(),m>=o.width){N();return}d&&(r=ri(),C=r.width,st(),Dt()),m=k(),p.displayStyle!==Ni.DisplayStyle.SPREAD_EVEN&&(m=Math.min(o.width,m));let R=p.htmlComp.layout.overflowTabItemWidth;m=Math.max(m,p.tabs.length?R:0),N(),d&&m<=R&&(C=l.width-m-g-b,st(),Dt());function k(){return l.width-C-g-b}function N(){p.htmlComp.setSize(new A(m,s.height).subtract(p.htmlComp.margins()))}function be(){return p.htmlComp.layout.smallPrefSize({widthHint:m}).add(p.htmlComp.margins())}function st(){d.htmlComp.setSize(new A(C,r.height).subtract(d.htmlComp.margins()))}function Ye(){return d.htmlComp.layout.compactPrefSize().add(d.htmlComp.margins())}function ri(){return d.htmlComp.layout.shrinkPrefSize().add(d.htmlComp.margins())}function Dt(){d.htmlComp.$comp.cssLeft(l.width-C-g)}}}function P$(i,e,t){return e=x$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function x$(i){var e=F$(i,"string");return typeof e=="symbol"?e:String(e)}function F$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Od extends I{constructor(){super(),P$(this,"widgets",void 0),this.widgets={}}static get(e){return f.find(e.desktop.addOns,t=>t instanceof Od)}_init(e){super._init(e),this._setWidgets(this.widgets)}_setWidgets(e){const t=$.extend(!0,{},this.widgets),r=Object.keys(t);e=this._ensureWidgets(e),this._setProperty("widgets",e);const s=[],o=[...r];Object.keys(this.widgets).forEach(n=>{f.remove(o,n)||s.push(n)}),s.forEach(n=>this._triggerWidgetAdd(n,this.widgets[n])),o.forEach(n=>this._triggerWidgetRemove(n,t[n]))}_ensureWidgets(e){const t={};return Object.keys(e).forEach(r=>{t[r]=this._createChildren(e[r])}),t}_triggerWidgetAdd(e,t){this.trigger("widgetAdd:".concat(e),{widget:t})}_triggerWidgetRemove(e,t){this.trigger("widgetRemove:".concat(e),{widget:t})}onHybridEvent(e,t,r){this.trigger("".concat(t,":").concat(e),{data:r})}onHybridWidgetEvent(e,t,r){const s=this.widgets[e];!s||(s instanceof Y?this._onHybridFormEvent(s,t,r):this._onHybridWidgetEvent(s,t,r))}_onHybridWidgetEvent(e,t,r){e.trigger(t,{data:r})}_onHybridFormEvent(e,t,r){t==="reset"?e.trigger("reset"):t==="save"?(e.setData(r),e.trigger("save")):t==="close"?e.trigger("close"):this._onHybridWidgetEvent(e,t,r)}_createEventId(){return wr.take(this.session)}triggerHybridAction(e,t){const r=this._createEventId();return this.trigger("hybridAction",{data:{id:r,eventType:e,data:t}}),r}async triggerHybridActionAndWait(e,t){const r=this.triggerHybridAction(e,t);return(await this.when("hybridActionEnd:".concat(r))).data}async openForm(e,t){const r=this.triggerHybridAction("openForm:".concat(e),t);return(await this.when("widgetAdd:".concat(r))).widget}async createForm(e,t){const r=this.triggerHybridAction("createForm:".concat(e),t);return(await this.when("widgetAdd:".concat(r))).widget}one(e,t){super.one(e,t)}on(e,t){return super.on(e,t)}off(e,t){super.off(e,t)}when(e){return super.when(e)}}class Z_ extends He{constructor(){super()}onModelAction(e){e.type==="hybridEvent"?this._onHybridEvent(e):e.type==="hybridWidgetEvent"?this._onHybridWidgetEvent(e):super.onModelAction(e)}_onHybridEvent(e){this.widget.onHybridEvent(e.id,e.eventType,e.data)}_onHybridWidgetEvent(e){this.widget.onHybridWidgetEvent(e.id,e.eventType,e.data)}_onWidgetEvent(e){e.type==="hybridAction"?this._onWidgetHybridAction(e):super._onWidgetEvent(e)}_onWidgetHybridAction(e){this._send("hybridAction",e.data)}}function Jt(i,e,t){return e=E$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function E$(i){var e=A$(i,"string");return typeof e=="symbol"?e:String(e)}function A$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zt extends I{constructor(){super(),Jt(this,"desktop",void 0),Jt(this,"outline",void 0),Jt(this,"handleVisible",void 0),Jt(this,"handle",void 0),Jt(this,"toolBox",void 0),Jt(this,"toolBoxVisible",void 0),Jt(this,"viewButtonBox",void 0),Jt(this,"layoutData",void 0),Jt(this,"$body",void 0),Jt(this,"htmlCompBody",void 0),Jt(this,"_outlinePropertyChangeHandler",void 0),Jt(this,"_desktopPropertyChangeHandler",void 0),Jt(this,"_viewButtonBoxPropertyChangeHandler",void 0),this.$body=null,this.layoutData={},this.toolBoxVisible=!1,this.viewButtonBox=null,this.handleVisible=!0,this._outlinePropertyChangeHandler=this._onOutlinePropertyChange.bind(this),this._desktopPropertyChangeHandler=this._onDesktopPropertyChange.bind(this),this._viewButtonBoxPropertyChangeHandler=this._onViewButtonBoxPropertyChange.bind(this)}_init(e){super._init(e),zt.MIN_WIDTH=L.getSize("desktop-navigation","min-width","minWidth",49),zt.DEFAULT_STYLE_WIDTH=L.getSize("desktop-navigation","width","width",290),zt.BREADCRUMB_STYLE_WIDTH=L.getSize("desktop-navigation-breadcrumb","width","width",240),this.desktop=this.parent,this.updateHandleVisibility(),this._setOutline(e.outline),this.viewButtonBox=u.create(Fd,{parent:this,viewButtons:this.desktop.viewButtons}),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler)}_render(){this.$container=this.$parent.appendDiv("desktop-navigation"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new pf(this)),this.htmlComp.layoutData=this.layoutData,this.$body=this.$container.appendDiv("navigation-body").on("mousedown",this._onNavigationBodyMouseDown.bind(this)),this.htmlCompBody=S.install(this.$body,this.session),this.htmlCompBody.setLayout(new Cr(null,{exact:!0})),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}_remove(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),super._remove()}_renderProperties(){super._renderProperties(),this._renderViewButtonBox(),this._renderViewButtonBoxVisible(),this._renderToolBoxVisible(),this._renderOutline(),this._renderHandleVisible(),this._renderInBackground()}_renderInBackground(){this.$container.toggleClass("in-background",this.desktop.inBackground&&this.desktop.displayStyle!==Ie.DisplayStyle.COMPACT)}_renderViewButtonBox(){this.viewButtonBox.render(),this.viewButtonBox.$container.insertBefore(this.$body)}_removeOutline(){!this.outline||this.outline.remove()}_renderOutline(){!this.outline||(this.outline.render(this.$body),this.outline.invalidateLayoutTree(),this.rendered&&this.outline.validateFocus())}setOutline(e){this.setProperty("outline",e)}_setOutline(e){let t=this.outline;this.outline&&this.outline.off("propertyChange",this._outlinePropertyChangeHandler),this.rendered&&this._removeOutline(),this.outline=e,this.outline&&(this.outline.setParent(this),this.outline.setBreadcrumbTogglingThreshold(zt.BREADCRUMB_STYLE_WIDTH),this.outline.toggleBreadcrumbStyleEnabled&&t&&t.toggleBreadcrumbStyleEnabled&&t.displayStyle&&this.outline.setDisplayStyle(t.displayStyle),this.outline.inBackground=this.desktop.inBackground,this.outline.on("propertyChange",this._outlinePropertyChangeHandler),this._updateHandle())}_renderViewButtonBoxVisible(){this.$container.toggleClass("view-button-box-invisible",!this.viewButtonBox.visible)}sendToBack(){this.outline&&this.outline.sendToBack(),this.rendered&&this._renderInBackground()}bringToFront(){this.outline&&this.outline.bringToFront(),this.rendered&&this._renderInBackground()}setToolBoxVisible(e){this.setProperty("toolBoxVisible",e)}setHandleVisible(e){this.setProperty("handleVisible",e)}_updateHandle(){this.handle&&this.handle.setRightVisible(this.outline&&this.outline.toggleBreadcrumbStyleEnabled&&this.desktop.outlineDisplayStyle()===fe.DisplayStyle.BREADCRUMB)}updateHandleVisibility(){this.setHandleVisible(this.desktop.navigationHandleVisible)}_renderToolBoxVisible(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox()}_renderToolBox(){this.toolBox||(this.toolBox=u.create(xd,{parent:this,menus:this.desktop.menus}),this.toolBox.render())}_removeToolBox(){!this.toolBox||(this.toolBox.destroy(),this.toolBox=null)}_renderHandleVisible(){this.handleVisible?this._renderHandle():this._removeHandle()}_createHandle(){return u.create(Cd,{parent:this,rightVisible:!1,horizontalAlignment:er.HorizontalAlignment.RIGHT})}_renderHandle(){this.handle||(this.handle=this._createHandle(),this.handle.render(),this.handle.addCssClass("navigation-open"),this.handle.on("action",this._onHandleAction.bind(this)),this._updateHandle())}_removeHandle(){!this.handle||(this.handle.destroy(),this.handle=null)}_onNavigationBodyMouseDown(e){this.desktop.bringOutlineToFront()}_onViewButtonBoxPropertyChange(e){e.propertyName==="visible"&&this.rendered&&this._renderViewButtonBoxVisible()}_onOutlinePropertyChange(e){e.propertyName==="displayStyle"&&this._updateHandle()}_onDesktopPropertyChange(e){e.propertyName==="navigationHandleVisible"&&this.updateHandleVisibility()}_onHandleAction(e){e.left?this.desktop.shrinkNavigation():this.desktop.enlargeNavigation()}}Jt(zt,"DEFAULT_STYLE_WIDTH",null),Jt(zt,"BREADCRUMB_STYLE_WIDTH",null),Jt(zt,"MIN_WIDTH",null);function D$(i,e,t){return e=M$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function M$(i){var e=$$(i,"string");return typeof e=="symbol"?e:String(e)}function $$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Cd extends er{constructor(){super(...arguments),D$(this,"desktopKeyStrokeContext",void 0)}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.desktopKeyStrokeContext=new Oe,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStrokes([new ff(this),new mf(this)])}_render(){super._render(),this.$container.addClass("desktop-navigation-handle"),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext)}_remove(){super._remove(),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext)}}function R$(i,e,t){return e=L$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function L$(i){var e=I$(i,"string");return typeof e=="symbol"?e:String(e)}function I$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class pf extends te{constructor(e){super(),R$(this,"navigation",void 0),this.navigation=e}layout(e){let t=this.navigation.htmlComp,r=t.size({exact:!0}).subtract(t.insets()),s=this.navigation.toolBox,o=0,n=0,l=this.navigation.viewButtonBox;if(l.visible){let p=l.htmlComp.prefSize(!0);o=p.height,n=r.width,s&&(n=p.width);let m=new A(n,o).subtract(l.htmlComp.margins());l.htmlComp.setSize(m)}if(s){let p,m=this.navigation.outline;if(n===0&&m&&m.$title){m.$title.addClass("measure");let g=w.prefSize(m.$title).width;m.$title.removeClass("measure"),p=new A(r.width-g,0).subtract(s.htmlComp.margins())}else p=new A(r.width-n,o).subtract(s.htmlComp.margins());s.htmlComp.setSize(p)}let d=this.navigation.htmlCompBody,h=new A(r.width,r.height).subtract(d.margins());d.$comp.cssTop(o),h.height-=o,d.setSize(h)}preferredLayoutSize(e,t){let r=this.navigation.htmlCompBody,s=r.prefSize(t).add(r.margins()),o=new A(0,0),n=this.navigation.viewButtonBox;if(n){let h=n.htmlComp.prefSize(!0);o.width+=h.width,o.height=Math.max(o.height,h.height)}let l=this.navigation.toolBox;if(l){let h=l.htmlComp.prefSize(!0);o.width+=h.width,o.height=Math.max(o.height,h.height)}let d=this.navigation.htmlComp;return s.height+=o.height,s.width=Math.max(s.width,o.width),s=s.add(d.insets()),s}}function k$(i,e,t){return e=B$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function B$(i){var e=O$(i,"string");return typeof e=="symbol"?e:String(e)}function O$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ff extends B{constructor(e){super(),k$(this,"desktop",void 0),this.field=e,this.desktop=e.session.desktop,this.ctrl=!0,this.which=[_.forBrowser(_.ANGULAR_BRACKET)],this.renderingHints.$drawingArea=(t,r)=>this.desktop.$container,this.inheritAccessibility=!1}_accept(e){return super._accept(e)||B.acceptModifiers(this,e)&&u.isOneOf(e.which,_.forBrowser(_.ANGULAR_BRACKET,"ctrl"))}_isEnabled(){return super._isEnabled()&&this.field.leftVisible}handle(e){this.desktop.shrinkNavigation()}_postRenderKeyBox(e,t){t.addClass("navigation-handle-key-box left");let s=this.field.$left.offsetTo(this.desktop.$container),o=s.left-t.outerWidth(!0),n=s.top;t.cssLeft(o).cssTop(n)}}function H$(i,e,t){return e=N$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function N$(i){var e=V$(i,"string");return typeof e=="symbol"?e:String(e)}function V$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class mf extends B{constructor(e){super(),H$(this,"desktop",void 0),this.field=e,this.desktop=e.session.desktop,this.ctrl=!0,this.shift=!0,this.which=[_.forBrowser(_.ANGULAR_BRACKET)],this.renderingHints.$drawingArea=(t,r)=>this.desktop.$container,this.inheritAccessibility=!1}_accept(e){return super._accept(e)||B.acceptModifiers(this,e)&&u.isOneOf(e.which,_.forBrowser(_.ANGULAR_BRACKET,"ctrl"))}_isEnabled(){return super._isEnabled()&&this.field.rightVisible}handle(e){this.desktop.enlargeNavigation()}_postRenderKeyBox(e,t){t.addClass("navigation-handle-key-box right");let r=this.field,s=r.$right.offsetTo(this.desktop.$container),o=s.left+r.$right.outerWidth(),n=s.top;t.cssLeft(o).cssTop(n)}}function Qi(i,e,t){return e=W$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function W$(i){var e=K$(i,"string");return typeof e=="symbol"?e:String(e)}function K$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ii extends Oh{constructor(){super(),Qi(this,"duration",void 0),Qi(this,"removeTimeout",void 0),Qi(this,"nativeOnly",void 0),Qi(this,"nativeNotificationTitle",void 0),Qi(this,"nativeNotificationStatus",void 0),Qi(this,"nativeNotificationVisibility",void 0),Qi(this,"nativeNotification",void 0),Qi(this,"nativeNotificationShown",void 0),Qi(this,"$loader",void 0),Qi(this,"_removing",void 0),this.closable=!0,this.duration=5e3,this.removeTimeout=null,this._removing=!1,this.nativeOnly=!1,this.nativeNotificationTitle=null,this.nativeNotificationStatus=null,this.nativeNotificationVisibility=ii.NativeNotificationVisibility.NONE,this.nativeNotification=null,this.nativeNotificationShown=!1}_init(e){super._init(e);let t=this.session.desktop.nativeNotificationDefaults;t&&(this.nativeNotificationTitle=e.nativeNotificationTitle!==void 0?e.nativeNotificationTitle:t.title,this.nativeNotificationStatus?this.nativeNotificationStatus.iconId=this.nativeNotificationStatus.iconId!==void 0?this.nativeNotificationStatus.iconId:t.iconId:this.nativeNotificationStatus=new E({iconId:t.iconId}),this.nativeNotificationVisibility=u.nvl(e.nativeNotificationVisibility!==void 0?e.nativeNotificationVisibility:t.visibility,ii.NativeNotificationVisibility.NONE)),this.resolveTextKeys(["nativeNotificationTitle"])}_render(){this._initNativeNotification(),this.$container=this.$parent.prependDiv("desktop-notification"),this.$content=this.$container.appendDiv("desktop-notification-content"),this.$messageText=this.$content.appendDiv("desktop-notification-message"),this.$loader=this.$container.appendDiv("desktop-notification-loader"),F.get().supportsCssAnimation()&&this.$loader.addClass("animated"),this.nativeOnly&&this.setVisible(!1)}_renderLoading(){this.$container.toggleClass("loading",this.loading),this.$loader.setVisible(this.loading)}_destroy(){this.nativeNotification&&this.nativeNotification.close(),super._destroy()}_isDocumentHidden(){return document.hidden}_showNativeNotification(e){if(e==="denied"||e==="default"){this.nativeOnly&&this.hide();return}let t=u.nvl(this.nativeNotificationTitle,""),r=(this.nativeNotificationStatus||{}).message;y.empty(r)&&(r=(this.status||{}).message),r||(r=""),this.htmlEnabled&&(r=y.plainText(r,{removeFontIcons:!0}));let s=(this.nativeNotificationStatus||{}).iconId;y.empty(s)&&(s=void 0),this.nativeNotification=new Notification(t,{body:r,icon:s}),this.nativeNotification.addEventListener("show",o=>{this._setNativeNotificationShown(!0)}),this.nativeNotification.addEventListener("click",o=>{window.focus()}),this.nativeNotification.addEventListener("close",o=>{this.nativeOnly&&this.hide(),this.nativeNotification=null,this._setNativeNotificationShown(!1)})}_initNativeNotification(){if(!this.nativeNotificationShown){if(this.nativeNotificationVisibility===ii.NativeNotificationVisibility.NONE){this._hideLaterIfNativeOnly();return}if(this.nativeNotificationVisibility===ii.NativeNotificationVisibility.BACKGROUND&&!this._isDocumentHidden()){this._hideLaterIfNativeOnly();return}if(window.Notification&&Notification.permission==="denied"){this._hideLaterIfNativeOnly();return}this._checkNotificationPromise()?Notification.requestPermission().then(this._showNativeNotification.bind(this)):Notification.requestPermission(this._showNativeNotification.bind(this))}}_hideLaterIfNativeOnly(){!this.nativeOnly||setTimeout(()=>this.hide())}_checkNotificationPromise(){try{Notification.requestPermission().then()}catch{return!1}return!0}_onCloseIconClick(){this.hide()}show(){this.session.desktop.addNotification(this)}hide(){this._removing||(this.trigger("close"),this.session.desktop.removeNotification(this))}fadeIn(e){this.render(e),F.get().supportsCssAnimation()&&this.$container.addClassForAnimation("desktop-notification-slide-in")}fadeOut(){if(!this._removing){if(this._removing=!0,!F.get().supportsCssAnimation()||!this.rendered){this.destroy();return}if(!this.$container.isVisible()){this.destroy();return}this.$container.addClass("desktop-notification-fade-out"),this.$container.oneAnimationEnd(()=>{this.destroy()})}}invalidateLayoutTree(){}_setNativeNotificationShown(e){this._setProperty("nativeNotificationShown",e)}setNativeNotificationTitle(e){this.setProperty("nativeNotificationTitle",e)}setNativeNotificationStatus(e){this.setProperty("nativeNotificationStatus",e)}_setNativeNotificationStatus(e){e=E.ensure(e),this._setProperty("nativeNotificationStatus",e)}setNativeNotificationVisibility(e){this.setProperty("nativeNotificationVisibility",e)}}Qi(ii,"NativeNotificationVisibility",{NONE:"none",BACKGROUND:"background",ALWAYS:"always"}),Qi(ii,"INFINITE",-1);class eb extends Hh{constructor(){super(),this._addRemoteProperties(["nativeNotificationShown"])}}function gf(i,e,t){return e=z$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function z$(i){var e=G$(i,"string");return typeof e=="symbol"?e:String(e)}function G$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class _f extends ii{constructor(){super(),gf(this,"connectFailedReset",void 0),gf(this,"connectionInterruptedStatus",void 0),gf(this,"reconnectingStatus",void 0),this.connectFailedReset=null}_init(e){super._init(e),this.closable=!1,this.duration=ii.INFINITE,this.connectionInterruptedStatus=new E({message:this.session.text("ui.ConnectionInterrupted"),severity:E.Severity.ERROR}),this.reconnectingStatus=new E({message:this.session.text("ui.Reconnecting_"),severity:E.Severity.ERROR}),this._setStatus(this.connectionInterruptedStatus)}_render(){super._render(),this.$content.addClass("offline-message"),this.$messageText.addClass("offline-message-text")}reconnect(){this.setLoading(!0),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.setStatus(this.reconnectingStatus)}reconnectFailed(){this.connectFailedReset=setTimeout(()=>{this.connectFailedReset=null,this.setLoading(!1),this.setStatus(this.connectionInterruptedStatus)},1100)}reconnectSucceeded(){this.setLoading(!1),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.setStatus({message:this.session.text("ui.ConnectionReestablished"),severity:E.Severity.OK})}}function bf(i,e,t){return e=U$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function U$(i){var e=q$(i,"string");return typeof e=="symbol"?e:String(e)}function q$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Pn{constructor(){bf(this,"objectType",void 0),bf(this,"session",void 0),bf(this,"preserveOpener",void 0),this.session=null,this.preserveOpener=!1}init(e){a().extend(this,e)}openWindow(e,t,r,s){t=t||"scout_"+new Date().getTime();let o=window.open("",t,r);if(o){this.preserveOpener||(o.opener=null);try{o.window.location.href=e}catch(n){this._handleInvalidUri(e,o,n);return}s&&s(o)}else a().log.warn("Popup-blocker detected! Show link to open window manually"),this.showNotification(()=>{this.openWindow(e,t,r,s)})}showNotification(e){let t,r=this.session.desktop;typeof e=="string"&&(t=e);let s=u.create(yf,{parent:r,linkUrl:t,preserveOpener:this.preserveOpener});!t&&a().isFunction(e)&&s.on("linkClick",e),s.show()}_handleInvalidUri(e,t,r){u.create(vo,{logError:!0,displayError:!1,sendError:!1}).handle(r),t.close(),as.createOk(this.session.desktop).withHeader(this.session.text("ui.UnexpectedProblem")).withBody(this.session.text("ui.InvalidUriMsg")).withSeverity(E.Severity.ERROR).buildAndOpen()}}function Pd(i,e,t){return e=Y$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Y$(i){var e=j$(i,"string");return typeof e=="symbol"?e:String(e)}function j$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class yf extends ii{constructor(){super(),Pd(this,"preserveOpener",void 0),Pd(this,"linkUrl",void 0),Pd(this,"linkText",void 0),Pd(this,"$link",void 0),this.duration=ii.INFINITE,this.preserveOpener=!1}_init(e){super._init(e),this.linkText=u.nvl(this.linkText,this.session.text("ui.OpenManually")),this._setStatus({message:this.session.text("ui.PopupBlockerDetected"),severity:E.Severity.WARNING})}_render(){super._render(),this.$messageText.addClass("popup-blocked-title"),this.$link=this.$content.appendElement("<a>","popup-blocked-link").text(this.linkText).on("click",this._onLinkClick.bind(this))}_renderProperties(){super._renderProperties(),this._renderLinkUrl()}_renderLinkUrl(){this.linkUrl?(this.$link.attr("href",this.linkUrl).attr("target","_blank"),this.preserveOpener||this.$link.attr("rel","noreferrer noopener")):this.$link.removeAttr("href").removeAttr("target")}_onLinkClick(e){this.trigger("linkClick"),this.hide()}}class xd extends Yh{constructor(){super(),this.uiMenuCssClass=y.join(" ",this.uiMenuCssClass,"desktop-tool-box-item")}_initMenu(e){super._initMenu(e),e.popupHorizontalAlignment=pe.Alignment.CENTER}_render(){super._render(),this.$container.addClass("desktop-tool-box")}}class vf extends Qs{constructor(e){super(e)}_postRenderKeyBox(e,t){let r=e.outerWidth(),s=e.find(".key-box").outerWidth(),o=r/2-s/2;e.find(".key-box").cssLeft(o)}}function wf(i,e,t){return e=X$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function X$(i){var e=J$(i,"string");return typeof e=="symbol"?e:String(e)}function J$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tf extends oe{constructor(){super(),wf(this,"displayStyle",void 0),wf(this,"selectedAsMenu",void 0),wf(this,"_desktopInBackgroundHandler",void 0),this.showTooltipWhenSelected=!1,this.displayStyle="TAB",this.selectedAsMenu=!1,this._desktopInBackgroundHandler=this._onDesktopInBackgroundChange.bind(this)}_init(e){super._init(e),this.session.desktop.on("propertyChange:inBackground",this._desktopInBackgroundHandler)}_destroy(){this.session.desktop.off("propertyChange:inBackground",this._desktopInBackgroundHandler),super._destroy()}renderAsTab(e){let t=e.appendDiv("view-tab-wrapper");this.render(t),this.$container.addClass("view-tab view-button-tab")}_render(){this.$container=this.$parent.appendDiv("view-button").on("mousedown",this._onMouseEvent.bind(this)),this.htmlComp=S.install(this.$container,this.session),this.$container.prependDiv("edge left"),this.$container.appendDiv("edge right")}_remove(){let e=this.$container.parent();e.hasClass("view-tab-wrapper")&&e.remove(),super._remove()}_renderProperties(){super._renderProperties(),this._renderInBackground()}_renderInBackground(){this.session.desktop.displayStyle!==Ie.DisplayStyle.COMPACT&&(this.rendering||(this.session.desktop.inBackground?this.$container.addClassForAnimation("animate-bring-to-back"):this.$container.addClassForAnimation("animate-bring-to-front")),this.$container.toggleClass("in-background",this.session.desktop.inBackground))}_renderText(){}setDisplayStyle(e){this.setProperty("displayStyle",e)}_onMouseEvent(e){this.doAction()}_createActionKeyStroke(){return new vf(this)}setSelectedAsMenu(e){this.selectedAsMenu=e}_onDesktopInBackgroundChange(e){this.rendered&&this._renderInBackground()}}class Sf extends bs{}function $s(i,e,t){return e=Q$(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Q$(i){var e=Z$(i,"string");return typeof e=="symbol"?e:String(e)}function Z$(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fd extends I{constructor(){super(),$s(this,"desktop",void 0),$s(this,"viewMenuTab",void 0),$s(this,"viewButtons",void 0),$s(this,"menuButtons",void 0),$s(this,"tabButtons",void 0),$s(this,"selectedMenuButtonAlwaysVisible",void 0),$s(this,"_desktopOutlineChangeHandler",void 0),$s(this,"_viewButtonPropertyChangeHandler",void 0),this.viewMenuTab=null,this.viewButtons=[],this.menuButtons=[],this.tabButtons=[],this._desktopOutlineChangeHandler=this._onDesktopOutlineChange.bind(this),this._viewButtonPropertyChangeHandler=this._onViewButtonPropertyChange.bind(this),this.selectedMenuButtonAlwaysVisible=!1,this._addWidgetProperties(["viewButtons"])}_init(e){super._init(e),this.desktop=this.session.desktop,this.viewMenuTab=u.create(Ff,{parent:this}),this._setViewButtons(this.viewButtons),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler)}_render(){this.$container=this.$parent.appendDiv("view-button-box"),this.htmlComp=S.install(this.$container,this.session),this.viewMenuTab.render(),this._onDesktopOutlineChange()}_renderProperties(){super._renderProperties(),this._renderTabButtons()}_remove(){this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.viewButtons.forEach(e=>e.off("selected",this._viewButtonPropertyChangeHandler)),super._remove()}setSelectedMenuButtonVisible(e){this.viewMenuTab.setSelectedButtonVisible(e)}setSelectedMenuButtonAlwaysVisible(e){this.setProperty("selectedMenuButtonAlwaysVisible",e)}_setSelectedMenuButtonAlwaysVisible(e){this._updateSelectedMenuButtonVisibility()}setViewButtons(e){this.setProperty("viewButtons",e)}_setViewButtons(e){this.viewButtons&&this.viewButtons.forEach(t=>t.off("propertyChange",this._viewButtonPropertyChangeHandler)),this._setProperty("viewButtons",e),this.viewButtons.forEach(t=>t.on("propertyChange",this._viewButtonPropertyChangeHandler)),this._updateViewButtons()}_setTabButtons(e){this._setProperty("tabButtons",e)}_removeTabButtons(){this.tabButtons.forEach(e=>e.remove())}_renderTabButtons(){this.tabButtons.forEach((e,t)=>e.renderAsTab(this.$container)),ke.updateFirstLastMarker(this.tabButtons)}_updateViewButtons(){let e=this.viewButtons.filter(s=>s.visible),t=e.filter(s=>s.displayStyle==="MENU"),r=null;t.length>1?r=e.filter(s=>s.displayStyle==="TAB"):(r=e,t=[]),this._setMenuButtons(t),this.rendered&&this._removeTabButtons(),this._setTabButtons(r),this.rendered&&this._renderTabButtons(),this._updateVisibility(),this._updateSelectedMenuButtonVisibility()}_updateVisibility(){this.setVisible(this.tabButtons.length+this.menuButtons.length>1)}_setMenuButtons(e){this._setProperty("menuButtons",e),this.viewMenuTab.setViewButtons(this.menuButtons)}_updateSelectedMenuButtonVisibility(){this.setSelectedMenuButtonVisible(this.selectedMenuButtonAlwaysVisible||this.tabButtons.length>=1&&this.menuButtons.length>=1)}_onDesktopOutlineChange(){let e=this.desktop.outline;this.viewButtons.forEach(t=>{t instanceof Dd&&t.onOutlineChange(e)})}_onViewButtonSelected(e){this.viewButtons.forEach(t=>{t!==e.source&&t.isToggleAction()&&t.setSelected(!1)}),this.viewMenuTab.onViewButtonSelected()}_onViewButtonPropertyChange(e){e.propertyName==="selected"?this._onViewButtonSelected(e):(e.propertyName==="visible"||e.propertyName==="displayStyle")&&this._updateViewButtons()}}class Cf extends B{constructor(e){super(),this.field=e,this.which=[_.F2],this.stopPropagation=!0,this.renderingHints.$drawingArea=(t,r)=>this.field.selected?this.field.dropdown.$container:this.field.selectedButton.$container}handle(e){this.field.selected?this.field.togglePopup():this.field.selectedButton&&this.field.selectedButton.doAction()}_postRenderKeyBox(e,t){let r=e.outerWidth(),s=e.find(".key-box").outerWidth(),o=r/2-s/2;e.find(".key-box").cssLeft(o)}}function tb(i,e,t){return e=eR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function eR(i){var e=tR(i,"string");return typeof e=="symbol"?e:String(e)}function tR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Pf extends tn{constructor(){super(),tb(this,"defaultIconId",void 0),tb(this,"viewMenus",void 0),this.cssClass="view-menu-popup",this.defaultIconId=null,this.viewMenus=[],this.trimWidth=!0}_init(e){super._init(e);let t=this._createTiles(),r=t.every(n=>!n.widgets[0].visible);this.content=u.create(_o,{parent:this,tiles:t,cssClass:r?"no-icons":"",selectable:!0,multiSelect:!1,gridColumnCount:this._computeGridColumnCount(t),layoutConfig:{columnWidth:100,rowHeight:-1,vgap:10,hgap:10}});let o=this.content.tiles.find(n=>n.viewMenu.selected);o&&this.content.selectTile(o)}_computeGridColumnCount(e){return e.length>8?4:e.length>4?3:2}_createTiles(){return this.viewMenus.map(e=>({objectType:Np,displayStyle:Wt.DisplayStyle.PLAIN,cssClass:u.nvl(e.cssClass,"")+" view-menu-tile "+(e.selected?"checked ":"")+(e.iconId?"":"text-only"),modelClass:e.modelClass,classId:e.classId,viewMenu:e,enabled:e.enabled,gridDataHints:{useUiHeight:!0},widgets:[{objectType:Qr,iconDesc:e.iconId,visible:!!e.iconId,prepend:!0},{objectType:ca,value:e.text,cssClass:"label"}]}))}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.registerKeyStroke(new xf(this))}_renderContent(){super._renderContent(),this.content.$container.on("click",".tile",e=>{let t=u.widget(e.target);t instanceof Wt||(t=t.findParent(r=>r instanceof Wt)),this.activateTile(t)})}activateTile(e){!e||!e.viewMenu.enabledComputed||(e.viewMenu.doAction(),this.close())}}class xf extends B{constructor(e){super(),this.field=e,this.which=[_.ENTER,_.SPACE],this.renderingHints.$drawingArea=(t,r)=>{let s=this.field.content.selectedTiles[0];if(s&&s.rendered)return s.$container},this.inheritAccessibility=!1}accept(e){return super.accept(e)&&this.field.content.selectedTiles.length===1&&this.field.content.selectedTiles[0].enabledComputed}handle(e){this.field.activateTile(this.field.content.selectedTiles[0])}}function os(i,e,t){return e=iR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function iR(i){var e=rR(i,"string");return typeof e=="symbol"?e:String(e)}function rR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ff extends I{constructor(){super(),os(this,"selected",void 0),os(this,"selectedButtonVisible",void 0),os(this,"defaultIconId",void 0),os(this,"viewButtons",void 0),os(this,"selectedButton",void 0),os(this,"dropdown",void 0),os(this,"popup",void 0),os(this,"desktopKeyStrokeContext",void 0),os(this,"_desktopInBackgroundHandler",void 0),this.viewButtons=[],this.selected=!1,this.selectedButton=null,this.selectedButtonVisible=!0,this.defaultIconId=ve.FOLDER,this._desktopInBackgroundHandler=this._onDesktopInBackgroundChange.bind(this),this._addWidgetProperties(["selectedButton"]),this._addPreserveOnPropertyChangeProperties(["selectedButton"])}_init(e){super._init(e),this.dropdown=u.create(oe,{parent:this,iconId:ve.ANGLE_DOWN,tabbable:!1,cssClass:"view-menu",toggleAction:!0}),this.dropdown.on("action",this.togglePopup.bind(this)),this._setViewButtons(this.viewButtons),this.session.desktop.on("propertyChange:inBackground",this._desktopInBackgroundHandler)}_destroy(){this.session.desktop.off("propertyChange:inBackground",this._desktopInBackgroundHandler),super._destroy()}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.desktopKeyStrokeContext=new Oe,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke(new Cf(this))}_render(){this.$container=this.$parent.appendDiv("view-tab view-menu-tab"),this.htmlComp=S.install(this.$container,this.session),this.dropdown.render(this.$container),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext),this.$container.appendDiv("edge right")}_remove(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),super._remove(),this.selectedButton&&this.selectedButton.remove()}_renderProperties(){super._renderProperties(),this._renderSelectedButtonVisible(),this._renderSelected(),this._renderInBackground()}setViewButtons(e){this.setProperty("viewButtons",e)}_setViewButtons(e){this._setProperty("viewButtons",e),this.setVisible(this.viewButtons.length>0);let t=this._findSelectedViewButton();t?this.setSelectedButton(t):this.setSelectedButton(f.find(this.viewButtons,r=>r.selectedAsMenu)||this.viewButtons[0]),this.setSelected(!!t)}setSelectedButton(e){this.selectedButton&&this.selectedButton.cloneOf===e||e&&this.setProperty("selectedButton",e)}_setSelectedButton(e){this.viewButtons.forEach(r=>r.setSelectedAsMenu(r===e));let t=this.selectedButton;t||(t=u.create(Dd,{parent:this,displayStyle:"TAB"})),t.cloneOf&&t.cloneOf.unmirror(t),t.cloneOf=e,e._cloneProperties.forEach(r=>t.callSetter(r,e[r])),t.setIconId(e.iconId||this.defaultIconId),e.mirror({delegateEventsToOriginal:["acceptInput","action"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected"]},t),this._setProperty("selectedButton",t)}_renderSelectedButton(){this._renderSelectedButtonVisible()}setSelectedButtonVisible(e){this.setProperty("selectedButtonVisible",e)}_renderSelectedButtonVisible(){this.$container.toggleClass("selected-button-invisible",!this.selectedButtonVisible),this.selectedButton&&(this.selectedButtonVisible?this.selectedButton.rendered||(this.selectedButton.render(),this.selectedButton.$container.prependTo(this.$container),this.invalidateLayoutTree()):this.selectedButton.rendered&&(this.selectedButton.remove(),this.invalidateLayoutTree()))}setSelected(e){this.setProperty("selected",e)}_renderSelected(){this.$container.select(this.selected)}_findSelectedViewButton(){return f.find(this.viewButtons,e=>e.selected)}togglePopup(){this.popup?this._closePopup():this._openPopup()}_openPopup(){this.popup||(this.popup=u.create(Pf,{parent:this,viewMenus:this.viewButtons,defaultIconId:this.defaultIconId,$anchor:this.$parent}),this.popup.open(),this.popup.one("destroy",e=>{this.dropdown.setSelected(!1),this.popup=null}))}_closePopup(){this.popup&&this.popup.close()}_renderInBackground(){this.session.desktop.displayStyle!==Ie.DisplayStyle.COMPACT&&(this.rendering||(this.session.desktop.inBackground?this.$container.addClassForAnimation("animate-bring-to-back"):this.$container.addClassForAnimation("animate-bring-to-front")),this.$container.toggleClass("in-background",this.session.desktop.inBackground))}onViewButtonSelected(){let e=this._findSelectedViewButton();e&&this.setSelectedButton(e),this.setSelected(!!e),this._closePopup()}_onDesktopInBackgroundChange(e){this.rendered&&this._renderInBackground()}}function ft(i,e,t){return e=sR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sR(i){var e=oR(i,"string");return typeof e=="symbol"?e:String(e)}function oR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class ai extends ts{constructor(){super(),ft(this,"nodeType",void 0),ft(this,"compactRoot",void 0),ft(this,"detailTable",void 0),ft(this,"detailTableVisible",void 0),ft(this,"detailForm",void 0),ft(this,"detailFormVisible",void 0),ft(this,"detailFormVisibleByUi",void 0),ft(this,"navigateButtonsVisible",void 0),ft(this,"tableStatusVisible",void 0),ft(this,"htmlComp",void 0),ft(this,"drillDownOnRowClick",void 0),ft(this,"overviewIconId",void 0),ft(this,"showTileOverview",void 0),ft(this,"row",void 0),ft(this,"tile",void 0),ft(this,"events",void 0),ft(this,"_tableFilterHandler",void 0),ft(this,"_tableRowClickHandler",void 0),ft(this,"_detailTableModel",void 0),ft(this,"_detailFormModel",void 0),this.nodeType=null,this.compactRoot=!1,this.detailTable=null,this.detailTableVisible=!0,this.detailForm=null,this.detailFormVisible=!0,this.detailFormVisibleByUi=!0,this.navigateButtonsVisible=!0,this.tableStatusVisible=!0,this.drillDownOnRowClick=!1,this.overviewIconId=null,this.showTileOverview=!1,this.events=new On,this.events.registerSubTypePredicate("propertyChange",(e,t)=>e.propertyName===t),this._tableFilterHandler=this._onTableFilter.bind(this),this._tableRowClickHandler=this._onTableRowClick.bind(this),this._detailTableModel=null,this._detailFormModel=null}_init(e){this._detailTableModel=ai._removePropertyIfLazyLoading(e,"detailTable"),this._detailFormModel=ai._removePropertyIfLazyLoading(e,"detailForm"),super._init(e),ve.resolveIconProperty(this,"overviewIconId"),this._internalInitTable(),this._internalInitDetailForm()}static _removePropertyIfLazyLoading(e,t){let r=e[t];return typeof r=="string"||r instanceof I?null:(delete e[t],r)}_destroy(){super._destroy(),this.detailTable&&this.detailTable.destroy(),this.detailForm&&this.detailForm.destroy()}_internalInitTable(){let e=this.detailTable;if(e){let t=this.getOutline()._createChild(e);this._setDetailTable(t)}}_internalInitDetailForm(){let e=this.detailForm;if(e){let t=this.getOutline()._createChild(e);this._setDetailForm(t)}}ensureDetailTable(){this.detailTable||this.setDetailTable(this.createDetailTable())}createDetailTable(){let e=this._createDetailTable();return!e&&this._detailTableModel&&(e=this.getOutline()._createChild(this._detailTableModel),this._detailTableModel=null),e}_createDetailTable(){return null}ensureDetailForm(){this.detailForm||this.setDetailForm(this.createDetailForm())}createDetailForm(){let e=this._createDetailForm();return!e&&this._detailFormModel&&(e=this.getOutline()._createChild(this._detailFormModel),this._detailFormModel=null),e}_createDetailForm(){return null}_initDetailForm(e){e instanceof Y&&(e.setModal(!1),e.setClosable(!1),e.setDisplayHint(Y.DisplayHint.VIEW),e.setDisplayViewId("C"),e.setShowOnOpen(!1)),e instanceof Aa&&e.setPage(this)}_destroyDetailForm(e){e instanceof Aa&&e.setPage(null),e.owner===this.getOutline()&&e.destroy()}_initDetailTable(e){e.menuBar.setPosition(ce.Position.TOP),e.on("filter",this._tableFilterHandler),this.drillDownOnRowClick&&(e.on("rowClick",this._tableRowClickHandler),e.setMultiSelect(!1)),e.setTableStatusVisible(this.tableStatusVisible)}_destroyDetailTable(e){e.off("filter",this._tableFilterHandler),e.off("rowClick",this._tableRowClickHandler),e.owner===this.getOutline()&&e.destroy()}_decorate(){super._decorate(),this.$node&&(this.session.inspector&&Vo.applyInfo(this,this.$node),this.$node.toggleClass("compact-root",this.compactRoot),this.$node.toggleClass("has-tile-overview",this.showTileOverview||this.compactRoot&&this.getOutline().detailContent instanceof Pl))}activate(){this.ensureDetailTable(),this.ensureDetailForm()}deactivate(){}getOutline(){return this.parent}pagesForTableRows(e){return e.map(this.pageForTableRow)}pageForTableRow(e){if(!e.page)throw new Error("Table-row is not linked to a page");return e.page}setDetailForm(e){e!==this.detailForm&&this._setDetailForm(e)}_setDetailForm(e){let t=this.detailForm;t!==e&&t instanceof I&&this._destroyDetailForm(t),this.detailForm=e,e&&this._initDetailForm(e),this.triggerPropertyChange("detailForm",t,e)}setDetailTable(e){e!==this.detailTable&&this._setDetailTable(e)}_setDetailTable(e){let t=this.detailTable;t!==e&&t instanceof I&&this._destroyDetailTable(t),this.detailTable=e,e&&this._initDetailTable(e),this.triggerPropertyChange("detailTable",t,e)}updatePagesFromTableRows(e){return e.map(t=>t.page.updatePageFromTableRow(t))}updatePageFromTableRow(e){let t=e.page;return t.enabled=e.enabled,t.text=t.computeTextForRow(e),e.cells.length>=1&&(t.htmlEnabled=e.cells[0].htmlEnabled,t.cssClass=e.cells[0].cssClass),t}computeTextForRow(e){let t="";return e.cells.length>=1&&(t=e.cells[0].text),t}_pageParam(e){let t={parent:this.getOutline()};return a().extend(t,e),t}reloadPage(){this.getOutline()&&this.loadChildren()}linkWithRow(e){this.row=e,e.page=this,this.getOutline().trigger("pageRowLink",{page:this,row:e})}unlinkWithRow(e){delete this.row,delete e.page}_onTableFilter(e){this.getOutline().mediator.onTableFilter(e,this)}_onTableRowClick(e){if(!this.drillDownOnRowClick)return;let t=e.row,r=this.pageForTableRow(t);this.getOutline().selectNode(r),this.detailTable.deselectRow(t)}triggerPropertyChange(e,t,r){return u.assertParameter("propertyName",e),this.trigger("propertyChange",{propertyName:e,oldValue:t,newValue:r})}trigger(e,t){let r;return t instanceof Gt?r=t:r=new Gt(t),r.source=this,this.events.trigger(e,r),r}one(e,t){this.events.one(e,t)}on(e,t){return this.events.on(e,t)}off(e,t){this.events.off(e,t)}}ft(ai,"NodeType",{NODES:"nodes",TABLE:"table"});class ib extends ai{constructor(){super(),this.nodeType=ai.NodeType.NODES}_createDetailTable(){let e=u.create(Me,{id:"NodeColumn",session:this.session}),t=u.create(W,{parent:this.parent,id:"PageWithNodesTable",autoResizeColumns:!0,headerVisible:!1,columns:[e]});return t.menuBar.setPosition(ce.Position.TOP),t.on("rowAction",this._onDetailTableRowAction.bind(this)),t}_onDetailTableRowAction(e){this.getOutline().mediator.onTableRowAction(e,this)}_rebuildDetailTable(e){let t=this.detailTable;if(!t)return;this._unlinkAllTableRows(t.rows),t.deleteAllRows();let r=this._createTableRowsForChildPages(e);t.insertRows(r)}_unlinkAllTableRows(e){e.forEach(t=>{t.page&&t.page.unlinkWithRow(t)})}_createTableRowsForChildPages(e){return e.map(t=>{let r=u.create(Qt,{parent:this.detailTable,cells:[t.text]});return t.linkWithRow(r),r})}loadChildren(){return this.childrenLoaded=!1,this._createChildPages().done(e=>{this._rebuildDetailTable(e),e.length>0&&this.getOutline().insertNodes(e,this),this.childrenLoaded=!0})}_createChildPages(){return a().resolvedPromise(this.childNodes)}}function bo(i,e,t){return e=nR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nR(i){var e=lR(i,"string");return typeof e=="symbol"?e:String(e)}function lR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class rb extends ai{constructor(){super(),bo(this,"alwaysCreateChildPage",void 0),bo(this,"_tableRowDeleteHandler",void 0),bo(this,"_tableRowInsertHandler",void 0),bo(this,"_tableRowUpdateHandler",void 0),bo(this,"_tableRowActionHandler",void 0),bo(this,"_tableRowOrderChangeHandler",void 0),bo(this,"_tableDataLoadHandler",void 0),this.nodeType=ai.NodeType.TABLE,this.alwaysCreateChildPage=!1,this._tableRowDeleteHandler=this._onTableRowsDeleted.bind(this),this._tableRowInsertHandler=this._onTableRowsInserted.bind(this),this._tableRowUpdateHandler=this._onTableRowsUpdated.bind(this),this._tableRowActionHandler=this._onTableRowAction.bind(this),this._tableRowOrderChangeHandler=this._onTableRowOrderChanged.bind(this),this._tableDataLoadHandler=this.loadTableData.bind(this)}init(e){super.init(e)}_initDetailTable(e){super._initDetailTable(e),e.on("rowsDeleted allRowsDeleted",this._tableRowDeleteHandler),e.on("rowsInserted",this._tableRowInsertHandler),e.on("rowsUpdated",this._tableRowUpdateHandler),e.on("rowAction",this._tableRowActionHandler),e.on("rowOrderChanged",this._tableRowOrderChangeHandler),e.on("reload",this._tableDataLoadHandler),e.hasReloadHandler=!0}_destroyDetailTable(e){e.off("rowsDeleted allRowsDeleted",this._tableRowDeleteHandler),e.off("rowsInserted",this._tableRowInsertHandler),e.off("rowsUpdated",this._tableRowUpdateHandler),e.off("rowAction",this._tableRowActionHandler),e.off("rowOrderChanged",this._tableRowOrderChangeHandler),e.off("reload",this._tableDataLoadHandler),super._destroyDetailTable(e)}_onTableRowsDeleted(e){if(this.leaf)return;let t=f.ensure(e.rows),r=t.map(s=>{let o=s.page;return o.unlinkWithRow(s),o});this.getOutline().mediator.onTableRowsDeleted(t,r,this)}_onTableRowsInserted(e){if(this.leaf)return;let t=f.ensure(e.rows),r=t.map(s=>this._createChildPageInternal(s));this.getOutline().mediator.onTableRowsInserted(t,r,this)}_onTableRowsUpdated(e){this.getOutline().mediator.onTableRowsUpdated(e,this)}_onTableRowAction(e){this.getOutline().mediator.onTableRowAction(e,this)}_onTableRowOrderChanged(e){e.animating||this.getOutline().mediator.onTableRowOrderChanged(e,this)}_createChildPageInternal(e){let t=this.createChildPage(e);return t===null&&this.alwaysCreateChildPage&&(t=this.createDefaultChildPage(e)),t.linkWithRow(e),t=t.updatePageFromTableRow(e),t}createChildPage(e){return null}createDefaultChildPage(e){return u.create(Df,{parent:this.getOutline(),row:e})}loadChildren(){return this.detailTable?this.loadTableData():a().resolvedPromise()}_createSearchFilter(){let e=this.detailTable.tableControls,t=f.find(e,r=>r.form instanceof Y);return t?t.form.exportData():null}loadTableData(){return this.ensureDetailTable(),this.detailTable.deleteAllRows(),this.detailTable.setLoading(!0),this._loadTableData(this._createSearchFilter()).then(this._onLoadTableDataDone.bind(this)).catch(this._onLoadTableDataFail.bind(this)).then(this._onLoadTableDataAlways.bind(this))}_loadTableData(e){return a().resolvedPromise()}_onLoadTableDataDone(e){let t=this._transformTableDataToTableRows(e);t&&t.length>0&&this.detailTable.insertRows(t)}_onLoadTableDataFail(e){this.detailTable.setTableStatus(E.error({message:this.session.text("ErrorWhileLoadingData")})),a().log.error("Failed to load tableData. error=",e)}_onLoadTableDataAlways(){this.childrenLoaded=!0,this.detailTable.setLoading(!1)}_transformTableDataToTableRows(e){return e}}function sb(i,e,t){return e=aR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function aR(i){var e=dR(i,"string");return typeof e=="symbol"?e:String(e)}function dR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ef extends Tl{constructor(){super(),sb(this,"page",void 0),sb(this,"outline",void 0),this.page=null}_init(e){super._init(e),this.label=this.page.text,this.iconId=this.page.overviewIconId,this.labelHtmlEnabled=this.page.htmlEnabled,this.on("click",t=>{this.outline.selectNode(this.page)})}notifyPageChanged(){this.setLabel(this.page.text),this.setIconId(this.page.overviewIconId),this.setLabelHtmlEnabled(this.page.htmlEnabled)}}function yo(i,e,t){return e=hR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function hR(i){var e=uR(i,"string");return typeof e=="symbol"?e:String(e)}function uR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ed extends _o{constructor(){super(),yo(this,"compact",void 0),yo(this,"compactLayoutConfig",void 0),yo(this,"outline",void 0),yo(this,"page",void 0),yo(this,"nodes",void 0),yo(this,"_outlineNodeChangedHandler",void 0),yo(this,"_outlineStructureChangedHandler",void 0),this.compact=!1,this.compactLayoutConfig=new tr({columnWidth:120,rowHeight:100,hgap:15,vgap:15}),this.outline=null,this.page=null,this.nodes=null,this.scrollable=!1,this.renderAnimationEnabled=!0,this.startupAnimationEnabled=!0,this._outlineNodeChangedHandler=this._onOutlineNodeChanged.bind(this),this._outlineStructureChangedHandler=this._onOutlineStructureChanged.bind(this)}_init(e){super._init(e),this.nodes=this.nodes||this.page&&this.page.childNodes||this.outline&&this.outline.nodes,this._setCompact(this.compact),this.setOutline(this.outline),this.setPage(this.page),this.setNodes(this.nodes),this._setCompactLayoutConfig(this.compactLayoutConfig)}_destroy(){this.setOutline(null),this.setPage(null),this.setNodes(null),super._destroy()}_createKeyStrokeContext(){return new Oe}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.keyStrokeContext.$bindTarget=this.session.$entryPoint,this.keyStrokeContext.registerKeyStroke(new Af(this))}setOutline(e){this.outline&&(this.outline.off("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.off("nodesDeleted",this._outlineStructureChangedHandler),this.outline.off("nodesInserted",this._outlineStructureChangedHandler),this.outline.off("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.off("childNodeOrderChanged",this._outlineStructureChangedHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.on("nodesDeleted",this._outlineStructureChangedHandler),this.outline.on("nodesInserted",this._outlineStructureChangedHandler),this.outline.on("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.on("childNodeOrderChanged",this._outlineStructureChangedHandler))}setCompact(e){this.setProperty("compact",e)}_setCompact(e){this._setProperty("compact",e),this.compact?this.setLayoutConfig(this.compactLayoutConfig):this.initialized&&this.setLayoutConfig(new tr),this.setGridColumnCount(this.compact?3:4),this.startupAnimationEnabled=!this.compact,this.initialized&&this._rebuild()}_setCompactLayoutConfig(e){e||(e=new tr),this._setProperty("compactLayoutConfig",tr.ensure(e))}setPage(e){this._setProperty("page",e)}setNodes(e){this._setProperty("nodes",e),this._rebuild()}_createPageTiles(e){return(e||[]).map(t=>this._createPageTile(t))}_createPageTile(e){let t=u.create(Ef,{parent:this,outline:this.outline,page:e}),r=u.create(Zp,{parent:this,cssClass:this.compact?"compact":null,tileWidget:t});return e.tile=r,r}_rebuild(){this.setTiles(this._createPageTiles(this.nodes))}_onOutlineNodeChanged(e){let r=(e.node||e.page).tile;if(!r)return;r.tileWidget.notifyPageChanged()}_onOutlineStructureChanged(e){if(this.page)this.page===e.parentNode&&this.setNodes(this.page.childNodes);else{let t=e;(t.nodes&&t.nodes.some(s=>!s.parentNode)||e.type==="allChildNodesDeleted")&&this.setNodes(this.outline.nodes)}}}class Af extends Yn{constructor(e){super(),this.field=e,this.registerRange(_[1],()=>_[Math.min(this._tiles().length,9)]),this.renderingHints.$drawingArea=(t,r)=>{let s=r.which-_[1],o=this._tiles();return s<o.length&&o[s].tileWidget instanceof Tl?o[s].tileWidget.$fieldContainer:null}}_accept(e){if(!super._accept(e)||this.field&&this.field.outline&&this.field.outline.inBackground)return!1;let r=_.codesToKeys[e.which]-1,s=this._tiles();return!!(r<s.length&&s[r].tileWidget instanceof Tl&&(e._$element=s[r].$container,e._$element))}handle(e){e._$element.data("widget").tileWidget.doAction()}_tiles(){return this.field.tiles}}class Df extends ai{constructor(){super(),this.leaf=!0}_init(e){u.assertParameter("row",e.row,Qt),super._init(e),this.text=this.row.cells[0].text}}class Mf{accept(e){return e.parentNode?e.parentNode.filterAccepted?!e.parentNode.detailTable||!e.row?!0:e.row.filterAccepted:!1:!0}}function xe(i,e,t){return e=cR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cR(i){var e=pR(i,"string");return typeof e=="symbol"?e:String(e)}function pR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class fr extends fe{constructor(){super(),xe(this,"compact",void 0),xe(this,"defaultDetailForm",void 0),xe(this,"detailContent",void 0),xe(this,"embedDetailContent",void 0),xe(this,"inBackground",void 0),xe(this,"iconId",void 0),xe(this,"iconVisible",void 0),xe(this,"mediator",void 0),xe(this,"navigateButtonsVisible",void 0),xe(this,"navigateUpInProgress",void 0),xe(this,"icon",void 0),xe(this,"outlineOverview",void 0),xe(this,"outlineOverviewVisible",void 0),xe(this,"title",void 0),xe(this,"titleVisible",void 0),xe(this,"titleMenuBar",void 0),xe(this,"nodeMenuBar",void 0),xe(this,"nodeMenuBarVisible",void 0),xe(this,"detailMenuBar",void 0),xe(this,"nodePaddingLevelHierarchyRow",void 0),xe(this,"detailMenuBarVisible",void 0),xe(this,"selectedViewTabs",void 0),xe(this,"views",void 0),xe(this,"dialogs",void 0),xe(this,"formController",void 0),xe(this,"messageBoxes",void 0),xe(this,"messageBoxController",void 0),xe(this,"fileChoosers",void 0),xe(this,"fileChooserController",void 0),xe(this,"$title",void 0),xe(this,"$titleText",void 0),xe(this,"_detailContentDestroyHandler",void 0),xe(this,"_detailMenusNodesSelectedHandler",void 0),xe(this,"_detailMenusChangeHandler",void 0),xe(this,"_detailMenusDestroyHandler",void 0),xe(this,"_defaultDetailFormDestroyHandler",void 0),this.compact=!1,this.defaultDetailForm=null,this.detailContent=null,this.embedDetailContent=!1,this.inBackground=!1,this.iconId=null,this.iconVisible=!1,this.mediator=null,this.navigateButtonsVisible=!0,this.navigateUpInProgress=!1,this.outlineOverview=null,this.outlineOverviewVisible=!0,this.toggleBreadcrumbStyleEnabled=!0,this.title=null,this.titleVisible=!0,this.menus=[],this.titleMenuBar=null,this.nodeMenuBar=null,this.nodeMenuBarVisible=!1,this.detailMenuBar=null,this.detailMenuBarVisible=!1,this.dialogs=[],this.views=[],this.messageBoxes=[],this.fileChoosers=[],this.formController=null,this.messageBoxController=null,this.fileChooserController=null,this.textFilterEnabled=!1,this._detailContentDestroyHandler=this._onDetailContentDestroy.bind(this),this._detailMenusNodesSelectedHandler=null,this._defaultDetailFormDestroyHandler=this._onDefaultDetailFormDestroy.bind(this),this._additionalContainerClasses+=" outline",this.nodePaddingLevelCheckable=20,this.nodePaddingLevelNotCheckable=20,this.nodePaddingLevelHierarchyRow=this.nodePaddingLevelNotCheckable,this._scrollDirections="y",this._addWidgetProperties(["defaultDetailForm","views","selectedViewTabs","dialogs","messageBoxes","fileChoosers"])}_init(e){this.compact=u.nvl(e.compact,e.parent.session.desktop.displayStyle===Ie.DisplayStyle.COMPACT),this.embedDetailContent=u.nvl(e.embedDetailContent,this.compact),this.addFilter(new Mf,!1),super._init(e),this.mediator=this._createMediator(),this.formController=u.create(ml,{displayParent:this,session:this.session}),this.messageBoxController=new gl(this,this.session),this.fileChooserController=new ll(this,this.session),this.resolveTextKeys(["title"]),this.titleMenuBar=u.create(ce,{parent:this,menuOrder:new rs}),this.nodeMenuBar=u.create(ce,{parent:this,position:ce.Position.BOTTOM,menuOrder:new rs}),this.detailMenuBar=u.create(ce,{parent:this,position:ce.Position.BOTTOM,menuOrder:new rs}),this._setDefaultDetailForm(this.defaultDetailForm),this._setOutlineOverviewVisible(this.outlineOverviewVisible),this._setOutlineOverview(this.outlineOverview),this._updateOutlineOverview(),this._setViews(this.views),this._setMenus(this.menus),this.updateDetailContent()}_createMediator(){return u.create($f)}insertNode(e,t){super.insertNode(e,t)}_createTreeNode(e){return e=e||{},e.objectType=u.nvl(e.objectType,ai),e.parent=this,u.create(e)}_createKeyStrokeContext(){return new If(this)}_filterMenus(e,t,r,s){return[]}_initTreeKeyStrokeContext(){let e=Se.CTRL|Se.SHIFT;this.keyStrokeContext.registerKeyStrokes([new Ga(this,e),new Ua(this,e),new kf(this,e),new qa(this,e),new Ya(this,e),new ja(this,e)]),this.keyStrokeContext.$bindTarget=()=>this.session.$entryPoint}_render(){super._render(),this.htmlComp.setLayout(new Ad(this)),this._renderCompact(),this._renderEmbedDetailContent(),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}_renderProperties(){super._renderProperties(),this._renderTitle(),this._updateIcon(),this._renderTitleMenuBar()}_computeNodePaddingLeft(e){return this._computeNodePaddings(),this.compact&&e.row&&e.getOutline().selectedNode()!==e?this.nodePaddingLeft+e.row.hierarchyLevel*this.nodePaddingLevelHierarchyRow:super._computeNodePaddingLeft(e)}_remove(){super._remove(),this._removeTitle(),this._removeIcon()}_renderTitle(){this.titleVisible&&(this.$title||(this.$title=this.$container.prependDiv("outline-title").on("mousedown",this._onTitleMouseDown.bind(this)).toggleClass("touch",F.get().supportsOnlyTouch()),this.$titleText=this.$title.prependDiv("text")),this.$titleText.text(this.title))}_removeTitle(){this.titleVisible&&(this.$title.remove(),this.$title=null)}setIconVisible(e){this.setProperty("iconVisible",e),this.rendered&&this._updateIcon()}setIconId(e){this.setProperty("iconId",e),this.rendered&&this._updateIcon()}_updateIcon(){if(this.titleVisible&&this.iconVisible&&this.iconId){if(this.icon){this.icon.setIconDesc(this.iconId);return}this.icon=u.create(Qr,{parent:this,iconDesc:this.iconId,prepend:!0}),this.icon.render(this.$title)}else{if(!this.icon)return;this.icon.remove(),this.icon=null}}_removeIcon(){this.icon&&(this.icon.remove(),this.icon=null)}_renderTitleMenuBar(){this.titleVisible&&(this.titleMenuBar.render(this.$title),this.titleMenuBar.$container.addClass("prevent-initial-focus"))}_renderEnabled(){super._renderEnabled(),this.$container.setTabbable(!1)}_initTreeNodeInternal(e,t){super._initTreeNodeInternal(e,t),this._initDetailTableAndForm(e),this.trigger("pageInit",{page:e})}_initDetailTableAndForm(e){e.detailTable&&this._initDetailTable(e),e.detailForm&&this._initDetailForm(e)}_initDetailTable(e){this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailTable(e)}_initDetailForm(e){this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailForm(e),e.detailForm.detailForm=!0,e.detailForm.one("destroy",()=>{e.detailForm=null,this._triggerPageChanged(e)})}_createNavigateButtons(e,t){let r=f.ensure(t.staticMenus);if(!this._hasMenu(r,$d)){let s=u.create($d,{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});r.push(s)}if(!this._hasMenu(r,Md)){let s=u.create(Md,{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});r.push(s)}return r}_getMenu(e,t){for(let r=0;r<e.length;r++)if(e[r]instanceof t)return e[r];return null}_hasMenu(e,t){return this._getMenu(e,t)!==null}_onTitleMouseDown(e){this.titleMenuBar.rendered&&this.titleMenuBar.$container.isOrHas(e.target)||this.navigateToTop()}navigateToTop(){this.compact&&this.embedDetailContent?this.selectNodes(this.compactRootNode()||[]):this.deselectAll(),this.handleInitialExpanded(),this.setScrollTop(0)}compactRootNode(){return this.nodes[0]&&this.nodes[0].compactRoot?this.nodes[0]:null}handleInitialExpanded(){this.visitNodes(e=>{this.setNodeExpanded(e,e.initialExpanded,{renderExpansion:!0})})}_onNodeDeleted(e){e.detailTable&&(e.detailTable.destroy(),e.detailTable=null)}selectNodes(e,t){e=f.ensure(e),!(e.length>0&&this.isNodeSelected(e[0]))&&(e.length===0&&this.selectedNodes.length===0||(this.navigateUpInProgress?this.navigateUpInProgress=!1:e.length===1&&this.setDetailFormVisibleByUi(e[0],!0),super.selectNodes(e,t)))}_setSelectedNodes(e,t){super._setSelectedNodes(e,t),this.updateDetailContent()}_nodesSelectedInternal(e){let t=this.activePage();t&&(t.activate(),t.ensureLoadChildren().done(this._onLoadChildrenDone.bind(this,t)))}_renderSelection(){super._renderSelection(),this.$container.toggleClass("node-selected",this.selectedNodes.length>0);let e=this.prevSelectedNode;this.embedDetailContent&&e&&e.$node&&(e.$node.cssHeight(null).cssWidth(null),e.height=e.$node.outerHeight(!0))}_removeNodeSelection(e){e.$text&&!this.isHorizontalScrollingEnabled()&&e.$text.cssWidth(null),super._removeNodeSelection(e)}setDefaultDetailForm(e){this.setProperty("defaultDetailForm",e)}_setDefaultDetailForm(e){this.defaultDetailForm&&(this.defaultDetailForm.detailForm=!1,this.defaultDetailForm.off("destroy",this._defaultDetailFormDestroyHandler)),this._setProperty("defaultDetailForm",e),this.defaultDetailForm&&(this._adaptDefaultDetailForm(this.defaultDetailForm),this.defaultDetailForm.one("destroy",this._defaultDetailFormDestroyHandler)),this.initialized&&(this._updateOutlineOverview(),this.updateDetailContent())}_adaptDefaultDetailForm(e){e.setModal(!1),e.setClosable(!1),e.setDisplayHint(Y.DisplayHint.VIEW),e.setDisplayViewId("C"),e.setShowOnOpen(!1),e.detailForm=!0}_onDefaultDetailFormDestroy(e){this.setDefaultDetailForm(null)}setOutlineOverviewVisible(e){this.setProperty("outlineOverviewVisible",e),this._updateOutlineOverview()}_setOutlineOverviewVisible(e){this._setProperty("outlineOverviewVisible",e)}setOutlineOverview(e){this.setProperty("outlineOverview",e),this._updateOutlineOverview()}_setOutlineOverview(e){e&&(e=this._createChild(e)),this._setProperty("outlineOverview",e)}_updateOutlineOverview(){this.defaultDetailForm?this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null)):this.outlineOverviewVisible?this.outlineOverview||this._setOutlineOverview(this._createOutlineOverview()):this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null))}_createOutlineOverview(){return u.create(Pl,{parent:this,outline:this})}setNavigateButtonsVisible(e){this.setProperty("navigateButtonsVisible",e)}_setNavigateButtonsVisible(e){this._setProperty("navigateButtonsVisible",e),this.visitNodes(this._setNavigateButtonsVisibleForNode.bind(this))}_setNavigateButtonsVisibleForNode(e,t){this.navigateButtonsVisible?(e.detailForm&&this._appendNavigateButtonsForDetailForm(e),e.detailTable&&this._appendNavigateButtonsForDetailTable(e)):(e.detailForm&&this._removeNavigateButtonsForDetailForm(e),e.detailTable&&this._removeNavigateButtonsForDetailTable(e))}_appendNavigateButtonsForDetailForm(e){if(e.detailForm.rootGroupBox){let t=this._createNavigateButtons(e,e.detailForm.rootGroupBox);e.detailForm.rootGroupBox.setStaticMenus(t)}}_appendNavigateButtonsForDetailTable(e){let t=this._createNavigateButtons(e,e.detailTable);e.detailTable.setStaticMenus(t)}_removeNavigateButtonsForDetailForm(e){if(e.detailForm.rootGroupBox){let t=e.detailForm.rootGroupBox.staticMenus.filter(r=>!(r instanceof Fn));e.detailForm.rootGroupBox.setStaticMenus(t)}}_removeNavigateButtonsForDetailTable(e){let t=e.detailTable.staticMenus.filter(r=>!(r instanceof Fn));e.detailTable.setStaticMenus(t)}selectedRow(){let e=this.selectedNode();return!e||!e.detailTable?null:e.detailTable.selectedRow()}selectedNode(){return super.selectedNode()}_isGroupingEnd(e){return e.nodeType===ai.NodeType.TABLE}_isTruncatedNodeTooltipEnabled(){return!1}setDetailFormVisibleByUi(e,t){e.detailFormVisibleByUi=t,this._triggerPageChanged(e)}validateFocus(){this.session.focusManager.validateFocus()}sendToBack(){this.inBackground=!0,this._renderInBackground(),this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach()}bringToFront(){this.inBackground=!1,this._renderInBackground(),this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach()}_renderInBackground(){this.$container.toggleClass("in-background",this.inBackground&&!this.compact)}_renderCompact(){this.$container.toggleClass("compact",this.compact),this.nodePaddingLeft=null,this.nodeControlPaddingLeft=null,this._updateNodePaddingsLeft(),this.invalidateLayoutTree()}_renderEmbedDetailContent(){this.$data.toggleClass("has-detail-content",this.embedDetailContent),this.invalidateLayoutTree()}_renderDetailContent(){if(!this.detailContent||this.detailContent.rendered)return;let e=this.selectedNode();!e.rendered||(e.$text.setVisible(!!e.text),e._decorate(),this.detailContent.render(e.$node),this.detailContent.$container.addClass("detail-content"),this.detailContent.htmlComp&&(this.detailContent.htmlComp.validateRoot=!1),this._ensurePageLayout(e),this.$data.addClass("detail-content-visible"))}nodeById(e){return super.nodeById(e)}nodesByIds(e){return super.nodesByIds(e)}_ensurePageLayout(e){e.htmlComp=S.install(e.$node,this.session),e.htmlComp.setLayout(new Rf(this,e))}_removeDetailContent(){!this.detailContent||(this.detailContent.remove(),this.$data.removeClass("detail-content-visible"))}_postRenderViewRange(){super._postRenderViewRange(),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}setCompact(e){this.setProperty("compact",e)}setEmbedDetailContent(e){this.setProperty("embedDetailContent",e)}_setEmbedDetailContent(e){this._setProperty("embedDetailContent",e),this.updateDetailContent()}_onDetailContentDestroy(e){this.setDetailContent(null),this.updateDetailMenus()}setDetailContent(e){this.detailContent!==e&&(this.rendered&&this._removeDetailContent(),this.detailContent&&this.detailContent.off("destroy",this._detailContentDestroyHandler),this.detailContent instanceof Ma&&this.detailContent.destroy(),this._setProperty("detailContent",e),e&&e.on("destroy",this._detailContentDestroyHandler),this.rendered&&this._renderDetailContent(),this.invalidateLayoutTree())}updateDetailContent(){if(!this.embedDetailContent){this.setDetailContent(null),this.setDetailMenus([]);return}this.setDetailMenuBarVisible(!1),this.setNodeMenuBarVisible(!1),this.setDetailContent(this._computeDetailContent()),this.updateDetailMenus()}_updateScrollTopAfterSelection(){if(!this.embedDetailContent){super._updateScrollTopAfterSelection();return}if(this.validateLayoutTree(),super._updateScrollTopAfterSelection(),this.selectedNodes[0]&&this.selectedNodes[0].parentNode){if(this.prevSelectedNode&&this.prevSelectedNode.isDescendantOf(this.selectedNodes[0]))return;this.scrollTo(this.selectedNodes[0].parentNode,{align:"top",animate:!0})}}_computeDetailContent(){let e=this.selectedNode();if(!e)return null;if(e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi)return e.detailForm;if(e===this.compactRootNode()){let t=this.getRootContent();if(t)return t}return e.row&&e.parentNode.nodeType===ai.NodeType.TABLE?u.create(Ma,{parent:this,table:e.parentNode.detailTable,page:e}):null}getRootContent(){return this.defaultDetailForm?this.defaultDetailForm:this.outlineOverview}updateDetailMenus(){if(!this.embedDetailContent)return;let e=this.selectedNodes,t=e[0],r=[],s=[],o=[],n,l=[];if(this.detailContent&&this.detailContent instanceof Y){let h=this.detailContent.rootGroupBox;h&&(r=h.processMenus.concat(h.menus),h.setMenuBarVisible(!1),this._attachDetailMenusListener(h))}else if(t&&!(this.detailContent instanceof Rd)){t.detailTable&&(n=t.detailTable,r=Ke.filter(n.menus,[W.MenuTypes.EmptySpace],{onlyVisible:!1,enableDisableKeyStrokes:!0}),s=n.tableControls,n.setMenuBarVisible(!1),this._attachDetailMenusListener(n));let h=t.parentNode;h&&h.detailTable&&(n=h.detailTable,r=r.concat(Ke.filter(n.menus,[W.MenuTypes.SingleSelection],{onlyVisible:!1,enableDisableKeyStrokes:!0})),n.setMenuBarVisible(!1),this._attachDetailMenusListener(n))}this.nodeMenuBar.menuItems.filter(h=>h instanceof Co).forEach(h=>h.destroy()),s.forEach(h=>{let p=u.create(Co,Co.adaptTableControlProperties(h,{parent:this,tableControl:h,horizontalAlignment:1}));o.push(p)}),r.forEach(h=>{h.horizontalAlignment===1?o.push(h):l.push(h)}),this.setNodeMenus(o),this.setDetailMenus(l)}_attachDetailMenusListener(e){this._detailMenusChangeHandler||(this._detailMenusChangeHandler=t=>{(t.propertyName==="menus"||t.propertyName==="tableControls")&&this.updateDetailMenus()}),this._detailMenusDestroyHandler||(this._detailMenusDestroyHandler=t=>{e.off("propertyChange",this._detailMenusChangeHandler)}),e.off("propertyChange",this._detailMenusChangeHandler),e.on("propertyChange",this._detailMenusChangeHandler),e.off("destroy",this._detailMenusDestroyHandler),e.one("destroy",this._detailMenusDestroyHandler),this._detailMenusNodesSelectedHandler||(this._detailMenusNodesSelectedHandler={outline:this,menuContainers:[],addMenuContainer:function(t){this.menuContainers.indexOf(t)>-1||this.menuContainers.push(t)},func:function(t){t.type==="nodesSelected"&&(this.menuContainers.forEach(function(r){r.off("propertyChange",this.outline._detailMenusChangeHandler),r.off("destroy",this.outline._detailMenusDestroyHandler)},this),this.menuContainers=[])}},this.addListener(this._detailMenusNodesSelectedHandler)),this._detailMenusNodesSelectedHandler.addMenuContainer(e)}setDetailMenus(e){this.detailMenuBar.setMenuItems([]),this.detailMenuBar.setMenuItems(e),this.setDetailMenuBarVisible(this.detailMenuBar.menuItems.length>0)}_renderDetailMenuBarVisible(){this.detailMenuBarVisible?this._renderDetailMenuBar():this._removeDetailMenuBar()}_renderDetailMenuBar(){if(this.detailMenuBar.rendered)return;let e=this.selectedNode();!e||!e.rendered||(this.detailMenuBar.render(e.$node),this.detailMenuBar.$container.addClass("detail-menubar"),this.detailContent&&this.detailContent.rendered&&this.detailMenuBar.$container.insertBefore(this.detailContent.$container),this._ensurePageLayout(e),this.invalidateLayoutTree())}_removeDetailMenuBar(){!this.detailMenuBar.rendered||(this.detailMenuBar.remove(),this.invalidateLayoutTree())}setDetailMenuBarVisible(e){this.setProperty("detailMenuBarVisible",e)}setNodeMenus(e){this.nodeMenuBar.setMenuItems([]),this.nodeMenuBar.setMenuItems(e),this.setNodeMenuBarVisible(this.nodeMenuBar.menuItems.length>0)}_renderNodeMenuBarVisible(){this.nodeMenuBarVisible?this._renderNodeMenuBar():this._removeNodeMenuBar()}_renderNodeMenuBar(){if(this.nodeMenuBar.rendered)return;let e=this.selectedNode();if(!e||!e.rendered)return;let t=e.$text;this.nodeMenuBar.render(e.$node),this.nodeMenuBar.$container.addClass("node-menubar"),this.nodeMenuBar.$container.insertAfter(t),this.invalidateLayoutTree()}_removeNodeMenuBar(){!this.nodeMenuBar.rendered||(this.nodeMenuBar.remove(),this.invalidateLayoutTree())}setNodeMenuBarVisible(e){this.setProperty("nodeMenuBarVisible",e)}glassPaneTargets(e){return this._glassPaneTargets(e)}_glassPaneTargets(e){let t=this.session.desktop,r=[];return t.navigation&&r.push(t.navigation.$body),t.bench&&t.bench.outlineContent&&f.pushAll(r,t.bench.outlineContent.glassPaneTargets(e)),r}onGlassPaneMouseDown(e,t){let r=this.session.desktop;r.navigation&&t.parent()[0]===r.navigation.$body[0]&&r.bringOutlineToFront()}inFront(){return this.session.desktop.outline===this&&!this.inBackground}acceptDialog(e){return this.session.desktop.outline===this}acceptView(e){return this.session.desktop.outline===this}activateCurrentPage(){let e=this.activePage();e&&e.activate()}activePage(){return this.selectedNode()}_setViews(e){e&&e.forEach(t=>t.setDisplayParent(this)),this._setProperty("views",e)}_setMenus(e){let t=this.menus;if(this.updateKeyStrokes(e,t),this._setProperty("menus",e),this.titleMenuBar){let r=Ke.filter(this.menus,[fe.MenuTypes.Header]);this.titleMenuBar.setMenuItems(r)}}_triggerPageChanged(e){this.trigger("pageChanged",{page:e})}_onLoadChildrenDone(e){e&&this._initDetailTableAndForm(e)}pageChanged(e){e&&this._initDetailTableAndForm(e);let t=this.selectedNode();(!e&&!t||e===t)&&this.updateDetailContent(),this._triggerPageChanged(e)}}function Cl(i,e,t){return e=fR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fR(i){var e=mR(i,"string");return typeof e=="symbol"?e:String(e)}function mR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class us extends Rn{constructor(){super(),Cl(this,"_filterDirty",void 0),Cl(this,"_nodeIdToRowMap",void 0),Cl(this,"_detailTableRowInitHandler",void 0),Cl(this,"_detailTableRowsInsertedHandler",void 0),Cl(this,"_detailTableFilterRemoved",void 0),this._filterDirty=!1,this._nodeIdToRowMap={},this._detailTableRowInitHandler=this._onDetailTableRowInit.bind(this),this._detailTableRowsInsertedHandler=this._onDetailTableRowsInserted.bind(this),this._detailTableFilterRemoved=this._onDetailTableFilterRemoved.bind(this)}_onPageChanged(e){let t=this.widget.nodeById(e.nodeId);t.overviewIconId=e.overviewIconId,t.detailFormVisible=e.detailFormVisible;let r=this.session.getOrCreateWidget(e.detailForm,this.widget);t.setDetailForm(r),t.navigateButtonsVisible=e.navigateButtonsVisible,t.detailTableVisible=e.detailTableVisible;let s=this.session.getOrCreateWidget(e.detailTable,this.widget);t.detailTable!==s&&(t.detailTable&&this._destroyDetailTable(t),t.setDetailTable(s),t.detailTable&&this._initDetailTable(t)),this.widget.pageChanged(t)}onModelAction(e){e.type==="pageChanged"?this._onPageChanged(e):super.onModelAction(e)}_initDetailTable(e){e.detailTable.rows.forEach(this._linkNodeWithRow.bind(this)),e.detailTable.on("rowInit",this._detailTableRowInitHandler),e.detailTable.on("rowsInserted",this._detailTableRowsInsertedHandler),e.detailTable.on("filterRemoved",this._detailTableFilterRemoved)}_destroyDetailTable(e){this._nodeIdToRowMap={},e.detailTable.rows.forEach(this._unlinkNodeWithRow.bind(this)),e.detailTable.off("rowInit",this._detailTableRowInitHandler),e.detailTable.off("rowsInserted",this._detailTableRowsInsertedHandler),e.detailTable.off("filterRemoved",this._detailTableFilterRemoved)}_linkNodeWithRow(e){u.assertParameter("row",e);let t=e.nodeId;if(t===void 0)return;let r=this.widget.nodesMap[t];r?r.linkWithRow(e):this._nodeIdToRowMap[t]=e}_unlinkNodeWithRow(e){let t=this.widget.nodesMap[e.nodeId];t&&t.unlinkWithRow(e)}_onDetailTableRowInit(e){this._linkNodeWithRow(e.row);let t=this.widget.nodesMap[e.row.nodeId];this.widget.isSelectedNode(t)&&!this.widget.detailContent&&this.widget.updateDetailContent()}_onDetailTableRowsInserted(e){let t=e.source;(this._filterDirty||t.filterCount()>0&&e.rows.some(r=>!r.filterAccepted))&&(this._filterDirty=!1,this.widget.filter())}_onDetailTableFilterRemoved(e){let r=e.source.modelAdapter;r&&r._rebuildingTable&&(this._filterDirty=!0)}_linkNodeWithRowLater(e){if(!e.parentNode||!e.parentNode.detailTable||!this._nodeIdToRowMap.hasOwnProperty(e.id))return;let t=this._nodeIdToRowMap[e.id];e.linkWithRow(t),delete this._nodeIdToRowMap[e.id]}_getDefaultNodeObjectType(){return"Page"}static modifyOutlinePrototype(){!ie.get().remote||(v.replacePrototypeFunction(fr,"_computeDetailContent",us._computeDetailContentRemote,!0),v.replacePrototypeFunction(fr,"updateDetailMenus",us.updateDetailMenusRemote,!0),v.replacePrototypeFunction(fr,"_initTreeNodeInternal",us._initTreeNodeInternalRemote,!0),v.replacePrototypeFunction(fr,"_createTreeNode",us._createTreeNodeRemote,!0))}static _computeDetailContentRemote(){if(!this.modelAdapter)return this._computeDetailContentOrig();let e=this.selectedNode();if(!e)return null;if(e.detailForm||e.detailFormResolved)return e.detailFormResolved=!0,this._computeDetailContentOrig();if(!this.session.areRequestsPending()&&!this.session.areEventsQueued())return e.detailFormResolved=!0,this._computeDetailContentOrig();this.session.listen().done(function(t){t.detailFormResolved||(t.detailFormResolved=!0,this.updateDetailContent())}.bind(this,e))}static updateDetailMenusRemote(){if(!this.modelAdapter)return this.updateDetailMenusOrig();if(this.selectedNode()&&this.selectedNode().detailFormResolved)return this.updateDetailMenusOrig()}static _initTreeNodeInternalRemote(e,t){this._initTreeNodeInternalOrig(e,t),this.modelAdapter&&(this.modelAdapter.widget=this,e.detailTable&&this.modelAdapter._initDetailTable(e),this.modelAdapter._linkNodeWithRowLater(e))}}ie.addListener("bootstrap",us.modifyOutlinePrototype);class $f{init(e){}_skipEvent(e){return e===null||e.getOutline()===null||e.leaf}onTableRowsInserted(e,t,r){this._skipEvent(r)||r.getTree().insertNodes(t,r)}onTableRowsDeleted(e,t,r){this._skipEvent(r)||r.getTree().deleteNodes(t,r)}onTableRowsUpdated(e,t){if(this._skipEvent(t))return;let r=t.updatePagesFromTableRows(e.rows);t.getTree().updateNodes(r)}onTableRowAction(e,t){let r=e.row.page;if(!r)return;let s=r.getOutline();!s||(s.selectNode(r),s.setNodeExpanded(r,!0))}onTableRowOrderChanged(e,t){if(this._skipEvent(t))return;let r=e.source,s=t.pagesForTableRows(r.rows);t.getOutline().updateNodeOrder(s,t)}onTableFilter(e,t){t.getOutline().filter()}}function gR(i,e,t){return e=_R(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _R(i){var e=bR(i,"string");return typeof e=="symbol"?e:String(e)}function bR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ad extends pl{constructor(e){super(e),gR(this,"outline",void 0),this.outline=e}_layout(e){let t=this.outline.htmlComp;super._layout(e);let r=t.availableSize({exact:!0}).subtract(t.insets());if(this.outline.embedDetailContent){let s=this.outline.selectedNodes[0];if(s&&s.rendered){let o=s.htmlComp;if(o){let n=o.prefSize({widthHint:r.width});o.setSize(new A(r.width,n.height)),s.height=n.height+o.margins().vertical()}}}this.outline.titleMenuBar.validateLayout(),this.outline.nodeMenuBar.validateLayout(),this.outline.detailMenuBar.validateLayout()}_setDataHeight(e){let t=null;this.outline.titleVisible&&(t=w.size(this.outline.$title,!0)),super._setDataHeight(e+(t===null?0:t.height))}}function yR(i,e,t){return e=vR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function vR(i){var e=wR(i,"string");return typeof e=="symbol"?e:String(e)}function wR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Dd extends Tf{constructor(){super(),yR(this,"outline",void 0),this.outline=null,this._addWidgetProperties("outline"),this._addPreserveOnPropertyChangeProperties(["outline"]),this._addCloneProperties(["outline"])}_init(e){super._init(e),this._setOutline(this.outline)}_setOutline(e){this._setProperty("outline",e),this.outline&&this.outline.setIconId(this.iconId)}_setIconId(e){this._setProperty("iconId",e),this.outline&&this.outline.setIconId(this.iconId)}_doAction(){super._doAction(),this.outline&&(this.session.desktop.setOutline(this.outline),this.session.desktop.bringOutlineToFront())}onOutlineChange(e){let t=!!e&&this.outline===e;this.setSelected(t)}}class ob extends Sf{_goOffline(){this.widget.outline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}_goOnline(){this.widget.outline||this.widget.setEnabled(this._enabledBeforeOffline)}}function nb(i,e,t){return e=TR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function TR(i){var e=SR(i,"string");return typeof e=="symbol"?e:String(e)}function SR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class lb extends M{constructor(){super(),nb(this,"outline",void 0),nb(this,"tileOutlineOverview",void 0),this.outline=null,this.tileOutlineOverview=null}_render(){this._ensureTileOutlineOverview(),this.addContainer(this.$parent,"outline-tile-field"),this.tileOutlineOverview.render(this.$container),this.addField(this.tileOutlineOverview.$container)}_ensureTileOutlineOverview(){if(this.tileOutlineOverview)return;let e=this.outline?this.session.getWidget(this.outline):null;this.tileOutlineOverview=u.create(Pl,{parent:this,outline:e})}}class ab extends dt{}function db(i,e,t){return e=CR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CR(i){var e=PR(i,"string");return typeof e=="symbol"?e:String(e)}function PR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Rf extends te{constructor(e,t){super(),db(this,"outline",void 0),db(this,"page",void 0),this.outline=e,this.page=t}layout(e){let t=this.page.htmlComp,r=this.page.$text,s=this.page.$icon(),o=0,n=0,l=this.outline.nodeMenuBar,d=this.outline.detailMenuBar,h=0,p=0,m=t.availableSize({exact:!0}).subtract(t.insets());if(p=m.width,s.length>0&&(p-=w.prefSize(s).width),l.visible){let g=l.htmlComp.prefSize();l.htmlComp.setSize(g),p-=g.add(l.htmlComp.margins()).width}if(r.cssWidth(p),d.visible){h=d.htmlComp.prefSize().height;let g=new A(m.width,h).subtract(d.htmlComp.margins());d.htmlComp.setSize(g)}if(this.outline.detailContent){s.length>0&&(n=s.outerHeight(!0)),r.isVisible()&&(o=r.outerHeight(!0)),o=Math.max(o,n);let g=this.outline.detailContent.htmlComp;g.setSize(new A(m.width,m.height-o-h-g.margins().vertical()))}}preferredLayoutSize(e,t){let r=0,s=this.page.htmlComp,o=new A,n=this.page.$text,l=this.page.$icon(),d=0,h=this.outline.detailMenuBar,p=new A,m=this.outline.nodeMenuBar,g=0;g=t.widthHint,l.length>0&&(g-=w.prefSize(l).width),m.visible&&m.rendered&&(g-=m.htmlComp.prefSize().width);let b=w.prefSize(n,{includeMargin:!0,widthHint:g,enforceSizeHints:!0,exact:!0}).height;if(l.length>0&&(r=l.outerHeight(!0)),d=Math.max(b,r),h.visible&&h.rendered&&(p=h.htmlComp.prefSize()),this.outline.detailContent){let P=this.outline.detailContent.htmlComp;t=$.extend({},t,{enforceSizeHints:!0,exact:!0}),o=P.prefSize(t).add(P.margins())}let C=new A(Math.max(o.width,p.width),d+p.height+o.height);return C=C.add(s.insets()),C}}function Rs(i,e,t){return e=xR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xR(i){var e=FR(i,"string");return typeof e=="symbol"?e:String(e)}function FR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class hb extends fr{constructor(){super(),Rs(this,"hasText",void 0),Rs(this,"searchQuery",void 0),Rs(this,"searchStatus",void 0),Rs(this,"searchFieldKeyStrokeContext",void 0),Rs(this,"$searchPanel",void 0),Rs(this,"$clearIcon",void 0),Rs(this,"$searchStatus",void 0),Rs(this,"$queryField",void 0),this.hasText=!1,this.$searchPanel=null,this.$clearIcon=null,this.$searchStatus=null,this.$queryField=null}_initKeyStrokeContext(){super._initKeyStrokeContext(),this.searchFieldKeyStrokeContext=this._createKeyStrokeContextForSearchField()}_createKeyStrokeContextForSearchField(){let e=new Fr;return e.$scopeTarget=()=>this.$searchPanel,e.$bindTarget=()=>this.$queryField,e.registerStopPropagationKeys(Se.NONE,[_.ENTER,_.BACKSPACE]),e}_render(){super._render(),this.htmlComp.setLayout(new Lf(this)),this.$container.addClass("search-outline"),this.$searchPanel=this.$container.prependDiv("search-outline-panel"),this.$queryField=this.$searchPanel.appendElement("<input>","search-outline-field").on("input",this._createOnQueryFieldInputFunction().bind(this)).on("keypress",this._onQueryFieldKeyPress.bind(this)),this.$clearIcon=this.$searchPanel.appendSpan("clear-icon unfocusable action text-field-icon").on("mousedown",this._onClearIconMouseDown.bind(this)),this.$searchStatus=this.$searchPanel.appendDiv("search-outline-status").on("mousedown",this._onTitleMouseDown.bind(this)),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}_remove(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this.$searchPanel.remove(),super._remove()}_renderProperties(){super._renderProperties(),this._renderSearchQuery(),this._renderSearchStatus(),this._updateHasText()}_renderTitle(){super._renderTitle(),this.titleVisible&&this.$title.insertBefore(this.$searchPanel)}_renderSearchQuery(){this.$queryField.val(this.searchQuery)}_renderSearchStatus(){let e=this.rendered;this.searchStatus&&!this.$searchStatus.isVisible()?e?this.$searchStatus.slideDown({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.show():!this.searchStatus&&this.$searchStatus.isVisible()&&(e?this.$searchStatus.slideUp({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.hide()),this.$searchStatus.textOrNbsp(this.searchStatus),this.$searchPanel.toggleClass("has-status",!!this.searchStatus)}focusQueryField(){this.validateFocus()}_triggerSearch(){this.trigger("search",{query:u.nvl(this.searchQuery,"")})}_createOnQueryFieldInputFunction(){let e=a().debounce(this._search.bind(this));return function(t){this._updateHasText(),e()}}_onClearIconMouseDown(e){this.$queryField.val(""),this._updateHasText(),this._search(),this.$queryField.focus(),e.preventDefault()}_onQueryFieldKeyPress(e){e.which===_.ENTER&&(this._setSearchQuery(this.$queryField.val()),this._triggerSearch())}_search(){let e=this.$queryField.val();this.searchQuery!==e&&(this._setSearchQuery(e),this._triggerSearch())}_setSearchQuery(e){this.searchQuery=e}_updateHasText(){this.$queryField.toggleClass("has-text",!!this.$queryField.val())}validateFocus(){if(!this.rendered)return;let e=this.$queryField[0];this.session.focusManager.requestFocus(e)&&e.select()}}class ub extends us{_initProperties(e){e.requestFocusQueryField!==void 0&&delete e.requestFocusQueryField}_syncRequestFocusQueryField(){this.widget.focusQueryField()}_onWidgetSearch(e){this._send("search",{query:e.query},{showBusyIndicator:!1})}_onWidgetEvent(e){e.type==="search"?this._onWidgetSearch(e):super._onWidgetEvent(e)}}class Lf extends Ad{constructor(e){super(e)}_setDataHeight(e){let t=w.size(this.outline.$searchPanel,!0);e+=t.height,super._setDataHeight(e)}}function xn(i,e,t){return e=ER(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ER(i){var e=AR(i,"string");return typeof e=="symbol"?e:String(e)}function AR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Fn extends le{constructor(){super(),xn(this,"node",void 0),xn(this,"outline",void 0),xn(this,"altKeyStrokeContext",void 0),xn(this,"overflow",void 0),xn(this,"_defaultText",void 0),xn(this,"_defaultIconId",void 0),this.node=null,this.outline=null,this.actionStyle=oe.ActionStyle.BUTTON,this._addCloneProperties(["node","outline","altKeyStrokeContext"]),this.inheritAccessibility=!1}_render(){this.overflow?(this.text=this.session.text(this._defaultText),this.iconId=null):(this.text=null,this.iconId=this._defaultIconId),this.updateEnabled(),super._render(),this.$container.addClass("navigate-button small"),this.altKeyStrokeContext.registerKeyStroke(this)}_remove(){super._remove(),this.altKeyStrokeContext.unregisterKeyStroke(this)}_setDetailVisible(){let e=this._toggleDetail();a().log.isDebugEnabled()&&a().log.debug("show detail-"+(e?"form":"table")),this.outline.setDetailFormVisibleByUi(this.node,e)}_doAction(){super._doAction(),this._isDetail()?this._setDetailVisible():this._drill()}updateEnabled(){this.setEnabled(this._buttonEnabled())}}function cb(i,e,t){return e=DR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DR(i){var e=MR(i,"string");return typeof e=="symbol"?e:String(e)}function MR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Md extends Fn{constructor(){super(),cb(this,"_detailTableRowsSelectedHandler",void 0),cb(this,"_outlinePageRowLinkHandler",void 0),this._defaultIconId=ve.ANGLE_DOWN,this._defaultText="ui.Continue",this.iconId=this._defaultIconId,this.keyStroke="enter",this._detailTableRowsSelectedHandler=this._onDetailTableRowsSelected.bind(this),this._outlinePageRowLinkHandler=this._onOutlinePageRowLink.bind(this)}_init(e){super._init(e),this.node.detailTable&&this.node.detailTable.on("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.on("pageRowLink",this._outlinePageRowLinkHandler)}_destroy(){this.node.detailTable&&this.node.detailTable.off("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.off("pageRowLink",this._outlinePageRowLinkHandler),super._destroy()}_render(){super._render(),this.$container.addClass("down")}_isDetail(){return!!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable&&this.node.detailFormVisibleByUi)}_toggleDetail(){return!1}_buttonEnabled(){if(this._isDetail())return!0;if(this.node.leaf)return!1;let e=this.node.detailTable;return e?e.selectedRows.length===1&&!!e.selectedRows[0].page:!0}_drill(){let e;if(this.node.detailTable){let t=this.node.detailTable.selectedRow();e=this.node.pageForTableRow(t)}else e=this.node.childNodes[0];if(e){a().log.isDebugEnabled()&&a().log.debug("drill down to node "+e);let t=e.parentNode;t&&t.childNodes.forEach(r=>{r.expanded&&r!==e&&this.outline.collapseNode(r,{renderAnimated:!1})}),this.outline.selectNodes(e),t&&t.nodeType===ai.NodeType.TABLE&&this.outline.expandNode(e)}}_onDetailTableRowsSelected(e){this.updateEnabled()}_onOutlinePageRowLink(e){let t=this.node.detailTable;t&&t.selectedRows.length===1&&t.selectedRows[0].page===e.page&&this.updateEnabled()}}class $d extends Fn{constructor(){super(),this._defaultIconId=ve.ANGLE_UP,this._defaultText="ui.Up",this.iconId=this._defaultIconId,this.keyStroke="backspace"}_render(){super._render(),this.$container.addClass("up")}_isDetail(){return!!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable&&!this.node.detailFormVisibleByUi)}_toggleDetail(){return!0}_buttonEnabled(){return!!this.node.parentNode||!!this.outline.defaultDetailForm||!!this.outline.outlineOverview}_drill(){let e=this.node.parentNode;e?(a().log.isDebugEnabled()&&a().log.debug("drill up to node "+e),this.outline.navigateUpInProgress=!0,this.outline.selectNodes(e),this.outline.collapseNode(e,{collapseChildNodes:!0})):(a().log.isDebugEnabled()&&a().log.debug("drill up to top"),this.outline.navigateToTop())}}function $R(i,e,t){return e=RR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function RR(i){var e=LR(i,"string");return typeof e=="symbol"?e:String(e)}function LR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class If extends Oe{constructor(e){super(),$R(this,"_outline",void 0),this._outline=e}accept(e){return!this._outline.inBackground&&!this.isFormMenuOpen()&&super.accept(e)}isFormMenuOpen(){return this._outline.session.desktop.menus.some(t=>t.popup&&t.popup.$container&&t.popup.$container.isAttached())}}class kf extends is{constructor(e,t){super(e,t),this.which=[_.HOME],this.renderingHints.hAlign=ht.RIGHT,this.renderingHints.$drawingArea=(r,s)=>this.field.$title||this.field.$data}handle(e){this.field.navigateToTop()}}function Bf(i,e,t){return e=IR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function IR(i){var e=kR(i,"string");return typeof e=="symbol"?e:String(e)}function kR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Rd extends I{constructor(){super(),Bf(this,"outline",void 0),Bf(this,"displayViewId",void 0),Bf(this,"$content",void 0),this.outline=null}_init(e){super._init(e),!this.outline&&this.parent instanceof fr&&(this.outline=this.parent),u.assertProperty(this,"outline",fr)}_render(){this.$container=this.$parent.appendDiv("outline-overview"),this.htmlComp=S.install(this.$container,this.session),this.$content=this.$container.appendDiv("outline-overview-content"),this.$content.appendDiv("outline-overview-icon").icon(this.outline.iconId),this.$content.appendDiv("outline-overview-title").text(this.outline.title)}_attach(){this.$parent.append(this.$container);let e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),super._attach()}_detach(){this.$container.detach(),super._detach()}}function En(i,e,t){return e=BR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function BR(i){var e=OR(i,"string");return typeof e=="symbol"?e:String(e)}function OR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Pl extends Rd{constructor(){super(),En(this,"pageTileGrid",void 0),En(this,"scrollable",void 0),En(this,"titleVisible",void 0),En(this,"contentHtmlComp",void 0),En(this,"$title",void 0),En(this,"_desktopNavigationVisibilityChangeHandler",void 0),this.pageTileGrid=null,this.scrollable=!0,this.titleVisible=!0,this._addWidgetProperties(["pageTileGrid"]),this._desktopNavigationVisibilityChangeHandler=this._onDesktopNavigationVisibilityChange.bind(this)}_init(e){super._init(e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid()),this.scrollable=!this.outline.compact,this.addCssClass("dimmed-background")}_render(){this.$container=this.$parent.appendDiv("tile-overview"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Ri({stretch:this.outline.compact})),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=S.install(this.$content,this.session),this.contentHtmlComp.setLayout(new Ri({stretch:this.outline.compact})),this.$title=this.$content.appendDiv("tile-overview-title").text(this.outline.title),S.install(this.$title,this.session),this.$title.cssMaxHeight(this.$title.cssHeight()),this._updateTitle(!1),this.findDesktop().on("propertyChange:navigationVisible",this._desktopNavigationVisibilityChangeHandler)}_remove(){super._remove(),this.findDesktop().off("propertyChange:navigationVisible",this._desktopNavigationVisibilityChangeHandler)}_renderProperties(){super._renderProperties(),this._renderPageTileGrid(),this._renderScrollable()}_renderPageTileGrid(){this.pageTileGrid.render(this.$content)}_createPageTileGrid(){let e,t;return this.outline.compact&&(e=this.outline.compactRootNode(),e&&(t=e.childNodes)),u.create(Ed,{parent:this,outline:this.outline,compact:this.outline.compact,page:e,nodes:t})}setScrollable(e){this.setProperty("scrollable",e)}_renderScrollable(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}_updateTitle(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;!this.$title||(this.$title.toggleClass("animated",e),this.$title.toggleClass("removed",this.findDesktop().navigationVisible))}_onDesktopNavigationVisibilityChange(e){this._updateTitle()}}function Of(i,e,t){return e=HR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HR(i){var e=NR(i,"string");return typeof e=="symbol"?e:String(e)}function NR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Hf extends ml{constructor(e){super(e),Of(this,"desktop",void 0),Of(this,"popupWindows",void 0),Of(this,"_documentPopupWindowReadyHandler",void 0),this.desktop=e.displayParent,this.popupWindows=[],this._documentPopupWindowReadyHandler=this._onDocumentPopupWindowReady.bind(this),a()(document).on("popupWindowReady",this._documentPopupWindowReadyHandler)}render(){super.render();let e=this.desktop.activeForm;e?e.activate():this.desktop.bringOutlineToFront()}_renderViews(){super._renderViews(),this.desktop.selectedViewTabs&&this.desktop.selectedViewTabs.forEach(e=>this._activateView(e)),this.desktop.bench&&this.desktop.bench.postRender()}isFormShown(e){return e.isPopupWindow()?this.popupWindows.some(t=>t.form.id===e.id):super.isFormShown(e)}_renderPopupWindow(e,t){let r,s,o=e.readCacheBounds();if(o)r="left="+o.x+",top="+o.y+",width="+o.width+",height="+o.height,s=!1;else{let d=a()(document),h=new A(d.width(),d.height());r="left=0,top=0,width="+h.width+",height="+h.height,s=!0}r+=",location=no,toolbar=no,menubar=no,resizable=yes";let n=u.create(Pn,{session:this.session,preserveOpener:!0}),l="popup-window.html?formId="+e.id;n.openWindow(l,"_blank",r,d=>{this._addPopupWindow(d,e,s)})}_addPopupWindow(e,t,r){let s=new Bs(e,t);s.resizeToPrefSize=r,s.on("popupWindowUnload",this._onPopupWindowUnload.bind(this)),this.popupWindows.push(s),a().log.isDebugEnabled()&&a().log.debug("Opened new popup window for form ID "+t.id)}_onDocumentPopupWindowReady(e,t){a().log.isDebugEnabled()&&a().log.debug("(FormController#_onDocumentPopupWindowReady) data="+t);let r;if(t.formId){let s=t.formId;a().log.isDebugEnabled()&&a().log.debug("Popup window for form ID "+s+" has been reloaded");for(let o=0;o<this.popupWindows.length&&(r=this.popupWindows[o],r.form.id!==s);o++);if(!r)throw new Error("Couldn't find popupWindow reference while popup window was reloaded")}else if(t.popupWindow)r=t.popupWindow;else throw new Error("Neither property 'formId' nor 'popupWindow' exists on data parameter");r._onReady()}_onPopupWindowUnload(e){let t=e.source,r=t.form;a().log.isDebugEnabled()&&a().log.debug("Popup window for form ID "+r.id+" is unloaded - don't know if its closed or reloaded yet"),r.remove(),setTimeout(()=>{t.isClosed()&&(a().log.isDebugEnabled()&&a().log.debug("Popup window for form ID "+r.id+" has been closed"),r.close())},250)}closePopupWindows(){this.popupWindows.forEach(e=>this._removePopupWindow(e.form)),this.popupWindows=[]}_removePopupWindow(e){let t=e.popupWindow;if(!t)throw new Error("Form has no popupWindow reference");delete e.popupWindow,f.remove(this.popupWindows,t),e.rendered&&(e.remove(),t.close())}dispose(){a()(document).off("popupWindowReady",this._documentPopupWindowReadyHandler)}}function VR(i,e,t){return e=WR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function WR(i){var e=KR(i,"string");return typeof e=="symbol"?e:String(e)}function KR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Nf extends Fe{constructor(){super(),VR(this,"filter",void 0),this.gridColumnCount=1,this.cssClass="filter-fields"}_init(e){super._init(e),this.filter.addFilterFields(this)}_renderProperties(){super._renderProperties(),this.filter.modifyFilterFields()}addFilterField(e,t){let r=u.create(e,{parent:this,label:this.session.text(t),statusVisible:!1,labelWidthInPixel:50});return this.addField0(r),r}addField0(e){this.fields.push(e),this._prepareFields()}}function _t(i,e,t){return e=zR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zR(i){var e=GR(i,"string");return typeof e=="symbol"?e:String(e)}function GR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ee{constructor(e){_t(this,"objectType",void 0),_t(this,"modes",void 0),_t(this,"boundaries",void 0),_t(this,"$container",void 0),_t(this,"$window",void 0),_t(this,"$resizableS",void 0),_t(this,"$resizableE",void 0),_t(this,"$resizableSE",void 0),_t(this,"$resizableW",void 0),_t(this,"$resizableSW",void 0),_t(this,"$resizableN",void 0),_t(this,"$resizableNW",void 0),_t(this,"$resizableNE",void 0),_t(this,"_context",void 0),_t(this,"_mouseDownHandler",void 0),_t(this,"_mouseUpHandler",void 0),_t(this,"_mousemoveHandler",void 0),_t(this,"_resizeHandler",void 0),u.assertParameter("model",e),u.assertParameter("$container",e.$container),this.$container=e.$container,this.$window=e.$container.window(),this.setModes(e.modes),this.setBoundaries(e.boundaries),this.$resizableS=null,this.$resizableE=null,this.$resizableSE=null,this.$resizableW=null,this.$resizableSW=null,this.$resizableN=null,this.$resizableNW=null,this.$resizableNE=null,this._context=null,this._mouseDownHandler=this._onMouseDown.bind(this),this._mouseUpHandler=this._onMouseUp.bind(this),this._mousemoveHandler=this._onMousemove.bind(this),this._resizeHandler=this._resize.bind(this)}setModes(e){let t=e||[Ee.MODES.SOUTH,Ee.MODES.EAST,Ee.MODES.WEST,Ee.MODES.NORTH];f.equals(t,this.modes)||(this.modes=t,this._calculateResizeHandlersVisibility())}setBoundaries(e){this.boundaries=a().extend(new qe,e),this._boundaryValueSet(this.boundaries.left)&&(this.boundaries.left-=this.$container.cssMarginLeft()),this._boundaryValueSet(this.boundaries.right)&&(this.boundaries.right-=this.$container.cssMarginRight()),this._boundaryValueSet(this.boundaries.top)&&(this.boundaries.top-=this.$container.cssMarginTop()),this._boundaryValueSet(this.boundaries.bottom)&&(this.boundaries.bottom-=this.$container.cssMarginBottom())}_appendResizeHandles(){this.$resizableS=this.$container.appendDiv("resizable-handle resizable-s").data("edge","s").on("mousedown.resizable",this._mouseDownHandler),this.$resizableE=this.$container.appendDiv("resizable-handle resizable-e").data("edge","e").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSE=this.$container.appendDiv("resizable-handle resizable-se").data("edge","se").on("mousedown.resizable",this._mouseDownHandler),this.$resizableW=this.$container.appendDiv("resizable-handle resizable-w").data("edge","w").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSW=this.$container.appendDiv("resizable-handle resizable-sw").data("edge","sw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableN=this.$container.appendDiv("resizable-handle resizable-n").data("edge","n").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNW=this.$container.appendDiv("resizable-handle resizable-nw").data("edge","nw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNE=this.$container.appendDiv("resizable-handle resizable-ne").data("edge","ne").on("mousedown.resizable",this._mouseDownHandler),this._calculateResizeHandlersVisibility()}_calculateResizeHandlersVisibility(){this.$resizableS&&this.$resizableS.setVisible(this._hasMode(Ee.MODES.SOUTH)),this.$resizableE&&this.$resizableE.setVisible(this._hasMode(Ee.MODES.EAST)),this.$resizableSE&&this.$resizableSE.setVisible(this._hasMode(Ee.MODES.SOUTH)&&this._hasMode(Ee.MODES.EAST)),this.$resizableW&&this.$resizableW.setVisible(this._hasMode(Ee.MODES.WEST)),this.$resizableSW&&this.$resizableSW.setVisible(this._hasMode(Ee.MODES.SOUTH)&&this._hasMode(Ee.MODES.WEST)),this.$resizableN&&this.$resizableN.setVisible(this._hasMode(Ee.MODES.NORTH)),this.$resizableNW&&this.$resizableNW.setVisible(this._hasMode(Ee.MODES.NORTH)&&this._hasMode(Ee.MODES.WEST)),this.$resizableNE&&this.$resizableNE.setVisible(this._hasMode(Ee.MODES.NORTH)&&this._hasMode(Ee.MODES.EAST))}_hasMode(e){return this.modes.some(t=>t===e)}init(){this.$container.addClass("resizable"),this._appendResizeHandles(),this._installRemoveHandler()}_installRemoveHandler(){this.$container.on("remove",this.destroy.bind(this))}destroy(){this.$resizableS&&(this.$resizableS.remove(),this.$resizableS=null),this.$resizableE&&(this.$resizableE.remove(),this.$resizableE=null),this.$resizableSE&&(this.$resizableSE.remove(),this.$resizableSE=null),this.$resizableW&&(this.$resizableW.remove(),this.$resizableW=null),this.$resizableSW&&(this.$resizableSW.remove(),this.$resizableSW=null),this.$resizableN&&(this.$resizableN.remove(),this.$resizableN=null),this.$resizableNW&&(this.$resizableNW.remove(),this.$resizableNW=null),this.$resizableNE&&(this.$resizableNE.remove(),this.$resizableNE=null),this.$container&&this.$container.removeClass("resizable"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler)}_onMouseDown(e){let t=this.$container,r=t.window(),s=a()(e.target),o=t.cssMinWidth(),n=t.cssMinHeight(),l=t.cssMaxWidth(),d=t.cssMaxHeight(),h=w.bounds(t,{exact:!0});this._context={initialBounds:h,minBounds:new re(h.right()-o,h.bottom()-n,o,n),maxBounds:new re(Math.max(-t.cssMarginLeft(),h.right()-l),Math.max(-t.cssMarginTop(),h.bottom()-d),Math.min(r.width()-t[0].offsetLeft,l),Math.min(r.height()-t[0].offsetTop,d)),distance:[0,0],edge:s.data("edge"),mousedownEvent:e},t.addClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler).on("mouseup.resizable",this._mouseUpHandler).on("mousemove.resizable",this._mousemoveHandler),a()("iframe").addClass("dragging-in-progress")}_onMouseUp(e){this.$container.removeClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler),a()("iframe").removeClass("dragging-in-progress"),this._context=null}_onMousemove(e){let t=this._context,r=t.initialBounds.clone(),s=this._calcDistance(t.mousedownEvent,e);u.isOneOf(t.edge,"ne","e","se")?r.width=Math.max(t.minBounds.width,Math.min(t.maxBounds.width,t.initialBounds.width+s[0])):u.isOneOf(t.edge,"nw","w","sw")&&(r.x=Math.min(t.minBounds.x,Math.max(t.maxBounds.x,t.initialBounds.x+s[0])),r.width+=t.initialBounds.x-r.x),u.isOneOf(t.edge,"sw","s","se")?r.height=Math.max(t.minBounds.height,Math.min(t.maxBounds.height,t.initialBounds.height+s[1])):u.isOneOf(t.edge,"nw","n","ne")&&(r.y=Math.min(t.minBounds.y,Math.max(t.maxBounds.y,t.initialBounds.y+s[1])),r.height+=t.initialBounds.y-r.y),a().throttle(this._resizeHandler,Ee.FPS)(r)}_resize(e){this._cropToBoundaries(e),w.setBounds(this.$container,e),this.$container.trigger("resize",{newBounds:e,initialBounds:this._context.initialBounds})}_cropToBoundaries(e){this._boundaryValueSet(this.boundaries.left)&&e.x>this.boundaries.left&&(e.width-=this.boundaries.left-e.x,e.x=this.boundaries.left),this._boundaryValueSet(this.boundaries.right)&&e.x+e.width<this.boundaries.right&&(e.width=this.boundaries.right-e.x),this._boundaryValueSet(this.boundaries.top)&&e.y>this.boundaries.top&&(e.height-=this.boundaries.top-e.y,e.y=this.boundaries.top),this._boundaryValueSet(this.boundaries.bottom)&&e.y+e.height<this.boundaries.bottom&&(e.height=this.boundaries.bottom-e.y)}_boundaryValueSet(e){return e>0}_calcDistance(e,t){let r=t.pageX-e.pageX,s=t.pageY-e.pageY;return[r,s]}}_t(Ee,"MODES",{SOUTH:"s",EAST:"e",WEST:"w",NORTH:"n"}),_t(Ee,"FPS",1e3/15);function pb(i,e,t){return e=UR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function UR(i){var e=qR(i,"string");return typeof e=="symbol"?e:String(e)}function qR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class In extends Y{constructor(){super(),pb(this,"unsavedForms",void 0),pb(this,"openFormsField",void 0),this.unsavedForms=[]}_jsonModel(){return{id:"scout.UnsavedFormChangesForm",type:"model",title:"${textKey:SaveChangesOfSelectedItems}",askIfNeedSave:!1,rootGroupBox:{id:"MainBox",objectType:Fe,menus:[{id:"OkMenu",objectType:_u},{id:"CancelMenu",objectType:gu}],fields:[{id:"UnsavedChangesBox",objectType:Fe,labelVisible:!1,gridColumnCount:1,fields:[{id:"OpenFormsField",objectType:od,gridDataHints:{h:5},labelVisible:!1}]}]}}}_init(e){super._init(e),this.openFormsField=this.widget("OpenFormsField",od),this.openFormsField.setLookupCall(u.create(Vf,{session:this.session,unsavedForms:this.unsavedForms})),this.openFormsField.table.one("rowsInserted",s=>{s.source.checkAll(!0)});let t=u.create(le,{parent:this.openFormsField.table,id:"CheckAllMenu",menuTypes:[W.MenuTypes.EmptySpace],text:"${textKey:CheckAll}"});t.on("action",s=>this.openFormsField.table.checkAll(!0));let r=u.create(le,{parent:this.openFormsField.table,id:"UncheckAllMenu",menuTypes:[W.MenuTypes.EmptySpace],text:"${textKey:UncheckAll}"});r.on("action",s=>this.openFormsField.table.uncheckAll()),this.openFormsField.table.setMenus([t,r]),this.on("postLoad",s=>this.touch())}_validate(){let e=this.getInvalidForms();if(e.length>0){let t=[];return t.push("<p><b>",this.session.text("NotAllCheckedFormsCanBeSaved"),"</b></p>"),t.push(this.session.text("FormsCannotBeSaved"),"<br><br>"),e.forEach(r=>t.push("- ",In.getFormDisplayName(r),"<br>")),E.error({message:t.join("")})}return E.ok()}getInvalidForms(){let e=[];return this.openFormsField.value.forEach(t=>{let r=t.lifecycle.invalidElements(),s=r.missingElements.slice(),o=r.invalidElements.slice();t.visitDisplayChildren(n=>{let l=n.lifecycle.invalidElements();f.pushAll(s,l.missingElements),f.pushAll(o,l.invalidElements)},n=>n instanceof Y),(s.length>0||o.length>0)&&e.push(t)}),e}static getFormDisplayName(e){return[e.title,e.subTitle].filter(Boolean).join(" - ")}}function YR(i,e,t){return e=jR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jR(i){var e=XR(i,"string");return typeof e=="symbol"?e:String(e)}function XR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Vf extends Ko{constructor(){super(),YR(this,"unsavedForms",void 0),this.unsavedForms=[]}_data(){return this.unsavedForms.map(e=>{let t=In.getFormDisplayName(e);return[e,t]})}}function Ls(i,e,t){return e=JR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function JR(i){var e=QR(i,"string");return typeof e=="symbol"?e:String(e)}function QR(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Wf extends Fe{constructor(){super(),Ls(this,"table",void 0),Ls(this,"groupByField",void 0),Ls(this,"sortByField",void 0),Ls(this,"isGrouping",void 0),Ls(this,"isSorting",void 0),Ls(this,"_tableGroupHandler",void 0),Ls(this,"_tableSortHandler",void 0),Ls(this,"_destroyHandler",void 0),this.table=null,this.labelVisible=!1,this.statusVisible=!1,this.gridColumnCount=7,this.bodyLayoutConfig=di.ensure({hgap:8}),this.groupByField=null,this.sortByField=null,this._tableGroupHandler=this._onTableGroup.bind(this),this._tableSortHandler=this._onTableSort.bind(this),this._destroyHandler=this._uninstallListeners.bind(this)}_installListeners(){this.table.on("group",this._tableGroupHandler),this.table.on("sort",this._tableSortHandler),this.table.one("destroy",this._destroyHandler)}_uninstallListeners(){this.table.off("group",this._tableGroupHandler),this.table.off("sort",this._tableSortHandler)}_init(e){super._init(e),this.table=this.parent,this._installListeners(),this.insertField(u.create(ad,{id:"PlaceholderField",parent:this,gridDataHints:{w:5}})),this.groupByField=u.create(ae,{id:"GroupByField",parent:this,label:this.session.text("GroupBy"),labelPosition:M.LabelPosition.ON_FIELD,clearable:ge.Clearable.ALWAYS,statusVisible:!1,displayStyle:ae.DisplayStyle.DROPDOWN}),this.groupByField.setLookupCall(this._createGroupByLookupCall()),this.groupByField.setVisible(!f.empty(this.groupByField.lookupCall.data)),this.groupByField.on("propertyChange",this._onGroupingChange.bind(this)),this.insertField(this.groupByField),this.sortByField=u.create(ae,{id:"SortByField",parent:this,label:this.session.text("SortBy"),labelPosition:M.LabelPosition.ON_FIELD,clearable:ge.Clearable.ALWAYS,statusVisible:!1,displayStyle:ae.DisplayStyle.DROPDOWN}),this.sortByField.setLookupCall(this._createSortByLookupCall()),this.sortByField.setVisible(!f.empty(this.sortByField.lookupCall.data)),this.sortByField.on("propertyChange",this._onSortingChange.bind(this)),this.insertField(this.sortByField),this._syncSortingGroupingFields()}_findSortByLookupRowForKey(e){return this.sortByField.lookupCall.data.map(r=>r[0]).find(r=>r.column===e.column&&r.asc===e.asc)}_createGroupByLookupCall(){return u.create(Du,{session:this.session,table:this.table})}_createSortByLookupCall(){return u.create(Mu,{session:this.session,table:this.table})}_onGroupingChange(e){if(!!this.table.tileMode&&e.propertyName==="value"){if(this.isGrouping=!0,e.newValue!==null){let t=e.newValue,r=t.sortIndex>=0&&!t.sortAscending?"desc":"asc";this.table.groupColumn(t,!1,r,!1)}else{let t=e.oldValue;this.table.groupColumn(t,!1,null,!0)}this.isGrouping=!1}}_onSortingChange(e){if(!!this.table.tileMode&&e.propertyName==="value"){if(this.isSorting=!0,e.newValue!==null){let t=e.newValue;this.table.sort(t.column,t.asc?"asc":"desc",!1,!1)}else{let t=e.oldValue;this.table.sort(t.column,null,!1,!0)}this.isSorting=!1}}_syncSortingGroupingFields(){let e=f.find(this.table.visibleColumns(),r=>r.grouped&&r.sortIndex===0);e?this.groupByField.setValue(e):this.groupByField.setValue(null);let t=f.find(this.table.visibleColumns(),r=>r.sortActive&&r.sortIndex===0);t?this.sortByField.setValue(this._findSortByLookupRowForKey({column:t,asc:t.sortAscending})):this.sortByField.setValue(null)}_onTableGroup(e){this.isGrouping||this._syncSortingGroupingFields()}_onTableSort(e){this.isSorting||this._syncSortingGroupingFields()}}class fb extends ie{init(e){return super.init(e)}_prepareEssentials(e){$t.get().init()}_doBootstrap(e){return[]}_init(e){return e=e||{},e.texts=a().extend({},Ce.readFromDOM(),e.texts),this._prepareDOM(),u.create(Ml,e).render(a()("body").addClass("login-body")),a().resolvedPromise()}}function ni(i,e,t){return e=ZR(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ZR(i){var e=eL(i,"string");return typeof e=="symbol"?e:String(e)}function eL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Ml extends ua{constructor(){super(),ni(this,"ajaxOptions",void 0),ni(this,"authUrl",void 0),ni(this,"onPostDoneFunc",void 0),ni(this,"redirectUrl",void 0),ni(this,"userDataKey",void 0),ni(this,"passwordDataKey",void 0),ni(this,"additionalData",void 0),ni(this,"prepareRedirectUrlFunc",void 0),ni(this,"messageKey",void 0),ni(this,"texts",void 0),ni(this,"$message",void 0),ni(this,"$form",void 0),ni(this,"$user",void 0),ni(this,"$password",void 0),ni(this,"$button",void 0),this.ajaxOptions={type:"POST"},this.authUrl="auth",this.onPostDoneFunc=this.redirect.bind(this),this.redirectUrl=null,this.logoUrl="logo.png",this.userDataKey="user",this.passwordDataKey="password",this.additionalData={},this.prepareRedirectUrlFunc=Ml.prepareRedirectUrl,this.messageKey=null,this.texts=null,this.$message=null,this.$form=null,this.$user=null,this.$password=null,this.$button=null}init(e){e=e||{};let t=a().extend({"ui.Login":"Login","ui.LoginFailed":"Login failed","ui.User":"Username","ui.Password":"Password"},e.texts);delete e.texts,e.ajaxOptions=a().extend(this.ajaxOptions,e.ajaxOptions),a().extend(this,e),this.texts=new Vr(t)}_render(){super._render(),this.$container.addClass("login-box"),this.$content.addClass("login-box-content "),this.$form=a()("<form>").attr("action",this.authUrl).attr("method","post").on("submit",this._onLoginFormSubmit.bind(this)).appendTo(this.$content),this.messageKey&&(this.$message=a()("<div>").attr("id","message-box").addClass("message-box").html(y.nl2br(this.texts.get(this.messageKey))).appendTo(this.$form)),this.$user=a()("<input>").attr("type","text").attr("autocapitalize","off").attr("autocorrect","off").placeholder(this.texts.get("ui.User")).appendTo(this.$form),this.$password=a()("<input>").attr("type","password").placeholder(this.texts.get("ui.Password")).appendTo(this.$form),this.$button=a()("<button>").attr("type","submit").addClass("login-button button default").text(this.texts.get("ui.Login")).appendTo(this.$form),this.$user.focus()}_resetButtonText(){this.$button.text(this.texts.get("ui.Login")).removeClass("login-error")}data(){let e={};return e[this.userDataKey]=this.$user.val(),e[this.passwordDataKey]=this.$password.val(),a().extend(e,this.additionalData),e}_onLoginFormSubmit(e){e.preventDefault();let t=this.$form.attr("action"),r=this.data();this.$button.removeClass("login-error").setEnabled(!1),this.$user.off("input.resetLoginError"),this.$password.off("input.resetLoginError"),F.get().supportsCssAnimation()&&this.$button.html("").append(a()("<div>").addClass("login-button-loading"));let s=a().extend({},this.ajaxOptions,{url:t,data:r});a().ajax(s).done(this._onPostDone.bind(this)).fail(this._onPostFail.bind(this))}redirect(e){this.$backgroundElements.addClass("box-background-elements-fadeout"),F.get().supportsCssAnimation()?this.$backgroundElements.oneAnimationEnd(()=>{this._redirect(e)}):this._redirect(e)}_redirect(e){let t=this.redirectUrl;t||(t=(window.location.href||"").trim(),t=this.prepareRedirectUrlFunc(t)),t?window.location.href=t:window.location.reload()}_onPostDone(e){this.remove(),this.onPostDoneFunc.call(this,e)}_onPostFail(e,t,r){setTimeout(this._onPostFailImpl.bind(this,e,t,r),300)}_onPostFailImpl(e,t,r){this.$button.setEnabled(!0).html("").text(this.texts.get("ui.LoginFailed")).addClass("login-error"),this.$user.val("").focus(),this.$password.val(""),this.$user.one("input.resetLoginError",this._resetButtonText.bind(this)),this.$password.one("input.resetLoginError",this._resetButtonText.bind(this))}static prepareRedirectUrl(e){let t=/^([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e||"");return t[1].replace(/login.html$/,"").replace(/login$/,"").replace(/logout$/,"")+(t[2]?t[2]:"")+(t[3]?t[3]:"")}}class mb extends ie{_prepareEssentials(e){$t.get().init()}_doBootstrap(e){return[]}_init(e){return e=e||{},e.texts=a().extend({},Ce.readFromDOM(),e.texts),this._prepareDOM(),u.create(Kf,e).render(a()("body").addClass("logout-body")),a().resolvedPromise()}}function Ld(i,e,t){return e=tL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tL(i){var e=iL(i,"string");return typeof e=="symbol"?e:String(e)}function iL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Kf extends ua{constructor(){super(),Ld(this,"texts",void 0),Ld(this,"loginUrl",void 0),Ld(this,"options",void 0),Ld(this,"$buttonBar",void 0),this.texts=null,this.loginUrl=null,this.options=null,this.$buttonBar=null}init(e){let t={loginUrl:Pe.getItemFromSessionStorage("scout:loginUrl")||"./",logoUrl:"logo.png"};this.options=a().extend({},t,e);let r={"ui.LogoutSuccessful":"Good bye!","ui.LoginAgain":"Login again"};this.options.texts=a().extend({},r,e.texts),this.texts=new Vr(this.options.texts),this.loginUrl=this.options.loginUrl,this.logoUrl=this.options.logoUrl}_render(){super._render(),this.$content.addClass("small centered").appendDiv().html(y.nl2br(this.texts.get("ui.LogoutSuccessful"))),this.$buttonBar=a()("<div>").addClass("button-bar").appendTo(this.$content),a()("<button>").addClass("button").text(this.texts.get("ui.LoginAgain")).on("click",this._loginAgain.bind(this)).appendTo(this.$buttonBar)}_loginAgain(){window.location.href=this.loginUrl}}function rL(i,e,t){return e=sL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sL(i){var e=oL(i,"string");return typeof e=="symbol"?e:String(e)}function oL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class zf extends oe{constructor(){super(),rL(this,"ref",void 0),this.ref=null}_render(){super._render(),this.$container.addClass("breadcrumb-item")}_renderText(){const e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),S.install(this.$text,this.session)),this.$text.text(e)):this._removeText()}}class gb extends bs{}function _b(i,e,t){return e=nL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nL(i){var e=lL(i,"string");return typeof e=="symbol"?e:String(e)}function lL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class bb extends I{constructor(){super(),_b(this,"breadcrumbItems",void 0),_b(this,"ellipsisBreadcrumbItem",void 0),this.breadcrumbItems=[],this.ellipsisBreadcrumbItem=null,this._addWidgetProperties(["breadcrumbItems"])}_init(e){super._init(e),this._setBreadcrumbItems(this.breadcrumbItems)}_render(){this.$container=this.$parent.appendDiv("breadcrumb-bar"),this.htmlComp=S.install(this.$container,this.session),this.htmlComp.setLayout(new Gf(this))}_renderProperties(){super._renderProperties(),this._renderBreadcrumbItems()}setBreadcrumbItems(e){this.setProperty("breadcrumbItems",e)}_setBreadcrumbItems(e){this._setProperty("breadcrumbItems",f.ensure(e))}_renderBreadcrumbItems(){this.breadcrumbItems.forEach((e,t)=>{t===1&&this._renderEllipsis(),e.render()}),this._updateMarkers(),this.htmlComp.invalidateLayoutTree()}_renderEllipsis(){this.ellipsisBreadcrumbItem&&this.ellipsisBreadcrumbItem.destroy(),!(this.breadcrumbItems.length<=2)&&(this.ellipsisBreadcrumbItem=u.create(zf,{parent:this,text:"...",enabled:!1}),this.ellipsisBreadcrumbItem.render())}_updateMarkers(){const e=[];this.breadcrumbItems.forEach(t=>{t.rendered&&(t.$container.removeClass("first last"),t.isVisible()&&e.push(t))}),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"))}}function aL(i,e,t){return e=dL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dL(i){var e=hL(i,"string");return typeof e=="symbol"?e:String(e)}function hL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Gf extends te{constructor(e){super(),aL(this,"_breadcrumbBar",void 0),this._breadcrumbBar=e}layout(e){this._undoCollapse();const t=this._visibleBreadcrumbItems(),s=this._breadcrumbBar.htmlComp.size();if(this._actualPrefSize(t,!1).width<=s.width){this._applyToEllipsis(n=>n.setVisible(!1));return}this._applyToEllipsis(n=>n.setVisible(!0)),this._collapse(s)}_collapse(e){let t=1;const r=this._visibleBreadcrumbItems();let s=this._actualPrefSize(r,!0);for(;s.width>e.width&&t<r.length-1;)r[t].$container.hide(),r.splice(t,1),s=this._actualPrefSize(r,!0)}_applyToEllipsis(e){this._breadcrumbBar.ellipsisBreadcrumbItem&&e(this._breadcrumbBar.ellipsisBreadcrumbItem)}_undoCollapse(){f.ensure(this._breadcrumbBar.breadcrumbItems).forEach(e=>{e.$container.show()})}preferredLayoutSize(e,t){return this._undoCollapse(),this._actualPrefSize()}_visibleBreadcrumbItems(){return this._breadcrumbBar.breadcrumbItems.filter(e=>e.visible)}_actualPrefSize(e,t){e=e||this._visibleBreadcrumbItems();const r=this._breadcrumbItemsWidth(e,t),s=w.prefSize(this._breadcrumbBar.$container,{includeMargin:!0,useCssSize:!0});return s.width=r+this._breadcrumbBar.htmlComp.insets().horizontal(),s}_breadcrumbItemsWidth(e,t){let r=0;return e=e||this._visibleBreadcrumbItems(),e.forEach(s=>{s.rendered&&(r+=s.$container.outerWidth(!0))}),t&&this._breadcrumbBar.ellipsisBreadcrumbItem&&this._breadcrumbBar.ellipsisBreadcrumbItem.rendered&&(r+=this._breadcrumbBar.ellipsisBreadcrumbItem.$container.outerWidth(!0)),r}}class yb extends He{}function uL(i,e,t){return e=cL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function cL(i){var e=pL(i,"string");return typeof e=="symbol"?e:String(e)}function pL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class vb extends M{constructor(){super(),uL(this,"breadcrumbBar",void 0),this.breadcrumbBar=null,this._addWidgetProperties(["breadcrumbBar"])}_render(){this.addContainer(this.$parent,"breadcrumb-bar-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this._renderBreadcrumbBar()}setBreadcrumbItems(e){!this.breadcrumbBar||this.breadcrumbBar.setBreadcrumbItems(e)}setBreadcrumbBar(e){this.setProperty("breadcrumbBar",e)}_renderBreadcrumbBar(){!this.breadcrumbBar||(this.breadcrumbBar.render(),this.addField(this.breadcrumbBar.$container),this.invalidateLayoutTree())}_removeBreadcrumbBar(){!this.breadcrumbBar||(this.breadcrumbBar.remove(),this._removeField(),this.invalidateLayoutTree())}}class wb extends dt{}function xl(i,e,t){return e=fL(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fL(i){var e=mL(i,"string");return typeof e=="symbol"?e:String(e)}function mL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class wr extends I{constructor(){super(),xl(this,"uuids",void 0),xl(this,"size",void 0),xl(this,"refillThreshold",void 0),xl(this,"failOnStarvation",void 0),xl(this,"refillInProgress",void 0),this.uuids=[],this.size=100,this.refillThreshold=25,this.failOnStarvation=!1,this.refillInProgress=!1}take(){if(!this.uuids.length){if(this.failOnStarvation)throw new Error("UUID pool exhausted");return this.generateUuid()}let e=this.uuids.shift();return this.uuids.length<=this.refillThreshold&&this.refill(),e}refill(){let e=this.size-this.uuids.length;e>0&&this.fill(e)}fill(e){this.trigger("refill",{count:e})}generateUuid(){let e=Date.now()+(performance?performance.now():0);return"zzzzzzzz-zzzz-4zzz-yzzz-zzzzzzzzzzzz".replace(/[zy]/g,t=>{let r=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="z"?r:r&3|8).toString(16)})}static _createInstance(e){return u.create(wr,{parent:e})}static installDesktopAddOn(){ie.addListener("desktopReady",e=>{let t=e.desktop;t.addOns.some(r=>r instanceof wr)||t.addOns.push(wr._createInstance(t))})}static get(e){return e=e||ie.get().sessions[0],u.assertParameter("session",e),f.find(e.desktop.addOns,r=>r instanceof wr)||wr._createInstance(e.desktop)}static take(e){return wr.get(e).take()}}wr.installDesktopAddOn();function gL(i,e,t){return e=_L(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function _L(i){var e=bL(i,"string");return typeof e=="symbol"?e:String(e)}function bL(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}class Tb extends He{constructor(){super(),gL(this,"refillInProgress",void 0),this.refillInProgress=!1}_onWidgetEvent(e){e.type==="refill"?this._onWidgetRefill(e):super._onWidgetEvent(e)}_onWidgetRefill(e){this.refillInProgress||(this.refillInProgress=!0,this._send("refill",{count:e.count},{showBusyIndicator:!1}))}onModelAction(e){e.type==="refill"?this._onModelRefill(e):super.onModelAction(e)}_onModelRefill(e){f.pushAll(this.widget.uuids,e.uuids),this.refillInProgress=!1}}function yL(i){if(!i||t(i.style))return!1;let e=(i instanceof Document?i:i.ownerDocument).defaultView;if(!e||t(e.getComputedStyle(i)))return!1;return!0;function t(r){return r.display==="none"}}function vL(i){let e=[];return i.forEach(t=>{t==="margin"||t==="padding"?(e.push(t+"-top"),e.push(t+"-right"),e.push(t+"-bottom"),e.push(t+"-left")):t==="border"?(e.push("border-top-style"),e.push("border-right-style"),e.push("border-bottom-style"),e.push("border-left-style"),e.push("border-top-color"),e.push("border-right-color"),e.push("border-bottom-color"),e.push("border-left-color"),e.push("border-top-width"),e.push("border-right-width"),e.push("border-bottom-width"),e.push("border-left-width")):e.push(t)}),e}function Id(i){return v.isNumber(i)?Math.ceil(i):i}const wL=a().cleanData;a().cleanData=i=>{let e,t,r;for(r=0;t=i[r];r++)try{e=a()._data(t,"events"),e&&e.remove&&a()(t).triggerHandler("remove")}catch{}wL(i)},a().ensure=i=>i instanceof a()?i:a()(i),a().suppressEvent=i=>{i&&(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation())},a().debounce=(i,e)=>{typeof e=="number"&&(e={delay:e}),e=a().extend({delay:250,reschedule:!0},e);let t=null,r=function(){for(var s=arguments.length,o=new Array(s),n=0;n<s;n++)o[n]=arguments[n];let l=this;t&&!e.reschedule||(t&&clearTimeout(t),t=setTimeout(()=>{t=null,i.apply(l,o)},e.delay))};return r.cancel=()=>t?(clearTimeout(t),t=null,!0):!1,r},a().throttle=(i,e)=>{e=e!==void 0?e:250;let t=null,r;return function(){for(var s=arguments.length,o=new Array(s),n=0;n<s;n++)o[n]=arguments[n];let l=this,d=new Date().getTime(),h=()=>{r=d,i.apply(l,o)};r&&r+e>d?(clearTimeout(t),t=setTimeout(()=>{h()},e)):h()}},a().negate=i=>function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!i.apply(this,t)},a().injectScript=(i,e)=>{e=e||{};let t=a().Deferred(),r=e.document||window.document,s=r.createElement("script");return a()(s).attr("src",i).attr("async",!0).on("load error",o=>{e.removeTag&&r.head.removeChild(s),o.type==="error"?t.reject(a()(s)):t.resolve(a()(s))}),r.head.appendChild(s),t.promise()},a().injectStyleSheet=(i,e)=>{e=e||{};let t=a().Deferred(),r=e.document||window.document,s=r.createElement("link");return a()(s).attr("rel","stylesheet").attr("type","text/css").attr("href",i).on("load error",o=>{o.type==="error"?t.reject(a()(s)):t.resolve(a()(s))}),r.head.appendChild(s),t.promise()},a().injectStyle=(i,e)=>{e=e||{};let t=e.document||window.document,r=t.createElement("style"),s=a()(r);return s.attr("type","text/css").html(i),t.head.appendChild(r),s},a().pxToNumber=i=>i?parseFloat(i):0,a().resolvedDeferred=function(){let i=a().Deferred();return i.resolve(...arguments),i},a().resolvedPromise=function(){let i=a().Deferred();return i.resolve(...arguments),i.promise()},a().rejectedPromise=function(){let i=a().Deferred();return i.reject(...arguments),i.promise()},a().promiseAll=(i,e)=>{e=u.nvl(e,!1),i=f.ensure(i);let t=a().Deferred();return a().when(...i).done(function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];e?t.resolve(s):t.resolve(...s)}).fail(function(){t.reject(...arguments)}),t.promise()},a().ajaxJson=i=>a().ajax({url:i,dataType:"json",contentType:"application/json; charset=UTF-8"}).catch(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.push(this),a().rejectedPromise(...t)}),a().isJqXHR=i=>typeof i=="object"&&i.hasOwnProperty("readyState")&&i.hasOwnProperty("status")&&i.hasOwnProperty("statusText"),a().fn.nvl=function(i){return this.length||!(i instanceof a())?this:i},a().fn.makeElement=function(i,e,t){let r=this.document(!0);if(r===void 0||i===void 0)throw new Error("missing arguments: document, element");let s=a()(i,r);return e&&s.addClass(e),t&&s.text(t),s},a().fn.makeDiv=function(i,e){return this.makeElement("<div>",i,e)},a().fn.makeSpan=function(i,e){return this.makeElement("<span>",i,e)},a().fn.document=function(i){let e=this.length?this[0]instanceof Document?this[0]:this[0].ownerDocument:null;return i?e:a()(e)},a().fn.window=function(i){let e=this.document(!0),t=e?e.defaultView:null;return i?t:a()(t)},a().fn.activeElement=function(i){let e=this.document(!0),t=e?e.activeElement:null;return i?t:a()(t)},a().fn.body=function(i){let e=a()("body",this.document(!0));return i?e[0]:e},a().fn.entryPoint=function(i){let e=this.closest(".scout");return i?e[0]:e},a().fn.windowSize=function(){let i=this.window();return new A(i.width(),i.height())},a().fn.elementFromPoint=function(i,e,t){let r=a()(this),s=r.document(!0),o=[],n=0,l;if(s||(s=r[0]),!s)return a()();for(;l=a()(s.elementFromPoint(i,e)),!(l.length===0||l[0]===s.documentElement||r.isOrHas(l)&&(!t||l.is(t)));)if(o.push(l),l.addClass("invisible"),n++,n>1e3){a().log.warn("Infinite loop aborted",l),l=a()();break}return l[0]===s.documentElement&&r[0]!==s&&(l=a()()),o.forEach(d=>{d.removeClass("invisible")}),l},a().fn.prependDiv=function(i,e){return this.makeDiv(i,e).prependTo(this)},a().fn.appendDiv=function(i,e){return this.makeDiv(i,e).appendTo(this)},a().fn.prependElement=function(i,e,t){return this.makeElement(i,e,t).prependTo(this)},a().fn.appendElement=function(i,e,t){return this.makeElement(i,e,t).appendTo(this)},a().fn.afterDiv=function(i,e){return this.makeDiv(i,e).insertAfter(this)},a().fn.beforeDiv=function(i,e){return this.makeDiv(i,e).insertBefore(this)},a().fn.appendSpan=function(i,e){return this.makeSpan(i,e).appendTo(this)},a().fn.appendBr=function(i){return this.makeElement("<br>",i).appendTo(this)},a().fn.appendTable=function(i){return this.appendElement("<table>",i)},a().fn.appendColgroup=function(i){return this.appendElement("<colgroup>",i)},a().fn.appendCol=function(i){return this.appendElement("<col>",i)},a().fn.appendTr=function(i){return this.appendElement("<tr>",i)},a().fn.appendTd=function(i,e){return this.appendElement("<td>",i,e)},a().fn.appendTh=function(i,e){return this.appendElement("<th>",i,e)},a().fn.appendUl=function(i){return this.appendElement("<ul>",i)},a().fn.appendLi=function(i,e){return this.appendElement("<li>",i,e)},a().fn.appendTextNode=function(i){return a()(this.document(!0).createTextNode(i)).appendTo(this)},a().fn.appendIcon=function(i,e){if(!i)return this.appendSpan(e).addClass("icon");let t;return i instanceof hi?t=i:t=ve.parseIconId(i),t.isFontIcon()?this.makeSpan(e,t.iconCharacter).addClass("icon").addClass(t.appendCssClass("font-icon")).appendTo(this):this.appendImg(t.iconUrl,e).addClass("icon image-icon")},a().fn.appendImg=function(i,e){let t=this.appendElement("<img>",e);return i&&t.attr("src",i),t},a().fn.icon=function(i,e){let t,r=this.data("$icon");return i?(t=ve.parseIconId(i),t.isFontIcon()?s.call(this,r,"<span>",e).addClass("icon").addClass(t.appendCssClass("font-icon")).text(t.iconCharacter):s.call(this,r,"<img>",e).attr("src",t.iconUrl).addClass("icon image-icon")):o.call(this,r),this;function s(n,l,d){return n&&!n.is(l.replace(/[<>]/g,""))&&(o.call(this,n),n=null),n||(n=a()(l),this.data("$icon",n),d?d.call(this,n):this.prepend(n)),n}function o(n){n&&n.remove(),this.removeData("$icon")}},a().fn.makeSVG=function(i,e,t,r){let s=this.document(!0);if(s===void 0||i===void 0)return new Error("missing arguments: document, type");let o=a()(s.createElementNS("http://www.w3.org/2000/svg",i));return e&&o.attr("class",e),t&&o.text(t),r!==void 0&&o.attr("id",r),o},a().fn.appendSVG=function(i,e,t,r){return this.makeSVG(i,e,t,r).appendTo(this)},a().fn.attrXLINK=function(i,e){return this.length===0?this:this.length===1?(this[0].setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+i,e),this):this.each(function(){this.setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+i,e)})},a().fn.appendAppLink=function(i,e){return this.appendSpan().appLink(i,e)},a().fn.appLink=function(i,e){return e?typeof e=="object"&&e._onAppLinkAction&&(e=e._onAppLinkAction.bind(e)):e=function(t){let r=u.widget(this);r&&r._onAppLinkAction&&r._onAppLinkAction(t)}.bind(this),this.addClass("app-link").attr("tabindex","0").unfocusable().on("click",e),typeof i=="string"?this.attr("data-ref",i):this.text(i.name).attr("data-ref",i.ref),this},a().fn.addDeviceClass=function(){return F.get().isIos()&&this.addClass("ios"),this},a().fn.selectOne=function(){return this.siblings().removeClass("selected"),this.addClass("selected"),this},a().fn.select=function(i){return this.toggleClass("selected",!!i)},a().fn.isSelected=function(){return this.hasClass("selected")},a().fn.setEnabled=function(i){return i=!!i,this.toggleClass("disabled",!i),this.is("button, input, select, textarea, optgroup, option, fieldset")&&this.toggleAttr("disabled",!i),this.trigger(i?"enable":"disable"),this},a().fn.isEnabled=function(){return!this.hasClass("disabled")},a().fn.setVisible=function(i){return!this.hasClass("hidden")===i?this:(i?(this.removeClass("hidden"),this.trigger("show")):(this.addClass("hidden"),this.trigger("hide")),this)},a().fn.isVisible=function(){return this.hasClass("hidden")?!1:yL(this[0])},a().fn.isEveryParentVisible=function(){let i=!0;return this.parents().each(function(){if(!a()(this).isVisible())return i=!1,!1}),i},a().fn.isDisplayNone=function(){return this.css("display")==="none"},a().fn.setTabbable=function(i){return this.attr("tabIndex",i?0:null)},a().fn.setTabbableOrFocusable=function(i){return this.attr("tabIndex",i?0:-1)},a().fn.isTabbable=function(){return this.attr("tabIndex")>=0},a().fn.placeholder=function(i){return this.toggleAttr("placeholder",!!i,i)},a().fn.isAttached=function(){return a().contains(this.document(!0).documentElement,this[0])},a().fn.scrollParent=function(){let i=this;for(;i.length>0;){if(i.data("scrollable"))return i;i=i.parent()}return a()()},a().fn.scrollParents=function(){let i=a()(),e=this;for(;e.length>0;)e.data("scrollable")&&i.push(e),e=e.parent();return i},a().fn.findUp=function(i,e){let t=a()(this);for(;t.length>0;){if(i(t))return t;if(e&&t[0]===e[0])return a()();t=t.parent()}return a()()},a().fn.isOrHas=function(i){return i instanceof a()&&(i=i[0]),this[0]===i||this.has(i).length>0},a().fn.animateAVCSD=function(i,e,t,r,s){let o={},n={};return o[i]=e,t&&(n.complete=t),r&&(n.step=r),s&&(n.duration=s),n.queue=!1,this.animate(o,n),this},a().fn.animateSVG=function(i,e,t,r,s){return this.each(function(){let o=parseFloat(a()(this).attr(i));if(s){let n=r;r=function(){n&&n.call(this),a()(this).removeAttr("tabindex")}}a()(this).animate({tabIndex:0},{step:function(n,l){this.setAttribute(i,o+(e-o)*l.pos)},duration:t,complete:r,queue:!1})})},a().fn.addClassForAnimation=function(i,e){let t={classesToRemove:i};return e=a().extend({},t,e),this.addClass(i),this.oneAnimationEnd(r=>{this.removeClass(e.classesToRemove)}),this},a().fn.oneAnimationEnd=function(i){if(!i)return this;let e=t=>{t.target===this[0]&&(this.off("animationend webkitAnimationEnd",e),i(t))};return this.on("animationend webkitAnimationEnd",e)},a().fn.hasAnimationClass=function(){return/(^|\s)animate-/.test(this.attr("class"))},a().fn.cssWidthAnimated=function(i,e,t){return t=t||{},t.duration=u.nvl(t.duration,300),this.cssWidth(i),this.animate({width:e},t),this},a().fn.cssHeightAnimated=function(i,e,t){return t=t||{},t.duration=u.nvl(t.duration,300),this.cssHeight(i),this.animate({height:e},t),this},a().fn.cssLeftAnimated=function(i,e,t){return t=t||{},t.duration=u.nvl(t.duration,300),this.cssLeft(i),this.animate({left:e},t),this},a().fn.cssTopAnimated=function(i,e,t){return t=t||{},t.duration=u.nvl(t.duration,300),this.cssTop(i),this.animate({top:e},t),this},a().fn.cssAnimated=function(i,e,t){return t=t||{},t.duration=u.nvl(t.duration,300),this.css(i),this.animate(e,t),this},a().fn.cssWidthToContentAnimated=function(i){let e=this.outerWidth(),t=this.css("width","auto").outerWidth();return this.cssWidthAnimated(e,t,i),this},a().fn.offsetTo=function(i){let e=i.offset(),t=this.offset();return{top:t.top-e.top,left:t.left-e.left}},a().fn.cssPxValue=function(i,e){return e===void 0?a().pxToNumber(this.css(i)):(e===null&&(e=""),typeof e=="string"?this.css(i,e):this.css(i,e+"px"))},a().fn.cssLeft=function(i){return this.cssPxValue("left",i)},a().fn.cssTop=function(i){return this.cssPxValue("top",i)},a().fn.cssPosition=function(i){return this.cssLeft(i.x).cssTop(i.y)},a().fn.cssBottom=function(i){return this.cssPxValue("bottom",i)},a().fn.cssRight=function(i){return this.cssPxValue("right",i)},a().fn.cssWidth=function(i){return this.cssPxValue("width",i)},a().fn.cssMinWidth=function(i){if(i===void 0){let e=this.css("min-width");return e==="auto"||e.indexOf("%")!==-1?0:a().pxToNumber(e)}return this.cssPxValue("min-width",i)},a().fn.cssMaxWidth=function(i){if(i===void 0){let e=this.css("max-width");return e==="none"||e.indexOf("%")!==-1?Number.MAX_VALUE:a().pxToNumber(e)}return this.cssPxValue("max-width",i)},a().fn.cssHeight=function(i){return this.cssPxValue("height",i)},a().fn.cssMinHeight=function(i){if(i===void 0){let e=this.css("min-height");return e==="auto"||e.indexOf("%")!==-1?0:a().pxToNumber(e)}return this.cssPxValue("min-height",i)},a().fn.cssMaxHeight=function(i){if(i===void 0){let e=this.css("max-height");return e==="none"||e.indexOf("%")!==-1?Number.MAX_VALUE:a().pxToNumber(e)}return this.cssPxValue("max-height",i)},a().fn.cssLineHeight=function(i){return this.cssPxValue("line-height",i)},a().fn.cssMarginLeft=function(i){return this.cssPxValue("margin-left",i)},a().fn.cssMarginBottom=function(i){return this.cssPxValue("margin-bottom",i)},a().fn.cssMarginRight=function(i){return this.cssPxValue("margin-right",i)},a().fn.cssMarginTop=function(i){return this.cssPxValue("margin-top",i)},a().fn.cssMarginX=function(i){return i===void 0?this.cssMarginLeft()+this.cssMarginRight():(this.cssMarginLeft(i),this.cssMarginRight(i),this)},a().fn.cssMarginY=function(i){return i===void 0?this.cssMarginTop()+this.cssMarginBottom():(this.cssMarginTop(i),this.cssMarginBottom(i),this)},a().fn.cssPaddingTop=function(i){return this.cssPxValue("padding-top",i)},a().fn.cssPaddingRight=function(i){return this.cssPxValue("padding-right",i)},a().fn.cssPaddingBottom=function(i){return this.cssPxValue("padding-bottom",i)},a().fn.cssPaddingLeft=function(i){return this.cssPxValue("padding-left",i)},a().fn.cssPaddingX=function(i){return i===void 0?this.cssPaddingLeft()+this.cssPaddingRight():(this.cssPaddingLeft(i),this.cssPaddingRight(i),this)},a().fn.cssPaddingY=function(i){return i===void 0?this.cssPaddingTop()+this.cssPaddingBottom():(this.cssPaddingTop(i),this.cssPaddingBottom(i),this)},a().fn.cssBorderBottomWidth=function(i){return this.cssPxValue("border-bottom-width",i)},a().fn.cssBorderLeftWidth=function(i){return this.cssPxValue("border-left-width",i)},a().fn.cssBorderRightWidth=function(i){return this.cssPxValue("border-right-width",i)},a().fn.cssBorderTopWidth=function(i){return this.cssPxValue("border-top-width",i)},a().fn.cssBorderWidthY=function(i){return i===void 0?this.cssBorderTopWidth()+this.cssBorderBottomWidth():(this.cssBorderTopWidth(i),this.cssBorderBottomWidth(i))},a().fn.cssBorderWidthX=function(i){return i===void 0?this.cssBorderLeftWidth()+this.cssBorderRightWidth():(this.cssBorderLeftWidth(i),this.cssBorderRightWidth(i))},a().fn.innerBottom=function(){return this.position().top+this.outerHeight(!0)-this.cssMarginBottom()-this.cssBorderBottomWidth()},a().fn.innerRight=function(){return this.position().left+this.outerWidth(!0)-this.cssMarginRight()-this.cssBorderRightWidth()},a().fn.copyCss=function(i,e){let t=e.split(" "),r=this;return t=vL(t),t.forEach(s=>{r.css(s,i.css(s))}),r},a().fn.copyCssClasses=function(i,e){let t=e.split(" "),r=this;return t.forEach(s=>{i.hasClass(s)&&r.addClass(s)}),r},a().fn.disableSpellcheck=function(){return this.attr("spellcheck",!1)},a().fn.resizable=function(i){let e=a()(this),t=e.data("resizable");return t?this:(t=u.create(Ee,a().extend(i,{$container:e})),e.data("resizable",t),this)},a().fn.unresizable=function(){let i=a()(this),e=i.data("resizable");return e&&(e.destroy(),i.removeData("resizable")),this},a().fn.draggable=function(i,e){let t=this;return i=i||t,i.on("mousedown.draggable",r=>{a()("iframe").addClass("dragging-in-progress");let s=t.offset(),o=r,n=i.width(),l=i.window().width(),d=i.window().height();i.parents().on("mousemove.dragging",h=>{let p=s.top+(h.pageY-o.pageY),m=s.left+(h.pageX-o.pageX);m=Math.max(100-n,m),m=Math.min(l-100,m),p=Math.max(0,p),p=Math.min(d-100,p);let g={top:p,left:m};t.offset(g),e&&e(g)}).on("mouseup.dragging",h=>{i.parents().off(".dragging"),a()("iframe").removeClass("dragging-in-progress")}),r.preventDefault()})},a().fn.undraggable=function(i){return i=i||this,i.off("mousedown.draggable")},a().fn.fadeOutAndRemove=function(i,e){return e===void 0&&typeof i=="function"&&(e=i,i=void 0),i=u.nvl(i,150),this.stop(!0).fadeOut(i,function(){a()(this).remove(),e&&e.call(this)})},a().fn.removeAnimated=function(i,e){e===void 0&&typeof i=="function"&&(e=i,i=void 0),this.isDisplayNone()?(this.remove(),e&&e.call(this)):F.get().supportsCssAnimation()?(this.addClass(i||"animate-remove"),this.oneAnimationEnd(function(){a()(this).remove(),e&&e.call(this)})):this.fadeOutAndRemove(e)};const TL=a().fn.hide;a().fn.hide=function(){this.trigger("hide");for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return TL.apply(this,e)};const SL=a().fn.width;a().fn.width=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Id(SL.apply(this,e))};const CL=a().fn.outerWidth;a().fn.outerWidth=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Id(CL.apply(this,e))};const PL=a().fn.height;a().fn.height=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Id(PL.apply(this,e))};let xL=a().fn.outerHeight;a().fn.outerHeight=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Id(xL.apply(this,e))},a().fn.textOrNbsp=function(i,e){return this.contentOrNbsp(!1,i,e)},a().fn.htmlOrNbsp=function(i,e){return this.contentOrNbsp(!0,i,e)},a().fn.contentOrNbsp=function(i,e,t){let r=i?this.html:this.text;return y.hasText(e)?(r.call(this,e),t&&this.removeClass(t)):(this.html("&nbsp;"),t&&this.addClass(t)),this},a().fn.toggleAttr=function(i,e,t){return i?(t===void 0&&(t=i),this.each(function(){let r=a()(this);e===void 0&&(e=r.attr(i)===void 0),e?r.attr(i,t):r.removeAttr(i)})):this},a().fn.attrOrRemove=function(i,e){return e?this.attr(i,e):this.removeAttr(i),this},a().fn.unfocusable=function(){return this.addClass("unfocusable")},a().fn.selectAllText=function(){let i,e=this.document(!0),t=this.window(!0),r=this[0];return!e||!e.body||!t||!r?this:(t.getSelection&&(i=e.createRange(),i.selectNodeContents(r),t.getSelection().removeAllRanges(),t.getSelection().addRange(i)),this)},a().fn._getClientAndScrollWidthRounded=function(){let i=this[0];return F.get().isEdge()?{clientWidth:Math.ceil(i.getBoundingClientRect().width)-this.cssBorderWidthX(),scrollWidth:i.scrollWidth}:{clientWidth:i.clientWidth,scrollWidth:i.scrollWidth}},a().fn._getClientAndScrollWidthReliable=function(){let i=this._getClientAndScrollWidthRounded();if(!F.get().isScrollWidthIncludingPadding()||i.scrollWidth>i.clientWidth)return i;let e=this.cssPaddingRight(),t=this.attr("style");if(e>0&&(this.css({width:i.clientWidth-e,paddingRight:"0px"}),i=this._getClientAndScrollWidthRounded(),this.attrOrRemove("style",t),i.scrollWidth>i.clientWidth))return i;let r=this[0].getBoundingClientRect().width;this.css("width","auto"),this.css("max-width","none");let s=this[0].getBoundingClientRect().width;return this.attrOrRemove("style",t),{clientWidth:r,scrollWidth:s}},a().fn.isContentTruncated=function(){let i=this._getClientAndScrollWidthReliable();return i.scrollWidth>i.clientWidth},a().fn.onPassive=function(i,e){let t=lt.passiveOptions();return this[0].addEventListener(i,e,t),this},a().fn.offPassive=function(i,e){let t=lt.passiveOptions();return this[0].removeEventListener(i,e,t),this},a().extend(a().easing,{easeInQuart:i=>Math.pow(i,4),easeOutQuart:i=>1-Math.pow(1-i,4)}),a().ajaxTransport("+binary",(i,e,t)=>{if(window.FormData&&(i.dataType&&i.dataType==="binary"||i.data&&(window.ArrayBuffer&&i.data instanceof ArrayBuffer||window.Blob&&i.data instanceof Blob)))return{send:(r,s)=>{let o=new XMLHttpRequest,n=i.url,l=i.type,d=i.async||!0,h=i.responseType||"blob",p=i.data||null,m=i.username||null,g=i.password||null;o.addEventListener("load",()=>{let b={};b[i.dataType]=o.response,s(o.status,o.statusText,b,o.getAllResponseHeaders())}),o.open(l,n,d,m,g);for(let b in r)o.setRequestHeader(b,r[b]);if(i.xhrFields)for(let b in i.xhrFields)o[b]=i.xhrFields[b];o.responseType=h,o.send(p)},abort:()=>{}}}),window.$!==a()&&(window.$=a());function Sb(i,e){let t=i.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(t)?!i.disabled:t==="a"&&i.href||e)&&FL(i)}function FL(i){return a().expr.filters.visible(i)&&!a()(i).parents().addBack().filter(function(){return a().css(this,"visibility")==="hidden"}).length}a().extend(a().expr[":"],{focusable:i=>Sb(i,!isNaN(a().attr(i,"tabindex"))),tabbable:i=>{let e=a().attr(i,"tabindex"),t=isNaN(e);return(t||e>=0)&&Sb(i,!t)}});const Cb=Rl;let EL={...Rl,...u};$t.get().registerNamespace("scout",EL);var AL=c.AbortKeyStroke,DL=c.AbstractCompactTreeControlKeyStroke,ML=c.AbstractGrid,$L=c.AbstractLayout,RL=c.AbstractTableNavigationKeyStroke,LL=c.AbstractTreeNavigationKeyStroke,IL=c.Accordion,kL=c.AccordionAdapter,BL=c.AccordionField,OL=c.AccordionFieldAdapter,HL=c.AccordionLayout,NL=c.Action,VL=c.ActionAdapter,WL=c.ActionExecKeyStroke,KL=c.ActionKeyStroke,zL=c.AggregateTableControl,GL=c.AggregateTableControlAdapter,UL=c.AjaxCall,qL=c.AjaxError,YL=c.AlphanumericSortingStringColumn,jL=c.App,XL=c.AppLinkKeyStroke,JL=c.AutoLeafPageWithNodes,QL=c.BackgroundJobPollingStatus,ZL=c.BackgroundJobPollingSupport,eI=c.BasicField,tI=c.BasicFieldAdapter,iI=c.BeanColumn,rI=c.BeanField,sI=c.BeanFieldAdapter,oI=c.BeanTile,nI=c.BeanTileAdapter,lI=c.BenchColumn,aI=c.BenchColumnLayoutData,dI=c.BenchRowLayoutData,hI=c.BooleanColumn,uI=c.Box,cI=c.BoxButtons,pI=c.BreadcrumbBar,fI=c.BreadcrumbBarAdapter,mI=c.BreadcrumbBarField,gI=c.BreadcrumbBarFieldAdapter,_I=c.BreadcrumbBarLayout,bI=c.BreadcrumbItem,yI=c.BreadcrumbItemAdapter,vI=c.BrowserField,wI=c.BrowserFieldAdapter,TI=c.BrowserFieldLayout,SI=c.BusyIndicator,CI=c.Button,PI=c.ButtonAdapter,xI=c.ButtonAdapterMenu,FI=c.ButtonKeyStroke,EI=c.ButtonLayout,AI=c.ButtonTile,DI=c.CachedElement,MI=c.Calculator,$I=c.Calendar,RI=c.CalendarAdapter,LI=c.CalendarComponent,II=c.CalendarComponentAdapter,kI=c.CalendarField,BI=c.CalendarFieldAdapter,OI=c.CalendarLayout,HI=c.CalendarListComponent,NI=c.CalendarModeMenu,VI=c.CalendarModesMenu,WI=c.Call,KI=c.CancelMenu,zI=c.Carousel,GI=c.CarouselField,UI=c.CarouselLayout,qI=c.Cell,YI=c.CellEditorCancelEditKeyStroke,jI=c.CellEditorCompleteEditKeyStroke,XI=c.CellEditorPopup,JI=c.CellEditorPopupLayout,QI=c.CellEditorTabKeyStroke,ZI=c.CheckBoxField,ek=c.CheckBoxFieldAdapter,tk=c.CheckBoxToggleKeyStroke,ik=c.ClickActiveElementKeyStroke,rk=c.ClipboardField,sk=c.ClipboardFieldAdapter,ok=c.CloseKeyStroke,nk=c.CloseMenu,lk=c.Code,ak=c.CodeLookupCall,dk=c.CodeType,hk=c.CollapseHandle,uk=c.ColorField,ck=c.ColorFieldAdapter,pk=c.Column,fk=c.ColumnLayout,mk=c.ColumnOptimalWidthMeasurer,gk=c.ColumnUserFilter,_k=c.ComboMenu,bk=c.ComboMenuAdapter,yk=c.CompactBean,vk=c.CompactColumn,wk=c.CompactLine,Tk=c.CompactLineBlock,Sk=c.CompactTree,Ck=c.CompactTreeDownKeyStroke,Pk=c.CompactTreeLeftKeyStroke,xk=c.CompactTreeNode,Fk=c.CompactTreeRightKeyStroke,Ek=c.CompactTreeUpKeyStroke,Ak=c.Composite,Dk=c.CompositeField,Mk=c.CompositeFieldAdapter,$k=c.CompositeTile,Rk=c.ContextMenuKeyStroke,Lk=c.ContextMenuPopup,Ik=c.ContextMenuPopupLayout,kk=c.CopyKeyStroke,Bk=c.DateColumn,Ok=c.DateColumnUserFilter,Hk=c.DateField,Nk=c.DateFieldAdapter,Vk=c.DateFormat,Wk=c.DateFormatPatternDefinition,Kk=c.DateFormatPatternType,zk=c.DatePicker,Gk=c.DatePickerPopup,Uk=c.DatePickerPopupLayout,qk=c.DatePickerTouchPopup,Yk=c.DatePickerTouchPopupLayout,jk=c.DatePredictionFailedStatus,Xk=c.DateRange,Jk=c.DateTimeCompositeLayout,Qk=c.DecimalFormat,Zk=c.DefaultStatus,eB=c.DeferredGlassPaneTarget,tB=c.Desktop,iB=c.DesktopAdapter,rB=c.DesktopBench,sB=c.DesktopFormController,oB=c.DesktopHeader,nB=c.DesktopHeaderLayout,lB=c.DesktopLayout,aB=c.DesktopLogo,dB=c.DesktopNavigation,hB=c.DesktopNavigationHandle,uB=c.DesktopNavigationLayout,cB=c.DesktopNotification,pB=c.DesktopNotificationAdapter,fB=c.DesktopResponsiveHandler,mB=c.DesktopTab,gB=c.DesktopTabArea,_B=c.DesktopTabAreaLayout,bB=c.DesktopTabBoxController,yB=c.DesktopTabSelectKeyStroke,vB=c.DesktopToolBox,wB=c.DetailTableTreeFilter,TB=c.Device,SB=c.DialogLayout,CB=c.Dimension,PB=c.DisableBrowserF5ReloadKeyStroke,xB=c.DisableBrowserTabSwitchingKeyStroke,FB=c.DoubleClickSupport,EB=c.DragAndDropHandler,AB=c.EllipsisMenu,DB=c.EllipsisTabMenu,MB=c.EnlargeNavigationKeyStroke,$B=c.ErrorHandler,RB=c.Event,LB=c.EventDelegator,IB=c.EventEmitter,kB=c.EventSupport,BB=c.Extension,OB=c.FieldStatus,HB=c.FileChooser,NB=c.FileChooserAdapter,VB=c.FileChooserButton,WB=c.FileChooserButtonAdapter,KB=c.FileChooserController,zB=c.FileChooserField,GB=c.FileChooserFieldAdapter,UB=c.FileChooserFieldBrowseKeyStroke,qB=c.FileChooserFieldDeleteKeyStroke,YB=c.FileInput,jB=c.FilterFieldsGroupBox,XB=c.FilterSupport,JB=c.FlexboxLayout,QB=c.FlexboxLayoutData,ZB=c.FocusAdjacentElementKeyStroke,eO=c.FocusContext,tO=c.FocusFilterFieldKeyStroke,iO=c.FocusManager,rO=c.FocusRule,sO=c.Form,oO=c.FormAdapter,nO=c.FormController,lO=c.FormField,aO=c.FormFieldAdapter,dO=c.FormFieldLayout,hO=c.FormFieldMenu,uO=c.FormFieldMenuAdapter,cO=c.FormFieldTile,pO=c.FormFieldTileAdapter,fO=c.FormGrid,mO=c.FormLayout,gO=c.FormLifecycle,_O=c.FormLifecycleMenu,bO=c.FormMenu,yO=c.FormMenuActionKeyStroke,vO=c.FormMenuAdapter,wO=c.FormTableControl,TO=c.FormTableControlAdapter,SO=c.FormTableControlLayout,CO=c.GlassPane,PO=c.GlassPaneRenderer,xO=c.GridData,FO=c.Group,EO=c.GroupAdapter,AO=c.GroupBox,DO=c.GroupBoxAdapter,MO=c.GroupBoxGridConfig,$O=c.GroupBoxLayout,RO=c.GroupBoxMenuItemsOrder,LO=c.GroupBoxResponsiveHandler,IO=c.GroupLayout,kO=c.GroupToggleCollapseKeyStroke,BO=c.HAlign,OO=c.HeaderTabBoxController,HO=c.HierarchicalLookupResultBuilder,NO=c.HorizontalGrid,VO=c.HorizontalGridMatrix,WO=c.HtmlComponent,KO=c.HtmlEncoder,zO=c.HtmlEnvironment,GO=c.HtmlField,UO=c.HtmlFieldAdapter,qO=c.HtmlTile,YO=c.HtmlTileAdapter,jO=c.HybridManager,XO=c.HybridManagerAdapter,JO=c.IFrame,QO=c.Icon,ZO=c.IconColumn,eH=c.IconDesc,tH=c.Image,iH=c.ImageField,rH=c.ImageFieldAdapter,sH=c.ImageFieldLayout,oH=c.ImageLayout,nH=c.InputFieldKeyStrokeContext,lH=c.Insets,aH=c.IntegerField,dH=c.JsFormAdapter,hH=c.Key,uH=c.KeyStroke,cH=c.KeyStrokeContext,pH=c.KeyStrokeManager,fH=c.KeyTableFilter,mH=c.Label,gH=c.LabelAdapter,_H=c.LabelField,bH=c.LabelFieldAdapter,yH=c.LayoutConstants,vH=c.LayoutValidator,wH=c.LazyNodeFilter,TH=c.Lifecycle,SH=c.ListBox,CH=c.ListBoxAdapter,PH=c.ListBoxLayout,xH=c.LoadingSupport,FH=c.Locale,EH=c.LogLevel,AH=c.LogicalGrid,DH=c.LogicalGridConfig,MH=c.LogicalGridData,$H=c.LogicalGridLayout,RH=c.LogicalGridLayoutConfig,LH=c.LogicalGridLayoutInfo,IH=c.LogicalGridMatrix,kH=c.LogicalGridMatrixCell,BH=c.LogicalGridMatrixCursor,OH=c.LoginApp,HH=c.LoginBox,NH=c.LogoutApp,VH=c.LogoutBox,WH=c.LookupBox,KH=c.LookupBoxLayout,zH=c.LookupCall,GH=c.LookupFieldAdapter,UH=c.LookupRow,qH=c.MaxLengthHandler,YH=c.Menu,jH=c.MenuAdapter,XH=c.MenuBar,JH=c.MenuBarBox,QH=c.MenuBarBoxLayout,ZH=c.MenuBarLayout,eN=c.MenuBarLeftKeyStroke,tN=c.MenuBarPopup,iN=c.MenuBarRightKeyStroke,rN=c.MenuBox,sN=c.MenuBoxLayout,oN=c.MenuDestinations,nN=c.MenuExecByNumberKeyStroke,lN=c.MenuExecKeyStroke,aN=c.MenuItemsOrder,dN=c.MenuKeyStroke,hN=c.MenuNavigationDownKeyStroke,uN=c.MenuNavigationExecKeyStroke,cN=c.MenuNavigationKeyStroke,pN=c.MenuNavigationUpKeyStroke,fN=c.MessageBox,mN=c.MessageBoxAdapter,gN=c.MessageBoxController,_N=c.MessageBoxLayout,bN=c.MessageBoxes,yN=c.MobilePopup,vN=c.MobilePopupAdapter,wN=c.MobilePopupLayout,TN=c.Mode,SN=c.ModeAdapter,CN=c.ModeSelector,PN=c.ModeSelectorField,xN=c.ModeSelectorFieldAdapter,FN=c.ModeSelectorLayout,EN=c.ModelAdapter,AN=c.NavigateButton,DN=c.NavigateDownButton,MN=c.NavigateUpButton,$N=c.Notification,RN=c.NotificationAdapter,LN=c.NotificationBadgeStatus,IN=c.NullLayout,kN=c.NullLogger,BN=c.NullWidget,ON=c.NullWidgetAdapter,HN=c.NumberColumn,NN=c.NumberColumnUserFilter,VN=c.NumberField,WN=c.NumberFieldAdapter,KN=c.ObjectFactory,zN=c.OfflineDesktopNotification,GN=c.OkMenu,UN=c.OpenUriHandler,qN=c.Outline,YN=c.OutlineAdapter,jN=c.OutlineKeyStrokeContext,XN=c.OutlineLayout,JN=c.OutlineMediator,QN=c.OutlineNavigateToTopKeyStroke,ZN=c.OutlineOverview,eV=c.OutlineTileField,tV=c.OutlineTileFieldAdapter,iV=c.OutlineViewButton,rV=c.OutlineViewButtonAdapter,sV=c.Page,oV=c.PageLayout,nV=c.PageTileButton,lV=c.PageTileGrid,aV=c.PageTileGridSelectKeyStroke,dV=c.PageWithNodes,hV=c.PageWithTable,uV=c.ParsingFailedStatus,cV=c.PlaceholderField,pV=c.PlaceholderFieldAdapter,fV=c.PlaceholderTile,mV=c.PlainTextEncoder,gV=c.Planner,_V=c.PlannerAdapter,bV=c.PlannerField,yV=c.PlannerFieldAdapter,vV=c.PlannerHeader,wV=c.PlannerLayout,TV=c.PlannerMenuItemsOrder,SV=c.Point,CV=c.Popup,PV=c.PopupAdapter,xV=c.PopupBlockerDesktopNotification,FV=c.PopupBlockerHandler,EV=c.PopupLayout,AV=c.PopupManager,DV=c.PopupManagerAdapter,MV=c.PopupWindow,$V=c.PrepopulatedLookupCall,RV=c.PromiseCreator,LV=c.PropertyChangeEventFilter,IV=c.PropertyEventEmitter,kV=c.ProposalChooser,BV=c.ProposalChooserLayout,OV=c.ProposalField,HV=c.ProposalFieldAdapter,NV=c.ProposalTreeNode,VV=c.QueryBy,WV=c.RadioButton,KV=c.RadioButtonAdapter,zV=c.RadioButtonGroup,GV=c.RadioButtonGroupAdapter,UV=c.RadioButtonGroupGridConfig,qV=c.RadioButtonGroupLayout,YV=c.RadioButtonGroupLeftOrUpKeyStroke,jV=c.RadioButtonGroupRightOrDownKeyStroke,XV=c.RadioButtonKeyStroke,JV=c.RadioButtonLayout,QV=c.Range,ZV=c.RangeKeyStroke,eW=c.Reconnector,tW=c.Rectangle,iW=c.RemoteApp,rW=c.RemoteEvent,sW=c.RemoteLookupCall,oW=c.RemoteLookupRequest,nW=c.RemoteTileFilter,lW=c.ResetMenu,aW=c.Resizable,dW=c.ResponseQueue,hW=c.ResponsiveHandler,uW=c.ResponsiveManager,cW=c.RestLookupCall,pW=c.RoundingMode,fW=c.Route,mW=c.RouteChangeEvent,gW=c.RowLayout,_W=c.SaveMenu,bW=c.Scrollbar,yW=c.SearchOutline,vW=c.SearchOutlineAdapter,wW=c.SearchOutlineLayout,TW=c.SequenceBox,SW=c.SequenceBoxAdapter,CW=c.SequenceBoxGridConfig,PW=c.SequenceBoxLayout,xW=c.Session,FW=c.ShrinkNavigationKeyStroke,EW=c.SimpleLoadingSupport,AW=c.SimpleTab,DW=c.SimpleTabArea,MW=c.SimpleTabAreaLayout,$W=c.SimpleTabBox,RW=c.SimpleTabBoxController,LW=c.SimpleTabBoxLayout,IW=c.SimpleTabViewContentLayout,kW=c.SingleLayout,BW=c.Slider,OW=c.SliderAdapter,HW=c.SliderField,NW=c.SliderLayout,VW=c.SmartColumn,WW=c.SmartField,KW=c.SmartFieldAdapter,zW=c.SmartFieldCancelKeyStroke,GW=c.SmartFieldLayout,UW=c.SmartFieldMultiline,qW=c.SmartFieldMultilineAdapter,YW=c.SmartFieldMultilineLayout,jW=c.SmartFieldPopup,XW=c.SmartFieldPopupLayout,JW=c.SmartFieldTouchPopup,QW=c.SplitBox,ZW=c.SplitBoxAdapter,eK=c.SplitBoxCollapseKeyStroke,tK=c.SplitBoxFirstCollapseKeyStroke,iK=c.SplitBoxLayout,rK=c.SplitBoxSecondCollapseKeyStroke,sK=c.Splitter,oK=c.StaticLookupCall,nK=c.Status,lK=c.StatusMenuMapping,aK=c.StatusMenuMappingAdapter,dK=c.StringField,hK=c.StringFieldAdapter,uK=c.StringFieldCtrlEnterKeyStroke,cK=c.StringFieldEnterKeyStroke,pK=c.StringFieldLayout,fK=c.SubCloseKeyStroke,mK=c.Switch,gK=c.Tab,_K=c.TabArea,bK=c.TabAreaLayout,yK=c.TabAreaLeftKeyStroke,vK=c.TabAreaRightKeyStroke,wK=c.TabBox,TK=c.TabBoxAdapter,SK=c.TabBoxHeader,CK=c.TabBoxHeaderLayout,PK=c.TabBoxLayout,xK=c.TabItem,FK=c.TabItemAdapter,EK=c.TabItemKeyStroke,AK=c.TabItemLayout,DK=c.Table,MK=c.TableAdapter,$K=c.TableCompactHandler,RK=c.TableControl,LK=c.TableControlActionKeyStroke,IK=c.TableControlAdapter,kK=c.TableControlAdapterMenu,BK=c.TableControlCloseKeyStroke,OK=c.TableCopyKeyStroke,HK=c.TableField,NK=c.TableFieldAdapter,VK=c.TableFooter,WK=c.TableFooterLayout,KK=c.TableHeader,zK=c.TableHeaderMenu,GK=c.TableHeaderMenuButton,UK=c.TableHeaderMenuGroup,qK=c.TableHeaderMenuLayout,YK=c.TableInfoFilterTooltip,jK=c.TableInfoLoadTooltip,XK=c.TableInfoSelectionTooltip,JK=c.TableLayout,QK=c.TableLayoutResetter,ZK=c.TableMatrix,ez=c.TableNavigationCollapseKeyStroke,tz=c.TableNavigationDownKeyStroke,iz=c.TableNavigationEndKeyStroke,rz=c.TableNavigationExpandKeyStroke,sz=c.TableNavigationHomeKeyStroke,oz=c.TableNavigationPageDownKeyStroke,nz=c.TableNavigationPageUpKeyStroke,lz=c.TableNavigationUpKeyStroke,az=c.TableProposalChooser,dz=c.TableRefreshKeyStroke,hz=c.TableRow,uz=c.TableRowDetail,cz=c.TableRowTileMapping,pz=c.TableRowTileMappingAdapter,fz=c.TableSelectAllKeyStroke,mz=c.TableSelectionHandler,gz=c.TableStartCellEditKeyStroke,_z=c.TableTextUserFilter,bz=c.TableTileGridMediator,yz=c.TableTileGridMediatorAdapter,vz=c.TableToggleRowKeyStroke,wz=c.TableTooltip,Tz=c.TableUpdateBuffer,Sz=c.TableUserFilter,Cz=c.TagBar,Pz=c.TagBarLayout,xz=c.TagBarOverflowPopup,Fz=c.TagBarOverflowPopupLayout,Ez=c.TagChooserPopup,Az=c.TagChooserPopupLayout,Dz=c.TagField,Mz=c.TagFieldAdapter,$z=c.TagFieldContainerLayout,Rz=c.TagFieldDeleteKeyStroke,Lz=c.TagFieldEnterKeyStroke,Iz=c.TagFieldLayout,kz=c.TagFieldNavigationKeyStroke,Bz=c.TagFieldOpenPopupKeyStroke,Oz=c.TextColumnUserFilter,Hz=c.TextMap,Nz=c.TextTableFilter,Vz=c.Tile,Wz=c.TileAccordion,Kz=c.TileAccordionAdapter,zz=c.TileAccordionLayout,Gz=c.TileAccordionSelectionHandler,Uz=c.TileAdapter,qz=c.TileButton,Yz=c.TileField,jz=c.TileFieldAdapter,Xz=c.TileGrid,Jz=c.TileGridAdapter,Qz=c.TileGridGridConfig,Zz=c.TileGridLayout,eG=c.TileGridLayoutConfig,tG=c.TileGridSelectAllKeyStroke,iG=c.TileGridSelectDownKeyStroke,rG=c.TileGridSelectFirstKeyStroke,sG=c.TileGridSelectKeyStroke,oG=c.TileGridSelectLastKeyStroke,nG=c.TileGridSelectLeftKeyStroke,lG=c.TileGridSelectRightKeyStroke,aG=c.TileGridSelectUpKeyStroke,dG=c.TileGridSelectionHandler,hG=c.TileHtmlField,uG=c.TileOutlineOverview,cG=c.TileOverviewForm,pG=c.TileOverviewFormAdapter,fG=c.TileTableField,mG=c.TileTableHeaderBox,gG=c.TileTableHeaderGroupByLookupCall,_G=c.TileTableHeaderSortByLookupCall,bG=c.TileTableHierarchyFilter,yG=c.TileTextFilter,vG=c.TimePicker,wG=c.TimePickerPopup,TG=c.TimePickerPopupLayout,SG=c.TimePickerTouchPopup,CG=c.Tooltip,PG=c.TooltipSupport,xG=c.TouchPopup,FG=c.TouchPopupLayout,EG=c.Tree,AG=c.TreeAdapter,DG=c.TreeBox,MG=c.TreeBoxAdapter,$G=c.TreeBoxLayout,RG=c.TreeBreadcrumbFilter,LG=c.TreeCollapseAllKeyStroke,IG=c.TreeCollapseOrDrillUpKeyStroke,kG=c.TreeExpandOrDrillDownKeyStroke,BG=c.TreeField,OG=c.TreeFieldAdapter,HG=c.TreeLayout,NG=c.TreeLayoutResetter,VG=c.TreeNavigationDownKeyStroke,WG=c.TreeNavigationEndKeyStroke,KG=c.TreeNavigationUpKeyStroke,zG=c.TreeNode,GG=c.TreeProposalChooser,UG=c.TreeSet,qG=c.TreeSpaceKeyStroke,YG=c.TreeVisitResult,jG=c.TypeDescriptor,XG=c.URL,JG=c.UnsavedFormChangesForm,QG=c.UnsavedFormsLookupCall,ZG=c.UserAgent,e1=c.UuidPool,t1=c.UuidPoolAdapter,i1=c.ValidationFailedStatus,r1=c.ValueField,s1=c.ValueFieldAdapter,o1=c.VerticalGridMatrix,n1=c.VerticalSmartGrid,l1=c.ViewButton,a1=c.ViewButtonActionKeyStroke,d1=c.ViewButtonAdapter,h1=c.ViewButtonBox,u1=c.ViewMenuOpenKeyStroke,c1=c.ViewMenuPopup,p1=c.ViewMenuPopupEnterKeyStroke,f1=c.ViewMenuTab,m1=c.ViewportScroller,g1=c.VirtualKeyStrokeEvent,_1=c.VirtualScrolling,b1=c.Widget,y1=c.WidgetEventTypeFilter,v1=c.WidgetField,w1=c.WidgetFieldAdapter,T1=c.WidgetFieldLayout,S1=c.WidgetPopup,C1=c.WidgetPopupAdapter,P1=c.WidgetPopupLayout,x1=c.WidgetSupport,F1=c.WidgetTile,E1=c.WidgetTileAdapter,A1=c.WidgetTooltip,D1=c.WizardProgressField,M1=c.WizardProgressFieldAdapter,$1=c.WizardProgressFieldLayout,R1=c.WrappedFormField,L1=c.WrappedFormFieldAdapter,I1=c.YearPanel,k1=c.aggregation,B1=c.ajax,O1=c.arrays,H1=c.clipboard,N1=c.codes,V1=c.colorSchemes,W1=c.comparators,K1=c.cookies,z1=c.dates,G1=c.default,U1=c.defaultValues,q1=c.dragAndDrop,Y1=c.events,j1=c.fields,X1=c.files,J1=c.filters,Q1=c.focusUtils,Z1=c.fonts,eU=c.graphics,tU=c.icons,iU=c.inspector,rU=c.isPropertyChangeEvent,sU=c.keyStrokeModifier,oU=c.keys,nU=c.locales,lU=c.logging,aU=c.lookupField,dU=c.menuNavigationKeyStrokes,hU=c.menus,uU=c.mimeTypes,cU=c.models,pU=c.numbers,fU=c.objects,mU=c.promises,gU=c.router,_U=c.scout,bU=c.scrollbars,yU=c.strings,vU=c.styles,wU=c.texts,TU=c.tooltips,SU=c.webstorage,CU=c.widgets;export{AL as AbortKeyStroke,DL as AbstractCompactTreeControlKeyStroke,ML as AbstractGrid,$L as AbstractLayout,RL as AbstractTableNavigationKeyStroke,LL as AbstractTreeNavigationKeyStroke,IL as Accordion,kL as AccordionAdapter,BL as AccordionField,OL as AccordionFieldAdapter,HL as AccordionLayout,NL as Action,VL as ActionAdapter,WL as ActionExecKeyStroke,KL as ActionKeyStroke,zL as AggregateTableControl,GL as AggregateTableControlAdapter,UL as AjaxCall,qL as AjaxError,YL as AlphanumericSortingStringColumn,jL as App,XL as AppLinkKeyStroke,JL as AutoLeafPageWithNodes,QL as BackgroundJobPollingStatus,ZL as BackgroundJobPollingSupport,eI as BasicField,tI as BasicFieldAdapter,iI as BeanColumn,rI as BeanField,sI as BeanFieldAdapter,oI as BeanTile,nI as BeanTileAdapter,lI as BenchColumn,aI as BenchColumnLayoutData,dI as BenchRowLayoutData,hI as BooleanColumn,uI as Box,cI as BoxButtons,pI as BreadcrumbBar,fI as BreadcrumbBarAdapter,mI as BreadcrumbBarField,gI as BreadcrumbBarFieldAdapter,_I as BreadcrumbBarLayout,bI as BreadcrumbItem,yI as BreadcrumbItemAdapter,vI as BrowserField,wI as BrowserFieldAdapter,TI as BrowserFieldLayout,SI as BusyIndicator,CI as Button,PI as ButtonAdapter,xI as ButtonAdapterMenu,FI as ButtonKeyStroke,EI as ButtonLayout,AI as ButtonTile,DI as CachedElement,MI as Calculator,$I as Calendar,RI as CalendarAdapter,LI as CalendarComponent,II as CalendarComponentAdapter,kI as CalendarField,BI as CalendarFieldAdapter,OI as CalendarLayout,HI as CalendarListComponent,NI as CalendarModeMenu,VI as CalendarModesMenu,WI as Call,KI as CancelMenu,zI as Carousel,GI as CarouselField,UI as CarouselLayout,qI as Cell,YI as CellEditorCancelEditKeyStroke,jI as CellEditorCompleteEditKeyStroke,XI as CellEditorPopup,JI as CellEditorPopupLayout,QI as CellEditorTabKeyStroke,ZI as CheckBoxField,ek as CheckBoxFieldAdapter,tk as CheckBoxToggleKeyStroke,ik as ClickActiveElementKeyStroke,rk as ClipboardField,sk as ClipboardFieldAdapter,ok as CloseKeyStroke,nk as CloseMenu,lk as Code,ak as CodeLookupCall,dk as CodeType,hk as CollapseHandle,uk as ColorField,ck as ColorFieldAdapter,pk as Column,fk as ColumnLayout,mk as ColumnOptimalWidthMeasurer,gk as ColumnUserFilter,_k as ComboMenu,bk as ComboMenuAdapter,yk as CompactBean,vk as CompactColumn,wk as CompactLine,Tk as CompactLineBlock,Sk as CompactTree,Ck as CompactTreeDownKeyStroke,Pk as CompactTreeLeftKeyStroke,xk as CompactTreeNode,Fk as CompactTreeRightKeyStroke,Ek as CompactTreeUpKeyStroke,Ak as Composite,Dk as CompositeField,Mk as CompositeFieldAdapter,$k as CompositeTile,Rk as ContextMenuKeyStroke,Lk as ContextMenuPopup,Ik as ContextMenuPopupLayout,kk as CopyKeyStroke,Bk as DateColumn,Ok as DateColumnUserFilter,Hk as DateField,Nk as DateFieldAdapter,Vk as DateFormat,Wk as DateFormatPatternDefinition,Kk as DateFormatPatternType,zk as DatePicker,Gk as DatePickerPopup,Uk as DatePickerPopupLayout,qk as DatePickerTouchPopup,Yk as DatePickerTouchPopupLayout,jk as DatePredictionFailedStatus,Xk as DateRange,Jk as DateTimeCompositeLayout,Qk as DecimalFormat,Zk as DefaultStatus,eB as DeferredGlassPaneTarget,tB as Desktop,iB as DesktopAdapter,rB as DesktopBench,sB as DesktopFormController,oB as DesktopHeader,nB as DesktopHeaderLayout,lB as DesktopLayout,aB as DesktopLogo,dB as DesktopNavigation,hB as DesktopNavigationHandle,uB as DesktopNavigationLayout,cB as DesktopNotification,pB as DesktopNotificationAdapter,fB as DesktopResponsiveHandler,mB as DesktopTab,gB as DesktopTabArea,_B as DesktopTabAreaLayout,bB as DesktopTabBoxController,yB as DesktopTabSelectKeyStroke,vB as DesktopToolBox,wB as DetailTableTreeFilter,TB as Device,SB as DialogLayout,CB as Dimension,PB as DisableBrowserF5ReloadKeyStroke,xB as DisableBrowserTabSwitchingKeyStroke,FB as DoubleClickSupport,EB as DragAndDropHandler,AB as EllipsisMenu,DB as EllipsisTabMenu,MB as EnlargeNavigationKeyStroke,$B as ErrorHandler,RB as Event,LB as EventDelegator,IB as EventEmitter,kB as EventSupport,BB as Extension,OB as FieldStatus,HB as FileChooser,NB as FileChooserAdapter,VB as FileChooserButton,WB as FileChooserButtonAdapter,KB as FileChooserController,zB as FileChooserField,GB as FileChooserFieldAdapter,UB as FileChooserFieldBrowseKeyStroke,qB as FileChooserFieldDeleteKeyStroke,YB as FileInput,jB as FilterFieldsGroupBox,XB as FilterSupport,JB as FlexboxLayout,QB as FlexboxLayoutData,ZB as FocusAdjacentElementKeyStroke,eO as FocusContext,tO as FocusFilterFieldKeyStroke,iO as FocusManager,rO as FocusRule,sO as Form,oO as FormAdapter,nO as FormController,lO as FormField,aO as FormFieldAdapter,dO as FormFieldLayout,hO as FormFieldMenu,uO as FormFieldMenuAdapter,cO as FormFieldTile,pO as FormFieldTileAdapter,fO as FormGrid,mO as FormLayout,gO as FormLifecycle,_O as FormLifecycleMenu,bO as FormMenu,yO as FormMenuActionKeyStroke,vO as FormMenuAdapter,wO as FormTableControl,TO as FormTableControlAdapter,SO as FormTableControlLayout,CO as GlassPane,PO as GlassPaneRenderer,xO as GridData,FO as Group,EO as GroupAdapter,AO as GroupBox,DO as GroupBoxAdapter,MO as GroupBoxGridConfig,$O as GroupBoxLayout,RO as GroupBoxMenuItemsOrder,LO as GroupBoxResponsiveHandler,IO as GroupLayout,kO as GroupToggleCollapseKeyStroke,BO as HAlign,OO as HeaderTabBoxController,HO as HierarchicalLookupResultBuilder,NO as HorizontalGrid,VO as HorizontalGridMatrix,WO as HtmlComponent,KO as HtmlEncoder,zO as HtmlEnvironment,GO as HtmlField,UO as HtmlFieldAdapter,qO as HtmlTile,YO as HtmlTileAdapter,jO as HybridManager,XO as HybridManagerAdapter,JO as IFrame,QO as Icon,ZO as IconColumn,eH as IconDesc,tH as Image,iH as ImageField,rH as ImageFieldAdapter,sH as ImageFieldLayout,oH as ImageLayout,nH as InputFieldKeyStrokeContext,lH as Insets,aH as IntegerField,dH as JsFormAdapter,hH as Key,uH as KeyStroke,cH as KeyStrokeContext,pH as KeyStrokeManager,fH as KeyTableFilter,mH as Label,gH as LabelAdapter,_H as LabelField,bH as LabelFieldAdapter,yH as LayoutConstants,vH as LayoutValidator,wH as LazyNodeFilter,TH as Lifecycle,SH as ListBox,CH as ListBoxAdapter,PH as ListBoxLayout,xH as LoadingSupport,FH as Locale,EH as LogLevel,AH as LogicalGrid,DH as LogicalGridConfig,MH as LogicalGridData,$H as LogicalGridLayout,RH as LogicalGridLayoutConfig,LH as LogicalGridLayoutInfo,IH as LogicalGridMatrix,kH as LogicalGridMatrixCell,BH as LogicalGridMatrixCursor,OH as LoginApp,HH as LoginBox,NH as LogoutApp,VH as LogoutBox,WH as LookupBox,KH as LookupBoxLayout,zH as LookupCall,GH as LookupFieldAdapter,UH as LookupRow,qH as MaxLengthHandler,YH as Menu,jH as MenuAdapter,XH as MenuBar,JH as MenuBarBox,QH as MenuBarBoxLayout,ZH as MenuBarLayout,eN as MenuBarLeftKeyStroke,tN as MenuBarPopup,iN as MenuBarRightKeyStroke,rN as MenuBox,sN as MenuBoxLayout,oN as MenuDestinations,nN as MenuExecByNumberKeyStroke,lN as MenuExecKeyStroke,aN as MenuItemsOrder,dN as MenuKeyStroke,hN as MenuNavigationDownKeyStroke,uN as MenuNavigationExecKeyStroke,cN as MenuNavigationKeyStroke,pN as MenuNavigationUpKeyStroke,fN as MessageBox,mN as MessageBoxAdapter,gN as MessageBoxController,_N as MessageBoxLayout,bN as MessageBoxes,yN as MobilePopup,vN as MobilePopupAdapter,wN as MobilePopupLayout,TN as Mode,SN as ModeAdapter,CN as ModeSelector,PN as ModeSelectorField,xN as ModeSelectorFieldAdapter,FN as ModeSelectorLayout,EN as ModelAdapter,AN as NavigateButton,DN as NavigateDownButton,MN as NavigateUpButton,$N as Notification,RN as NotificationAdapter,LN as NotificationBadgeStatus,IN as NullLayout,kN as NullLogger,BN as NullWidget,ON as NullWidgetAdapter,HN as NumberColumn,NN as NumberColumnUserFilter,VN as NumberField,WN as NumberFieldAdapter,KN as ObjectFactory,zN as OfflineDesktopNotification,GN as OkMenu,UN as OpenUriHandler,qN as Outline,YN as OutlineAdapter,jN as OutlineKeyStrokeContext,XN as OutlineLayout,JN as OutlineMediator,QN as OutlineNavigateToTopKeyStroke,ZN as OutlineOverview,eV as OutlineTileField,tV as OutlineTileFieldAdapter,iV as OutlineViewButton,rV as OutlineViewButtonAdapter,sV as Page,oV as PageLayout,nV as PageTileButton,lV as PageTileGrid,aV as PageTileGridSelectKeyStroke,dV as PageWithNodes,hV as PageWithTable,uV as ParsingFailedStatus,cV as PlaceholderField,pV as PlaceholderFieldAdapter,fV as PlaceholderTile,mV as PlainTextEncoder,gV as Planner,_V as PlannerAdapter,bV as PlannerField,yV as PlannerFieldAdapter,vV as PlannerHeader,wV as PlannerLayout,TV as PlannerMenuItemsOrder,SV as Point,CV as Popup,PV as PopupAdapter,xV as PopupBlockerDesktopNotification,FV as PopupBlockerHandler,EV as PopupLayout,AV as PopupManager,DV as PopupManagerAdapter,MV as PopupWindow,$V as PrepopulatedLookupCall,RV as PromiseCreator,LV as PropertyChangeEventFilter,IV as PropertyEventEmitter,kV as ProposalChooser,BV as ProposalChooserLayout,OV as ProposalField,HV as ProposalFieldAdapter,NV as ProposalTreeNode,VV as QueryBy,WV as RadioButton,KV as RadioButtonAdapter,zV as RadioButtonGroup,GV as RadioButtonGroupAdapter,UV as RadioButtonGroupGridConfig,qV as RadioButtonGroupLayout,YV as RadioButtonGroupLeftOrUpKeyStroke,jV as RadioButtonGroupRightOrDownKeyStroke,XV as RadioButtonKeyStroke,JV as RadioButtonLayout,QV as Range,ZV as RangeKeyStroke,eW as Reconnector,tW as Rectangle,iW as RemoteApp,rW as RemoteEvent,sW as RemoteLookupCall,oW as RemoteLookupRequest,nW as RemoteTileFilter,lW as ResetMenu,aW as Resizable,dW as ResponseQueue,hW as ResponsiveHandler,uW as ResponsiveManager,cW as RestLookupCall,pW as RoundingMode,fW as Route,mW as RouteChangeEvent,gW as RowLayout,_W as SaveMenu,bW as Scrollbar,yW as SearchOutline,vW as SearchOutlineAdapter,wW as SearchOutlineLayout,TW as SequenceBox,SW as SequenceBoxAdapter,CW as SequenceBoxGridConfig,PW as SequenceBoxLayout,xW as Session,FW as ShrinkNavigationKeyStroke,EW as SimpleLoadingSupport,AW as SimpleTab,DW as SimpleTabArea,MW as SimpleTabAreaLayout,$W as SimpleTabBox,RW as SimpleTabBoxController,LW as SimpleTabBoxLayout,IW as SimpleTabViewContentLayout,kW as SingleLayout,BW as Slider,OW as SliderAdapter,HW as SliderField,NW as SliderLayout,VW as SmartColumn,WW as SmartField,KW as SmartFieldAdapter,zW as SmartFieldCancelKeyStroke,GW as SmartFieldLayout,UW as SmartFieldMultiline,qW as SmartFieldMultilineAdapter,YW as SmartFieldMultilineLayout,jW as SmartFieldPopup,XW as SmartFieldPopupLayout,JW as SmartFieldTouchPopup,QW as SplitBox,ZW as SplitBoxAdapter,eK as SplitBoxCollapseKeyStroke,tK as SplitBoxFirstCollapseKeyStroke,iK as SplitBoxLayout,rK as SplitBoxSecondCollapseKeyStroke,sK as Splitter,oK as StaticLookupCall,nK as Status,lK as StatusMenuMapping,aK as StatusMenuMappingAdapter,dK as StringField,hK as StringFieldAdapter,uK as StringFieldCtrlEnterKeyStroke,cK as StringFieldEnterKeyStroke,pK as StringFieldLayout,fK as SubCloseKeyStroke,mK as Switch,gK as Tab,_K as TabArea,bK as TabAreaLayout,yK as TabAreaLeftKeyStroke,vK as TabAreaRightKeyStroke,wK as TabBox,TK as TabBoxAdapter,SK as TabBoxHeader,CK as TabBoxHeaderLayout,PK as TabBoxLayout,xK as TabItem,FK as TabItemAdapter,EK as TabItemKeyStroke,AK as TabItemLayout,DK as Table,MK as TableAdapter,$K as TableCompactHandler,RK as TableControl,LK as TableControlActionKeyStroke,IK as TableControlAdapter,kK as TableControlAdapterMenu,BK as TableControlCloseKeyStroke,OK as TableCopyKeyStroke,HK as TableField,NK as TableFieldAdapter,VK as TableFooter,WK as TableFooterLayout,KK as TableHeader,zK as TableHeaderMenu,GK as TableHeaderMenuButton,UK as TableHeaderMenuGroup,qK as TableHeaderMenuLayout,YK as TableInfoFilterTooltip,jK as TableInfoLoadTooltip,XK as TableInfoSelectionTooltip,JK as TableLayout,QK as TableLayoutResetter,ZK as TableMatrix,ez as TableNavigationCollapseKeyStroke,tz as TableNavigationDownKeyStroke,iz as TableNavigationEndKeyStroke,rz as TableNavigationExpandKeyStroke,sz as TableNavigationHomeKeyStroke,oz as TableNavigationPageDownKeyStroke,nz as TableNavigationPageUpKeyStroke,lz as TableNavigationUpKeyStroke,az as TableProposalChooser,dz as TableRefreshKeyStroke,hz as TableRow,uz as TableRowDetail,cz as TableRowTileMapping,pz as TableRowTileMappingAdapter,fz as TableSelectAllKeyStroke,mz as TableSelectionHandler,gz as TableStartCellEditKeyStroke,_z as TableTextUserFilter,bz as TableTileGridMediator,yz as TableTileGridMediatorAdapter,vz as TableToggleRowKeyStroke,wz as TableTooltip,Tz as TableUpdateBuffer,Sz as TableUserFilter,Cz as TagBar,Pz as TagBarLayout,xz as TagBarOverflowPopup,Fz as TagBarOverflowPopupLayout,Ez as TagChooserPopup,Az as TagChooserPopupLayout,Dz as TagField,Mz as TagFieldAdapter,$z as TagFieldContainerLayout,Rz as TagFieldDeleteKeyStroke,Lz as TagFieldEnterKeyStroke,Iz as TagFieldLayout,kz as TagFieldNavigationKeyStroke,Bz as TagFieldOpenPopupKeyStroke,Oz as TextColumnUserFilter,Hz as TextMap,Nz as TextTableFilter,Vz as Tile,Wz as TileAccordion,Kz as TileAccordionAdapter,zz as TileAccordionLayout,Gz as TileAccordionSelectionHandler,Uz as TileAdapter,qz as TileButton,Yz as TileField,jz as TileFieldAdapter,Xz as TileGrid,Jz as TileGridAdapter,Qz as TileGridGridConfig,Zz as TileGridLayout,eG as TileGridLayoutConfig,tG as TileGridSelectAllKeyStroke,iG as TileGridSelectDownKeyStroke,rG as TileGridSelectFirstKeyStroke,sG as TileGridSelectKeyStroke,oG as TileGridSelectLastKeyStroke,nG as TileGridSelectLeftKeyStroke,lG as TileGridSelectRightKeyStroke,aG as TileGridSelectUpKeyStroke,dG as TileGridSelectionHandler,hG as TileHtmlField,uG as TileOutlineOverview,cG as TileOverviewForm,pG as TileOverviewFormAdapter,fG as TileTableField,mG as TileTableHeaderBox,gG as TileTableHeaderGroupByLookupCall,_G as TileTableHeaderSortByLookupCall,bG as TileTableHierarchyFilter,yG as TileTextFilter,vG as TimePicker,wG as TimePickerPopup,TG as TimePickerPopupLayout,SG as TimePickerTouchPopup,CG as Tooltip,PG as TooltipSupport,xG as TouchPopup,FG as TouchPopupLayout,EG as Tree,AG as TreeAdapter,DG as TreeBox,MG as TreeBoxAdapter,$G as TreeBoxLayout,RG as TreeBreadcrumbFilter,LG as TreeCollapseAllKeyStroke,IG as TreeCollapseOrDrillUpKeyStroke,kG as TreeExpandOrDrillDownKeyStroke,BG as TreeField,OG as TreeFieldAdapter,HG as TreeLayout,NG as TreeLayoutResetter,VG as TreeNavigationDownKeyStroke,WG as TreeNavigationEndKeyStroke,KG as TreeNavigationUpKeyStroke,zG as TreeNode,GG as TreeProposalChooser,UG as TreeSet,qG as TreeSpaceKeyStroke,YG as TreeVisitResult,jG as TypeDescriptor,XG as URL,JG as UnsavedFormChangesForm,QG as UnsavedFormsLookupCall,ZG as UserAgent,e1 as UuidPool,t1 as UuidPoolAdapter,i1 as ValidationFailedStatus,r1 as ValueField,s1 as ValueFieldAdapter,o1 as VerticalGridMatrix,n1 as VerticalSmartGrid,l1 as ViewButton,a1 as ViewButtonActionKeyStroke,d1 as ViewButtonAdapter,h1 as ViewButtonBox,u1 as ViewMenuOpenKeyStroke,c1 as ViewMenuPopup,p1 as ViewMenuPopupEnterKeyStroke,f1 as ViewMenuTab,m1 as ViewportScroller,g1 as VirtualKeyStrokeEvent,_1 as VirtualScrolling,b1 as Widget,y1 as WidgetEventTypeFilter,v1 as WidgetField,w1 as WidgetFieldAdapter,T1 as WidgetFieldLayout,S1 as WidgetPopup,C1 as WidgetPopupAdapter,P1 as WidgetPopupLayout,x1 as WidgetSupport,F1 as WidgetTile,E1 as WidgetTileAdapter,A1 as WidgetTooltip,D1 as WizardProgressField,M1 as WizardProgressFieldAdapter,$1 as WizardProgressFieldLayout,R1 as WrappedFormField,L1 as WrappedFormFieldAdapter,I1 as YearPanel,k1 as aggregation,B1 as ajax,O1 as arrays,H1 as clipboard,N1 as codes,V1 as colorSchemes,W1 as comparators,K1 as cookies,z1 as dates,G1 as default,U1 as defaultValues,q1 as dragAndDrop,Y1 as events,j1 as fields,X1 as files,J1 as filters,Q1 as focusUtils,Z1 as fonts,eU as graphics,tU as icons,iU as inspector,rU as isPropertyChangeEvent,sU as keyStrokeModifier,oU as keys,nU as locales,lU as logging,aU as lookupField,dU as menuNavigationKeyStrokes,hU as menus,uU as mimeTypes,cU as models,pU as numbers,fU as objects,mU as promises,gU as router,_U as scout,bU as scrollbars,yU as strings,vU as styles,wU as texts,TU as tooltips,SU as webstorage,CU as widgets};

//# sourceMappingURL=eclipse-scout-core.esm-6eedcda9eea09cc7ef20.min.js.map